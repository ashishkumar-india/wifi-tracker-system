2025-12-28 21:27:25,259 - app.main - INFO - Starting WiFi Tracker System...
2025-12-28 21:27:25,269 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-28 21:27:25,270 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:27:25,275 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-28 21:27:25,277 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:27:25,281 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-28 21:27:25,283 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:27:25,289 - app.database - ERROR - Database connection check failed: Not an executable object: 'SELECT 1'
2025-12-28 21:27:25,290 - app.main - ERROR - Database connection failed!
2025-12-28 21:28:30,841 - app.database - ERROR - Database connection check failed: Not an executable object: 'SELECT 1'
2025-12-28 21:30:43,301 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-28 21:31:11,414 - app.main - INFO - Starting WiFi Tracker System...
2025-12-28 21:31:11,424 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-28 21:31:11,425 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:31:11,427 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-28 21:31:11,429 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:31:11,431 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-28 21:31:11,433 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:31:11,441 - app.database - ERROR - Database connection check failed: Not an executable object: 'SELECT 1'
2025-12-28 21:31:11,442 - app.main - ERROR - Database connection failed!
2025-12-28 21:31:40,391 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-28 21:31:56,115 - app.main - INFO - Starting WiFi Tracker System...
2025-12-28 21:31:56,123 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-28 21:31:56,124 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:31:56,128 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-28 21:31:56,129 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:31:56,131 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-28 21:31:56,133 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:31:56,137 - app.database - ERROR - Database connection check failed: Not an executable object: 'SELECT 1'
2025-12-28 21:31:56,138 - app.main - ERROR - Database connection failed!
2025-12-28 21:32:24,678 - app.main - INFO - Starting WiFi Tracker System...
2025-12-28 21:32:24,687 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-28 21:32:24,689 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:32:24,693 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-28 21:32:24,697 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:32:24,699 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-28 21:32:24,699 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:32:24,705 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:32:24,706 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-28 21:32:24,710 - sqlalchemy.engine.Engine - INFO - [generated in 0.00454s] {}
2025-12-28 21:32:24,713 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:32:24,714 - app.main - INFO - Database connection successful
2025-12-28 21:32:24,715 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:32:24,716 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-28 21:32:24,720 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:32:24,741 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-28 21:32:24,744 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:32:24,755 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-28 21:32:24,756 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:32:24,781 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-28 21:32:24,784 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:32:24,792 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-28 21:32:24,797 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:32:24,804 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-28 21:32:24,806 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:32:24,815 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-28 21:32:24,816 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:32:24,827 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-28 21:32:24,831 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:32:24,844 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 21:32:24,847 - app.database - INFO - Database tables initialized successfully
2025-12-28 21:32:46,360 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:32:46,361 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-28 21:32:46,361 - sqlalchemy.engine.Engine - INFO - [cached since 21.66s ago] {}
2025-12-28 21:32:46,363 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:33:00,970 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:33:00,980 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.username = %(username_1)s 
 LIMIT %(param_1)s
2025-12-28 21:33:00,985 - sqlalchemy.engine.Engine - INFO - [generated in 0.00438s] {'username_1': 'admin', 'param_1': 1}
2025-12-28 21:33:00,989 - app.database - ERROR - Database session error: 'admin' is not among the defined enum values. Enum name: userrole. Possible values: ADMIN, VIEWER
2025-12-28 21:33:00,990 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:33:00,994 - app.main - ERROR - Unhandled exception: 'admin' is not among the defined enum values. Enum name: userrole. Possible values: ADMIN, VIEWER
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'admin'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\auth.py", line 125, in login
    user = db.query(User).filter(User.username == form_data.username).first()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2759, in first
    return self.limit(1)._iter().first()  # type: ignore
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1791, in first
    return self._only_one_row(
           ~~~~~~~~~~~~~~~~~~^
        raise_for_second_row=False, raise_for_none=False, scalar=False
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 757, in _only_one_row
    row: Optional[_InterimRowType[Any]] = onerow(hard_close=True)
                                          ~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1678, in _fetchone_impl
    return self._real_result._fetchone_impl(hard_close=hard_close)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2264, in _fetchone_impl
    row = next(self.iterator, _NO_ROW)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'admin' is not among the defined enum values. Enum name: userrole. Possible values: ADMIN, VIEWER
2025-12-28 21:33:57,701 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-28 21:34:09,696 - app.main - INFO - Starting WiFi Tracker System...
2025-12-28 21:34:09,703 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-28 21:34:09,704 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:09,707 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-28 21:34:09,708 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:09,710 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-28 21:34:09,711 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:09,715 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:34:09,718 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-28 21:34:09,720 - sqlalchemy.engine.Engine - INFO - [generated in 0.00518s] {}
2025-12-28 21:34:09,722 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:34:09,723 - app.main - INFO - Database connection successful
2025-12-28 21:34:09,724 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:34:09,728 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-28 21:34:09,729 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:09,752 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-28 21:34:09,755 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:09,762 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-28 21:34:09,763 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:09,773 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-28 21:34:09,774 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:09,784 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-28 21:34:09,789 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:09,796 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-28 21:34:09,797 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:09,820 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-28 21:34:09,823 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:09,836 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-28 21:34:09,841 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:09,849 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 21:34:09,854 - app.database - INFO - Database tables initialized successfully
2025-12-28 21:34:20,460 - app.main - INFO - Starting WiFi Tracker System...
2025-12-28 21:34:20,467 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-28 21:34:20,468 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:20,471 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-28 21:34:20,473 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:20,475 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-28 21:34:20,476 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:20,482 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:34:20,485 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-28 21:34:20,487 - sqlalchemy.engine.Engine - INFO - [generated in 0.00437s] {}
2025-12-28 21:34:20,489 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:34:20,490 - app.main - INFO - Database connection successful
2025-12-28 21:34:20,490 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:34:20,492 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-28 21:34:20,493 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:20,516 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-28 21:34:20,519 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:20,545 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-28 21:34:20,547 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:20,560 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-28 21:34:20,562 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:20,573 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-28 21:34:20,576 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:20,588 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-28 21:34:20,589 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:20,599 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-28 21:34:20,602 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:20,612 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-28 21:34:20,614 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:20,627 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 21:34:20,629 - app.database - INFO - Database tables initialized successfully
2025-12-28 21:34:31,844 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-28 21:34:42,578 - app.main - INFO - Starting WiFi Tracker System...
2025-12-28 21:34:42,586 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-28 21:34:42,587 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:42,590 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-28 21:34:42,591 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:42,594 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-28 21:34:42,595 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:42,600 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:34:42,601 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-28 21:34:42,602 - sqlalchemy.engine.Engine - INFO - [generated in 0.00170s] {}
2025-12-28 21:34:42,603 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:34:42,605 - app.main - INFO - Database connection successful
2025-12-28 21:34:42,605 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:34:42,607 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-28 21:34:42,607 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:42,633 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-28 21:34:42,635 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:42,663 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-28 21:34:42,686 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:42,703 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-28 21:34:42,707 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:42,722 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-28 21:34:42,730 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:42,739 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-28 21:34:42,741 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:42,755 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-28 21:34:42,757 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:42,771 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-28 21:34:42,772 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:34:42,786 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 21:34:42,788 - app.database - INFO - Database tables initialized successfully
2025-12-28 21:35:14,118 - app.main - INFO - Starting WiFi Tracker System...
2025-12-28 21:35:14,126 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-28 21:35:14,127 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:35:14,129 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-28 21:35:14,132 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:35:14,135 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-28 21:35:14,140 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:35:14,143 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:35:14,145 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-28 21:35:14,145 - sqlalchemy.engine.Engine - INFO - [generated in 0.00266s] {}
2025-12-28 21:35:14,147 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:35:14,148 - app.main - INFO - Database connection successful
2025-12-28 21:35:14,148 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:35:14,150 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-28 21:35:14,152 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:35:14,178 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-28 21:35:14,179 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:35:14,202 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-28 21:35:14,207 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:35:14,217 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-28 21:35:14,222 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:35:14,230 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-28 21:35:14,232 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:35:14,242 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-28 21:35:14,245 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:35:14,253 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-28 21:35:14,257 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:35:14,265 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-28 21:35:14,266 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:35:14,277 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 21:35:14,278 - app.database - INFO - Database tables initialized successfully
2025-12-28 21:35:37,099 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:35:37,104 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.username = %(username_1)s 
 LIMIT %(param_1)s
2025-12-28 21:35:37,108 - sqlalchemy.engine.Engine - INFO - [generated in 0.00423s] {'username_1': 'admin', 'param_1': 1}
2025-12-28 21:35:37,114 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-12-28 21:35:37,130 - app.database - ERROR - Database session error: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])
2025-12-28 21:35:37,133 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:35:37,137 - app.main - ERROR - Unhandled exception: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\auth.py", line 127, in login
    if not user or not verify_password(form_data.password, user.password_hash):
                       ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\utils\security.py", line 28, in verify_password
    return pwd_context.verify(plain_password, hashed_password)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\context.py", line 2347, in verify
    return record.verify(secret, hash, **kwds)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\utils\handlers.py", line 792, in verify
    return consteq(self._calc_checksum(secret), chk)
                   ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\handlers\bcrypt.py", line 591, in _calc_checksum
    self._stub_requires_backend()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\utils\handlers.py", line 2254, in _stub_requires_backend
    cls.set_backend()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\utils\handlers.py", line 2156, in set_backend
    return owner.set_backend(name, dryrun=dryrun)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\utils\handlers.py", line 2163, in set_backend
    return cls.set_backend(name, dryrun=dryrun)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\utils\handlers.py", line 2188, in set_backend
    cls._set_backend(name, dryrun)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\utils\handlers.py", line 2311, in _set_backend
    super(SubclassBackendMixin, cls)._set_backend(name, dryrun)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\utils\handlers.py", line 2224, in _set_backend
    ok = loader(**kwds)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\handlers\bcrypt.py", line 626, in _load_backend_mixin
    return mixin_cls._finalize_backend_mixin(name, dryrun)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\handlers\bcrypt.py", line 421, in _finalize_backend_mixin
    if detect_wrap_bug(IDENT_2A):
       ~~~~~~~~~~~~~~~^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\handlers\bcrypt.py", line 380, in detect_wrap_bug
    if verify(secret, bug_hash):
       ~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\utils\handlers.py", line 792, in verify
    return consteq(self._calc_checksum(secret), chk)
                   ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\handlers\bcrypt.py", line 655, in _calc_checksum
    hash = _bcrypt.hashpw(secret, config)
ValueError: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])
2025-12-28 21:36:50,986 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:36:50,990 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.username = %(username_1)s 
 LIMIT %(param_1)s
2025-12-28 21:36:51,051 - sqlalchemy.engine.Engine - INFO - [cached since 73.95s ago] {'username_1': 'admin', 'param_1': 1}
2025-12-28 21:36:51,151 - app.database - ERROR - Database session error: hash could not be identified
2025-12-28 21:36:51,159 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:36:51,267 - app.main - ERROR - Unhandled exception: hash could not be identified
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\auth.py", line 127, in login
    if not user or not verify_password(form_data.password, user.password_hash):
                       ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\utils\security.py", line 28, in verify_password
    return pwd_context.verify(plain_password, hashed_password)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\context.py", line 2343, in verify
    record = self._get_or_identify_record(hash, scheme, category)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\context.py", line 2031, in _get_or_identify_record
    return self._identify_record(hash, category)
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\context.py", line 1132, in identify_record
    raise exc.UnknownHashError("hash could not be identified")
passlib.exc.UnknownHashError: hash could not be identified
2025-12-28 21:38:08,630 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:38:08,631 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.username = %(username_1)s 
 LIMIT %(param_1)s
2025-12-28 21:38:08,635 - sqlalchemy.engine.Engine - INFO - [cached since 151.5s ago] {'username_1': 'admin', 'param_1': 1}
2025-12-28 21:38:08,640 - app.database - ERROR - Database session error: hash could not be identified
2025-12-28 21:38:08,640 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:38:08,644 - app.main - ERROR - Unhandled exception: hash could not be identified
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\auth.py", line 127, in login
    if not user or not verify_password(form_data.password, user.password_hash):
                       ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\utils\security.py", line 28, in verify_password
    return pwd_context.verify(plain_password, hashed_password)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\context.py", line 2343, in verify
    record = self._get_or_identify_record(hash, scheme, category)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\context.py", line 2031, in _get_or_identify_record
    return self._identify_record(hash, category)
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\context.py", line 1132, in identify_record
    raise exc.UnknownHashError("hash could not be identified")
passlib.exc.UnknownHashError: hash could not be identified
2025-12-28 21:38:45,043 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-28 21:38:57,959 - app.main - INFO - Starting WiFi Tracker System...
2025-12-28 21:38:57,972 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-28 21:38:57,973 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:38:57,975 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-28 21:38:57,976 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:38:57,978 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-28 21:38:57,978 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:38:57,982 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:38:57,985 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-28 21:38:57,986 - sqlalchemy.engine.Engine - INFO - [generated in 0.00440s] {}
2025-12-28 21:38:57,988 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:38:57,989 - app.main - INFO - Database connection successful
2025-12-28 21:38:57,993 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:38:57,997 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-28 21:38:57,999 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:38:58,027 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-28 21:38:58,028 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:38:58,048 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-28 21:38:58,051 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:38:58,061 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-28 21:38:58,062 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:38:58,073 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-28 21:38:58,077 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:38:58,087 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-28 21:38:58,093 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:38:58,105 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-28 21:38:58,110 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:38:58,119 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-28 21:38:58,121 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:38:58,133 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 21:38:58,135 - app.database - INFO - Database tables initialized successfully
2025-12-28 21:39:09,498 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:39:09,506 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.username = %(username_1)s 
 LIMIT %(param_1)s
2025-12-28 21:39:09,511 - sqlalchemy.engine.Engine - INFO - [generated in 0.00534s] {'username_1': 'admin', 'param_1': 1}
2025-12-28 21:39:09,518 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-12-28 21:39:09,540 - app.database - ERROR - Database session error: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])
2025-12-28 21:39:09,541 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:39:09,544 - app.main - ERROR - Unhandled exception: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\auth.py", line 127, in login
    if not user or not verify_password(form_data.password, user.password_hash):
                       ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\utils\security.py", line 28, in verify_password
    return pwd_context.verify(plain_password, hashed_password)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\context.py", line 2347, in verify
    return record.verify(secret, hash, **kwds)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\utils\handlers.py", line 792, in verify
    return consteq(self._calc_checksum(secret), chk)
                   ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\handlers\bcrypt.py", line 591, in _calc_checksum
    self._stub_requires_backend()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\utils\handlers.py", line 2254, in _stub_requires_backend
    cls.set_backend()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\utils\handlers.py", line 2156, in set_backend
    return owner.set_backend(name, dryrun=dryrun)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\utils\handlers.py", line 2163, in set_backend
    return cls.set_backend(name, dryrun=dryrun)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\utils\handlers.py", line 2188, in set_backend
    cls._set_backend(name, dryrun)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\utils\handlers.py", line 2311, in _set_backend
    super(SubclassBackendMixin, cls)._set_backend(name, dryrun)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\utils\handlers.py", line 2224, in _set_backend
    ok = loader(**kwds)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\handlers\bcrypt.py", line 626, in _load_backend_mixin
    return mixin_cls._finalize_backend_mixin(name, dryrun)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\handlers\bcrypt.py", line 421, in _finalize_backend_mixin
    if detect_wrap_bug(IDENT_2A):
       ~~~~~~~~~~~~~~~^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\handlers\bcrypt.py", line 380, in detect_wrap_bug
    if verify(secret, bug_hash):
       ~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\utils\handlers.py", line 792, in verify
    return consteq(self._calc_checksum(secret), chk)
                   ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\handlers\bcrypt.py", line 655, in _calc_checksum
    hash = _bcrypt.hashpw(secret, config)
ValueError: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])
2025-12-28 21:39:53,182 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-28 21:40:18,426 - app.main - INFO - Starting WiFi Tracker System...
2025-12-28 21:40:18,434 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-28 21:40:18,435 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:40:18,438 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-28 21:40:18,440 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:40:18,442 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-28 21:40:18,443 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:40:18,450 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:40:18,451 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-28 21:40:18,453 - sqlalchemy.engine.Engine - INFO - [generated in 0.00282s] {}
2025-12-28 21:40:18,454 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:40:18,455 - app.main - INFO - Database connection successful
2025-12-28 21:40:18,456 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:40:18,457 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-28 21:40:18,459 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:40:18,481 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-28 21:40:18,485 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:40:18,510 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-28 21:40:18,511 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:40:18,521 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-28 21:40:18,526 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:40:18,539 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-28 21:40:18,542 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:40:18,551 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-28 21:40:18,554 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:40:18,566 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-28 21:40:18,568 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:40:18,580 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-28 21:40:18,584 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:40:18,593 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 21:40:18,595 - app.database - INFO - Database tables initialized successfully
2025-12-28 21:40:41,372 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:40:41,377 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.username = %(username_1)s 
 LIMIT %(param_1)s
2025-12-28 21:40:41,386 - sqlalchemy.engine.Engine - INFO - [generated in 0.00893s] {'username_1': 'admin', 'param_1': 1}
2025-12-28 21:40:41,396 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2025-12-28 21:40:41,410 - app.database - ERROR - Database session error: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])
2025-12-28 21:40:41,412 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:40:41,414 - app.main - ERROR - Unhandled exception: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\auth.py", line 127, in login
    if not user or not verify_password(form_data.password, user.password_hash):
                       ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\utils\security.py", line 28, in verify_password
    return pwd_context.verify(plain_password, hashed_password)
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\context.py", line 2347, in verify
    return record.verify(secret, hash, **kwds)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\utils\handlers.py", line 792, in verify
    return consteq(self._calc_checksum(secret), chk)
                   ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\handlers\bcrypt.py", line 591, in _calc_checksum
    self._stub_requires_backend()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\utils\handlers.py", line 2254, in _stub_requires_backend
    cls.set_backend()
    ~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\utils\handlers.py", line 2156, in set_backend
    return owner.set_backend(name, dryrun=dryrun)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\utils\handlers.py", line 2163, in set_backend
    return cls.set_backend(name, dryrun=dryrun)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\utils\handlers.py", line 2188, in set_backend
    cls._set_backend(name, dryrun)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\utils\handlers.py", line 2311, in _set_backend
    super(SubclassBackendMixin, cls)._set_backend(name, dryrun)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\utils\handlers.py", line 2224, in _set_backend
    ok = loader(**kwds)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\handlers\bcrypt.py", line 626, in _load_backend_mixin
    return mixin_cls._finalize_backend_mixin(name, dryrun)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\handlers\bcrypt.py", line 421, in _finalize_backend_mixin
    if detect_wrap_bug(IDENT_2A):
       ~~~~~~~~~~~~~~~^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\handlers\bcrypt.py", line 380, in detect_wrap_bug
    if verify(secret, bug_hash):
       ~~~~~~^^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\utils\handlers.py", line 792, in verify
    return consteq(self._calc_checksum(secret), chk)
                   ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\passlib\handlers\bcrypt.py", line 655, in _calc_checksum
    hash = _bcrypt.hashpw(secret, config)
ValueError: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])
2025-12-28 21:40:59,381 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-28 21:41:12,836 - app.main - INFO - Starting WiFi Tracker System...
2025-12-28 21:41:12,843 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-28 21:41:12,844 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:41:12,847 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-28 21:41:12,848 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:41:12,850 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-28 21:41:12,852 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:41:12,855 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:41:12,856 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-28 21:41:12,859 - sqlalchemy.engine.Engine - INFO - [generated in 0.00421s] {}
2025-12-28 21:41:12,860 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:41:12,862 - app.main - INFO - Database connection successful
2025-12-28 21:41:12,863 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:41:12,864 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-28 21:41:12,865 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:41:12,892 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-28 21:41:12,895 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:41:12,916 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-28 21:41:12,921 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:41:12,928 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-28 21:41:12,930 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:41:12,941 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-28 21:41:12,948 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:41:12,958 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-28 21:41:12,962 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:41:12,974 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-28 21:41:12,975 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:41:12,983 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-28 21:41:12,986 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:41:12,997 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 21:41:12,999 - app.database - INFO - Database tables initialized successfully
2025-12-28 21:41:45,214 - app.main - INFO - Starting WiFi Tracker System...
2025-12-28 21:41:45,222 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-28 21:41:45,223 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:41:45,227 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-28 21:41:45,228 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:41:45,230 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-28 21:41:45,231 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:41:45,235 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:41:45,236 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-28 21:41:45,237 - sqlalchemy.engine.Engine - INFO - [generated in 0.00182s] {}
2025-12-28 21:41:45,238 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:41:45,240 - app.main - INFO - Database connection successful
2025-12-28 21:41:45,240 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:41:45,242 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-28 21:41:45,245 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:41:45,272 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-28 21:41:45,274 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:41:45,286 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-28 21:41:45,287 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:41:45,299 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-28 21:41:45,301 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:41:45,311 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-28 21:41:45,314 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:41:45,323 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-28 21:41:45,324 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:41:45,336 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-28 21:41:45,337 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:41:45,349 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-28 21:41:45,351 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:41:45,363 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 21:41:45,365 - app.database - INFO - Database tables initialized successfully
2025-12-28 21:42:07,893 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:42:07,898 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.username = %(username_1)s 
 LIMIT %(param_1)s
2025-12-28 21:42:07,901 - sqlalchemy.engine.Engine - INFO - [generated in 0.00306s] {'username_1': 'admin', 'param_1': 1}
2025-12-28 21:42:08,314 - sqlalchemy.engine.Engine - INFO - UPDATE users SET last_login=%(last_login)s WHERE users.id = %(users_id)s
2025-12-28 21:42:08,315 - sqlalchemy.engine.Engine - INFO - [generated in 0.00120s] {'last_login': datetime.datetime(2025, 12, 28, 16, 12, 8, 312406), 'users_id': 1}
2025-12-28 21:42:08,319 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 21:42:08,324 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:42:08,326 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-28 21:42:08,333 - sqlalchemy.engine.Engine - INFO - [generated in 0.00698s] {'pk_1': 1}
2025-12-28 21:42:08,372 - app.routers.auth - INFO - User logged in: admin
2025-12-28 21:42:08,378 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:42:27,707 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:42:27,728 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.username = %(username_1)s 
 LIMIT %(param_1)s
2025-12-28 21:42:27,743 - sqlalchemy.engine.Engine - INFO - [cached since 19.85s ago] {'username_1': 'admin', 'param_1': 1}
2025-12-28 21:42:28,274 - sqlalchemy.engine.Engine - INFO - UPDATE users SET last_login=%(last_login)s WHERE users.id = %(users_id)s
2025-12-28 21:42:28,275 - sqlalchemy.engine.Engine - INFO - [cached since 19.96s ago] {'last_login': datetime.datetime(2025, 12, 28, 16, 12, 28, 274290), 'users_id': 1}
2025-12-28 21:42:28,278 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 21:42:28,282 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:42:28,284 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-28 21:42:28,289 - sqlalchemy.engine.Engine - INFO - [cached since 19.96s ago] {'pk_1': 1}
2025-12-28 21:42:28,292 - app.routers.auth - INFO - User logged in: admin
2025-12-28 21:42:28,296 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:42:28,406 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:42:28,408 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:42:28,411 - sqlalchemy.engine.Engine - INFO - [generated in 0.00340s] {'id_1': 1, 'param_1': 1}
2025-12-28 21:42:28,431 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 21:42:28,441 - sqlalchemy.engine.Engine - INFO - [generated in 0.00974s] {}
2025-12-28 21:42:28,447 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 21:42:28,463 - sqlalchemy.engine.Engine - INFO - [generated in 0.01571s] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 2, 28, 444385)}
2025-12-28 21:42:28,478 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 21:42:28,485 - sqlalchemy.engine.Engine - INFO - [generated in 0.00694s] {}
2025-12-28 21:42:28,494 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 21:42:28,501 - sqlalchemy.engine.Engine - INFO - [generated in 0.00761s] {}
2025-12-28 21:42:28,508 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 21:42:28,519 - sqlalchemy.engine.Engine - INFO - [generated in 0.01062s] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 21:42:28,540 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 21:42:28,544 - sqlalchemy.engine.Engine - INFO - [generated in 0.00436s] {}
2025-12-28 21:42:28,552 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 21:42:28,560 - sqlalchemy.engine.Engine - INFO - [generated in 0.00825s] {}
2025-12-28 21:42:28,569 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 21:42:28,580 - sqlalchemy.engine.Engine - INFO - [generated in 0.01158s] {'status_1': 'COMPLETED'}
2025-12-28 21:42:28,589 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 21:42:28,603 - sqlalchemy.engine.Engine - INFO - [generated in 0.01398s] {'status_1': 'COMPLETED', 'param_1': 1}
2025-12-28 21:42:28,611 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 21:42:28,614 - sqlalchemy.engine.Engine - INFO - [generated in 0.00350s] {}
2025-12-28 21:42:28,625 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:48:02,070 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:48:02,130 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.username = %(username_1)s 
 LIMIT %(param_1)s
2025-12-28 21:48:02,282 - sqlalchemy.engine.Engine - INFO - [cached since 354.4s ago] {'username_1': 'admin', 'param_1': 1}
2025-12-28 21:48:04,175 - sqlalchemy.engine.Engine - INFO - UPDATE users SET last_login=%(last_login)s WHERE users.id = %(users_id)s
2025-12-28 21:48:04,180 - sqlalchemy.engine.Engine - INFO - [cached since 355.9s ago] {'last_login': datetime.datetime(2025, 12, 28, 16, 18, 4, 174287), 'users_id': 1}
2025-12-28 21:48:04,197 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 21:48:04,212 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:48:04,223 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-28 21:48:04,281 - sqlalchemy.engine.Engine - INFO - [cached since 356s ago] {'pk_1': 1}
2025-12-28 21:48:04,300 - app.routers.auth - INFO - User logged in: admin
2025-12-28 21:48:04,317 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:48:04,714 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:48:04,731 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:48:04,843 - sqlalchemy.engine.Engine - INFO - [cached since 336.4s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:48:04,915 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:48:05,002 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:48:05,010 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:48:05,023 - sqlalchemy.engine.Engine - INFO - [cached since 336.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:48:05,030 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 21:48:05,048 - sqlalchemy.engine.Engine - INFO - [cached since 336.6s ago] {}
2025-12-28 21:48:05,060 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 21:48:05,082 - sqlalchemy.engine.Engine - INFO - [cached since 336.6s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 8, 5, 58879)}
2025-12-28 21:48:05,091 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 21:48:05,117 - sqlalchemy.engine.Engine - INFO - [cached since 336.6s ago] {}
2025-12-28 21:48:05,127 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 21:48:05,174 - sqlalchemy.engine.Engine - INFO - [cached since 336.7s ago] {}
2025-12-28 21:48:05,185 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 21:48:05,222 - sqlalchemy.engine.Engine - INFO - [cached since 336.7s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 21:48:05,230 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 21:48:05,262 - sqlalchemy.engine.Engine - INFO - [cached since 336.7s ago] {}
2025-12-28 21:48:05,293 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 21:48:05,379 - sqlalchemy.engine.Engine - INFO - [cached since 336.8s ago] {}
2025-12-28 21:48:05,411 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 21:48:05,465 - sqlalchemy.engine.Engine - INFO - [cached since 336.9s ago] {'status_1': 'COMPLETED'}
2025-12-28 21:48:05,480 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 21:48:05,511 - sqlalchemy.engine.Engine - INFO - [cached since 336.9s ago] {'status_1': 'COMPLETED', 'param_1': 1}
2025-12-28 21:48:05,520 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 21:48:05,528 - sqlalchemy.engine.Engine - INFO - [cached since 336.9s ago] {}
2025-12-28 21:48:05,553 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:48:05,563 - app.services.notification - INFO - WebSocket client registered. Total: 1
2025-12-28 21:48:05,583 - app.main - INFO - WebSocket client connected
2025-12-28 21:48:05,646 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:48:05,678 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:48:05,717 - sqlalchemy.engine.Engine - INFO - [cached since 337.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:48:05,736 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:48:05,765 - sqlalchemy.engine.Engine - INFO - [generated in 0.02975s] {'id_1': 7, 'param_1': 1}
2025-12-28 21:48:05,805 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 21:48:05,814 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:48:05,913 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:48:05,923 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:48:05,943 - sqlalchemy.engine.Engine - INFO - [cached since 337.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:48:05,955 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 21:48:05,977 - sqlalchemy.engine.Engine - INFO - [cached since 337.5s ago] {}
2025-12-28 21:48:05,985 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 21:48:06,006 - sqlalchemy.engine.Engine - INFO - [cached since 337.6s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 8, 5, 983935)}
2025-12-28 21:48:06,016 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 21:48:06,036 - sqlalchemy.engine.Engine - INFO - [cached since 337.6s ago] {}
2025-12-28 21:48:06,045 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 21:48:06,068 - sqlalchemy.engine.Engine - INFO - [cached since 337.6s ago] {}
2025-12-28 21:48:06,074 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 21:48:06,106 - sqlalchemy.engine.Engine - INFO - [cached since 337.6s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 21:48:06,116 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 21:48:06,139 - sqlalchemy.engine.Engine - INFO - [cached since 337.6s ago] {}
2025-12-28 21:48:06,145 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 21:48:06,175 - sqlalchemy.engine.Engine - INFO - [cached since 337.6s ago] {}
2025-12-28 21:48:06,180 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 21:48:06,332 - sqlalchemy.engine.Engine - INFO - [cached since 337.8s ago] {'status_1': 'COMPLETED'}
2025-12-28 21:48:06,400 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 21:48:06,497 - sqlalchemy.engine.Engine - INFO - [cached since 337.9s ago] {'status_1': 'COMPLETED', 'param_1': 1}
2025-12-28 21:48:06,520 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 21:48:06,541 - sqlalchemy.engine.Engine - INFO - [cached since 337.9s ago] {}
2025-12-28 21:48:06,555 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:48:06,665 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:48:06,672 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:48:06,681 - sqlalchemy.engine.Engine - INFO - [cached since 338.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:48:06,689 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 21:48:06,695 - sqlalchemy.engine.Engine - INFO - [generated in 0.00618s] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 16, 18, 6, 685940), 'param_1': 100}
2025-12-28 21:48:06,703 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:50:38,085 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:50:38,088 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:50:38,091 - sqlalchemy.engine.Engine - INFO - [cached since 489.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:50:38,124 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-28 21:50:38,126 - sqlalchemy.engine.Engine - INFO - [generated in 0.00328s] {'started_at': datetime.datetime(2025, 12, 28, 16, 20, 38, 124019), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'ARP', 'network_range': '192.168.1.0/24', 'status': 'RUNNING', 'error_message': None}
2025-12-28 21:50:38,131 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 21:50:38,138 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:50:38,143 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-28 21:50:38,148 - sqlalchemy.engine.Engine - INFO - [generated in 0.00526s] {'pk_1': 1}
2025-12-28 21:50:38,158 - app.database - ERROR - Database session error: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
2025-12-28 21:50:38,158 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:50:38,161 - app.main - ERROR - Unhandled exception: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'arp'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\scans.py", line 190, in start_scan
    db.refresh(session)
    ~~~~~~~~~~^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\session.py", line 3154, in refresh
    loading.load_on_ident(
    ~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<10 lines>...
        is_user_refresh=True,
        ^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 510, in load_on_ident
    return load_on_pk_identity(
        session,
    ...<11 lines>...
        is_user_refresh=is_user_refresh,
    )
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 706, in load_on_pk_identity
    return result.one()
           ~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1815, in one
    return self._only_one_row(
           ~~~~~~~~~~~~~~~~~~^
        raise_for_second_row=True, raise_for_none=True, scalar=False
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 757, in _only_one_row
    row: Optional[_InterimRowType[Any]] = onerow(hard_close=True)
                                          ~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1678, in _fetchone_impl
    return self._real_result._fetchone_impl(hard_close=hard_close)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2264, in _fetchone_impl
    row = next(self.iterator, _NO_ROW)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
2025-12-28 21:50:40,307 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:50:40,308 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:50:40,311 - sqlalchemy.engine.Engine - INFO - [cached since 491.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:50:40,315 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-28 21:50:40,323 - sqlalchemy.engine.Engine - INFO - [cached since 2.2s ago] {'started_at': datetime.datetime(2025, 12, 28, 16, 20, 40, 315389), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'ARP', 'network_range': '192.168.1.0/24', 'status': 'RUNNING', 'error_message': None}
2025-12-28 21:50:40,330 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 21:50:40,335 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:50:40,339 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-28 21:50:40,343 - sqlalchemy.engine.Engine - INFO - [cached since 2.2s ago] {'pk_1': 2}
2025-12-28 21:50:40,345 - app.database - ERROR - Database session error: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
2025-12-28 21:50:40,346 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:50:40,349 - app.main - ERROR - Unhandled exception: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'arp'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\scans.py", line 190, in start_scan
    db.refresh(session)
    ~~~~~~~~~~^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\session.py", line 3154, in refresh
    loading.load_on_ident(
    ~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<10 lines>...
        is_user_refresh=True,
        ^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 510, in load_on_ident
    return load_on_pk_identity(
        session,
    ...<11 lines>...
        is_user_refresh=is_user_refresh,
    )
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 706, in load_on_pk_identity
    return result.one()
           ~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1815, in one
    return self._only_one_row(
           ~~~~~~~~~~~~~~~~~~^
        raise_for_second_row=True, raise_for_none=True, scalar=False
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 757, in _only_one_row
    row: Optional[_InterimRowType[Any]] = onerow(hard_close=True)
                                          ~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1678, in _fetchone_impl
    return self._real_result._fetchone_impl(hard_close=hard_close)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2264, in _fetchone_impl
    row = next(self.iterator, _NO_ROW)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
2025-12-28 21:51:27,379 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:51:27,381 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:51:27,384 - sqlalchemy.engine.Engine - INFO - [cached since 539s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:51:27,388 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-28 21:51:27,394 - sqlalchemy.engine.Engine - INFO - [cached since 49.27s ago] {'started_at': datetime.datetime(2025, 12, 28, 16, 21, 27, 388756), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'ARP', 'network_range': '192.168.1.0/24', 'status': 'RUNNING', 'error_message': None}
2025-12-28 21:51:27,401 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 21:51:27,406 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:51:27,411 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-28 21:51:27,416 - sqlalchemy.engine.Engine - INFO - [cached since 49.27s ago] {'pk_1': 3}
2025-12-28 21:51:27,420 - app.database - ERROR - Database session error: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
2025-12-28 21:51:27,424 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:51:27,426 - app.main - ERROR - Unhandled exception: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'arp'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\scans.py", line 190, in start_scan
    db.refresh(session)
    ~~~~~~~~~~^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\session.py", line 3154, in refresh
    loading.load_on_ident(
    ~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<10 lines>...
        is_user_refresh=True,
        ^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 510, in load_on_ident
    return load_on_pk_identity(
        session,
    ...<11 lines>...
        is_user_refresh=is_user_refresh,
    )
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 706, in load_on_pk_identity
    return result.one()
           ~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1815, in one
    return self._only_one_row(
           ~~~~~~~~~~~~~~~~~~^
        raise_for_second_row=True, raise_for_none=True, scalar=False
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 757, in _only_one_row
    row: Optional[_InterimRowType[Any]] = onerow(hard_close=True)
                                          ~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1678, in _fetchone_impl
    return self._real_result._fetchone_impl(hard_close=hard_close)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2264, in _fetchone_impl
    row = next(self.iterator, _NO_ROW)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
2025-12-28 21:51:31,050 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:51:31,052 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:51:31,061 - sqlalchemy.engine.Engine - INFO - [cached since 542.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:51:31,066 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 21:51:31,069 - sqlalchemy.engine.Engine - INFO - [cached since 542.6s ago] {}
2025-12-28 21:51:31,077 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-28 21:51:31,080 - sqlalchemy.engine.Engine - INFO - [generated in 0.00326s] {'param_1': 0, 'param_2': 20}
2025-12-28 21:51:31,091 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:51:32,099 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:51:32,101 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:51:32,110 - sqlalchemy.engine.Engine - INFO - [cached since 543.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:51:32,114 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 21:51:32,129 - sqlalchemy.engine.Engine - INFO - [cached since 543.5s ago] {'status_1': 'COMPLETED', 'param_1': 1}
2025-12-28 21:51:32,134 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:51:32,150 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:51:32,155 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:51:32,162 - sqlalchemy.engine.Engine - INFO - [cached since 543.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:51:32,167 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:51:33,913 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:51:33,914 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:51:33,917 - sqlalchemy.engine.Engine - INFO - [cached since 545.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:51:33,924 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-28 21:51:33,926 - sqlalchemy.engine.Engine - INFO - [cached since 55.8s ago] {'started_at': datetime.datetime(2025, 12, 28, 16, 21, 33, 924148), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'ARP', 'network_range': '192.168.1.0/24', 'status': 'RUNNING', 'error_message': None}
2025-12-28 21:51:33,931 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 21:51:33,936 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:51:33,942 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-28 21:51:33,944 - sqlalchemy.engine.Engine - INFO - [cached since 55.8s ago] {'pk_1': 4}
2025-12-28 21:51:33,946 - app.database - ERROR - Database session error: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
2025-12-28 21:51:33,947 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:51:33,949 - app.main - ERROR - Unhandled exception: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'arp'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\scans.py", line 190, in start_scan
    db.refresh(session)
    ~~~~~~~~~~^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\session.py", line 3154, in refresh
    loading.load_on_ident(
    ~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<10 lines>...
        is_user_refresh=True,
        ^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 510, in load_on_ident
    return load_on_pk_identity(
        session,
    ...<11 lines>...
        is_user_refresh=is_user_refresh,
    )
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 706, in load_on_pk_identity
    return result.one()
           ~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1815, in one
    return self._only_one_row(
           ~~~~~~~~~~~~~~~~~~^
        raise_for_second_row=True, raise_for_none=True, scalar=False
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 757, in _only_one_row
    row: Optional[_InterimRowType[Any]] = onerow(hard_close=True)
                                          ~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1678, in _fetchone_impl
    return self._real_result._fetchone_impl(hard_close=hard_close)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2264, in _fetchone_impl
    row = next(self.iterator, _NO_ROW)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
2025-12-28 21:51:42,840 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:51:42,842 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:51:42,844 - sqlalchemy.engine.Engine - INFO - [cached since 554.4s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:51:42,847 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-28 21:51:42,851 - sqlalchemy.engine.Engine - INFO - [cached since 64.73s ago] {'started_at': datetime.datetime(2025, 12, 28, 16, 21, 42, 847336), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'ARP', 'network_range': '192.168.1.0/24', 'status': 'RUNNING', 'error_message': None}
2025-12-28 21:51:42,857 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 21:51:42,861 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:51:42,862 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-28 21:51:42,864 - sqlalchemy.engine.Engine - INFO - [cached since 64.72s ago] {'pk_1': 5}
2025-12-28 21:51:42,868 - app.database - ERROR - Database session error: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
2025-12-28 21:51:42,869 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:51:42,871 - app.main - ERROR - Unhandled exception: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'arp'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\scans.py", line 190, in start_scan
    db.refresh(session)
    ~~~~~~~~~~^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\session.py", line 3154, in refresh
    loading.load_on_ident(
    ~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<10 lines>...
        is_user_refresh=True,
        ^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 510, in load_on_ident
    return load_on_pk_identity(
        session,
    ...<11 lines>...
        is_user_refresh=is_user_refresh,
    )
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 706, in load_on_pk_identity
    return result.one()
           ~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1815, in one
    return self._only_one_row(
           ~~~~~~~~~~~~~~~~~~^
        raise_for_second_row=True, raise_for_none=True, scalar=False
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 757, in _only_one_row
    row: Optional[_InterimRowType[Any]] = onerow(hard_close=True)
                                          ~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1678, in _fetchone_impl
    return self._real_result._fetchone_impl(hard_close=hard_close)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2264, in _fetchone_impl
    row = next(self.iterator, _NO_ROW)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
2025-12-28 21:51:47,105 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:51:47,106 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:51:47,109 - sqlalchemy.engine.Engine - INFO - [cached since 558.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:51:47,113 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 21:51:47,122 - sqlalchemy.engine.Engine - INFO - [cached since 558.6s ago] {}
2025-12-28 21:51:47,125 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 21:51:47,130 - sqlalchemy.engine.Engine - INFO - [cached since 558.6s ago] {}
2025-12-28 21:51:47,137 - sqlalchemy.engine.Engine - INFO - SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts ORDER BY alerts.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-28 21:51:47,142 - sqlalchemy.engine.Engine - INFO - [generated in 0.00510s] {'param_1': 0, 'param_2': 20}
2025-12-28 21:51:47,147 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:51:47,741 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:51:47,742 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:51:47,744 - sqlalchemy.engine.Engine - INFO - [cached since 559.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:51:47,749 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:51:52,123 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:51:52,125 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:51:52,127 - sqlalchemy.engine.Engine - INFO - [cached since 563.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:51:52,130 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-28 21:51:52,136 - sqlalchemy.engine.Engine - INFO - [cached since 74.01s ago] {'started_at': datetime.datetime(2025, 12, 28, 16, 21, 52, 130159), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'ARP', 'network_range': '192.168.1.0/24', 'status': 'RUNNING', 'error_message': None}
2025-12-28 21:51:52,141 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 21:51:52,144 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:51:52,146 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-28 21:51:52,152 - sqlalchemy.engine.Engine - INFO - [cached since 74.01s ago] {'pk_1': 6}
2025-12-28 21:51:52,155 - app.database - ERROR - Database session error: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
2025-12-28 21:51:52,156 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:51:52,158 - app.main - ERROR - Unhandled exception: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'arp'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\scans.py", line 190, in start_scan
    db.refresh(session)
    ~~~~~~~~~~^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\session.py", line 3154, in refresh
    loading.load_on_ident(
    ~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<10 lines>...
        is_user_refresh=True,
        ^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 510, in load_on_ident
    return load_on_pk_identity(
        session,
    ...<11 lines>...
        is_user_refresh=is_user_refresh,
    )
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 706, in load_on_pk_identity
    return result.one()
           ~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1815, in one
    return self._only_one_row(
           ~~~~~~~~~~~~~~~~~~^
        raise_for_second_row=True, raise_for_none=True, scalar=False
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 757, in _only_one_row
    row: Optional[_InterimRowType[Any]] = onerow(hard_close=True)
                                          ~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1678, in _fetchone_impl
    return self._real_result._fetchone_impl(hard_close=hard_close)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2264, in _fetchone_impl
    row = next(self.iterator, _NO_ROW)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
2025-12-28 21:51:53,793 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:51:54,086 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:51:54,093 - sqlalchemy.engine.Engine - INFO - [cached since 565.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:51:54,101 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices
2025-12-28 21:51:54,111 - sqlalchemy.engine.Engine - INFO - [generated in 0.00994s] {}
2025-12-28 21:51:54,116 - app.ml.detector - INFO - Training anomaly detector with 0 devices
2025-12-28 21:51:54,120 - app.routers.dashboard - INFO - ML training initiated by admin: {'status': 'insufficient_data', 'samples': 0, 'required': 100}
2025-12-28 21:51:54,123 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:52:43,993 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:52:43,994 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:52:44,001 - sqlalchemy.engine.Engine - INFO - [cached since 615.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:52:44,009 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-28 21:52:44,013 - sqlalchemy.engine.Engine - INFO - [cached since 125.9s ago] {'started_at': datetime.datetime(2025, 12, 28, 16, 22, 44, 9871), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'ARP', 'network_range': '192.168.1.0/24', 'status': 'RUNNING', 'error_message': None}
2025-12-28 21:52:44,019 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 21:52:44,024 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:52:44,027 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-28 21:52:44,031 - sqlalchemy.engine.Engine - INFO - [cached since 125.9s ago] {'pk_1': 7}
2025-12-28 21:52:44,034 - app.database - ERROR - Database session error: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
2025-12-28 21:52:44,037 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:52:44,040 - app.main - ERROR - Unhandled exception: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'arp'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\scans.py", line 190, in start_scan
    db.refresh(session)
    ~~~~~~~~~~^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\session.py", line 3154, in refresh
    loading.load_on_ident(
    ~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<10 lines>...
        is_user_refresh=True,
        ^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 510, in load_on_ident
    return load_on_pk_identity(
        session,
    ...<11 lines>...
        is_user_refresh=is_user_refresh,
    )
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 706, in load_on_pk_identity
    return result.one()
           ~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1815, in one
    return self._only_one_row(
           ~~~~~~~~~~~~~~~~~~^
        raise_for_second_row=True, raise_for_none=True, scalar=False
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 757, in _only_one_row
    row: Optional[_InterimRowType[Any]] = onerow(hard_close=True)
                                          ~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1678, in _fetchone_impl
    return self._real_result._fetchone_impl(hard_close=hard_close)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2264, in _fetchone_impl
    row = next(self.iterator, _NO_ROW)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
2025-12-28 21:54:30,151 - app.services.notification - INFO - WebSocket client unregistered. Total: 0
2025-12-28 21:54:30,152 - app.main - INFO - WebSocket client disconnected
2025-12-28 21:54:30,256 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-28 21:54:45,857 - app.main - INFO - Starting WiFi Tracker System...
2025-12-28 21:54:45,870 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-28 21:54:45,871 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:54:45,875 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-28 21:54:45,877 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:54:45,881 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-28 21:54:45,882 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:54:45,886 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:54:45,887 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-28 21:54:45,888 - sqlalchemy.engine.Engine - INFO - [generated in 0.00237s] {}
2025-12-28 21:54:45,891 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:54:45,893 - app.main - INFO - Database connection successful
2025-12-28 21:54:45,897 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:54:45,900 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-28 21:54:45,902 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:54:45,938 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-28 21:54:45,950 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:54:45,984 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-28 21:54:46,016 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:54:46,065 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-28 21:54:46,082 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:54:46,162 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-28 21:54:46,170 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:54:46,183 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-28 21:54:46,187 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:54:46,196 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-28 21:54:46,204 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:54:46,214 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-28 21:54:46,219 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 21:54:46,233 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 21:54:46,240 - app.database - INFO - Database tables initialized successfully
2025-12-28 21:54:46,251 - app.services.notification - INFO - WebSocket client registered. Total: 1
2025-12-28 21:54:46,252 - app.main - INFO - WebSocket client connected
2025-12-28 21:55:03,080 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:55:03,266 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:55:03,859 - sqlalchemy.engine.Engine - INFO - [generated in 0.59296s] {'id_1': 1, 'param_1': 1}
2025-12-28 21:55:04,192 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:55:06,691 - app.services.notification - INFO - WebSocket client registered. Total: 2
2025-12-28 21:55:06,888 - app.main - INFO - WebSocket client connected
2025-12-28 21:55:07,047 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:55:07,209 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:55:07,600 - sqlalchemy.engine.Engine - INFO - [cached since 4.332s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:55:07,757 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 21:55:07,770 - sqlalchemy.engine.Engine - INFO - [generated in 0.01279s] {}
2025-12-28 21:55:07,977 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 21:55:08,351 - sqlalchemy.engine.Engine - INFO - [generated in 0.37396s] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 15, 7, 965177)}
2025-12-28 21:55:08,587 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 21:55:08,692 - sqlalchemy.engine.Engine - INFO - [generated in 0.10492s] {}
2025-12-28 21:55:09,211 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 21:55:09,393 - sqlalchemy.engine.Engine - INFO - [generated in 0.18168s] {}
2025-12-28 21:55:09,542 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 21:55:10,204 - sqlalchemy.engine.Engine - INFO - [generated in 0.66172s] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 21:55:10,869 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 21:55:11,066 - sqlalchemy.engine.Engine - INFO - [generated in 0.19735s] {}
2025-12-28 21:55:11,554 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 21:55:11,940 - sqlalchemy.engine.Engine - INFO - [generated in 0.38580s] {}
2025-12-28 21:55:12,054 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 21:55:12,263 - sqlalchemy.engine.Engine - INFO - [generated in 0.20863s] {'status_1': 'COMPLETED'}
2025-12-28 21:55:12,562 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 21:55:12,682 - sqlalchemy.engine.Engine - INFO - [generated in 0.12000s] {'status_1': 'COMPLETED', 'param_1': 1}
2025-12-28 21:55:13,373 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 21:55:13,897 - sqlalchemy.engine.Engine - INFO - [generated in 0.52478s] {}
2025-12-28 21:55:14,394 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:55:14,729 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:55:14,846 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:55:14,941 - sqlalchemy.engine.Engine - INFO - [cached since 11.68s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:55:15,049 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:55:15,255 - sqlalchemy.engine.Engine - INFO - [generated in 0.20631s] {'id_1': 7, 'param_1': 1}
2025-12-28 21:55:15,503 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 21:55:15,615 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:55:16,085 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:55:16,239 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:55:16,563 - sqlalchemy.engine.Engine - INFO - [cached since 13.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:55:16,624 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 21:55:16,814 - sqlalchemy.engine.Engine - INFO - [cached since 9.057s ago] {}
2025-12-28 21:55:17,030 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 21:55:17,440 - sqlalchemy.engine.Engine - INFO - [cached since 9.463s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 15, 17, 28078)}
2025-12-28 21:55:17,613 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 21:55:17,864 - sqlalchemy.engine.Engine - INFO - [cached since 9.277s ago] {}
2025-12-28 21:55:18,380 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 21:55:18,666 - sqlalchemy.engine.Engine - INFO - [cached since 9.455s ago] {}
2025-12-28 21:55:18,686 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 21:55:18,880 - sqlalchemy.engine.Engine - INFO - [cached since 9.338s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 21:55:19,192 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 21:55:19,410 - sqlalchemy.engine.Engine - INFO - [cached since 8.542s ago] {}
2025-12-28 21:55:19,587 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 21:55:20,095 - sqlalchemy.engine.Engine - INFO - [cached since 8.541s ago] {}
2025-12-28 21:55:20,276 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 21:55:20,800 - sqlalchemy.engine.Engine - INFO - [cached since 8.746s ago] {'status_1': 'COMPLETED'}
2025-12-28 21:55:21,107 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 21:55:21,699 - sqlalchemy.engine.Engine - INFO - [cached since 9.135s ago] {'status_1': 'COMPLETED', 'param_1': 1}
2025-12-28 21:55:21,836 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 21:55:22,210 - sqlalchemy.engine.Engine - INFO - [cached since 8.838s ago] {}
2025-12-28 21:55:22,482 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:55:23,158 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:55:23,251 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:55:23,529 - sqlalchemy.engine.Engine - INFO - [cached since 20.26s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:55:23,690 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 21:55:23,993 - sqlalchemy.engine.Engine - INFO - [generated in 0.30394s] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 16, 25, 23, 673970), 'param_1': 100}
2025-12-28 21:55:24,338 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:57:32,767 - app.services.notification - INFO - WebSocket client unregistered. Total: 1
2025-12-28 21:57:32,821 - app.main - INFO - WebSocket client disconnected
2025-12-28 21:57:33,165 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:57:33,168 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:57:33,190 - sqlalchemy.engine.Engine - INFO - [cached since 149.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:57:33,199 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:57:33,233 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:57:33,235 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:57:33,239 - sqlalchemy.engine.Engine - INFO - [cached since 150s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:57:33,245 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 21:57:33,250 - sqlalchemy.engine.Engine - INFO - [cached since 145.5s ago] {}
2025-12-28 21:57:33,259 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 21:57:33,265 - sqlalchemy.engine.Engine - INFO - [cached since 145.3s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 17, 33, 257575)}
2025-12-28 21:57:33,274 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 21:57:33,279 - sqlalchemy.engine.Engine - INFO - [cached since 144.7s ago] {}
2025-12-28 21:57:33,284 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 21:57:33,309 - sqlalchemy.engine.Engine - INFO - [cached since 144.1s ago] {}
2025-12-28 21:57:33,312 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 21:57:33,321 - sqlalchemy.engine.Engine - INFO - [cached since 143.8s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 21:57:33,325 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 21:57:33,328 - sqlalchemy.engine.Engine - INFO - [cached since 142.5s ago] {}
2025-12-28 21:57:33,330 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 21:57:33,339 - sqlalchemy.engine.Engine - INFO - [cached since 141.8s ago] {}
2025-12-28 21:57:33,343 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 21:57:33,348 - sqlalchemy.engine.Engine - INFO - [cached since 141.3s ago] {'status_1': 'COMPLETED'}
2025-12-28 21:57:33,354 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 21:57:33,360 - sqlalchemy.engine.Engine - INFO - [cached since 140.8s ago] {'status_1': 'COMPLETED', 'param_1': 1}
2025-12-28 21:57:33,363 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 21:57:33,364 - sqlalchemy.engine.Engine - INFO - [cached since 140s ago] {}
2025-12-28 21:57:33,372 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:57:33,382 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:57:33,387 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:57:33,397 - sqlalchemy.engine.Engine - INFO - [cached since 150.1s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:57:33,403 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:57:33,411 - sqlalchemy.engine.Engine - INFO - [cached since 138.4s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 21:57:33,413 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 21:57:33,414 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:57:33,437 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:57:33,440 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:57:33,445 - sqlalchemy.engine.Engine - INFO - [cached since 150.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:57:33,447 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 21:57:33,456 - sqlalchemy.engine.Engine - INFO - [cached since 145.7s ago] {}
2025-12-28 21:57:33,461 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 21:57:33,465 - sqlalchemy.engine.Engine - INFO - [cached since 145.5s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 17, 33, 460657)}
2025-12-28 21:57:33,471 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 21:57:33,478 - sqlalchemy.engine.Engine - INFO - [cached since 144.9s ago] {}
2025-12-28 21:57:33,481 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 21:57:33,492 - sqlalchemy.engine.Engine - INFO - [cached since 144.3s ago] {}
2025-12-28 21:57:33,495 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 21:57:33,500 - sqlalchemy.engine.Engine - INFO - [cached since 144s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 21:57:33,508 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 21:57:33,512 - sqlalchemy.engine.Engine - INFO - [cached since 142.6s ago] {}
2025-12-28 21:57:33,516 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 21:57:33,530 - sqlalchemy.engine.Engine - INFO - [cached since 142s ago] {}
2025-12-28 21:57:33,536 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 21:57:33,544 - sqlalchemy.engine.Engine - INFO - [cached since 141.5s ago] {'status_1': 'COMPLETED'}
2025-12-28 21:57:33,548 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 21:57:33,586 - sqlalchemy.engine.Engine - INFO - [cached since 141s ago] {'status_1': 'COMPLETED', 'param_1': 1}
2025-12-28 21:57:33,609 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 21:57:33,613 - sqlalchemy.engine.Engine - INFO - [cached since 140.2s ago] {}
2025-12-28 21:57:33,621 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:57:33,645 - app.services.notification - INFO - WebSocket client registered. Total: 2
2025-12-28 21:57:33,646 - app.main - INFO - WebSocket client connected
2025-12-28 21:57:33,693 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:57:33,696 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:57:33,711 - sqlalchemy.engine.Engine - INFO - [cached since 150.4s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:57:33,719 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 21:57:33,730 - sqlalchemy.engine.Engine - INFO - [cached since 130s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 16, 27, 33, 716437), 'param_1': 100}
2025-12-28 21:57:33,748 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:57:36,147 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:57:36,149 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:57:36,157 - sqlalchemy.engine.Engine - INFO - [cached since 152.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:57:36,162 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-28 21:57:36,165 - sqlalchemy.engine.Engine - INFO - [generated in 0.00265s] {'started_at': datetime.datetime(2025, 12, 28, 16, 27, 36, 162469), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'ARP', 'network_range': '192.168.1.0/24', 'status': 'RUNNING', 'error_message': None}
2025-12-28 21:57:36,175 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 21:57:36,179 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:57:36,184 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-28 21:57:36,191 - sqlalchemy.engine.Engine - INFO - [generated in 0.00681s] {'pk_1': 8}
2025-12-28 21:57:36,193 - app.database - ERROR - Database session error: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
2025-12-28 21:57:36,194 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:57:36,196 - app.main - ERROR - Unhandled exception: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'arp'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\scans.py", line 190, in start_scan
    db.refresh(session)
    ~~~~~~~~~~^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\session.py", line 3154, in refresh
    loading.load_on_ident(
    ~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<10 lines>...
        is_user_refresh=True,
        ^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 510, in load_on_ident
    return load_on_pk_identity(
        session,
    ...<11 lines>...
        is_user_refresh=is_user_refresh,
    )
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 706, in load_on_pk_identity
    return result.one()
           ~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1815, in one
    return self._only_one_row(
           ~~~~~~~~~~~~~~~~~~^
        raise_for_second_row=True, raise_for_none=True, scalar=False
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 757, in _only_one_row
    row: Optional[_InterimRowType[Any]] = onerow(hard_close=True)
                                          ~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1678, in _fetchone_impl
    return self._real_result._fetchone_impl(hard_close=hard_close)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2264, in _fetchone_impl
    row = next(self.iterator, _NO_ROW)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
2025-12-28 21:58:06,420 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:58:06,422 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.username = %(username_1)s 
 LIMIT %(param_1)s
2025-12-28 21:58:06,425 - sqlalchemy.engine.Engine - INFO - [generated in 0.00293s] {'username_1': 'admin', 'param_1': 1}
2025-12-28 21:58:06,835 - sqlalchemy.engine.Engine - INFO - UPDATE users SET last_login=%(last_login)s WHERE users.id = %(users_id)s
2025-12-28 21:58:06,837 - sqlalchemy.engine.Engine - INFO - [generated in 0.00288s] {'last_login': datetime.datetime(2025, 12, 28, 16, 28, 6, 832251), 'users_id': 1}
2025-12-28 21:58:06,845 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 21:58:06,854 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:58:06,861 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-28 21:58:06,875 - sqlalchemy.engine.Engine - INFO - [generated in 0.01272s] {'pk_1': 1}
2025-12-28 21:58:06,904 - app.routers.auth - INFO - User logged in: admin
2025-12-28 21:58:06,928 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:58:06,982 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:58:06,989 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:58:06,999 - sqlalchemy.engine.Engine - INFO - [cached since 183.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:58:07,005 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:58:07,026 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:58:07,035 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:58:07,052 - sqlalchemy.engine.Engine - INFO - [cached since 183.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:58:07,072 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 21:58:07,087 - sqlalchemy.engine.Engine - INFO - [cached since 179.3s ago] {}
2025-12-28 21:58:07,092 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 21:58:07,106 - sqlalchemy.engine.Engine - INFO - [cached since 179.1s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 18, 7, 90424)}
2025-12-28 21:58:07,117 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 21:58:07,128 - sqlalchemy.engine.Engine - INFO - [cached since 178.5s ago] {}
2025-12-28 21:58:07,133 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 21:58:07,148 - sqlalchemy.engine.Engine - INFO - [cached since 177.9s ago] {}
2025-12-28 21:58:07,152 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 21:58:07,157 - sqlalchemy.engine.Engine - INFO - [cached since 177.6s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 21:58:07,164 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 21:58:07,170 - sqlalchemy.engine.Engine - INFO - [cached since 176.3s ago] {}
2025-12-28 21:58:07,172 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 21:58:07,181 - sqlalchemy.engine.Engine - INFO - [cached since 175.6s ago] {}
2025-12-28 21:58:07,187 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 21:58:07,192 - sqlalchemy.engine.Engine - INFO - [cached since 175.1s ago] {'status_1': 'COMPLETED'}
2025-12-28 21:58:07,197 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 21:58:07,205 - sqlalchemy.engine.Engine - INFO - [cached since 174.6s ago] {'status_1': 'COMPLETED', 'param_1': 1}
2025-12-28 21:58:07,208 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 21:58:07,215 - sqlalchemy.engine.Engine - INFO - [cached since 173.8s ago] {}
2025-12-28 21:58:07,219 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:58:07,232 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:58:07,237 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:58:07,255 - sqlalchemy.engine.Engine - INFO - [cached since 184s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:58:07,265 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:58:07,282 - sqlalchemy.engine.Engine - INFO - [cached since 172.2s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 21:58:07,287 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 21:58:07,287 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:58:07,316 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:58:07,319 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:58:07,330 - sqlalchemy.engine.Engine - INFO - [cached since 184.1s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:58:07,342 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 21:58:07,365 - sqlalchemy.engine.Engine - INFO - [cached since 179.6s ago] {}
2025-12-28 21:58:07,379 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 21:58:07,403 - sqlalchemy.engine.Engine - INFO - [cached since 179.4s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 18, 7, 378362)}
2025-12-28 21:58:07,414 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 21:58:07,437 - sqlalchemy.engine.Engine - INFO - [cached since 178.9s ago] {}
2025-12-28 21:58:07,458 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 21:58:07,486 - sqlalchemy.engine.Engine - INFO - [cached since 178.3s ago] {}
2025-12-28 21:58:07,491 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 21:58:07,505 - sqlalchemy.engine.Engine - INFO - [cached since 178s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 21:58:07,514 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 21:58:07,525 - sqlalchemy.engine.Engine - INFO - [cached since 176.7s ago] {}
2025-12-28 21:58:07,530 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 21:58:07,547 - sqlalchemy.engine.Engine - INFO - [cached since 176s ago] {}
2025-12-28 21:58:07,552 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 21:58:07,563 - sqlalchemy.engine.Engine - INFO - [cached since 175.5s ago] {'status_1': 'COMPLETED'}
2025-12-28 21:58:07,571 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 21:58:07,586 - sqlalchemy.engine.Engine - INFO - [cached since 175s ago] {'status_1': 'COMPLETED', 'param_1': 1}
2025-12-28 21:58:07,589 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 21:58:07,599 - sqlalchemy.engine.Engine - INFO - [cached since 174.2s ago] {}
2025-12-28 21:58:07,617 - app.services.notification - INFO - WebSocket client registered. Total: 3
2025-12-28 21:58:07,607 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:58:07,622 - app.main - INFO - WebSocket client connected
2025-12-28 21:58:07,659 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:58:07,665 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:58:07,671 - sqlalchemy.engine.Engine - INFO - [cached since 184.4s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:58:07,683 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 21:58:07,691 - sqlalchemy.engine.Engine - INFO - [cached since 164s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 16, 28, 7, 682376), 'param_1': 100}
2025-12-28 21:58:07,706 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:58:09,085 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:58:09,086 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:58:09,096 - sqlalchemy.engine.Engine - INFO - [cached since 185.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:58:09,101 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-28 21:58:09,104 - sqlalchemy.engine.Engine - INFO - [cached since 32.94s ago] {'started_at': datetime.datetime(2025, 12, 28, 16, 28, 9, 101501), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'ARP', 'network_range': '192.168.1.0/24', 'status': 'RUNNING', 'error_message': None}
2025-12-28 21:58:09,109 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 21:58:09,114 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:58:09,118 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-28 21:58:09,120 - sqlalchemy.engine.Engine - INFO - [cached since 32.94s ago] {'pk_1': 9}
2025-12-28 21:58:09,127 - app.database - ERROR - Database session error: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
2025-12-28 21:58:09,131 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:58:09,133 - app.main - ERROR - Unhandled exception: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'arp'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\scans.py", line 190, in start_scan
    db.refresh(session)
    ~~~~~~~~~~^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\session.py", line 3154, in refresh
    loading.load_on_ident(
    ~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<10 lines>...
        is_user_refresh=True,
        ^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 510, in load_on_ident
    return load_on_pk_identity(
        session,
    ...<11 lines>...
        is_user_refresh=is_user_refresh,
    )
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 706, in load_on_pk_identity
    return result.one()
           ~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1815, in one
    return self._only_one_row(
           ~~~~~~~~~~~~~~~~~~^
        raise_for_second_row=True, raise_for_none=True, scalar=False
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 757, in _only_one_row
    row: Optional[_InterimRowType[Any]] = onerow(hard_close=True)
                                          ~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1678, in _fetchone_impl
    return self._real_result._fetchone_impl(hard_close=hard_close)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2264, in _fetchone_impl
    row = next(self.iterator, _NO_ROW)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
2025-12-28 21:58:15,131 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:58:15,133 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:58:15,138 - sqlalchemy.engine.Engine - INFO - [cached since 191.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:58:15,144 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-28 21:58:15,151 - sqlalchemy.engine.Engine - INFO - [cached since 38.99s ago] {'started_at': datetime.datetime(2025, 12, 28, 16, 28, 15, 144601), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'ARP', 'network_range': '192.168.1.0/24', 'status': 'RUNNING', 'error_message': None}
2025-12-28 21:58:15,154 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 21:58:15,160 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:58:15,164 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-28 21:58:15,167 - sqlalchemy.engine.Engine - INFO - [cached since 38.98s ago] {'pk_1': 10}
2025-12-28 21:58:15,170 - app.database - ERROR - Database session error: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
2025-12-28 21:58:15,170 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:58:15,173 - app.main - ERROR - Unhandled exception: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'arp'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\scans.py", line 190, in start_scan
    db.refresh(session)
    ~~~~~~~~~~^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\session.py", line 3154, in refresh
    loading.load_on_ident(
    ~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<10 lines>...
        is_user_refresh=True,
        ^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 510, in load_on_ident
    return load_on_pk_identity(
        session,
    ...<11 lines>...
        is_user_refresh=is_user_refresh,
    )
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 706, in load_on_pk_identity
    return result.one()
           ~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1815, in one
    return self._only_one_row(
           ~~~~~~~~~~~~~~~~~~^
        raise_for_second_row=True, raise_for_none=True, scalar=False
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 757, in _only_one_row
    row: Optional[_InterimRowType[Any]] = onerow(hard_close=True)
                                          ~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1678, in _fetchone_impl
    return self._real_result._fetchone_impl(hard_close=hard_close)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2264, in _fetchone_impl
    row = next(self.iterator, _NO_ROW)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
2025-12-28 21:58:23,566 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:58:23,569 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:58:23,582 - sqlalchemy.engine.Engine - INFO - [cached since 200.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:58:23,587 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 21:58:23,600 - sqlalchemy.engine.Engine - INFO - [cached since 192.7s ago] {}
2025-12-28 21:58:23,603 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 21:58:23,614 - sqlalchemy.engine.Engine - INFO - [cached since 192.1s ago] {}
2025-12-28 21:58:23,622 - sqlalchemy.engine.Engine - INFO - SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts ORDER BY alerts.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-28 21:58:23,636 - sqlalchemy.engine.Engine - INFO - [generated in 0.01407s] {'param_1': 0, 'param_2': 20}
2025-12-28 21:58:23,645 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:58:23,653 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:58:23,659 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:58:23,666 - sqlalchemy.engine.Engine - INFO - [cached since 200.4s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:58:23,669 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 21:58:23,680 - sqlalchemy.engine.Engine - INFO - [cached since 192.8s ago] {}
2025-12-28 21:58:23,684 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 21:58:23,693 - sqlalchemy.engine.Engine - INFO - [cached since 192.1s ago] {}
2025-12-28 21:58:23,698 - sqlalchemy.engine.Engine - INFO - SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts ORDER BY alerts.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-28 21:58:23,702 - sqlalchemy.engine.Engine - INFO - [cached since 0.08018s ago] {'param_1': 0, 'param_2': 20}
2025-12-28 21:58:23,712 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:58:24,790 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:58:24,794 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:58:24,797 - sqlalchemy.engine.Engine - INFO - [cached since 201.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:58:24,801 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 21:58:24,816 - sqlalchemy.engine.Engine - INFO - [cached since 197.1s ago] {}
2025-12-28 21:58:24,819 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-28 21:58:24,831 - sqlalchemy.engine.Engine - INFO - [generated in 0.01220s] {'param_1': 0, 'param_2': 20}
2025-12-28 21:58:24,835 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:58:24,843 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:58:24,849 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:58:24,852 - sqlalchemy.engine.Engine - INFO - [cached since 201.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:58:24,858 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 21:58:24,866 - sqlalchemy.engine.Engine - INFO - [cached since 197.1s ago] {}
2025-12-28 21:58:24,869 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-28 21:58:24,882 - sqlalchemy.engine.Engine - INFO - [cached since 0.0628s ago] {'param_1': 0, 'param_2': 20}
2025-12-28 21:58:24,889 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:58:25,717 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:58:25,720 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:58:25,735 - sqlalchemy.engine.Engine - INFO - [cached since 202.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:58:25,747 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 21:58:25,752 - sqlalchemy.engine.Engine - INFO - [cached since 193.2s ago] {'status_1': 'COMPLETED', 'param_1': 1}
2025-12-28 21:58:25,763 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:58:25,770 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:58:25,778 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:58:25,789 - sqlalchemy.engine.Engine - INFO - [cached since 202.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:58:25,796 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 21:58:25,808 - sqlalchemy.engine.Engine - INFO - [cached since 193.2s ago] {'status_1': 'COMPLETED', 'param_1': 1}
2025-12-28 21:58:25,816 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:58:25,829 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:58:25,835 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:58:25,846 - sqlalchemy.engine.Engine - INFO - [cached since 202.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:58:25,852 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:58:25,859 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:58:25,865 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:58:25,881 - sqlalchemy.engine.Engine - INFO - [cached since 202.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:58:25,897 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:58:30,284 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:58:30,285 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:58:30,301 - sqlalchemy.engine.Engine - INFO - [cached since 207s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:58:30,317 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 21:58:30,346 - sqlalchemy.engine.Engine - INFO - [cached since 202.6s ago] {}
2025-12-28 21:58:30,349 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 21:58:30,360 - sqlalchemy.engine.Engine - INFO - [cached since 202.4s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 18, 30, 349045)}
2025-12-28 21:58:30,366 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 21:58:30,381 - sqlalchemy.engine.Engine - INFO - [cached since 201.8s ago] {}
2025-12-28 21:58:30,386 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 21:58:30,400 - sqlalchemy.engine.Engine - INFO - [cached since 201.2s ago] {}
2025-12-28 21:58:30,411 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 21:58:30,418 - sqlalchemy.engine.Engine - INFO - [cached since 200.9s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 21:58:30,427 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 21:58:30,435 - sqlalchemy.engine.Engine - INFO - [cached since 199.6s ago] {}
2025-12-28 21:58:30,441 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 21:58:30,458 - sqlalchemy.engine.Engine - INFO - [cached since 198.9s ago] {}
2025-12-28 21:58:30,467 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 21:58:30,480 - sqlalchemy.engine.Engine - INFO - [cached since 198.4s ago] {'status_1': 'COMPLETED'}
2025-12-28 21:58:30,483 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 21:58:30,492 - sqlalchemy.engine.Engine - INFO - [cached since 197.9s ago] {'status_1': 'COMPLETED', 'param_1': 1}
2025-12-28 21:58:30,498 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 21:58:30,501 - sqlalchemy.engine.Engine - INFO - [cached since 197.1s ago] {}
2025-12-28 21:58:30,511 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:58:30,516 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:58:30,519 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:58:30,534 - sqlalchemy.engine.Engine - INFO - [cached since 207.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:58:30,543 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 21:58:30,551 - sqlalchemy.engine.Engine - INFO - [cached since 202.8s ago] {}
2025-12-28 21:58:30,556 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 21:58:30,566 - sqlalchemy.engine.Engine - INFO - [cached since 202.6s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 18, 30, 554366)}
2025-12-28 21:58:30,570 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 21:58:30,581 - sqlalchemy.engine.Engine - INFO - [cached since 202s ago] {}
2025-12-28 21:58:30,585 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 21:58:30,607 - sqlalchemy.engine.Engine - INFO - [cached since 201.4s ago] {}
2025-12-28 21:58:30,614 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 21:58:30,629 - sqlalchemy.engine.Engine - INFO - [cached since 201.1s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 21:58:30,637 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 21:58:30,646 - sqlalchemy.engine.Engine - INFO - [cached since 199.8s ago] {}
2025-12-28 21:58:30,649 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 21:58:30,656 - sqlalchemy.engine.Engine - INFO - [cached since 199.1s ago] {}
2025-12-28 21:58:30,663 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 21:58:30,668 - sqlalchemy.engine.Engine - INFO - [cached since 198.6s ago] {'status_1': 'COMPLETED'}
2025-12-28 21:58:30,673 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 21:58:30,682 - sqlalchemy.engine.Engine - INFO - [cached since 198.1s ago] {'status_1': 'COMPLETED', 'param_1': 1}
2025-12-28 21:58:30,684 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 21:58:30,688 - sqlalchemy.engine.Engine - INFO - [cached since 197.3s ago] {}
2025-12-28 21:58:30,697 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:58:30,717 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:58:30,724 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:58:30,730 - sqlalchemy.engine.Engine - INFO - [cached since 207.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:58:30,743 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:58:30,751 - sqlalchemy.engine.Engine - INFO - [cached since 195.7s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 21:58:30,761 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 21:58:30,763 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:58:30,777 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:58:30,782 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:58:30,794 - sqlalchemy.engine.Engine - INFO - [cached since 207.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:58:30,800 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:58:30,810 - sqlalchemy.engine.Engine - INFO - [cached since 195.8s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 21:58:30,817 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 21:58:30,828 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:58:30,834 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:58:30,840 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:58:30,850 - sqlalchemy.engine.Engine - INFO - [cached since 207.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:58:30,860 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 21:58:30,866 - sqlalchemy.engine.Engine - INFO - [cached since 203.1s ago] {}
2025-12-28 21:58:30,870 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 21:58:30,891 - sqlalchemy.engine.Engine - INFO - [cached since 202.9s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 18, 30, 869158)}
2025-12-28 21:58:30,897 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 21:58:30,909 - sqlalchemy.engine.Engine - INFO - [cached since 202.3s ago] {}
2025-12-28 21:58:30,914 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 21:58:30,931 - sqlalchemy.engine.Engine - INFO - [cached since 201.7s ago] {}
2025-12-28 21:58:30,933 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 21:58:30,943 - sqlalchemy.engine.Engine - INFO - [cached since 201.4s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 21:58:30,948 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 21:58:30,959 - sqlalchemy.engine.Engine - INFO - [cached since 200.1s ago] {}
2025-12-28 21:58:30,963 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 21:58:30,965 - sqlalchemy.engine.Engine - INFO - [cached since 199.4s ago] {}
2025-12-28 21:58:30,969 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 21:58:30,982 - sqlalchemy.engine.Engine - INFO - [cached since 198.9s ago] {'status_1': 'COMPLETED'}
2025-12-28 21:58:30,985 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 21:58:30,998 - sqlalchemy.engine.Engine - INFO - [cached since 198.4s ago] {'status_1': 'COMPLETED', 'param_1': 1}
2025-12-28 21:58:31,000 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 21:58:31,004 - sqlalchemy.engine.Engine - INFO - [cached since 197.6s ago] {}
2025-12-28 21:58:31,016 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:58:31,067 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:58:31,075 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:58:31,083 - sqlalchemy.engine.Engine - INFO - [cached since 207.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:58:31,098 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 21:58:31,107 - sqlalchemy.engine.Engine - INFO - [cached since 187.4s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 16, 28, 31, 96812), 'param_1': 100}
2025-12-28 21:58:31,117 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:58:31,126 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:58:31,134 - sqlalchemy.engine.Engine - INFO - [cached since 207.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:58:31,139 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 21:58:31,159 - sqlalchemy.engine.Engine - INFO - [cached since 203.4s ago] {}
2025-12-28 21:58:31,164 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 21:58:31,178 - sqlalchemy.engine.Engine - INFO - [cached since 203.2s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 18, 31, 162870)}
2025-12-28 21:58:31,187 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 21:58:31,215 - sqlalchemy.engine.Engine - INFO - [cached since 202.6s ago] {}
2025-12-28 21:58:31,220 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 21:58:31,246 - sqlalchemy.engine.Engine - INFO - [cached since 202s ago] {}
2025-12-28 21:58:31,252 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 21:58:31,264 - sqlalchemy.engine.Engine - INFO - [cached since 201.7s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 21:58:31,279 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 21:58:31,283 - sqlalchemy.engine.Engine - INFO - [cached since 200.4s ago] {}
2025-12-28 21:58:31,292 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 21:58:31,301 - sqlalchemy.engine.Engine - INFO - [cached since 199.7s ago] {}
2025-12-28 21:58:31,315 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 21:58:31,330 - sqlalchemy.engine.Engine - INFO - [cached since 199.3s ago] {'status_1': 'COMPLETED'}
2025-12-28 21:58:31,347 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 21:58:31,359 - sqlalchemy.engine.Engine - INFO - [cached since 198.8s ago] {'status_1': 'COMPLETED', 'param_1': 1}
2025-12-28 21:58:31,374 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 21:58:31,382 - sqlalchemy.engine.Engine - INFO - [cached since 198s ago] {}
2025-12-28 21:58:31,390 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:58:31,391 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:58:31,437 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:58:31,449 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:58:31,468 - sqlalchemy.engine.Engine - INFO - [cached since 208.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:58:31,483 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 21:58:31,500 - sqlalchemy.engine.Engine - INFO - [cached since 187.8s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 16, 28, 31, 482068), 'param_1': 100}
2025-12-28 21:58:31,515 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:58:32,112 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:58:32,114 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:58:32,116 - sqlalchemy.engine.Engine - INFO - [cached since 208.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:58:32,121 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-28 21:58:32,128 - sqlalchemy.engine.Engine - INFO - [cached since 55.97s ago] {'started_at': datetime.datetime(2025, 12, 28, 16, 28, 32, 120933), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'ARP', 'network_range': '192.168.1.0/24', 'status': 'RUNNING', 'error_message': None}
2025-12-28 21:58:32,133 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 21:58:32,140 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:58:32,144 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-28 21:58:32,147 - sqlalchemy.engine.Engine - INFO - [cached since 55.96s ago] {'pk_1': 11}
2025-12-28 21:58:32,149 - app.database - ERROR - Database session error: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
2025-12-28 21:58:32,150 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:58:32,153 - app.main - ERROR - Unhandled exception: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'arp'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\scans.py", line 190, in start_scan
    db.refresh(session)
    ~~~~~~~~~~^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\session.py", line 3154, in refresh
    loading.load_on_ident(
    ~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<10 lines>...
        is_user_refresh=True,
        ^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 510, in load_on_ident
    return load_on_pk_identity(
        session,
    ...<11 lines>...
        is_user_refresh=is_user_refresh,
    )
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 706, in load_on_pk_identity
    return result.one()
           ~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1815, in one
    return self._only_one_row(
           ~~~~~~~~~~~~~~~~~~^
        raise_for_second_row=True, raise_for_none=True, scalar=False
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 757, in _only_one_row
    row: Optional[_InterimRowType[Any]] = onerow(hard_close=True)
                                          ~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1678, in _fetchone_impl
    return self._real_result._fetchone_impl(hard_close=hard_close)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2264, in _fetchone_impl
    row = next(self.iterator, _NO_ROW)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
2025-12-28 21:58:58,594 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:58:58,599 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:58:58,604 - sqlalchemy.engine.Engine - INFO - [cached since 235.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:58:58,607 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 21:58:58,611 - sqlalchemy.engine.Engine - INFO - [cached since 230.9s ago] {}
2025-12-28 21:58:58,618 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-28 21:58:58,632 - sqlalchemy.engine.Engine - INFO - [cached since 33.81s ago] {'param_1': 0, 'param_2': 20}
2025-12-28 21:58:58,642 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:58:58,651 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:58:58,657 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:58:58,676 - sqlalchemy.engine.Engine - INFO - [cached since 235.4s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:58:58,683 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 21:58:58,698 - sqlalchemy.engine.Engine - INFO - [cached since 230.9s ago] {}
2025-12-28 21:58:58,705 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-28 21:58:58,722 - sqlalchemy.engine.Engine - INFO - [cached since 33.9s ago] {'param_1': 0, 'param_2': 20}
2025-12-28 21:58:58,733 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:59:00,540 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:59:00,541 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:59:00,546 - sqlalchemy.engine.Engine - INFO - [cached since 237.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:59:00,551 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-28 21:59:00,598 - sqlalchemy.engine.Engine - INFO - [cached since 84.44s ago] {'started_at': datetime.datetime(2025, 12, 28, 16, 29, 0, 551456), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'ARP', 'network_range': '192.168.1.0/24', 'status': 'RUNNING', 'error_message': None}
2025-12-28 21:59:00,778 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 21:59:00,803 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:59:00,817 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-28 21:59:00,868 - sqlalchemy.engine.Engine - INFO - [cached since 84.68s ago] {'pk_1': 12}
2025-12-28 21:59:00,876 - app.database - ERROR - Database session error: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
2025-12-28 21:59:00,881 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:59:00,884 - app.main - ERROR - Unhandled exception: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'arp'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\scans.py", line 190, in start_scan
    db.refresh(session)
    ~~~~~~~~~~^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\session.py", line 3154, in refresh
    loading.load_on_ident(
    ~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<10 lines>...
        is_user_refresh=True,
        ^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 510, in load_on_ident
    return load_on_pk_identity(
        session,
    ...<11 lines>...
        is_user_refresh=is_user_refresh,
    )
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 706, in load_on_pk_identity
    return result.one()
           ~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1815, in one
    return self._only_one_row(
           ~~~~~~~~~~~~~~~~~~^
        raise_for_second_row=True, raise_for_none=True, scalar=False
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 757, in _only_one_row
    row: Optional[_InterimRowType[Any]] = onerow(hard_close=True)
                                          ~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1678, in _fetchone_impl
    return self._real_result._fetchone_impl(hard_close=hard_close)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2264, in _fetchone_impl
    row = next(self.iterator, _NO_ROW)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
2025-12-28 21:59:34,114 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:59:34,115 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 21:59:34,118 - sqlalchemy.engine.Engine - INFO - [cached since 270.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 21:59:34,122 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-28 21:59:34,128 - sqlalchemy.engine.Engine - INFO - [cached since 118s ago] {'started_at': datetime.datetime(2025, 12, 28, 16, 29, 34, 122577), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'ARP', 'network_range': '192.168.1.0/24', 'status': 'RUNNING', 'error_message': None}
2025-12-28 21:59:34,134 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 21:59:34,139 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 21:59:34,141 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-28 21:59:34,144 - sqlalchemy.engine.Engine - INFO - [cached since 118s ago] {'pk_1': 13}
2025-12-28 21:59:34,147 - app.database - ERROR - Database session error: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
2025-12-28 21:59:34,147 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 21:59:34,149 - app.main - ERROR - Unhandled exception: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'arp'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\scans.py", line 190, in start_scan
    db.refresh(session)
    ~~~~~~~~~~^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\session.py", line 3154, in refresh
    loading.load_on_ident(
    ~~~~~~~~~~~~~~~~~~~~~^
        self,
        ^^^^^
    ...<10 lines>...
        is_user_refresh=True,
        ^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 510, in load_on_ident
    return load_on_pk_identity(
        session,
    ...<11 lines>...
        is_user_refresh=is_user_refresh,
    )
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 706, in load_on_pk_identity
    return result.one()
           ~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1815, in one
    return self._only_one_row(
           ~~~~~~~~~~~~~~~~~~^
        raise_for_second_row=True, raise_for_none=True, scalar=False
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 757, in _only_one_row
    row: Optional[_InterimRowType[Any]] = onerow(hard_close=True)
                                          ~~~~~~^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1678, in _fetchone_impl
    return self._real_result._fetchone_impl(hard_close=hard_close)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2264, in _fetchone_impl
    row = next(self.iterator, _NO_ROW)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'arp' is not among the defined enum values. Enum name: scantype. Possible values: ARP, ICMP, FULL
2025-12-28 22:01:12,241 - app.services.notification - INFO - WebSocket client unregistered. Total: 2
2025-12-28 22:01:12,242 - app.main - INFO - WebSocket client disconnected
2025-12-28 22:01:12,243 - app.services.notification - INFO - WebSocket client unregistered. Total: 1
2025-12-28 22:01:12,245 - app.main - INFO - WebSocket client disconnected
2025-12-28 22:01:12,254 - app.services.notification - INFO - WebSocket client unregistered. Total: 0
2025-12-28 22:01:12,255 - app.main - INFO - WebSocket client disconnected
2025-12-28 22:01:12,350 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-28 22:01:27,270 - app.main - INFO - Starting WiFi Tracker System...
2025-12-28 22:01:27,282 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-28 22:01:27,284 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:27,286 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-28 22:01:27,287 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:27,289 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-28 22:01:27,290 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:27,293 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:01:27,294 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-28 22:01:27,295 - sqlalchemy.engine.Engine - INFO - [generated in 0.00207s] {}
2025-12-28 22:01:27,297 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:01:27,298 - app.main - INFO - Database connection successful
2025-12-28 22:01:27,299 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:01:27,301 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-28 22:01:27,302 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:27,326 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-28 22:01:27,328 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:27,336 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-28 22:01:27,338 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:27,347 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-28 22:01:27,348 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:27,368 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-28 22:01:27,369 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:27,377 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-28 22:01:27,379 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:27,387 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-28 22:01:27,388 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:27,395 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-28 22:01:27,397 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:27,407 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:01:27,409 - app.database - INFO - Database tables initialized successfully
2025-12-28 22:01:27,414 - app.services.notification - INFO - WebSocket client registered. Total: 1
2025-12-28 22:01:27,415 - app.main - INFO - WebSocket client connected
2025-12-28 22:01:27,430 - app.services.notification - INFO - WebSocket client registered. Total: 2
2025-12-28 22:01:27,431 - app.main - INFO - WebSocket client connected
2025-12-28 22:01:27,447 - app.services.notification - INFO - WebSocket client registered. Total: 3
2025-12-28 22:01:27,448 - app.main - INFO - WebSocket client connected
2025-12-28 22:01:28,514 - app.services.notification - INFO - WebSocket client unregistered. Total: 2
2025-12-28 22:01:28,517 - app.main - INFO - WebSocket client disconnected
2025-12-28 22:01:28,520 - app.services.notification - INFO - WebSocket client unregistered. Total: 1
2025-12-28 22:01:28,523 - app.main - INFO - WebSocket client disconnected
2025-12-28 22:01:28,525 - app.services.notification - INFO - WebSocket client unregistered. Total: 0
2025-12-28 22:01:28,527 - app.main - INFO - WebSocket client disconnected
2025-12-28 22:01:28,630 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-28 22:01:40,739 - app.main - INFO - Starting WiFi Tracker System...
2025-12-28 22:01:40,747 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-28 22:01:40,748 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:40,750 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-28 22:01:40,751 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:40,752 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-28 22:01:40,754 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:40,757 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:01:40,759 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-28 22:01:40,760 - sqlalchemy.engine.Engine - INFO - [generated in 0.00271s] {}
2025-12-28 22:01:40,761 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:01:40,763 - app.main - INFO - Database connection successful
2025-12-28 22:01:40,764 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:01:40,766 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-28 22:01:40,767 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:40,787 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-28 22:01:40,789 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:40,809 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-28 22:01:40,811 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:40,819 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-28 22:01:40,821 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:40,829 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-28 22:01:40,831 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:40,838 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-28 22:01:40,840 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:40,849 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-28 22:01:40,851 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:40,858 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-28 22:01:40,859 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:40,869 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:01:40,870 - app.database - INFO - Database tables initialized successfully
2025-12-28 22:01:40,875 - app.services.notification - INFO - WebSocket client registered. Total: 1
2025-12-28 22:01:40,876 - app.main - INFO - WebSocket client connected
2025-12-28 22:01:40,898 - app.services.notification - INFO - WebSocket client registered. Total: 2
2025-12-28 22:01:40,899 - app.main - INFO - WebSocket client connected
2025-12-28 22:01:40,914 - app.services.notification - INFO - WebSocket client registered. Total: 3
2025-12-28 22:01:40,916 - app.main - INFO - WebSocket client connected
2025-12-28 22:01:45,120 - app.services.notification - INFO - WebSocket client unregistered. Total: 2
2025-12-28 22:01:45,121 - app.main - INFO - WebSocket client disconnected
2025-12-28 22:01:45,122 - app.services.notification - INFO - WebSocket client unregistered. Total: 1
2025-12-28 22:01:45,125 - app.main - INFO - WebSocket client disconnected
2025-12-28 22:01:45,126 - app.services.notification - INFO - WebSocket client unregistered. Total: 0
2025-12-28 22:01:45,127 - app.main - INFO - WebSocket client disconnected
2025-12-28 22:01:45,226 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-28 22:01:57,466 - app.main - INFO - Starting WiFi Tracker System...
2025-12-28 22:01:57,474 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-28 22:01:57,476 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:57,479 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-28 22:01:57,480 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:57,482 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-28 22:01:57,483 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:57,485 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:01:57,487 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-28 22:01:57,488 - sqlalchemy.engine.Engine - INFO - [generated in 0.00313s] {}
2025-12-28 22:01:57,490 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:01:57,491 - app.main - INFO - Database connection successful
2025-12-28 22:01:57,492 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:01:57,494 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-28 22:01:57,495 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:57,516 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-28 22:01:57,518 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:57,527 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-28 22:01:57,528 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:57,554 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-28 22:01:57,558 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:57,570 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-28 22:01:57,574 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:57,584 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-28 22:01:57,586 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:57,595 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-28 22:01:57,596 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:57,605 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-28 22:01:57,608 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:01:57,619 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:01:57,624 - app.database - INFO - Database tables initialized successfully
2025-12-28 22:01:57,630 - app.services.notification - INFO - WebSocket client registered. Total: 1
2025-12-28 22:01:57,631 - app.main - INFO - WebSocket client connected
2025-12-28 22:01:57,655 - app.services.notification - INFO - WebSocket client registered. Total: 2
2025-12-28 22:01:57,656 - app.main - INFO - WebSocket client connected
2025-12-28 22:01:57,672 - app.services.notification - INFO - WebSocket client registered. Total: 3
2025-12-28 22:01:57,674 - app.main - INFO - WebSocket client connected
2025-12-28 22:02:05,114 - app.services.notification - INFO - WebSocket client unregistered. Total: 2
2025-12-28 22:02:05,115 - app.main - INFO - WebSocket client disconnected
2025-12-28 22:02:05,116 - app.services.notification - INFO - WebSocket client unregistered. Total: 1
2025-12-28 22:02:05,117 - app.main - INFO - WebSocket client disconnected
2025-12-28 22:02:05,120 - app.services.notification - INFO - WebSocket client unregistered. Total: 0
2025-12-28 22:02:05,121 - app.main - INFO - WebSocket client disconnected
2025-12-28 22:02:05,221 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-28 22:02:17,383 - app.main - INFO - Starting WiFi Tracker System...
2025-12-28 22:02:17,392 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-28 22:02:17,393 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:02:17,395 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-28 22:02:17,397 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:02:17,399 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-28 22:02:17,401 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:02:17,405 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:02:17,406 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-28 22:02:17,407 - sqlalchemy.engine.Engine - INFO - [generated in 0.00203s] {}
2025-12-28 22:02:17,408 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:02:17,410 - app.main - INFO - Database connection successful
2025-12-28 22:02:17,411 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:02:17,412 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-28 22:02:17,413 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:02:17,435 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-28 22:02:17,437 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:02:17,444 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-28 22:02:17,445 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:02:17,454 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-28 22:02:17,458 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:02:17,481 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-28 22:02:17,483 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:02:17,492 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-28 22:02:17,493 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:02:17,503 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-28 22:02:17,504 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:02:17,513 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-28 22:02:17,515 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:02:17,527 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:02:17,528 - app.database - INFO - Database tables initialized successfully
2025-12-28 22:02:17,534 - app.services.notification - INFO - WebSocket client registered. Total: 1
2025-12-28 22:02:17,535 - app.main - INFO - WebSocket client connected
2025-12-28 22:02:17,558 - app.services.notification - INFO - WebSocket client registered. Total: 2
2025-12-28 22:02:17,559 - app.main - INFO - WebSocket client connected
2025-12-28 22:02:17,589 - app.services.notification - INFO - WebSocket client registered. Total: 3
2025-12-28 22:02:17,591 - app.main - INFO - WebSocket client connected
2025-12-28 22:02:39,719 - app.services.notification - INFO - WebSocket client unregistered. Total: 2
2025-12-28 22:02:39,720 - app.main - INFO - WebSocket client disconnected
2025-12-28 22:02:39,721 - app.services.notification - INFO - WebSocket client unregistered. Total: 1
2025-12-28 22:02:39,722 - app.main - INFO - WebSocket client disconnected
2025-12-28 22:02:39,723 - app.services.notification - INFO - WebSocket client unregistered. Total: 0
2025-12-28 22:02:39,726 - app.main - INFO - WebSocket client disconnected
2025-12-28 22:02:39,829 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-28 22:02:52,915 - app.main - INFO - Starting WiFi Tracker System...
2025-12-28 22:02:52,924 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-28 22:02:52,925 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:02:52,928 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-28 22:02:52,930 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:02:52,932 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-28 22:02:52,934 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:02:52,937 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:02:52,938 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-28 22:02:52,939 - sqlalchemy.engine.Engine - INFO - [generated in 0.00202s] {}
2025-12-28 22:02:52,942 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:02:52,943 - app.main - INFO - Database connection successful
2025-12-28 22:02:52,944 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:02:52,946 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-28 22:02:52,947 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:02:52,972 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-28 22:02:52,974 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:02:52,982 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-28 22:02:52,984 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:02:52,993 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-28 22:02:52,995 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:02:53,003 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-28 22:02:53,005 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:02:53,026 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-28 22:02:53,029 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:02:53,051 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-28 22:02:53,052 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:02:53,060 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-28 22:02:53,062 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:02:53,070 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:02:53,072 - app.database - INFO - Database tables initialized successfully
2025-12-28 22:02:53,078 - app.services.notification - INFO - WebSocket client registered. Total: 1
2025-12-28 22:02:53,079 - app.main - INFO - WebSocket client connected
2025-12-28 22:02:53,097 - app.services.notification - INFO - WebSocket client registered. Total: 2
2025-12-28 22:02:53,098 - app.main - INFO - WebSocket client connected
2025-12-28 22:02:53,113 - app.services.notification - INFO - WebSocket client registered. Total: 3
2025-12-28 22:02:53,114 - app.main - INFO - WebSocket client connected
2025-12-28 22:03:02,511 - app.services.notification - INFO - WebSocket client unregistered. Total: 2
2025-12-28 22:03:02,512 - app.main - INFO - WebSocket client disconnected
2025-12-28 22:03:02,513 - app.services.notification - INFO - WebSocket client unregistered. Total: 1
2025-12-28 22:03:02,514 - app.main - INFO - WebSocket client disconnected
2025-12-28 22:03:02,515 - app.services.notification - INFO - WebSocket client unregistered. Total: 0
2025-12-28 22:03:02,516 - app.main - INFO - WebSocket client disconnected
2025-12-28 22:03:02,617 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-28 22:03:15,731 - app.main - INFO - Starting WiFi Tracker System...
2025-12-28 22:03:15,742 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-28 22:03:15,743 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:03:15,745 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-28 22:03:15,746 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:03:15,748 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-28 22:03:15,749 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:03:15,752 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:03:15,754 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-28 22:03:15,755 - sqlalchemy.engine.Engine - INFO - [generated in 0.00309s] {}
2025-12-28 22:03:15,757 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:03:15,758 - app.main - INFO - Database connection successful
2025-12-28 22:03:15,759 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:03:15,762 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-28 22:03:15,763 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:03:15,783 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-28 22:03:15,785 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:03:15,794 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-28 22:03:15,797 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:03:15,819 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-28 22:03:15,821 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:03:15,829 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-28 22:03:15,831 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:03:15,838 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-28 22:03:15,840 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:03:15,849 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-28 22:03:15,851 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:03:15,859 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-28 22:03:15,861 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:03:15,872 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:03:15,874 - app.database - INFO - Database tables initialized successfully
2025-12-28 22:03:15,880 - app.services.notification - INFO - WebSocket client registered. Total: 1
2025-12-28 22:03:15,881 - app.main - INFO - WebSocket client connected
2025-12-28 22:03:15,897 - app.services.notification - INFO - WebSocket client registered. Total: 2
2025-12-28 22:03:15,898 - app.main - INFO - WebSocket client connected
2025-12-28 22:03:15,914 - app.services.notification - INFO - WebSocket client registered. Total: 3
2025-12-28 22:03:15,916 - app.main - INFO - WebSocket client connected
2025-12-28 22:03:28,379 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:03:28,387 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.username = %(username_1)s 
 LIMIT %(param_1)s
2025-12-28 22:03:28,391 - sqlalchemy.engine.Engine - INFO - [generated in 0.00432s] {'username_1': 'admin', 'param_1': 1}
2025-12-28 22:03:28,866 - sqlalchemy.engine.Engine - INFO - UPDATE users SET last_login=%(last_login)s WHERE users.id = %(users_id)s
2025-12-28 22:03:28,868 - sqlalchemy.engine.Engine - INFO - [generated in 0.00281s] {'last_login': datetime.datetime(2025, 12, 28, 16, 33, 28, 863298), 'users_id': 1}
2025-12-28 22:03:28,873 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:03:28,877 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:03:28,880 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-28 22:03:28,887 - sqlalchemy.engine.Engine - INFO - [generated in 0.00690s] {'pk_1': 1}
2025-12-28 22:03:28,921 - app.routers.auth - INFO - User logged in: admin
2025-12-28 22:03:28,925 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:03:28,932 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:03:28,936 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:03:28,940 - sqlalchemy.engine.Engine - INFO - [generated in 0.00395s] {'id_1': 1, 'param_1': 1}
2025-12-28 22:03:28,947 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-28 22:03:28,953 - sqlalchemy.engine.Engine - INFO - [generated in 0.00622s] {'started_at': datetime.datetime(2025, 12, 28, 16, 33, 28, 946924), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'arp', 'network_range': '192.168.1.0/24', 'status': 'running', 'error_message': None}
2025-12-28 22:03:28,959 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:03:28,964 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:03:28,971 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-28 22:03:28,976 - sqlalchemy.engine.Engine - INFO - [generated in 0.00506s] {'pk_1': 14}
2025-12-28 22:03:28,978 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-28 22:03:28,985 - sqlalchemy.engine.Engine - INFO - [cached since 0.105s ago] {'pk_1': 1}
2025-12-28 22:03:28,989 - app.routers.scans - INFO - Scan started by admin: 14
2025-12-28 22:03:28,996 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:03:29,020 - sqlalchemy.engine.Engine - INFO - [generated in 0.02424s] {'id_1': 14, 'param_1': 1}
2025-12-28 22:03:29,028 - app.services.scanner - WARNING - Scapy not available, falling back to ARP table
2025-12-28 22:03:29,140 - app.services.scanner - ERROR - Failed to read ARP table: Command 'arp -a' returned non-zero exit status 1.
2025-12-28 22:03:29,144 - sqlalchemy.engine.Engine - INFO - UPDATE scan_sessions SET completed_at=%(completed_at)s, status=%(status)s WHERE scan_sessions.id = %(scan_sessions_id)s
2025-12-28 22:03:29,150 - sqlalchemy.engine.Engine - INFO - [generated in 0.00612s] {'completed_at': datetime.datetime(2025, 12, 28, 16, 33, 29, 142915), 'status': 'completed', 'scan_sessions_id': 14}
2025-12-28 22:03:29,160 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:03:29,167 - app.routers.scans - INFO - Scan completed: 0 devices, 0 new
2025-12-28 22:03:29,721 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:03:29,724 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:03:29,736 - sqlalchemy.engine.Engine - INFO - [cached since 0.7996s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:03:29,754 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:03:29,762 - sqlalchemy.engine.Engine - INFO - [generated in 0.00825s] {}
2025-12-28 22:03:29,775 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:03:29,793 - sqlalchemy.engine.Engine - INFO - [generated in 0.01823s] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 23, 29, 768253)}
2025-12-28 22:03:29,809 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:03:29,825 - sqlalchemy.engine.Engine - INFO - [generated in 0.01589s] {}
2025-12-28 22:03:29,910 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:03:29,960 - sqlalchemy.engine.Engine - INFO - [generated in 0.05049s] {}
2025-12-28 22:03:29,983 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:03:30,011 - sqlalchemy.engine.Engine - INFO - [generated in 0.02772s] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:03:30,061 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:03:30,077 - sqlalchemy.engine.Engine - INFO - [generated in 0.01598s] {}
2025-12-28 22:03:30,091 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:03:30,097 - sqlalchemy.engine.Engine - INFO - [generated in 0.00608s] {}
2025-12-28 22:03:30,108 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:03:30,117 - sqlalchemy.engine.Engine - INFO - [generated in 0.00995s] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:03:30,188 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:03:30,222 - sqlalchemy.engine.Engine - INFO - [generated in 0.03450s] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:03:30,277 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:03:30,294 - sqlalchemy.engine.Engine - INFO - [generated in 0.01720s] {}
2025-12-28 22:03:30,311 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:03:30,339 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:03:30,343 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:03:30,353 - sqlalchemy.engine.Engine - INFO - [cached since 1.417s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:03:30,366 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:03:30,374 - sqlalchemy.engine.Engine - INFO - [generated in 0.00828s] {'id_1': 7, 'param_1': 1}
2025-12-28 22:03:30,380 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 22:03:30,388 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:03:30,404 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:03:30,408 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:03:30,421 - sqlalchemy.engine.Engine - INFO - [cached since 1.485s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:03:30,428 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:03:30,439 - sqlalchemy.engine.Engine - INFO - [cached since 0.6855s ago] {}
2025-12-28 22:03:30,443 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:03:30,466 - sqlalchemy.engine.Engine - INFO - [cached since 0.6907s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 23, 30, 442231)}
2025-12-28 22:03:30,473 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:03:30,482 - sqlalchemy.engine.Engine - INFO - [cached since 0.6732s ago] {}
2025-12-28 22:03:30,489 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:03:30,507 - sqlalchemy.engine.Engine - INFO - [cached since 0.5968s ago] {}
2025-12-28 22:03:30,512 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:03:30,524 - sqlalchemy.engine.Engine - INFO - [cached since 0.5403s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:03:30,533 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:03:30,542 - sqlalchemy.engine.Engine - INFO - [cached since 0.4807s ago] {}
2025-12-28 22:03:30,548 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:03:30,560 - sqlalchemy.engine.Engine - INFO - [cached since 0.4694s ago] {}
2025-12-28 22:03:30,565 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:03:30,579 - sqlalchemy.engine.Engine - INFO - [cached since 0.4716s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:03:30,587 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:03:30,602 - sqlalchemy.engine.Engine - INFO - [cached since 0.4141s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:03:30,607 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:03:30,612 - sqlalchemy.engine.Engine - INFO - [cached since 0.3353s ago] {}
2025-12-28 22:03:30,624 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:03:30,635 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:03:30,637 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:03:30,644 - sqlalchemy.engine.Engine - INFO - [cached since 1.708s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:03:30,651 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:03:30,658 - sqlalchemy.engine.Engine - INFO - [cached since 0.9047s ago] {}
2025-12-28 22:03:30,663 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:03:30,691 - sqlalchemy.engine.Engine - INFO - [cached since 0.9161s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 23, 30, 662353)}
2025-12-28 22:03:30,704 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:03:30,734 - sqlalchemy.engine.Engine - INFO - [cached since 0.9246s ago] {}
2025-12-28 22:03:30,739 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:03:30,761 - sqlalchemy.engine.Engine - INFO - [cached since 0.8513s ago] {}
2025-12-28 22:03:30,769 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:03:30,795 - sqlalchemy.engine.Engine - INFO - [cached since 0.8112s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:03:30,804 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:03:30,849 - sqlalchemy.engine.Engine - INFO - [cached since 0.7881s ago] {}
2025-12-28 22:03:30,856 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:03:30,894 - sqlalchemy.engine.Engine - INFO - [cached since 0.8036s ago] {}
2025-12-28 22:03:30,900 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:03:30,911 - sqlalchemy.engine.Engine - INFO - [cached since 0.8033s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:03:30,916 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:03:30,922 - sqlalchemy.engine.Engine - INFO - [cached since 0.7349s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:03:30,927 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:03:30,930 - sqlalchemy.engine.Engine - INFO - [cached since 0.6526s ago] {}
2025-12-28 22:03:30,936 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:03:30,941 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:03:30,944 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:03:30,949 - sqlalchemy.engine.Engine - INFO - [cached since 2.012s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:03:30,955 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:03:30,968 - sqlalchemy.engine.Engine - INFO - [cached since 1.215s ago] {}
2025-12-28 22:03:30,973 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:03:30,984 - sqlalchemy.engine.Engine - INFO - [cached since 1.209s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 23, 30, 971784)}
2025-12-28 22:03:30,989 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:03:31,004 - sqlalchemy.engine.Engine - INFO - [cached since 1.194s ago] {}
2025-12-28 22:03:31,009 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:03:31,018 - sqlalchemy.engine.Engine - INFO - [cached since 1.109s ago] {}
2025-12-28 22:03:31,023 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:03:31,040 - sqlalchemy.engine.Engine - INFO - [cached since 1.056s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:03:31,045 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:03:31,053 - sqlalchemy.engine.Engine - INFO - [cached since 0.9914s ago] {}
2025-12-28 22:03:31,057 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:03:31,067 - sqlalchemy.engine.Engine - INFO - [cached since 0.9763s ago] {}
2025-12-28 22:03:31,071 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:03:31,088 - sqlalchemy.engine.Engine - INFO - [cached since 0.9803s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:03:31,093 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:03:31,102 - sqlalchemy.engine.Engine - INFO - [cached since 0.9146s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:03:31,109 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:03:31,113 - sqlalchemy.engine.Engine - INFO - [cached since 0.8357s ago] {}
2025-12-28 22:03:31,123 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:03:31,134 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:03:31,137 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:03:31,143 - sqlalchemy.engine.Engine - INFO - [cached since 2.207s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:03:31,149 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:03:31,156 - sqlalchemy.engine.Engine - INFO - [cached since 0.7902s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:03:31,162 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 22:03:31,167 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:03:31,177 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:03:31,182 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:03:31,191 - sqlalchemy.engine.Engine - INFO - [cached since 2.255s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:03:31,199 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:03:31,228 - sqlalchemy.engine.Engine - INFO - [cached since 0.8616s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:03:31,233 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 22:03:31,234 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:03:31,275 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:03:31,280 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:03:31,286 - sqlalchemy.engine.Engine - INFO - [cached since 2.35s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:03:31,295 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:03:31,307 - sqlalchemy.engine.Engine - INFO - [generated in 0.01167s] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 16, 33, 31, 290537), 'param_1': 100}
2025-12-28 22:03:31,317 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:03:31,338 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:03:31,341 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:03:31,351 - sqlalchemy.engine.Engine - INFO - [cached since 2.415s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:03:31,357 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:03:31,367 - sqlalchemy.engine.Engine - INFO - [cached since 1.614s ago] {}
2025-12-28 22:03:31,372 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:03:31,379 - sqlalchemy.engine.Engine - INFO - [cached since 1.604s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 23, 31, 371197)}
2025-12-28 22:03:31,384 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:03:31,394 - sqlalchemy.engine.Engine - INFO - [cached since 1.585s ago] {}
2025-12-28 22:03:31,399 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:03:31,409 - sqlalchemy.engine.Engine - INFO - [cached since 1.5s ago] {}
2025-12-28 22:03:31,413 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:03:31,421 - sqlalchemy.engine.Engine - INFO - [cached since 1.438s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:03:31,426 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:03:31,435 - sqlalchemy.engine.Engine - INFO - [cached since 1.373s ago] {}
2025-12-28 22:03:31,439 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:03:31,451 - sqlalchemy.engine.Engine - INFO - [cached since 1.361s ago] {}
2025-12-28 22:03:31,456 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:03:31,465 - sqlalchemy.engine.Engine - INFO - [cached since 1.358s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:03:31,472 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:03:31,489 - sqlalchemy.engine.Engine - INFO - [cached since 1.302s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:03:31,495 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:03:31,505 - sqlalchemy.engine.Engine - INFO - [cached since 1.228s ago] {}
2025-12-28 22:03:31,512 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:03:31,525 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:03:31,528 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:03:31,538 - sqlalchemy.engine.Engine - INFO - [cached since 2.602s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:03:31,543 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:03:31,554 - sqlalchemy.engine.Engine - INFO - [cached since 1.801s ago] {}
2025-12-28 22:03:31,559 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:03:31,571 - sqlalchemy.engine.Engine - INFO - [cached since 1.796s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 23, 31, 558281)}
2025-12-28 22:03:31,576 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:03:31,585 - sqlalchemy.engine.Engine - INFO - [cached since 1.776s ago] {}
2025-12-28 22:03:31,589 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:03:31,596 - sqlalchemy.engine.Engine - INFO - [cached since 1.686s ago] {}
2025-12-28 22:03:31,601 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:03:31,609 - sqlalchemy.engine.Engine - INFO - [cached since 1.626s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:03:31,615 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:03:31,624 - sqlalchemy.engine.Engine - INFO - [cached since 1.563s ago] {}
2025-12-28 22:03:31,628 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:03:31,636 - sqlalchemy.engine.Engine - INFO - [cached since 1.546s ago] {}
2025-12-28 22:03:31,641 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:03:31,661 - sqlalchemy.engine.Engine - INFO - [cached since 1.553s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:03:31,669 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:03:31,693 - sqlalchemy.engine.Engine - INFO - [cached since 1.506s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:03:31,703 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:03:31,709 - sqlalchemy.engine.Engine - INFO - [cached since 1.431s ago] {}
2025-12-28 22:03:31,719 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:03:31,726 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:03:31,731 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:03:31,736 - sqlalchemy.engine.Engine - INFO - [cached since 2.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:03:31,742 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:03:31,752 - sqlalchemy.engine.Engine - INFO - [cached since 0.4571s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 16, 33, 31, 741760), 'param_1': 100}
2025-12-28 22:03:31,761 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:03:31,788 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:03:31,792 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:03:31,800 - sqlalchemy.engine.Engine - INFO - [cached since 2.864s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:03:31,806 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:03:31,817 - sqlalchemy.engine.Engine - INFO - [cached since 0.5216s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 16, 33, 31, 805504), 'param_1': 100}
2025-12-28 22:03:31,826 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:03:51,890 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:03:51,902 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:03:51,950 - sqlalchemy.engine.Engine - INFO - [cached since 23.01s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:03:52,135 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:03:54,349 - app.services.notification - INFO - WebSocket client registered. Total: 4
2025-12-28 22:03:54,350 - app.main - INFO - WebSocket client connected
2025-12-28 22:03:54,797 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:03:54,800 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:03:54,805 - sqlalchemy.engine.Engine - INFO - [cached since 25.87s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:03:54,979 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:03:54,988 - sqlalchemy.engine.Engine - INFO - [cached since 25.23s ago] {}
2025-12-28 22:03:55,207 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:03:55,354 - sqlalchemy.engine.Engine - INFO - [cached since 25.58s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 23, 54, 994195)}
2025-12-28 22:03:55,367 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:03:55,373 - sqlalchemy.engine.Engine - INFO - [cached since 25.56s ago] {}
2025-12-28 22:03:55,633 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:03:55,725 - sqlalchemy.engine.Engine - INFO - [cached since 25.81s ago] {}
2025-12-28 22:03:55,777 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:03:56,087 - sqlalchemy.engine.Engine - INFO - [cached since 26.1s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:03:56,134 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:03:56,367 - sqlalchemy.engine.Engine - INFO - [cached since 26.31s ago] {}
2025-12-28 22:03:56,395 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:03:56,656 - sqlalchemy.engine.Engine - INFO - [cached since 26.57s ago] {}
2025-12-28 22:03:56,937 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:03:57,117 - sqlalchemy.engine.Engine - INFO - [cached since 27.01s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:03:57,136 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:03:57,231 - sqlalchemy.engine.Engine - INFO - [cached since 27.04s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:03:57,256 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:03:57,316 - sqlalchemy.engine.Engine - INFO - [cached since 27.04s ago] {}
2025-12-28 22:03:57,705 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:03:58,112 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:03:58,116 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:03:58,166 - sqlalchemy.engine.Engine - INFO - [cached since 29.23s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:03:58,850 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:03:58,977 - sqlalchemy.engine.Engine - INFO - [cached since 28.61s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:03:58,984 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 22:03:58,990 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:03:59,136 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:03:59,139 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:03:59,146 - sqlalchemy.engine.Engine - INFO - [cached since 30.21s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:03:59,215 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:03:59,606 - sqlalchemy.engine.Engine - INFO - [cached since 29.85s ago] {}
2025-12-28 22:03:59,687 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:03:59,944 - sqlalchemy.engine.Engine - INFO - [cached since 30.17s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 23, 59, 683318)}
2025-12-28 22:03:59,957 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:04:00,802 - sqlalchemy.engine.Engine - INFO - [cached since 30.99s ago] {}
2025-12-28 22:04:01,196 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:04:01,732 - sqlalchemy.engine.Engine - INFO - [cached since 31.82s ago] {}
2025-12-28 22:04:01,739 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:04:01,753 - sqlalchemy.engine.Engine - INFO - [cached since 31.77s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:04:01,759 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:04:01,767 - sqlalchemy.engine.Engine - INFO - [cached since 31.71s ago] {}
2025-12-28 22:04:02,119 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:04:02,577 - sqlalchemy.engine.Engine - INFO - [cached since 32.49s ago] {}
2025-12-28 22:04:02,854 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:04:03,243 - sqlalchemy.engine.Engine - INFO - [cached since 33.14s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:04:03,261 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:04:03,483 - sqlalchemy.engine.Engine - INFO - [cached since 33.3s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:04:03,491 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:04:03,496 - sqlalchemy.engine.Engine - INFO - [cached since 33.22s ago] {}
2025-12-28 22:04:03,526 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:04:04,040 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:04:04,125 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:04:04,351 - sqlalchemy.engine.Engine - INFO - [cached since 35.41s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:04:04,566 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:04:04,685 - sqlalchemy.engine.Engine - INFO - [cached since 33.39s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 16, 34, 4, 565183), 'param_1': 100}
2025-12-28 22:04:04,714 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:04:37,036 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:04:37,054 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:04:37,289 - sqlalchemy.engine.Engine - INFO - [cached since 68.35s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:04:37,540 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-28 22:04:37,556 - sqlalchemy.engine.Engine - INFO - [cached since 68.61s ago] {'started_at': datetime.datetime(2025, 12, 28, 16, 34, 37, 540540), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'arp', 'network_range': '192.168.1.0/24', 'status': 'running', 'error_message': None}
2025-12-28 22:04:37,713 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:04:38,220 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:04:38,725 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-28 22:04:38,734 - sqlalchemy.engine.Engine - INFO - [cached since 69.76s ago] {'pk_1': 15}
2025-12-28 22:04:38,756 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-28 22:04:38,760 - sqlalchemy.engine.Engine - INFO - [cached since 69.88s ago] {'pk_1': 1}
2025-12-28 22:04:38,777 - app.routers.scans - INFO - Scan started by admin: 15
2025-12-28 22:04:38,784 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:04:39,114 - sqlalchemy.engine.Engine - INFO - [cached since 70.12s ago] {'id_1': 15, 'param_1': 1}
2025-12-28 22:04:39,929 - app.services.scanner - WARNING - Scapy not available, falling back to ARP table
2025-12-28 22:04:41,528 - app.services.scanner - ERROR - Failed to read ARP table: Command 'arp -a' returned non-zero exit status 1.
2025-12-28 22:04:41,532 - sqlalchemy.engine.Engine - INFO - UPDATE scan_sessions SET completed_at=%(completed_at)s, status=%(status)s WHERE scan_sessions.id = %(scan_sessions_id)s
2025-12-28 22:04:41,535 - sqlalchemy.engine.Engine - INFO - [cached since 72.39s ago] {'completed_at': datetime.datetime(2025, 12, 28, 16, 34, 41, 530956), 'status': 'completed', 'scan_sessions_id': 15}
2025-12-28 22:04:41,540 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:04:41,621 - app.routers.scans - INFO - Scan completed: 0 devices, 0 new
2025-12-28 22:04:42,102 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:04:42,120 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:04:42,319 - sqlalchemy.engine.Engine - INFO - [cached since 73.38s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:04:42,761 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:04:42,927 - sqlalchemy.engine.Engine - INFO - [cached since 73.17s ago] {}
2025-12-28 22:04:43,215 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:04:43,438 - sqlalchemy.engine.Engine - INFO - [cached since 73.66s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 24, 43, 211999)}
2025-12-28 22:04:43,578 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:04:43,654 - sqlalchemy.engine.Engine - INFO - [cached since 73.84s ago] {}
2025-12-28 22:04:43,823 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:04:44,137 - sqlalchemy.engine.Engine - INFO - [cached since 74.23s ago] {}
2025-12-28 22:04:44,529 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:04:44,707 - sqlalchemy.engine.Engine - INFO - [cached since 74.72s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:04:44,795 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:04:44,906 - sqlalchemy.engine.Engine - INFO - [cached since 74.84s ago] {}
2025-12-28 22:04:45,186 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:04:46,592 - sqlalchemy.engine.Engine - INFO - [cached since 76.5s ago] {}
2025-12-28 22:04:47,345 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:04:47,956 - sqlalchemy.engine.Engine - INFO - [cached since 77.85s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:04:48,334 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:04:48,585 - sqlalchemy.engine.Engine - INFO - [cached since 78.4s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:04:49,027 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:04:49,439 - sqlalchemy.engine.Engine - INFO - [cached since 79.16s ago] {}
2025-12-28 22:04:51,508 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:04:52,130 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:04:52,133 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:04:52,159 - sqlalchemy.engine.Engine - INFO - [cached since 83.22s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:04:52,293 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:04:52,481 - sqlalchemy.engine.Engine - INFO - [cached since 82.73s ago] {}
2025-12-28 22:04:52,897 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:04:52,907 - sqlalchemy.engine.Engine - INFO - [cached since 83.13s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 24, 52, 893569)}
2025-12-28 22:04:52,920 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:04:52,927 - sqlalchemy.engine.Engine - INFO - [cached since 83.12s ago] {}
2025-12-28 22:04:53,316 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:04:53,527 - sqlalchemy.engine.Engine - INFO - [cached since 83.62s ago] {}
2025-12-28 22:04:53,912 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:04:53,981 - sqlalchemy.engine.Engine - INFO - [cached since 84s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:04:54,038 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:04:54,398 - sqlalchemy.engine.Engine - INFO - [cached since 84.34s ago] {}
2025-12-28 22:04:55,196 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:04:55,332 - sqlalchemy.engine.Engine - INFO - [cached since 85.24s ago] {}
2025-12-28 22:04:55,434 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:04:55,501 - sqlalchemy.engine.Engine - INFO - [cached since 85.39s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:04:55,541 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:04:55,633 - sqlalchemy.engine.Engine - INFO - [cached since 85.45s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:04:55,682 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:04:55,806 - sqlalchemy.engine.Engine - INFO - [cached since 85.53s ago] {}
2025-12-28 22:04:56,072 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:04:56,256 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:04:56,781 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:04:56,926 - sqlalchemy.engine.Engine - INFO - [cached since 87.99s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:04:57,122 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:04:57,220 - sqlalchemy.engine.Engine - INFO - [cached since 87.47s ago] {}
2025-12-28 22:04:57,478 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:04:57,597 - sqlalchemy.engine.Engine - INFO - [cached since 87.82s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 24, 57, 476115)}
2025-12-28 22:04:57,784 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:04:57,935 - sqlalchemy.engine.Engine - INFO - [cached since 88.13s ago] {}
2025-12-28 22:04:58,368 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:04:58,376 - sqlalchemy.engine.Engine - INFO - [cached since 88.47s ago] {}
2025-12-28 22:04:58,387 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:04:58,396 - sqlalchemy.engine.Engine - INFO - [cached since 88.41s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:04:58,657 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:04:58,914 - sqlalchemy.engine.Engine - INFO - [cached since 88.85s ago] {}
2025-12-28 22:04:58,991 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:04:59,276 - sqlalchemy.engine.Engine - INFO - [cached since 89.18s ago] {}
2025-12-28 22:04:59,990 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:05:00,001 - sqlalchemy.engine.Engine - INFO - [cached since 89.89s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:05:00,010 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:05:00,021 - sqlalchemy.engine.Engine - INFO - [cached since 89.83s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:05:00,030 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:05:00,034 - sqlalchemy.engine.Engine - INFO - [cached since 89.76s ago] {}
2025-12-28 22:05:00,053 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:05:00,178 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:05:00,865 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:05:01,001 - sqlalchemy.engine.Engine - INFO - [cached since 92.06s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:05:01,124 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:05:01,129 - sqlalchemy.engine.Engine - INFO - [cached since 91.38s ago] {}
2025-12-28 22:05:01,136 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:05:01,144 - sqlalchemy.engine.Engine - INFO - [cached since 91.37s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 25, 1, 133629)}
2025-12-28 22:05:01,152 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:05:01,160 - sqlalchemy.engine.Engine - INFO - [cached since 91.35s ago] {}
2025-12-28 22:05:01,360 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:05:01,535 - sqlalchemy.engine.Engine - INFO - [cached since 91.63s ago] {}
2025-12-28 22:05:01,558 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:05:01,691 - sqlalchemy.engine.Engine - INFO - [cached since 91.71s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:05:01,928 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:05:02,242 - sqlalchemy.engine.Engine - INFO - [cached since 92.18s ago] {}
2025-12-28 22:05:02,418 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:05:02,705 - sqlalchemy.engine.Engine - INFO - [cached since 92.61s ago] {}
2025-12-28 22:05:02,771 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:05:02,902 - sqlalchemy.engine.Engine - INFO - [cached since 92.79s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:05:02,938 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:05:03,136 - sqlalchemy.engine.Engine - INFO - [cached since 92.95s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:05:03,143 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:05:03,145 - sqlalchemy.engine.Engine - INFO - [cached since 92.87s ago] {}
2025-12-28 22:05:03,167 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:05:03,397 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:05:03,555 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:05:03,801 - sqlalchemy.engine.Engine - INFO - [cached since 94.86s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:05:03,825 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:05:03,938 - sqlalchemy.engine.Engine - INFO - [cached since 93.57s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:05:04,036 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 22:05:04,182 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:05:05,416 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:05:05,636 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:05:06,185 - sqlalchemy.engine.Engine - INFO - [cached since 97.25s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:05:06,277 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:05:06,383 - sqlalchemy.engine.Engine - INFO - [cached since 96.02s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:05:06,763 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 22:05:06,879 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:05:06,885 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:05:06,888 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:05:07,155 - sqlalchemy.engine.Engine - INFO - [cached since 98.22s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:05:07,190 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:05:07,269 - sqlalchemy.engine.Engine - INFO - [cached since 97.52s ago] {}
2025-12-28 22:05:07,359 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:05:07,682 - sqlalchemy.engine.Engine - INFO - [cached since 97.83s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 25, 7, 356190)}
2025-12-28 22:05:07,778 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:05:07,947 - sqlalchemy.engine.Engine - INFO - [cached since 98.14s ago] {}
2025-12-28 22:05:08,024 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:05:08,073 - sqlalchemy.engine.Engine - INFO - [cached since 98.16s ago] {}
2025-12-28 22:05:08,616 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:05:08,723 - sqlalchemy.engine.Engine - INFO - [cached since 98.74s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:05:09,260 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:05:09,504 - sqlalchemy.engine.Engine - INFO - [cached since 99.44s ago] {}
2025-12-28 22:05:09,589 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:05:09,737 - sqlalchemy.engine.Engine - INFO - [cached since 99.65s ago] {}
2025-12-28 22:05:09,886 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:05:10,022 - sqlalchemy.engine.Engine - INFO - [cached since 99.91s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:05:10,287 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:05:10,335 - sqlalchemy.engine.Engine - INFO - [cached since 100.1s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:05:10,363 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:05:10,463 - sqlalchemy.engine.Engine - INFO - [cached since 100.2s ago] {}
2025-12-28 22:05:11,349 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:05:11,586 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:05:11,648 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:05:11,660 - sqlalchemy.engine.Engine - INFO - [cached since 102.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:05:11,689 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:05:11,694 - sqlalchemy.engine.Engine - INFO - [cached since 101.3s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:05:11,856 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 22:05:12,288 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:05:12,294 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:05:12,372 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:05:12,386 - sqlalchemy.engine.Engine - INFO - [cached since 103.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:05:12,402 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:05:12,418 - sqlalchemy.engine.Engine - INFO - [cached since 102.7s ago] {}
2025-12-28 22:05:12,424 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:05:12,440 - sqlalchemy.engine.Engine - INFO - [cached since 102.7s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 25, 12, 422295)}
2025-12-28 22:05:12,449 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:05:12,462 - sqlalchemy.engine.Engine - INFO - [cached since 102.7s ago] {}
2025-12-28 22:05:12,468 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:05:12,478 - sqlalchemy.engine.Engine - INFO - [cached since 102.6s ago] {}
2025-12-28 22:05:12,483 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:05:12,497 - sqlalchemy.engine.Engine - INFO - [cached since 102.5s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:05:12,504 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:05:12,514 - sqlalchemy.engine.Engine - INFO - [cached since 102.5s ago] {}
2025-12-28 22:05:12,518 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:05:12,531 - sqlalchemy.engine.Engine - INFO - [cached since 102.4s ago] {}
2025-12-28 22:05:12,537 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:05:12,559 - sqlalchemy.engine.Engine - INFO - [cached since 102.5s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:05:12,569 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:05:12,580 - sqlalchemy.engine.Engine - INFO - [cached since 102.4s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:05:12,586 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:05:12,589 - sqlalchemy.engine.Engine - INFO - [cached since 102.3s ago] {}
2025-12-28 22:05:12,601 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:05:12,603 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:05:12,626 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:05:12,634 - sqlalchemy.engine.Engine - INFO - [cached since 103.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:05:12,640 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:05:12,659 - sqlalchemy.engine.Engine - INFO - [cached since 101.4s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 16, 35, 12, 639014), 'param_1': 100}
2025-12-28 22:05:12,669 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:05:12,674 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:05:12,678 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:05:12,684 - sqlalchemy.engine.Engine - INFO - [cached since 103.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:05:12,690 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:05:12,699 - sqlalchemy.engine.Engine - INFO - [cached since 102.3s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:05:12,705 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 22:05:12,708 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:05:12,710 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:05:12,712 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:05:12,718 - sqlalchemy.engine.Engine - INFO - [cached since 103.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:05:12,724 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:05:12,737 - sqlalchemy.engine.Engine - INFO - [cached since 101.4s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 16, 35, 12, 723440), 'param_1': 100}
2025-12-28 22:05:12,749 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:05:12,827 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:05:12,872 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:05:12,897 - sqlalchemy.engine.Engine - INFO - [cached since 104s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:05:12,913 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:05:12,925 - sqlalchemy.engine.Engine - INFO - [cached since 103.2s ago] {}
2025-12-28 22:05:12,938 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:05:12,956 - sqlalchemy.engine.Engine - INFO - [cached since 103.2s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 25, 12, 936883)}
2025-12-28 22:05:12,965 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:05:12,975 - sqlalchemy.engine.Engine - INFO - [cached since 103.2s ago] {}
2025-12-28 22:05:12,981 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:05:12,992 - sqlalchemy.engine.Engine - INFO - [cached since 103.1s ago] {}
2025-12-28 22:05:12,998 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:05:13,007 - sqlalchemy.engine.Engine - INFO - [cached since 103s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:05:13,014 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:05:13,022 - sqlalchemy.engine.Engine - INFO - [cached since 103s ago] {}
2025-12-28 22:05:13,028 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:05:13,036 - sqlalchemy.engine.Engine - INFO - [cached since 102.9s ago] {}
2025-12-28 22:05:13,042 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:05:13,051 - sqlalchemy.engine.Engine - INFO - [cached since 102.9s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:05:13,057 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:05:13,067 - sqlalchemy.engine.Engine - INFO - [cached since 102.9s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:05:13,072 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:05:13,080 - sqlalchemy.engine.Engine - INFO - [cached since 102.8s ago] {}
2025-12-28 22:05:13,085 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:05:13,098 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:05:13,100 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:05:13,108 - sqlalchemy.engine.Engine - INFO - [cached since 104.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:05:13,113 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:05:13,121 - sqlalchemy.engine.Engine - INFO - [cached since 103.4s ago] {}
2025-12-28 22:05:13,124 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:05:13,147 - sqlalchemy.engine.Engine - INFO - [cached since 103.4s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 25, 13, 123641)}
2025-12-28 22:05:13,394 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:05:13,687 - sqlalchemy.engine.Engine - INFO - [cached since 103.9s ago] {}
2025-12-28 22:05:13,793 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:05:13,853 - sqlalchemy.engine.Engine - INFO - [cached since 103.9s ago] {}
2025-12-28 22:05:13,887 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:05:14,048 - sqlalchemy.engine.Engine - INFO - [cached since 104.1s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:05:14,368 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:05:14,547 - sqlalchemy.engine.Engine - INFO - [cached since 104.5s ago] {}
2025-12-28 22:05:14,651 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:05:14,688 - sqlalchemy.engine.Engine - INFO - [cached since 104.6s ago] {}
2025-12-28 22:05:14,726 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:05:14,803 - sqlalchemy.engine.Engine - INFO - [cached since 104.7s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:05:14,831 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:05:15,037 - sqlalchemy.engine.Engine - INFO - [cached since 104.9s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:05:15,269 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:05:15,536 - sqlalchemy.engine.Engine - INFO - [cached since 105.3s ago] {}
2025-12-28 22:05:15,873 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:05:26,127 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:05:26,178 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:05:26,349 - sqlalchemy.engine.Engine - INFO - [cached since 117.4s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:05:26,617 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:05:26,693 - sqlalchemy.engine.Engine - INFO - [cached since 115.4s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 16, 35, 26, 616038), 'param_1': 100}
2025-12-28 22:05:27,280 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:05:30,304 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:05:30,347 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:05:30,377 - sqlalchemy.engine.Engine - INFO - [cached since 121.4s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:05:30,393 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:05:30,424 - sqlalchemy.engine.Engine - INFO - [cached since 119.1s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 16, 35, 30, 390978), 'param_1': 100}
2025-12-28 22:05:30,762 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:06:18,416 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:06:18,418 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:06:18,421 - sqlalchemy.engine.Engine - INFO - [cached since 169.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:06:18,427 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-28 22:06:18,430 - sqlalchemy.engine.Engine - INFO - [cached since 169.5s ago] {'started_at': datetime.datetime(2025, 12, 28, 16, 36, 18, 426938), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'arp', 'network_range': '192.168.1.0/24', 'status': 'running', 'error_message': None}
2025-12-28 22:06:18,436 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:06:18,442 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:06:18,444 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-28 22:06:18,447 - sqlalchemy.engine.Engine - INFO - [cached since 169.5s ago] {'pk_1': 16}
2025-12-28 22:06:18,452 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-28 22:06:18,456 - sqlalchemy.engine.Engine - INFO - [cached since 169.6s ago] {'pk_1': 1}
2025-12-28 22:06:18,459 - app.routers.scans - INFO - Scan started by admin: 16
2025-12-28 22:06:18,463 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:06:18,468 - sqlalchemy.engine.Engine - INFO - [cached since 169.5s ago] {'id_1': 16, 'param_1': 1}
2025-12-28 22:06:18,480 - app.services.scanner - WARNING - Scapy not available, falling back to ARP table
2025-12-28 22:06:18,534 - app.services.scanner - ERROR - Failed to read ARP table: Command 'arp -a' returned non-zero exit status 1.
2025-12-28 22:06:18,536 - sqlalchemy.engine.Engine - INFO - UPDATE scan_sessions SET completed_at=%(completed_at)s, status=%(status)s WHERE scan_sessions.id = %(scan_sessions_id)s
2025-12-28 22:06:18,538 - sqlalchemy.engine.Engine - INFO - [cached since 169.4s ago] {'completed_at': datetime.datetime(2025, 12, 28, 16, 36, 18, 535938), 'status': 'completed', 'scan_sessions_id': 16}
2025-12-28 22:06:18,546 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:06:18,550 - app.routers.scans - INFO - Scan completed: 0 devices, 0 new
2025-12-28 22:06:18,566 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:06:18,572 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:06:18,587 - sqlalchemy.engine.Engine - INFO - [cached since 169.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:06:18,598 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:06:18,605 - sqlalchemy.engine.Engine - INFO - [cached since 168.9s ago] {}
2025-12-28 22:06:18,614 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:06:18,622 - sqlalchemy.engine.Engine - INFO - [cached since 168.8s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 26, 18, 613084)}
2025-12-28 22:06:18,633 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:06:18,646 - sqlalchemy.engine.Engine - INFO - [cached since 168.8s ago] {}
2025-12-28 22:06:18,651 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:06:18,664 - sqlalchemy.engine.Engine - INFO - [cached since 168.8s ago] {}
2025-12-28 22:06:18,669 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:06:18,688 - sqlalchemy.engine.Engine - INFO - [cached since 168.7s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:06:18,697 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:06:18,716 - sqlalchemy.engine.Engine - INFO - [cached since 168.7s ago] {}
2025-12-28 22:06:18,720 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:06:18,733 - sqlalchemy.engine.Engine - INFO - [cached since 168.6s ago] {}
2025-12-28 22:06:18,737 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:06:18,757 - sqlalchemy.engine.Engine - INFO - [cached since 168.6s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:06:18,766 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:06:18,786 - sqlalchemy.engine.Engine - INFO - [cached since 168.6s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:06:18,795 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:06:18,800 - sqlalchemy.engine.Engine - INFO - [cached since 168.5s ago] {}
2025-12-28 22:06:18,806 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:06:18,834 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:06:18,845 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:06:18,855 - sqlalchemy.engine.Engine - INFO - [cached since 169.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:06:18,865 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:06:18,879 - sqlalchemy.engine.Engine - INFO - [cached since 169.1s ago] {}
2025-12-28 22:06:18,884 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:06:18,904 - sqlalchemy.engine.Engine - INFO - [cached since 169.1s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 26, 18, 883357)}
2025-12-28 22:06:18,912 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:06:18,930 - sqlalchemy.engine.Engine - INFO - [cached since 169.1s ago] {}
2025-12-28 22:06:18,935 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:06:18,951 - sqlalchemy.engine.Engine - INFO - [cached since 169s ago] {}
2025-12-28 22:06:18,955 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:06:18,967 - sqlalchemy.engine.Engine - INFO - [cached since 169s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:06:18,972 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:06:18,985 - sqlalchemy.engine.Engine - INFO - [cached since 168.9s ago] {}
2025-12-28 22:06:18,989 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:06:18,998 - sqlalchemy.engine.Engine - INFO - [cached since 168.9s ago] {}
2025-12-28 22:06:19,003 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:06:19,018 - sqlalchemy.engine.Engine - INFO - [cached since 168.9s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:06:19,024 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:06:19,040 - sqlalchemy.engine.Engine - INFO - [cached since 168.9s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:06:19,049 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:06:19,054 - sqlalchemy.engine.Engine - INFO - [cached since 168.8s ago] {}
2025-12-28 22:06:19,064 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:06:19,071 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:06:19,077 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:06:19,085 - sqlalchemy.engine.Engine - INFO - [cached since 170.1s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:06:19,090 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:06:19,104 - sqlalchemy.engine.Engine - INFO - [cached since 168.7s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:06:19,116 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 22:06:19,117 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:06:19,119 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:06:19,120 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:06:19,136 - sqlalchemy.engine.Engine - INFO - [cached since 170.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:06:19,143 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:06:19,154 - sqlalchemy.engine.Engine - INFO - [cached since 169.4s ago] {}
2025-12-28 22:06:19,164 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:06:19,186 - sqlalchemy.engine.Engine - INFO - [cached since 169.4s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 26, 19, 163369)}
2025-12-28 22:06:19,193 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:06:19,207 - sqlalchemy.engine.Engine - INFO - [cached since 169.4s ago] {}
2025-12-28 22:06:19,215 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:06:19,231 - sqlalchemy.engine.Engine - INFO - [cached since 169.3s ago] {}
2025-12-28 22:06:19,237 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:06:19,248 - sqlalchemy.engine.Engine - INFO - [cached since 169.3s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:06:19,254 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:06:19,269 - sqlalchemy.engine.Engine - INFO - [cached since 169.2s ago] {}
2025-12-28 22:06:19,275 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:06:19,301 - sqlalchemy.engine.Engine - INFO - [cached since 169.2s ago] {}
2025-12-28 22:06:19,305 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:06:19,319 - sqlalchemy.engine.Engine - INFO - [cached since 169.2s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:06:19,324 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:06:19,336 - sqlalchemy.engine.Engine - INFO - [cached since 169.1s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:06:19,342 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:06:19,347 - sqlalchemy.engine.Engine - INFO - [cached since 169.1s ago] {}
2025-12-28 22:06:19,355 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:06:19,370 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:06:19,372 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:06:19,388 - sqlalchemy.engine.Engine - INFO - [cached since 170.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:06:19,398 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:06:19,406 - sqlalchemy.engine.Engine - INFO - [cached since 169.7s ago] {}
2025-12-28 22:06:19,414 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:06:19,433 - sqlalchemy.engine.Engine - INFO - [cached since 169.7s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 26, 19, 413520)}
2025-12-28 22:06:19,439 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:06:19,449 - sqlalchemy.engine.Engine - INFO - [cached since 169.6s ago] {}
2025-12-28 22:06:19,453 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:06:19,466 - sqlalchemy.engine.Engine - INFO - [cached since 169.6s ago] {}
2025-12-28 22:06:19,470 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:06:19,482 - sqlalchemy.engine.Engine - INFO - [cached since 169.5s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:06:19,487 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:06:19,499 - sqlalchemy.engine.Engine - INFO - [cached since 169.4s ago] {}
2025-12-28 22:06:19,503 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:06:19,514 - sqlalchemy.engine.Engine - INFO - [cached since 169.4s ago] {}
2025-12-28 22:06:19,518 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:06:19,529 - sqlalchemy.engine.Engine - INFO - [cached since 169.4s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:06:19,534 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:06:19,552 - sqlalchemy.engine.Engine - INFO - [cached since 169.4s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:06:19,564 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:06:19,571 - sqlalchemy.engine.Engine - INFO - [cached since 169.3s ago] {}
2025-12-28 22:06:19,582 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:06:19,609 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:06:19,616 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:06:19,630 - sqlalchemy.engine.Engine - INFO - [cached since 170.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:06:19,635 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:06:19,649 - sqlalchemy.engine.Engine - INFO - [cached since 168.4s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 16, 36, 19, 634326), 'param_1': 100}
2025-12-28 22:06:19,656 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:06:19,689 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:06:19,697 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:06:19,704 - sqlalchemy.engine.Engine - INFO - [cached since 170.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:06:19,709 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:06:19,717 - sqlalchemy.engine.Engine - INFO - [cached since 169.4s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:06:19,729 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 22:06:19,731 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:06:19,756 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:06:19,764 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:06:19,771 - sqlalchemy.engine.Engine - INFO - [cached since 170.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:06:19,778 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:06:19,790 - sqlalchemy.engine.Engine - INFO - [cached since 170s ago] {}
2025-12-28 22:06:19,799 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:06:19,810 - sqlalchemy.engine.Engine - INFO - [cached since 170s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 26, 19, 798510)}
2025-12-28 22:06:19,816 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:06:19,835 - sqlalchemy.engine.Engine - INFO - [cached since 170s ago] {}
2025-12-28 22:06:19,839 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:06:19,853 - sqlalchemy.engine.Engine - INFO - [cached since 169.9s ago] {}
2025-12-28 22:06:19,856 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:06:19,870 - sqlalchemy.engine.Engine - INFO - [cached since 169.9s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:06:19,875 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:06:19,879 - sqlalchemy.engine.Engine - INFO - [cached since 169.8s ago] {}
2025-12-28 22:06:19,883 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:06:19,901 - sqlalchemy.engine.Engine - INFO - [cached since 169.8s ago] {}
2025-12-28 22:06:19,906 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:06:19,923 - sqlalchemy.engine.Engine - INFO - [cached since 169.8s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:06:19,933 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:06:19,951 - sqlalchemy.engine.Engine - INFO - [cached since 169.8s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:06:19,975 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:06:19,981 - sqlalchemy.engine.Engine - INFO - [cached since 169.7s ago] {}
2025-12-28 22:06:19,989 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:06:19,998 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:06:20,002 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:06:20,011 - sqlalchemy.engine.Engine - INFO - [cached since 171.1s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:06:20,015 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:06:20,030 - sqlalchemy.engine.Engine - INFO - [cached since 170.3s ago] {}
2025-12-28 22:06:20,037 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:06:20,047 - sqlalchemy.engine.Engine - INFO - [cached since 170.3s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 26, 20, 36395)}
2025-12-28 22:06:20,053 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:06:20,069 - sqlalchemy.engine.Engine - INFO - [cached since 170.3s ago] {}
2025-12-28 22:06:20,072 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:06:20,086 - sqlalchemy.engine.Engine - INFO - [cached since 170.2s ago] {}
2025-12-28 22:06:20,090 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:06:20,104 - sqlalchemy.engine.Engine - INFO - [cached since 170.1s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:06:20,109 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:06:20,122 - sqlalchemy.engine.Engine - INFO - [cached since 170.1s ago] {}
2025-12-28 22:06:20,133 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:06:20,148 - sqlalchemy.engine.Engine - INFO - [cached since 170.1s ago] {}
2025-12-28 22:06:20,152 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:06:20,168 - sqlalchemy.engine.Engine - INFO - [cached since 170.1s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:06:20,173 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:06:20,187 - sqlalchemy.engine.Engine - INFO - [cached since 170s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:06:20,200 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:06:20,204 - sqlalchemy.engine.Engine - INFO - [cached since 169.9s ago] {}
2025-12-28 22:06:20,214 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:06:20,276 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:06:20,280 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:06:20,291 - sqlalchemy.engine.Engine - INFO - [cached since 171.4s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:06:20,299 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:06:20,314 - sqlalchemy.engine.Engine - INFO - [cached since 169.9s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:06:20,333 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 22:06:20,334 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:06:20,389 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:06:20,394 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:06:20,401 - sqlalchemy.engine.Engine - INFO - [cached since 171.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:06:20,411 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:06:20,421 - sqlalchemy.engine.Engine - INFO - [cached since 170.1s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:06:20,430 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 22:06:20,431 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:06:20,455 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:06:20,463 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:06:20,473 - sqlalchemy.engine.Engine - INFO - [cached since 171.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:06:20,479 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:06:20,496 - sqlalchemy.engine.Engine - INFO - [cached since 170.7s ago] {}
2025-12-28 22:06:20,501 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:06:20,514 - sqlalchemy.engine.Engine - INFO - [cached since 170.7s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 26, 20, 500224)}
2025-12-28 22:06:20,520 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:06:20,537 - sqlalchemy.engine.Engine - INFO - [cached since 170.7s ago] {}
2025-12-28 22:06:20,548 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:06:20,563 - sqlalchemy.engine.Engine - INFO - [cached since 170.7s ago] {}
2025-12-28 22:06:20,568 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:06:20,589 - sqlalchemy.engine.Engine - INFO - [cached since 170.6s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:06:20,599 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:06:20,603 - sqlalchemy.engine.Engine - INFO - [cached since 170.5s ago] {}
2025-12-28 22:06:20,606 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:06:20,616 - sqlalchemy.engine.Engine - INFO - [cached since 170.5s ago] {}
2025-12-28 22:06:20,620 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:06:20,628 - sqlalchemy.engine.Engine - INFO - [cached since 170.5s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:06:20,632 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:06:20,636 - sqlalchemy.engine.Engine - INFO - [cached since 170.4s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:06:20,640 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:06:20,645 - sqlalchemy.engine.Engine - INFO - [cached since 170.4s ago] {}
2025-12-28 22:06:20,652 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:06:20,660 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:06:20,664 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:06:20,675 - sqlalchemy.engine.Engine - INFO - [cached since 171.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:06:20,682 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:06:20,689 - sqlalchemy.engine.Engine - INFO - [cached since 170.9s ago] {}
2025-12-28 22:06:20,697 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:06:20,701 - sqlalchemy.engine.Engine - INFO - [cached since 170.9s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 26, 20, 695514)}
2025-12-28 22:06:20,705 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:06:20,714 - sqlalchemy.engine.Engine - INFO - [cached since 170.9s ago] {}
2025-12-28 22:06:20,717 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:06:20,722 - sqlalchemy.engine.Engine - INFO - [cached since 170.8s ago] {}
2025-12-28 22:06:20,730 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:06:20,733 - sqlalchemy.engine.Engine - INFO - [cached since 170.7s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:06:20,738 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:06:20,746 - sqlalchemy.engine.Engine - INFO - [cached since 170.7s ago] {}
2025-12-28 22:06:20,750 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:06:20,754 - sqlalchemy.engine.Engine - INFO - [cached since 170.7s ago] {}
2025-12-28 22:06:20,758 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:06:20,763 - sqlalchemy.engine.Engine - INFO - [cached since 170.7s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:06:20,767 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:06:20,776 - sqlalchemy.engine.Engine - INFO - [cached since 170.6s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:06:20,781 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:06:20,783 - sqlalchemy.engine.Engine - INFO - [cached since 170.5s ago] {}
2025-12-28 22:06:20,789 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:06:20,813 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:06:20,815 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:06:20,819 - sqlalchemy.engine.Engine - INFO - [cached since 171.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:06:20,824 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:06:20,831 - sqlalchemy.engine.Engine - INFO - [cached since 169.5s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 16, 36, 20, 822608), 'param_1': 100}
2025-12-28 22:06:20,836 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:06:20,854 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:06:20,856 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:06:20,862 - sqlalchemy.engine.Engine - INFO - [cached since 171.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:06:20,866 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:06:20,870 - sqlalchemy.engine.Engine - INFO - [cached since 169.6s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 16, 36, 20, 865805), 'param_1': 100}
2025-12-28 22:06:20,880 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:06:20,915 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:06:20,917 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:06:20,923 - sqlalchemy.engine.Engine - INFO - [cached since 172s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:06:20,930 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:06:20,943 - sqlalchemy.engine.Engine - INFO - [cached since 169.6s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 16, 36, 20, 930142), 'param_1': 100}
2025-12-28 22:06:20,950 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:06:48,418 - app.services.notification - INFO - WebSocket client unregistered. Total: 3
2025-12-28 22:06:48,455 - app.main - INFO - WebSocket client disconnected
2025-12-28 22:06:48,461 - app.services.notification - INFO - WebSocket client unregistered. Total: 2
2025-12-28 22:06:48,473 - app.main - INFO - WebSocket client disconnected
2025-12-28 22:06:48,475 - app.services.notification - INFO - WebSocket client unregistered. Total: 1
2025-12-28 22:06:48,477 - app.main - INFO - WebSocket client disconnected
2025-12-28 22:06:48,479 - app.services.notification - INFO - WebSocket client unregistered. Total: 0
2025-12-28 22:06:48,484 - app.main - INFO - WebSocket client disconnected
2025-12-28 22:11:16,092 - app.main - INFO - Starting WiFi Tracker System...
2025-12-28 22:11:16,105 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-28 22:11:16,106 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:11:16,108 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-28 22:11:16,110 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:11:16,111 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-28 22:11:16,112 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:11:16,116 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:11:16,119 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-28 22:11:16,122 - sqlalchemy.engine.Engine - INFO - [generated in 0.00591s] {}
2025-12-28 22:11:16,125 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:11:16,126 - app.main - INFO - Database connection successful
2025-12-28 22:11:16,127 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:11:16,129 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-28 22:11:16,130 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:11:16,156 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-28 22:11:16,158 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:11:16,166 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-28 22:11:16,167 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:11:16,181 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-28 22:11:16,183 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:11:16,195 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-28 22:11:16,196 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:11:16,207 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-28 22:11:16,208 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:11:16,218 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-28 22:11:16,219 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:11:16,228 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-28 22:11:16,229 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:11:16,244 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:11:16,246 - app.database - INFO - Database tables initialized successfully
2025-12-28 22:15:20,487 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:15:20,490 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.username = %(username_1)s 
 LIMIT %(param_1)s
2025-12-28 22:15:20,497 - sqlalchemy.engine.Engine - INFO - [cached since 712.1s ago] {'username_1': 'admin@hospital.com', 'param_1': 1}
2025-12-28 22:15:20,504 - app.database - ERROR - Database session error: 401: Incorrect username or password
2025-12-28 22:15:20,505 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:15:31,187 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:15:31,188 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.username = %(username_1)s 
 LIMIT %(param_1)s
2025-12-28 22:15:31,193 - sqlalchemy.engine.Engine - INFO - [cached since 722.8s ago] {'username_1': 'admin', 'param_1': 1}
2025-12-28 22:15:31,687 - sqlalchemy.engine.Engine - INFO - UPDATE users SET last_login=%(last_login)s WHERE users.id = %(users_id)s
2025-12-28 22:15:31,689 - sqlalchemy.engine.Engine - INFO - [cached since 722.8s ago] {'last_login': datetime.datetime(2025, 12, 28, 16, 45, 31, 685931), 'users_id': 1}
2025-12-28 22:15:31,693 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:15:31,697 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:15:31,698 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-28 22:15:31,707 - sqlalchemy.engine.Engine - INFO - [cached since 722.8s ago] {'pk_1': 1}
2025-12-28 22:15:31,714 - app.routers.auth - INFO - User logged in: admin
2025-12-28 22:15:31,718 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:15:31,731 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:15:31,732 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:15:31,735 - sqlalchemy.engine.Engine - INFO - [cached since 722.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:15:31,739 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:15:31,756 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:15:31,759 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:15:31,770 - sqlalchemy.engine.Engine - INFO - [cached since 722.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:15:31,782 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:15:31,907 - sqlalchemy.engine.Engine - INFO - [cached since 722.2s ago] {}
2025-12-28 22:15:31,923 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:15:31,939 - sqlalchemy.engine.Engine - INFO - [cached since 722.2s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 35, 31, 921280)}
2025-12-28 22:15:31,950 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:15:31,976 - sqlalchemy.engine.Engine - INFO - [cached since 722.2s ago] {}
2025-12-28 22:15:31,983 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:15:32,001 - sqlalchemy.engine.Engine - INFO - [cached since 722.1s ago] {}
2025-12-28 22:15:32,008 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:15:32,053 - sqlalchemy.engine.Engine - INFO - [cached since 722.1s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:15:32,062 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:15:32,169 - sqlalchemy.engine.Engine - INFO - [cached since 722.1s ago] {}
2025-12-28 22:15:32,188 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:15:32,201 - sqlalchemy.engine.Engine - INFO - [cached since 722.1s ago] {}
2025-12-28 22:15:32,205 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:15:32,224 - sqlalchemy.engine.Engine - INFO - [cached since 722.1s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:15:32,236 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:15:32,266 - sqlalchemy.engine.Engine - INFO - [cached since 722.1s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:15:32,274 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:15:32,286 - sqlalchemy.engine.Engine - INFO - [cached since 722s ago] {}
2025-12-28 22:15:32,300 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:15:32,308 - app.services.notification - INFO - WebSocket client registered. Total: 1
2025-12-28 22:15:32,318 - app.main - INFO - WebSocket client connected
2025-12-28 22:15:32,338 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:15:32,340 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:15:32,353 - sqlalchemy.engine.Engine - INFO - [cached since 723.4s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:15:32,358 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:15:32,371 - sqlalchemy.engine.Engine - INFO - [cached since 722s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:15:32,379 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 22:15:32,382 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:15:32,402 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:15:32,404 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:15:32,410 - sqlalchemy.engine.Engine - INFO - [cached since 723.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:15:32,418 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:15:32,425 - sqlalchemy.engine.Engine - INFO - [cached since 722.7s ago] {}
2025-12-28 22:15:32,435 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:15:32,452 - sqlalchemy.engine.Engine - INFO - [cached since 722.7s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 35, 32, 434200)}
2025-12-28 22:15:32,460 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:15:32,482 - sqlalchemy.engine.Engine - INFO - [cached since 722.7s ago] {}
2025-12-28 22:15:32,486 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:15:32,491 - sqlalchemy.engine.Engine - INFO - [cached since 722.6s ago] {}
2025-12-28 22:15:32,498 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:15:32,502 - sqlalchemy.engine.Engine - INFO - [cached since 722.5s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:15:32,505 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:15:32,513 - sqlalchemy.engine.Engine - INFO - [cached since 722.5s ago] {}
2025-12-28 22:15:32,516 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:15:32,520 - sqlalchemy.engine.Engine - INFO - [cached since 722.4s ago] {}
2025-12-28 22:15:32,523 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:15:32,532 - sqlalchemy.engine.Engine - INFO - [cached since 722.4s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:15:32,536 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:15:32,541 - sqlalchemy.engine.Engine - INFO - [cached since 722.4s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:15:32,548 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:15:32,550 - sqlalchemy.engine.Engine - INFO - [cached since 722.3s ago] {}
2025-12-28 22:15:32,554 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:15:32,613 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:15:32,662 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:15:32,678 - sqlalchemy.engine.Engine - INFO - [cached since 723.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:15:32,686 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:15:32,701 - sqlalchemy.engine.Engine - INFO - [cached since 721.4s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 16, 45, 32, 685371), 'param_1': 100}
2025-12-28 22:15:32,712 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:15:37,372 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:15:37,374 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:15:37,384 - sqlalchemy.engine.Engine - INFO - [cached since 728.4s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:15:37,388 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-28 22:15:37,396 - sqlalchemy.engine.Engine - INFO - [cached since 728.4s ago] {'started_at': datetime.datetime(2025, 12, 28, 16, 45, 37, 388913), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'arp', 'network_range': '192.168.1.0/24', 'status': 'running', 'error_message': None}
2025-12-28 22:15:37,404 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:15:37,415 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:15:37,419 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-28 22:15:37,430 - sqlalchemy.engine.Engine - INFO - [cached since 728.5s ago] {'pk_1': 17}
2025-12-28 22:15:37,438 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-28 22:15:37,448 - sqlalchemy.engine.Engine - INFO - [cached since 728.6s ago] {'pk_1': 1}
2025-12-28 22:15:37,451 - app.routers.scans - INFO - Scan started by admin: 17
2025-12-28 22:15:37,458 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:15:37,477 - sqlalchemy.engine.Engine - INFO - [cached since 728.5s ago] {'id_1': 17, 'param_1': 1}
2025-12-28 22:15:37,485 - app.services.scanner - WARNING - Scapy not available, falling back to ARP table
2025-12-28 22:15:37,529 - app.services.scanner - ERROR - Failed to read ARP table: Command 'arp -a' returned non-zero exit status 1.
2025-12-28 22:15:37,530 - sqlalchemy.engine.Engine - INFO - UPDATE scan_sessions SET completed_at=%(completed_at)s, status=%(status)s WHERE scan_sessions.id = %(scan_sessions_id)s
2025-12-28 22:15:37,533 - sqlalchemy.engine.Engine - INFO - [cached since 728.4s ago] {'completed_at': datetime.datetime(2025, 12, 28, 16, 45, 37, 530287), 'status': 'completed', 'scan_sessions_id': 17}
2025-12-28 22:15:37,536 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:15:37,539 - app.routers.scans - INFO - Scan completed: 0 devices, 0 new
2025-12-28 22:15:37,551 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:15:37,554 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:15:37,567 - sqlalchemy.engine.Engine - INFO - [cached since 728.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:15:37,574 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:15:37,584 - sqlalchemy.engine.Engine - INFO - [cached since 727.8s ago] {}
2025-12-28 22:15:37,590 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:15:37,601 - sqlalchemy.engine.Engine - INFO - [cached since 727.8s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 35, 37, 588909)}
2025-12-28 22:15:37,606 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:15:37,619 - sqlalchemy.engine.Engine - INFO - [cached since 727.8s ago] {}
2025-12-28 22:15:37,625 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:15:37,637 - sqlalchemy.engine.Engine - INFO - [cached since 727.7s ago] {}
2025-12-28 22:15:37,641 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:15:37,650 - sqlalchemy.engine.Engine - INFO - [cached since 727.7s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:15:37,654 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:15:37,659 - sqlalchemy.engine.Engine - INFO - [cached since 727.6s ago] {}
2025-12-28 22:15:37,663 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:15:37,673 - sqlalchemy.engine.Engine - INFO - [cached since 727.6s ago] {}
2025-12-28 22:15:37,682 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:15:37,687 - sqlalchemy.engine.Engine - INFO - [cached since 727.6s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:15:37,691 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:15:37,702 - sqlalchemy.engine.Engine - INFO - [cached since 727.5s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:15:37,706 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:15:37,712 - sqlalchemy.engine.Engine - INFO - [cached since 727.4s ago] {}
2025-12-28 22:15:37,717 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:15:37,726 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:15:37,732 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:15:37,738 - sqlalchemy.engine.Engine - INFO - [cached since 728.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:15:37,745 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:15:37,753 - sqlalchemy.engine.Engine - INFO - [cached since 727.4s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:15:37,756 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 22:15:37,757 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:15:37,774 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:15:37,779 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:15:37,785 - sqlalchemy.engine.Engine - INFO - [cached since 728.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:15:37,788 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:15:37,798 - sqlalchemy.engine.Engine - INFO - [cached since 728s ago] {}
2025-12-28 22:15:37,801 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:15:37,805 - sqlalchemy.engine.Engine - INFO - [cached since 728s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 35, 37, 800449)}
2025-12-28 22:15:37,809 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:15:37,815 - sqlalchemy.engine.Engine - INFO - [cached since 728s ago] {}
2025-12-28 22:15:37,817 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:15:37,823 - sqlalchemy.engine.Engine - INFO - [cached since 727.9s ago] {}
2025-12-28 22:15:37,830 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:15:37,834 - sqlalchemy.engine.Engine - INFO - [cached since 727.9s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:15:37,837 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:15:37,841 - sqlalchemy.engine.Engine - INFO - [cached since 727.8s ago] {}
2025-12-28 22:15:37,849 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:15:37,854 - sqlalchemy.engine.Engine - INFO - [cached since 727.8s ago] {}
2025-12-28 22:15:37,856 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:15:37,865 - sqlalchemy.engine.Engine - INFO - [cached since 727.8s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:15:37,868 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:15:37,879 - sqlalchemy.engine.Engine - INFO - [cached since 727.7s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:15:37,883 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:15:37,884 - sqlalchemy.engine.Engine - INFO - [cached since 727.6s ago] {}
2025-12-28 22:15:37,888 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:15:37,911 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:15:37,916 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:15:37,921 - sqlalchemy.engine.Engine - INFO - [cached since 729s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:15:37,925 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:15:37,938 - sqlalchemy.engine.Engine - INFO - [cached since 726.6s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 16, 45, 37, 924190), 'param_1': 100}
2025-12-28 22:15:37,945 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:15:44,867 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:15:44,868 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:15:44,876 - sqlalchemy.engine.Engine - INFO - [cached since 735.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:15:44,880 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:15:44,883 - sqlalchemy.engine.Engine - INFO - [cached since 735.1s ago] {}
2025-12-28 22:15:44,893 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-28 22:15:44,899 - sqlalchemy.engine.Engine - INFO - [generated in 0.00623s] {'param_1': 0, 'param_2': 20}
2025-12-28 22:15:44,905 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:15:50,867 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:15:50,869 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:15:50,876 - sqlalchemy.engine.Engine - INFO - [cached since 741.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:15:50,882 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:15:50,886 - sqlalchemy.engine.Engine - INFO - [cached since 740.7s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-28 22:15:50,893 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:15:50,909 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:15:50,912 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:15:50,916 - sqlalchemy.engine.Engine - INFO - [cached since 742s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:15:50,922 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:15:54,782 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:15:54,784 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:15:54,786 - sqlalchemy.engine.Engine - INFO - [cached since 745.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:15:54,793 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:15:54,796 - sqlalchemy.engine.Engine - INFO - [cached since 744.7s ago] {}
2025-12-28 22:15:54,798 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:15:54,801 - sqlalchemy.engine.Engine - INFO - [cached since 744.7s ago] {}
2025-12-28 22:15:54,808 - sqlalchemy.engine.Engine - INFO - SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts ORDER BY alerts.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-28 22:15:54,814 - sqlalchemy.engine.Engine - INFO - [generated in 0.00661s] {'param_1': 0, 'param_2': 20}
2025-12-28 22:15:54,819 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:15:55,849 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:15:55,852 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:15:55,863 - sqlalchemy.engine.Engine - INFO - [cached since 746.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:15:55,867 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:15:58,759 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:15:58,761 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:15:58,765 - sqlalchemy.engine.Engine - INFO - [cached since 749.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:15:58,772 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:15:58,782 - sqlalchemy.engine.Engine - INFO - [cached since 749s ago] {}
2025-12-28 22:15:58,792 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:15:58,796 - sqlalchemy.engine.Engine - INFO - [cached since 749s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 35, 58, 790593)}
2025-12-28 22:15:58,800 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:15:58,809 - sqlalchemy.engine.Engine - INFO - [cached since 749s ago] {}
2025-12-28 22:15:58,812 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:15:58,816 - sqlalchemy.engine.Engine - INFO - [cached since 748.9s ago] {}
2025-12-28 22:15:58,821 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:15:58,828 - sqlalchemy.engine.Engine - INFO - [cached since 748.8s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:15:58,832 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:15:58,842 - sqlalchemy.engine.Engine - INFO - [cached since 748.8s ago] {}
2025-12-28 22:15:58,844 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:15:58,850 - sqlalchemy.engine.Engine - INFO - [cached since 748.8s ago] {}
2025-12-28 22:15:58,855 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:15:58,865 - sqlalchemy.engine.Engine - INFO - [cached since 748.8s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:15:58,873 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:15:58,895 - sqlalchemy.engine.Engine - INFO - [cached since 748.7s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:15:58,900 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:15:58,908 - sqlalchemy.engine.Engine - INFO - [cached since 748.6s ago] {}
2025-12-28 22:15:58,916 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:15:58,931 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:15:58,934 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:15:58,944 - sqlalchemy.engine.Engine - INFO - [cached since 750s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:15:58,947 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:15:58,949 - sqlalchemy.engine.Engine - INFO - [cached since 748.6s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:15:58,953 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 22:15:58,956 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:15:58,970 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:15:58,974 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:15:58,980 - sqlalchemy.engine.Engine - INFO - [cached since 750s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:15:58,984 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:15:58,991 - sqlalchemy.engine.Engine - INFO - [cached since 749.2s ago] {}
2025-12-28 22:15:58,994 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:15:59,000 - sqlalchemy.engine.Engine - INFO - [cached since 749.2s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 35, 58, 994062)}
2025-12-28 22:15:59,005 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:15:59,010 - sqlalchemy.engine.Engine - INFO - [cached since 749.2s ago] {}
2025-12-28 22:15:59,014 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:15:59,019 - sqlalchemy.engine.Engine - INFO - [cached since 749.1s ago] {}
2025-12-28 22:15:59,025 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:15:59,030 - sqlalchemy.engine.Engine - INFO - [cached since 749s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:15:59,034 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:15:59,039 - sqlalchemy.engine.Engine - INFO - [cached since 749s ago] {}
2025-12-28 22:15:59,041 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:15:59,046 - sqlalchemy.engine.Engine - INFO - [cached since 749s ago] {}
2025-12-28 22:15:59,048 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:15:59,051 - sqlalchemy.engine.Engine - INFO - [cached since 748.9s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:15:59,056 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:15:59,062 - sqlalchemy.engine.Engine - INFO - [cached since 748.9s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:15:59,064 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:15:59,066 - sqlalchemy.engine.Engine - INFO - [cached since 748.8s ago] {}
2025-12-28 22:15:59,072 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:15:59,089 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:15:59,091 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:15:59,094 - sqlalchemy.engine.Engine - INFO - [cached since 750.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:15:59,098 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:15:59,102 - sqlalchemy.engine.Engine - INFO - [cached since 747.8s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 16, 45, 59, 97581), 'param_1': 100}
2025-12-28 22:15:59,111 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:16:00,425 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:00,426 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:00,429 - sqlalchemy.engine.Engine - INFO - [cached since 751.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:00,431 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-28 22:16:00,435 - sqlalchemy.engine.Engine - INFO - [cached since 751.5s ago] {'started_at': datetime.datetime(2025, 12, 28, 16, 46, 0, 431770), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'arp', 'network_range': '192.168.1.0/24', 'status': 'running', 'error_message': None}
2025-12-28 22:16:00,445 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:16:00,448 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:00,450 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-28 22:16:00,456 - sqlalchemy.engine.Engine - INFO - [cached since 751.5s ago] {'pk_1': 18}
2025-12-28 22:16:00,459 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-28 22:16:00,461 - sqlalchemy.engine.Engine - INFO - [cached since 751.6s ago] {'pk_1': 1}
2025-12-28 22:16:00,463 - app.routers.scans - INFO - Scan started by admin: 18
2025-12-28 22:16:00,466 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:00,476 - sqlalchemy.engine.Engine - INFO - [cached since 751.5s ago] {'id_1': 18, 'param_1': 1}
2025-12-28 22:16:00,478 - app.services.scanner - WARNING - Scapy not available, falling back to ARP table
2025-12-28 22:16:00,501 - app.services.scanner - ERROR - Failed to read ARP table: Command 'arp -a' returned non-zero exit status 1.
2025-12-28 22:16:00,503 - sqlalchemy.engine.Engine - INFO - UPDATE scan_sessions SET completed_at=%(completed_at)s, status=%(status)s WHERE scan_sessions.id = %(scan_sessions_id)s
2025-12-28 22:16:00,506 - sqlalchemy.engine.Engine - INFO - [cached since 751.4s ago] {'completed_at': datetime.datetime(2025, 12, 28, 16, 46, 0, 501855), 'status': 'completed', 'scan_sessions_id': 18}
2025-12-28 22:16:00,509 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:16:00,513 - app.routers.scans - INFO - Scan completed: 0 devices, 0 new
2025-12-28 22:16:00,522 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:00,524 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:00,528 - sqlalchemy.engine.Engine - INFO - [cached since 751.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:00,533 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:16:00,542 - sqlalchemy.engine.Engine - INFO - [cached since 750.8s ago] {}
2025-12-28 22:16:00,546 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:16:00,551 - sqlalchemy.engine.Engine - INFO - [cached since 750.8s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 36, 0, 545266)}
2025-12-28 22:16:00,560 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:16:00,568 - sqlalchemy.engine.Engine - INFO - [cached since 750.8s ago] {}
2025-12-28 22:16:00,577 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:16:00,584 - sqlalchemy.engine.Engine - INFO - [cached since 750.7s ago] {}
2025-12-28 22:16:00,593 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:16:00,607 - sqlalchemy.engine.Engine - INFO - [cached since 750.6s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:16:00,611 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:16:00,616 - sqlalchemy.engine.Engine - INFO - [cached since 750.6s ago] {}
2025-12-28 22:16:00,622 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:16:00,626 - sqlalchemy.engine.Engine - INFO - [cached since 750.5s ago] {}
2025-12-28 22:16:00,629 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:16:00,634 - sqlalchemy.engine.Engine - INFO - [cached since 750.5s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:16:00,640 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:16:00,646 - sqlalchemy.engine.Engine - INFO - [cached since 750.5s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:16:00,651 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:16:00,657 - sqlalchemy.engine.Engine - INFO - [cached since 750.4s ago] {}
2025-12-28 22:16:00,662 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:16:00,679 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:00,681 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:00,685 - sqlalchemy.engine.Engine - INFO - [cached since 751.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:00,694 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:00,699 - sqlalchemy.engine.Engine - INFO - [cached since 750.3s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:16:00,703 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 22:16:00,705 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:16:00,715 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:00,717 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:00,725 - sqlalchemy.engine.Engine - INFO - [cached since 751.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:00,727 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:16:00,730 - sqlalchemy.engine.Engine - INFO - [cached since 751s ago] {}
2025-12-28 22:16:00,732 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:16:00,741 - sqlalchemy.engine.Engine - INFO - [cached since 751s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 36, 0, 731948)}
2025-12-28 22:16:00,743 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:16:00,748 - sqlalchemy.engine.Engine - INFO - [cached since 750.9s ago] {}
2025-12-28 22:16:00,750 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:16:00,757 - sqlalchemy.engine.Engine - INFO - [cached since 750.8s ago] {}
2025-12-28 22:16:00,760 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:16:00,764 - sqlalchemy.engine.Engine - INFO - [cached since 750.8s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:16:00,766 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:16:00,773 - sqlalchemy.engine.Engine - INFO - [cached since 750.7s ago] {}
2025-12-28 22:16:00,775 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:16:00,780 - sqlalchemy.engine.Engine - INFO - [cached since 750.7s ago] {}
2025-12-28 22:16:00,782 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:16:00,789 - sqlalchemy.engine.Engine - INFO - [cached since 750.7s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:16:00,792 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:16:00,796 - sqlalchemy.engine.Engine - INFO - [cached since 750.6s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:16:00,799 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:16:00,802 - sqlalchemy.engine.Engine - INFO - [cached since 750.5s ago] {}
2025-12-28 22:16:00,808 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:16:00,825 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:00,827 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:00,832 - sqlalchemy.engine.Engine - INFO - [cached since 751.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:00,835 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:16:00,848 - sqlalchemy.engine.Engine - INFO - [cached since 749.6s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 16, 46, 0, 834656), 'param_1': 100}
2025-12-28 22:16:00,856 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:16:01,875 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:01,876 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:01,879 - sqlalchemy.engine.Engine - INFO - [cached since 752.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:01,881 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-28 22:16:01,888 - sqlalchemy.engine.Engine - INFO - [cached since 752.9s ago] {'started_at': datetime.datetime(2025, 12, 28, 16, 46, 1, 881869), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'arp', 'network_range': '192.168.1.0/24', 'status': 'running', 'error_message': None}
2025-12-28 22:16:01,896 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:16:01,900 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:01,902 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-28 22:16:01,908 - sqlalchemy.engine.Engine - INFO - [cached since 752.9s ago] {'pk_1': 19}
2025-12-28 22:16:01,910 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-28 22:16:01,913 - sqlalchemy.engine.Engine - INFO - [cached since 753s ago] {'pk_1': 1}
2025-12-28 22:16:01,915 - app.routers.scans - INFO - Scan started by admin: 19
2025-12-28 22:16:01,917 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:01,928 - sqlalchemy.engine.Engine - INFO - [cached since 752.9s ago] {'id_1': 19, 'param_1': 1}
2025-12-28 22:16:01,930 - app.services.scanner - WARNING - Scapy not available, falling back to ARP table
2025-12-28 22:16:01,954 - app.services.scanner - ERROR - Failed to read ARP table: Command 'arp -a' returned non-zero exit status 1.
2025-12-28 22:16:01,956 - sqlalchemy.engine.Engine - INFO - UPDATE scan_sessions SET completed_at=%(completed_at)s, status=%(status)s WHERE scan_sessions.id = %(scan_sessions_id)s
2025-12-28 22:16:01,957 - sqlalchemy.engine.Engine - INFO - [cached since 752.8s ago] {'completed_at': datetime.datetime(2025, 12, 28, 16, 46, 1, 955783), 'status': 'completed', 'scan_sessions_id': 19}
2025-12-28 22:16:01,960 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:16:01,964 - app.routers.scans - INFO - Scan completed: 0 devices, 0 new
2025-12-28 22:16:01,973 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:01,976 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:01,981 - sqlalchemy.engine.Engine - INFO - [cached since 753s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:01,988 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:16:01,996 - sqlalchemy.engine.Engine - INFO - [cached since 752.2s ago] {}
2025-12-28 22:16:01,999 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:16:02,012 - sqlalchemy.engine.Engine - INFO - [cached since 752.2s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 36, 1, 998653)}
2025-12-28 22:16:02,017 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:16:02,027 - sqlalchemy.engine.Engine - INFO - [cached since 752.2s ago] {}
2025-12-28 22:16:02,030 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:16:02,034 - sqlalchemy.engine.Engine - INFO - [cached since 752.1s ago] {}
2025-12-28 22:16:02,040 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:16:02,043 - sqlalchemy.engine.Engine - INFO - [cached since 752.1s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:16:02,046 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:16:02,051 - sqlalchemy.engine.Engine - INFO - [cached since 752s ago] {}
2025-12-28 22:16:02,060 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:16:02,066 - sqlalchemy.engine.Engine - INFO - [cached since 752s ago] {}
2025-12-28 22:16:02,069 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:16:02,076 - sqlalchemy.engine.Engine - INFO - [cached since 752s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:16:02,079 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:16:02,092 - sqlalchemy.engine.Engine - INFO - [cached since 751.9s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:16:02,096 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:16:02,097 - sqlalchemy.engine.Engine - INFO - [cached since 751.8s ago] {}
2025-12-28 22:16:02,101 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:16:02,111 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:02,112 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:02,115 - sqlalchemy.engine.Engine - INFO - [cached since 753.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:02,118 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:02,128 - sqlalchemy.engine.Engine - INFO - [cached since 751.8s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:16:02,132 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 22:16:02,133 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:16:02,145 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:02,147 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:02,150 - sqlalchemy.engine.Engine - INFO - [cached since 753.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:02,156 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:16:02,159 - sqlalchemy.engine.Engine - INFO - [cached since 752.4s ago] {}
2025-12-28 22:16:02,161 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:16:02,165 - sqlalchemy.engine.Engine - INFO - [cached since 752.4s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 36, 2, 161241)}
2025-12-28 22:16:02,168 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:16:02,175 - sqlalchemy.engine.Engine - INFO - [cached since 752.4s ago] {}
2025-12-28 22:16:02,177 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:16:02,180 - sqlalchemy.engine.Engine - INFO - [cached since 752.3s ago] {}
2025-12-28 22:16:02,183 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:16:02,193 - sqlalchemy.engine.Engine - INFO - [cached since 752.2s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:16:02,196 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:16:02,200 - sqlalchemy.engine.Engine - INFO - [cached since 752.1s ago] {}
2025-12-28 22:16:02,204 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:16:02,210 - sqlalchemy.engine.Engine - INFO - [cached since 752.1s ago] {}
2025-12-28 22:16:02,212 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:16:02,218 - sqlalchemy.engine.Engine - INFO - [cached since 752.1s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:16:02,224 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:16:02,229 - sqlalchemy.engine.Engine - INFO - [cached since 752s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:16:02,233 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:16:02,238 - sqlalchemy.engine.Engine - INFO - [cached since 752s ago] {}
2025-12-28 22:16:02,242 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:16:02,262 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:02,264 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:02,276 - sqlalchemy.engine.Engine - INFO - [cached since 753.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:02,283 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:16:02,297 - sqlalchemy.engine.Engine - INFO - [cached since 751s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 16, 46, 2, 282615), 'param_1': 100}
2025-12-28 22:16:02,308 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:16:12,754 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:12,755 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:12,757 - sqlalchemy.engine.Engine - INFO - [cached since 763.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:12,760 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-28 22:16:12,763 - sqlalchemy.engine.Engine - INFO - [cached since 763.8s ago] {'started_at': datetime.datetime(2025, 12, 28, 16, 46, 12, 760168), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'arp', 'network_range': '192.168.1.0/24', 'status': 'running', 'error_message': None}
2025-12-28 22:16:12,772 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:16:12,777 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:12,778 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-28 22:16:12,781 - sqlalchemy.engine.Engine - INFO - [cached since 763.8s ago] {'pk_1': 20}
2025-12-28 22:16:12,788 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-28 22:16:12,794 - sqlalchemy.engine.Engine - INFO - [cached since 763.9s ago] {'pk_1': 1}
2025-12-28 22:16:12,796 - app.routers.scans - INFO - Scan started by admin: 20
2025-12-28 22:16:12,800 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:12,812 - sqlalchemy.engine.Engine - INFO - [cached since 763.8s ago] {'id_1': 20, 'param_1': 1}
2025-12-28 22:16:12,815 - app.services.scanner - WARNING - Scapy not available, falling back to ARP table
2025-12-28 22:16:12,840 - app.services.scanner - ERROR - Failed to read ARP table: Command 'arp -a' returned non-zero exit status 1.
2025-12-28 22:16:12,841 - sqlalchemy.engine.Engine - INFO - UPDATE scan_sessions SET completed_at=%(completed_at)s, status=%(status)s WHERE scan_sessions.id = %(scan_sessions_id)s
2025-12-28 22:16:12,842 - sqlalchemy.engine.Engine - INFO - [cached since 763.7s ago] {'completed_at': datetime.datetime(2025, 12, 28, 16, 46, 12, 840804), 'status': 'completed', 'scan_sessions_id': 20}
2025-12-28 22:16:12,845 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:16:12,848 - app.routers.scans - INFO - Scan completed: 0 devices, 0 new
2025-12-28 22:16:12,857 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:12,858 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:12,861 - sqlalchemy.engine.Engine - INFO - [cached since 763.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:12,864 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:16:12,876 - sqlalchemy.engine.Engine - INFO - [cached since 763.1s ago] {}
2025-12-28 22:16:12,881 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:16:12,891 - sqlalchemy.engine.Engine - INFO - [cached since 763.1s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 36, 12, 880931)}
2025-12-28 22:16:12,894 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:16:12,898 - sqlalchemy.engine.Engine - INFO - [cached since 763.1s ago] {}
2025-12-28 22:16:12,904 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:16:12,908 - sqlalchemy.engine.Engine - INFO - [cached since 763s ago] {}
2025-12-28 22:16:12,911 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:16:12,920 - sqlalchemy.engine.Engine - INFO - [cached since 762.9s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:16:12,925 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:16:12,931 - sqlalchemy.engine.Engine - INFO - [cached since 762.9s ago] {}
2025-12-28 22:16:12,939 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:16:12,946 - sqlalchemy.engine.Engine - INFO - [cached since 762.9s ago] {}
2025-12-28 22:16:12,951 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:16:12,962 - sqlalchemy.engine.Engine - INFO - [cached since 762.9s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:16:12,969 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:16:12,980 - sqlalchemy.engine.Engine - INFO - [cached since 762.8s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:16:12,989 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:16:12,991 - sqlalchemy.engine.Engine - INFO - [cached since 762.7s ago] {}
2025-12-28 22:16:12,995 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:16:13,011 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:13,013 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:13,021 - sqlalchemy.engine.Engine - INFO - [cached since 764.1s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:13,025 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:13,029 - sqlalchemy.engine.Engine - INFO - [cached since 762.7s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:16:13,031 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 22:16:13,033 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:16:13,047 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:13,048 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:13,054 - sqlalchemy.engine.Engine - INFO - [cached since 764.1s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:13,057 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:16:13,064 - sqlalchemy.engine.Engine - INFO - [cached since 763.3s ago] {}
2025-12-28 22:16:13,070 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:16:13,077 - sqlalchemy.engine.Engine - INFO - [cached since 763.3s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 36, 13, 68781)}
2025-12-28 22:16:13,080 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:16:13,087 - sqlalchemy.engine.Engine - INFO - [cached since 763.3s ago] {}
2025-12-28 22:16:13,091 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:16:13,095 - sqlalchemy.engine.Engine - INFO - [cached since 763.2s ago] {}
2025-12-28 22:16:13,097 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:16:13,103 - sqlalchemy.engine.Engine - INFO - [cached since 763.1s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:16:13,107 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:16:13,112 - sqlalchemy.engine.Engine - INFO - [cached since 763.1s ago] {}
2025-12-28 22:16:13,114 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:16:13,123 - sqlalchemy.engine.Engine - INFO - [cached since 763s ago] {}
2025-12-28 22:16:13,127 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:16:13,131 - sqlalchemy.engine.Engine - INFO - [cached since 763s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:16:13,134 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:16:13,142 - sqlalchemy.engine.Engine - INFO - [cached since 763s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:16:13,144 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:16:13,146 - sqlalchemy.engine.Engine - INFO - [cached since 762.9s ago] {}
2025-12-28 22:16:13,154 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:16:13,170 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:13,174 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:13,180 - sqlalchemy.engine.Engine - INFO - [cached since 764.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:13,185 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:16:13,193 - sqlalchemy.engine.Engine - INFO - [cached since 761.9s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 16, 46, 13, 184068), 'param_1': 100}
2025-12-28 22:16:13,197 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:16:15,705 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:15,706 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:15,708 - sqlalchemy.engine.Engine - INFO - [cached since 766.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:15,711 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-28 22:16:15,716 - sqlalchemy.engine.Engine - INFO - [cached since 766.8s ago] {'started_at': datetime.datetime(2025, 12, 28, 16, 46, 15, 711455), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'arp', 'network_range': '192.168.1.0/24', 'status': 'running', 'error_message': None}
2025-12-28 22:16:15,726 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:16:15,730 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:15,732 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-28 22:16:15,738 - sqlalchemy.engine.Engine - INFO - [cached since 766.8s ago] {'pk_1': 21}
2025-12-28 22:16:15,740 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-28 22:16:15,744 - sqlalchemy.engine.Engine - INFO - [cached since 766.9s ago] {'pk_1': 1}
2025-12-28 22:16:15,746 - app.routers.scans - INFO - Scan started by admin: 21
2025-12-28 22:16:15,752 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:15,761 - sqlalchemy.engine.Engine - INFO - [cached since 766.8s ago] {'id_1': 21, 'param_1': 1}
2025-12-28 22:16:15,764 - app.services.scanner - WARNING - Scapy not available, falling back to ARP table
2025-12-28 22:16:15,790 - app.services.scanner - ERROR - Failed to read ARP table: Command 'arp -a' returned non-zero exit status 1.
2025-12-28 22:16:15,791 - sqlalchemy.engine.Engine - INFO - UPDATE scan_sessions SET completed_at=%(completed_at)s, status=%(status)s WHERE scan_sessions.id = %(scan_sessions_id)s
2025-12-28 22:16:15,793 - sqlalchemy.engine.Engine - INFO - [cached since 766.6s ago] {'completed_at': datetime.datetime(2025, 12, 28, 16, 46, 15, 791501), 'status': 'completed', 'scan_sessions_id': 21}
2025-12-28 22:16:15,796 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:16:15,800 - app.routers.scans - INFO - Scan completed: 0 devices, 0 new
2025-12-28 22:16:15,809 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:15,810 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:15,814 - sqlalchemy.engine.Engine - INFO - [cached since 766.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:15,824 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:16:15,828 - sqlalchemy.engine.Engine - INFO - [cached since 766.1s ago] {}
2025-12-28 22:16:15,831 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:16:15,840 - sqlalchemy.engine.Engine - INFO - [cached since 766.1s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 36, 15, 830628)}
2025-12-28 22:16:15,843 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:16:15,847 - sqlalchemy.engine.Engine - INFO - [cached since 766s ago] {}
2025-12-28 22:16:15,853 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:16:15,857 - sqlalchemy.engine.Engine - INFO - [cached since 765.9s ago] {}
2025-12-28 22:16:15,859 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:16:15,863 - sqlalchemy.engine.Engine - INFO - [cached since 765.9s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:16:15,869 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:16:15,873 - sqlalchemy.engine.Engine - INFO - [cached since 765.8s ago] {}
2025-12-28 22:16:15,875 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:16:15,879 - sqlalchemy.engine.Engine - INFO - [cached since 765.8s ago] {}
2025-12-28 22:16:15,883 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:16:15,889 - sqlalchemy.engine.Engine - INFO - [cached since 765.8s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:16:15,892 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:16:15,897 - sqlalchemy.engine.Engine - INFO - [cached since 765.7s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:16:15,904 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:16:15,905 - sqlalchemy.engine.Engine - INFO - [cached since 765.6s ago] {}
2025-12-28 22:16:15,909 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:16:15,917 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:15,923 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:15,929 - sqlalchemy.engine.Engine - INFO - [cached since 767s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:15,934 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:15,941 - sqlalchemy.engine.Engine - INFO - [cached since 765.6s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:16:15,943 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 22:16:15,944 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:16:15,959 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:15,960 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:15,963 - sqlalchemy.engine.Engine - INFO - [cached since 767s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:15,966 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:16:15,971 - sqlalchemy.engine.Engine - INFO - [cached since 766.2s ago] {}
2025-12-28 22:16:15,974 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:16:15,977 - sqlalchemy.engine.Engine - INFO - [cached since 766.2s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 36, 15, 974043)}
2025-12-28 22:16:15,980 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:16:15,988 - sqlalchemy.engine.Engine - INFO - [cached since 766.2s ago] {}
2025-12-28 22:16:15,991 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:16:15,995 - sqlalchemy.engine.Engine - INFO - [cached since 766.1s ago] {}
2025-12-28 22:16:15,997 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:16:16,007 - sqlalchemy.engine.Engine - INFO - [cached since 766s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:16:16,095 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:16:16,144 - sqlalchemy.engine.Engine - INFO - [cached since 766.1s ago] {}
2025-12-28 22:16:16,326 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:16:16,346 - sqlalchemy.engine.Engine - INFO - [cached since 766.3s ago] {}
2025-12-28 22:16:16,358 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:16:16,409 - sqlalchemy.engine.Engine - INFO - [cached since 766.3s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:16:16,432 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:16:16,443 - sqlalchemy.engine.Engine - INFO - [cached since 766.3s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:16:16,449 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:16:16,455 - sqlalchemy.engine.Engine - INFO - [cached since 766.2s ago] {}
2025-12-28 22:16:16,461 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:16:16,482 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:16,489 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:16,494 - sqlalchemy.engine.Engine - INFO - [cached since 767.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:16,499 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:16:16,508 - sqlalchemy.engine.Engine - INFO - [cached since 765.2s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 16, 46, 16, 498077), 'param_1': 100}
2025-12-28 22:16:16,513 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:16:26,189 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:26,191 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:26,193 - sqlalchemy.engine.Engine - INFO - [cached since 777.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:26,196 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-28 22:16:26,202 - sqlalchemy.engine.Engine - INFO - [cached since 777.3s ago] {'started_at': datetime.datetime(2025, 12, 28, 16, 46, 26, 196214), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'arp', 'network_range': '192.168.1.0/24', 'status': 'running', 'error_message': None}
2025-12-28 22:16:26,207 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:16:26,211 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:26,218 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-28 22:16:26,222 - sqlalchemy.engine.Engine - INFO - [cached since 777.3s ago] {'pk_1': 22}
2025-12-28 22:16:26,225 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-28 22:16:26,228 - sqlalchemy.engine.Engine - INFO - [cached since 777.3s ago] {'pk_1': 1}
2025-12-28 22:16:26,235 - app.routers.scans - INFO - Scan started by admin: 22
2025-12-28 22:16:26,239 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:26,248 - sqlalchemy.engine.Engine - INFO - [cached since 777.3s ago] {'id_1': 22, 'param_1': 1}
2025-12-28 22:16:26,253 - app.services.scanner - WARNING - Scapy not available, falling back to ARP table
2025-12-28 22:16:26,278 - app.services.scanner - ERROR - Failed to read ARP table: Command 'arp -a' returned non-zero exit status 1.
2025-12-28 22:16:26,284 - sqlalchemy.engine.Engine - INFO - UPDATE scan_sessions SET completed_at=%(completed_at)s, status=%(status)s WHERE scan_sessions.id = %(scan_sessions_id)s
2025-12-28 22:16:26,285 - sqlalchemy.engine.Engine - INFO - [cached since 777.1s ago] {'completed_at': datetime.datetime(2025, 12, 28, 16, 46, 26, 283195), 'status': 'completed', 'scan_sessions_id': 22}
2025-12-28 22:16:26,288 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:16:26,295 - app.routers.scans - INFO - Scan completed: 0 devices, 0 new
2025-12-28 22:16:26,307 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:26,309 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:26,318 - sqlalchemy.engine.Engine - INFO - [cached since 777.4s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:26,322 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:16:26,328 - sqlalchemy.engine.Engine - INFO - [cached since 776.6s ago] {}
2025-12-28 22:16:26,342 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:16:26,366 - sqlalchemy.engine.Engine - INFO - [cached since 776.6s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 36, 26, 340695)}
2025-12-28 22:16:26,373 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:16:26,378 - sqlalchemy.engine.Engine - INFO - [cached since 776.6s ago] {}
2025-12-28 22:16:26,385 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:16:26,389 - sqlalchemy.engine.Engine - INFO - [cached since 776.5s ago] {}
2025-12-28 22:16:26,392 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:16:26,403 - sqlalchemy.engine.Engine - INFO - [cached since 776.4s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:16:26,406 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:16:26,410 - sqlalchemy.engine.Engine - INFO - [cached since 776.3s ago] {}
2025-12-28 22:16:26,414 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:16:26,422 - sqlalchemy.engine.Engine - INFO - [cached since 776.3s ago] {}
2025-12-28 22:16:26,425 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:16:26,435 - sqlalchemy.engine.Engine - INFO - [cached since 776.3s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:16:26,439 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:16:26,444 - sqlalchemy.engine.Engine - INFO - [cached since 776.3s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:16:26,453 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:16:26,455 - sqlalchemy.engine.Engine - INFO - [cached since 776.2s ago] {}
2025-12-28 22:16:26,458 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:16:26,471 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:26,473 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:26,477 - sqlalchemy.engine.Engine - INFO - [cached since 777.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:26,481 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:26,487 - sqlalchemy.engine.Engine - INFO - [cached since 776.1s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:16:26,490 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 22:16:26,490 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:16:26,504 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:26,505 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:26,509 - sqlalchemy.engine.Engine - INFO - [cached since 777.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:26,511 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:16:26,521 - sqlalchemy.engine.Engine - INFO - [cached since 776.8s ago] {}
2025-12-28 22:16:26,524 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:16:26,531 - sqlalchemy.engine.Engine - INFO - [cached since 776.8s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 36, 26, 523718)}
2025-12-28 22:16:26,538 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:16:26,543 - sqlalchemy.engine.Engine - INFO - [cached since 776.7s ago] {}
2025-12-28 22:16:26,548 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:16:26,554 - sqlalchemy.engine.Engine - INFO - [cached since 776.6s ago] {}
2025-12-28 22:16:26,557 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:16:26,561 - sqlalchemy.engine.Engine - INFO - [cached since 776.6s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:16:26,569 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:16:26,574 - sqlalchemy.engine.Engine - INFO - [cached since 776.5s ago] {}
2025-12-28 22:16:26,577 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:16:26,587 - sqlalchemy.engine.Engine - INFO - [cached since 776.5s ago] {}
2025-12-28 22:16:26,589 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:16:26,596 - sqlalchemy.engine.Engine - INFO - [cached since 776.5s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:16:26,605 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:16:26,611 - sqlalchemy.engine.Engine - INFO - [cached since 776.4s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:16:26,622 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:16:26,625 - sqlalchemy.engine.Engine - INFO - [cached since 776.3s ago] {}
2025-12-28 22:16:26,631 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:16:26,659 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:26,662 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:26,676 - sqlalchemy.engine.Engine - INFO - [cached since 777.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:26,682 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:16:26,691 - sqlalchemy.engine.Engine - INFO - [cached since 775.4s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 16, 46, 26, 679037), 'param_1': 100}
2025-12-28 22:16:26,698 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:16:32,634 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:32,636 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:32,638 - sqlalchemy.engine.Engine - INFO - [cached since 783.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:32,640 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-28 22:16:32,643 - sqlalchemy.engine.Engine - INFO - [cached since 783.7s ago] {'started_at': datetime.datetime(2025, 12, 28, 16, 46, 32, 640824), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'arp', 'network_range': '192.168.1.0/24', 'status': 'running', 'error_message': None}
2025-12-28 22:16:32,654 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:16:32,657 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:32,659 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-28 22:16:32,665 - sqlalchemy.engine.Engine - INFO - [cached since 783.7s ago] {'pk_1': 23}
2025-12-28 22:16:32,668 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-28 22:16:32,670 - sqlalchemy.engine.Engine - INFO - [cached since 783.8s ago] {'pk_1': 1}
2025-12-28 22:16:32,673 - app.routers.scans - INFO - Scan started by admin: 23
2025-12-28 22:16:32,676 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:32,689 - sqlalchemy.engine.Engine - INFO - [cached since 783.7s ago] {'id_1': 23, 'param_1': 1}
2025-12-28 22:16:32,692 - app.services.scanner - WARNING - Scapy not available, falling back to ARP table
2025-12-28 22:16:32,720 - app.services.scanner - ERROR - Failed to read ARP table: Command 'arp -a' returned non-zero exit status 1.
2025-12-28 22:16:32,721 - sqlalchemy.engine.Engine - INFO - UPDATE scan_sessions SET completed_at=%(completed_at)s, status=%(status)s WHERE scan_sessions.id = %(scan_sessions_id)s
2025-12-28 22:16:32,723 - sqlalchemy.engine.Engine - INFO - [cached since 783.6s ago] {'completed_at': datetime.datetime(2025, 12, 28, 16, 46, 32, 721353), 'status': 'completed', 'scan_sessions_id': 23}
2025-12-28 22:16:32,726 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:16:32,731 - app.routers.scans - INFO - Scan completed: 0 devices, 0 new
2025-12-28 22:16:32,739 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:32,740 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:32,743 - sqlalchemy.engine.Engine - INFO - [cached since 783.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:32,749 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:16:32,756 - sqlalchemy.engine.Engine - INFO - [cached since 783s ago] {}
2025-12-28 22:16:32,763 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:16:32,772 - sqlalchemy.engine.Engine - INFO - [cached since 783s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 36, 32, 760559)}
2025-12-28 22:16:32,776 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:16:32,785 - sqlalchemy.engine.Engine - INFO - [cached since 783s ago] {}
2025-12-28 22:16:32,788 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:16:32,792 - sqlalchemy.engine.Engine - INFO - [cached since 782.9s ago] {}
2025-12-28 22:16:32,797 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:16:32,802 - sqlalchemy.engine.Engine - INFO - [cached since 782.8s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:16:32,805 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:16:32,808 - sqlalchemy.engine.Engine - INFO - [cached since 782.7s ago] {}
2025-12-28 22:16:32,812 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:16:32,817 - sqlalchemy.engine.Engine - INFO - [cached since 782.7s ago] {}
2025-12-28 22:16:32,819 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:16:32,825 - sqlalchemy.engine.Engine - INFO - [cached since 782.7s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:16:32,829 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:16:32,836 - sqlalchemy.engine.Engine - INFO - [cached since 782.6s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:16:32,840 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:16:32,842 - sqlalchemy.engine.Engine - INFO - [cached since 782.6s ago] {}
2025-12-28 22:16:32,848 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:16:32,856 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:32,858 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:32,867 - sqlalchemy.engine.Engine - INFO - [cached since 783.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:32,872 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:32,885 - sqlalchemy.engine.Engine - INFO - [cached since 782.5s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:16:32,889 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 22:16:32,890 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:16:32,905 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:32,907 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:32,914 - sqlalchemy.engine.Engine - INFO - [cached since 784s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:32,918 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:16:32,921 - sqlalchemy.engine.Engine - INFO - [cached since 783.2s ago] {}
2025-12-28 22:16:32,924 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:16:32,927 - sqlalchemy.engine.Engine - INFO - [cached since 783.2s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 36, 32, 923405)}
2025-12-28 22:16:32,934 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:16:32,938 - sqlalchemy.engine.Engine - INFO - [cached since 783.1s ago] {}
2025-12-28 22:16:32,940 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:16:32,947 - sqlalchemy.engine.Engine - INFO - [cached since 783s ago] {}
2025-12-28 22:16:32,952 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:16:32,957 - sqlalchemy.engine.Engine - INFO - [cached since 783s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:16:32,959 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:16:32,967 - sqlalchemy.engine.Engine - INFO - [cached since 782.9s ago] {}
2025-12-28 22:16:32,970 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:16:32,974 - sqlalchemy.engine.Engine - INFO - [cached since 782.9s ago] {}
2025-12-28 22:16:32,976 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:16:32,985 - sqlalchemy.engine.Engine - INFO - [cached since 782.9s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:16:32,988 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:16:32,993 - sqlalchemy.engine.Engine - INFO - [cached since 782.8s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:16:32,999 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:16:33,000 - sqlalchemy.engine.Engine - INFO - [cached since 782.7s ago] {}
2025-12-28 22:16:33,004 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:16:33,021 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:33,023 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:33,025 - sqlalchemy.engine.Engine - INFO - [cached since 784.1s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:33,029 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:16:33,039 - sqlalchemy.engine.Engine - INFO - [cached since 781.7s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 16, 46, 33, 27411), 'param_1': 100}
2025-12-28 22:16:33,048 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:16:35,138 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:35,166 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:35,172 - sqlalchemy.engine.Engine - INFO - [cached since 786.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:35,176 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-28 22:16:35,184 - sqlalchemy.engine.Engine - INFO - [cached since 786.2s ago] {'started_at': datetime.datetime(2025, 12, 28, 16, 46, 35, 176653), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'arp', 'network_range': '192.168.1.0/24', 'status': 'running', 'error_message': None}
2025-12-28 22:16:35,195 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:16:35,203 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:35,207 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-28 22:16:35,220 - sqlalchemy.engine.Engine - INFO - [cached since 786.2s ago] {'pk_1': 24}
2025-12-28 22:16:35,229 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-28 22:16:35,240 - sqlalchemy.engine.Engine - INFO - [cached since 786.4s ago] {'pk_1': 1}
2025-12-28 22:16:35,248 - app.routers.scans - INFO - Scan started by admin: 24
2025-12-28 22:16:35,252 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:35,269 - sqlalchemy.engine.Engine - INFO - [cached since 786.3s ago] {'id_1': 24, 'param_1': 1}
2025-12-28 22:16:35,273 - app.services.scanner - WARNING - Scapy not available, falling back to ARP table
2025-12-28 22:16:35,312 - app.services.scanner - ERROR - Failed to read ARP table: Command 'arp -a' returned non-zero exit status 1.
2025-12-28 22:16:35,315 - sqlalchemy.engine.Engine - INFO - UPDATE scan_sessions SET completed_at=%(completed_at)s, status=%(status)s WHERE scan_sessions.id = %(scan_sessions_id)s
2025-12-28 22:16:35,318 - sqlalchemy.engine.Engine - INFO - [cached since 786.2s ago] {'completed_at': datetime.datetime(2025, 12, 28, 16, 46, 35, 314648), 'status': 'completed', 'scan_sessions_id': 24}
2025-12-28 22:16:35,324 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:16:35,329 - app.routers.scans - INFO - Scan completed: 0 devices, 0 new
2025-12-28 22:16:35,338 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:35,343 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:35,357 - sqlalchemy.engine.Engine - INFO - [cached since 786.4s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:35,362 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:16:35,369 - sqlalchemy.engine.Engine - INFO - [cached since 785.6s ago] {}
2025-12-28 22:16:35,373 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:16:35,386 - sqlalchemy.engine.Engine - INFO - [cached since 785.6s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 36, 35, 372657)}
2025-12-28 22:16:35,390 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:16:35,403 - sqlalchemy.engine.Engine - INFO - [cached since 785.6s ago] {}
2025-12-28 22:16:35,406 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:16:35,506 - sqlalchemy.engine.Engine - INFO - [cached since 785.6s ago] {}
2025-12-28 22:16:35,615 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:16:36,024 - sqlalchemy.engine.Engine - INFO - [cached since 786s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:16:36,322 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:16:36,336 - sqlalchemy.engine.Engine - INFO - [cached since 786.3s ago] {}
2025-12-28 22:16:36,341 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:16:36,350 - sqlalchemy.engine.Engine - INFO - [cached since 786.3s ago] {}
2025-12-28 22:16:36,354 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:16:36,363 - sqlalchemy.engine.Engine - INFO - [cached since 786.3s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:16:36,368 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:16:36,375 - sqlalchemy.engine.Engine - INFO - [cached since 786.2s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:16:36,382 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:16:36,385 - sqlalchemy.engine.Engine - INFO - [cached since 786.1s ago] {}
2025-12-28 22:16:36,391 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:16:36,441 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:36,447 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:36,483 - sqlalchemy.engine.Engine - INFO - [cached since 787.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:36,489 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:36,653 - sqlalchemy.engine.Engine - INFO - [cached since 786.3s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:16:36,660 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 22:16:36,663 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:16:36,682 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:36,685 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:36,689 - sqlalchemy.engine.Engine - INFO - [cached since 787.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:36,694 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:16:36,704 - sqlalchemy.engine.Engine - INFO - [cached since 787s ago] {}
2025-12-28 22:16:36,707 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:16:36,719 - sqlalchemy.engine.Engine - INFO - [cached since 786.9s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 36, 36, 706374)}
2025-12-28 22:16:36,724 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:16:36,733 - sqlalchemy.engine.Engine - INFO - [cached since 786.9s ago] {}
2025-12-28 22:16:36,736 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:16:36,740 - sqlalchemy.engine.Engine - INFO - [cached since 786.8s ago] {}
2025-12-28 22:16:36,743 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:16:36,755 - sqlalchemy.engine.Engine - INFO - [cached since 786.8s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:16:36,758 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:16:36,767 - sqlalchemy.engine.Engine - INFO - [cached since 786.7s ago] {}
2025-12-28 22:16:36,770 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:16:36,774 - sqlalchemy.engine.Engine - INFO - [cached since 786.7s ago] {}
2025-12-28 22:16:36,780 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:16:36,785 - sqlalchemy.engine.Engine - INFO - [cached since 786.7s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:16:36,789 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:16:36,793 - sqlalchemy.engine.Engine - INFO - [cached since 786.6s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:16:36,801 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:16:36,803 - sqlalchemy.engine.Engine - INFO - [cached since 786.5s ago] {}
2025-12-28 22:16:36,807 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:16:36,827 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:16:36,833 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:16:36,839 - sqlalchemy.engine.Engine - INFO - [cached since 787.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:16:36,842 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:16:36,858 - sqlalchemy.engine.Engine - INFO - [cached since 785.6s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 16, 46, 36, 841950), 'param_1': 100}
2025-12-28 22:16:36,868 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:20:56,818 - app.services.notification - INFO - WebSocket client unregistered. Total: 0
2025-12-28 22:20:56,820 - app.main - INFO - WebSocket client disconnected
2025-12-28 22:20:56,973 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-28 22:21:02,840 - app.services.notification - INFO - WebSocket client registered. Total: 1
2025-12-28 22:21:02,841 - app.main - INFO - WebSocket client connected
2025-12-28 22:21:26,456 - app.main - INFO - Starting WiFi Tracker System...
2025-12-28 22:21:26,467 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-28 22:21:26,468 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:21:26,471 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-28 22:21:26,473 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:21:26,475 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-28 22:21:26,477 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:21:26,480 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:21:26,482 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-28 22:21:26,484 - sqlalchemy.engine.Engine - INFO - [generated in 0.00434s] {}
2025-12-28 22:21:26,487 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:21:26,488 - app.main - INFO - Database connection successful
2025-12-28 22:21:26,491 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:21:26,494 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-28 22:21:26,496 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:21:26,535 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-28 22:21:26,537 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:21:26,546 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-28 22:21:26,549 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:21:26,558 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-28 22:21:26,561 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:21:26,571 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-28 22:21:26,573 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:21:26,600 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-28 22:21:26,603 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:21:26,617 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-28 22:21:26,622 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:21:26,633 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-28 22:21:26,637 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:21:26,652 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:21:26,654 - app.database - INFO - Database tables initialized successfully
2025-12-28 22:22:19,725 - app.services.notification - INFO - WebSocket client unregistered. Total: 0
2025-12-28 22:22:19,726 - app.main - INFO - WebSocket client disconnected
2025-12-28 22:22:19,833 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-28 22:22:19,858 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-28 22:22:41,942 - app.main - INFO - Starting WiFi Tracker System...
2025-12-28 22:22:41,954 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-28 22:22:41,960 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:22:41,963 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-28 22:22:41,965 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:22:41,967 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-28 22:22:41,968 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:22:41,971 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:22:41,973 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-28 22:22:41,979 - sqlalchemy.engine.Engine - INFO - [generated in 0.00742s] {}
2025-12-28 22:22:41,985 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:22:41,987 - app.main - INFO - Database connection successful
2025-12-28 22:22:41,989 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:22:41,995 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-28 22:22:41,997 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:22:42,033 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-28 22:22:42,035 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:22:42,063 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-28 22:22:42,065 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:22:42,079 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-28 22:22:42,081 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:22:42,090 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-28 22:22:42,092 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:22:42,104 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-28 22:22:42,106 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:22:42,118 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-28 22:22:42,121 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:22:42,134 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-28 22:22:42,137 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:22:42,151 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:22:42,153 - app.database - INFO - Database tables initialized successfully
2025-12-28 22:22:42,279 - app.main - INFO - Starting WiFi Tracker System...
2025-12-28 22:22:42,286 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-28 22:22:42,288 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:22:42,291 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-28 22:22:42,293 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:22:42,294 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-28 22:22:42,296 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:22:42,300 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:22:42,301 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-28 22:22:42,302 - sqlalchemy.engine.Engine - INFO - [generated in 0.00231s] {}
2025-12-28 22:22:42,304 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:22:42,305 - app.main - INFO - Database connection successful
2025-12-28 22:22:42,306 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:22:42,308 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-28 22:22:42,310 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:22:42,319 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-28 22:22:42,321 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:22:42,330 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-28 22:22:42,333 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:22:42,343 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-28 22:22:42,348 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:22:42,360 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-28 22:22:42,366 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:22:42,375 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-28 22:22:42,380 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:22:42,391 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-28 22:22:42,395 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:22:42,405 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-28 22:22:42,408 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:22:42,420 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:22:42,423 - app.database - INFO - Database tables initialized successfully
2025-12-28 22:23:03,500 - app.main - INFO - Starting WiFi Tracker System...
2025-12-28 22:23:03,516 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-28 22:23:03,517 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:03,524 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-28 22:23:03,525 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:03,530 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-28 22:23:03,533 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:03,540 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:23:03,541 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-28 22:23:03,545 - sqlalchemy.engine.Engine - INFO - [generated in 0.00515s] {}
2025-12-28 22:23:03,550 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:23:03,553 - app.main - INFO - Database connection successful
2025-12-28 22:23:03,554 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:23:03,556 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-28 22:23:03,557 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:03,598 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-28 22:23:03,605 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:03,632 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-28 22:23:03,636 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:03,648 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-28 22:23:03,650 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:03,663 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-28 22:23:03,664 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:03,679 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-28 22:23:03,680 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:03,697 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-28 22:23:03,699 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:03,721 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-28 22:23:03,724 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:03,742 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:23:03,744 - app.database - INFO - Database tables initialized successfully
2025-12-28 22:23:03,755 - app.services.notification - INFO - WebSocket client registered. Total: 1
2025-12-28 22:23:03,755 - app.main - INFO - WebSocket client connected
2025-12-28 22:23:04,221 - app.main - INFO - Starting WiFi Tracker System...
2025-12-28 22:23:04,227 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-28 22:23:04,229 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:04,231 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-28 22:23:04,233 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:04,235 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-28 22:23:04,237 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:04,240 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:23:04,242 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-28 22:23:04,243 - sqlalchemy.engine.Engine - INFO - [generated in 0.00235s] {}
2025-12-28 22:23:04,245 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:23:04,247 - app.main - INFO - Database connection successful
2025-12-28 22:23:04,249 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:23:04,250 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-28 22:23:04,252 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:04,276 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-28 22:23:04,277 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:04,286 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-28 22:23:04,288 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:04,308 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-28 22:23:04,310 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:04,317 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-28 22:23:04,319 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:04,329 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-28 22:23:04,330 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:04,339 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-28 22:23:04,343 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:04,351 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-28 22:23:04,355 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:04,367 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:23:04,370 - app.database - INFO - Database tables initialized successfully
2025-12-28 22:23:29,836 - app.services.notification - INFO - WebSocket client unregistered. Total: 0
2025-12-28 22:23:29,837 - app.main - INFO - WebSocket client disconnected
2025-12-28 22:23:29,950 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-28 22:23:29,950 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-28 22:23:45,166 - app.main - INFO - Starting WiFi Tracker System...
2025-12-28 22:23:45,177 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-28 22:23:45,178 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:45,182 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-28 22:23:45,183 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:45,185 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-28 22:23:45,186 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:45,190 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:23:45,194 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-28 22:23:45,195 - sqlalchemy.engine.Engine - INFO - [generated in 0.00548s] {}
2025-12-28 22:23:45,197 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:23:45,198 - app.main - INFO - Database connection successful
2025-12-28 22:23:45,199 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:23:45,201 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-28 22:23:45,202 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:45,223 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-28 22:23:45,229 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:45,238 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-28 22:23:45,241 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:45,253 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-28 22:23:45,255 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:45,265 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-28 22:23:45,266 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:45,290 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-28 22:23:45,296 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:45,308 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-28 22:23:45,310 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:45,322 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-28 22:23:45,323 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:45,338 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:23:45,347 - app.database - INFO - Database tables initialized successfully
2025-12-28 22:23:45,355 - app.services.notification - INFO - WebSocket client registered. Total: 1
2025-12-28 22:23:45,356 - app.main - INFO - WebSocket client connected
2025-12-28 22:23:45,823 - app.main - INFO - Starting WiFi Tracker System...
2025-12-28 22:23:45,832 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-28 22:23:45,833 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:45,835 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-28 22:23:45,836 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:45,838 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-28 22:23:45,839 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:45,842 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:23:45,843 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-28 22:23:45,845 - sqlalchemy.engine.Engine - INFO - [generated in 0.00270s] {}
2025-12-28 22:23:45,846 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:23:45,848 - app.main - INFO - Database connection successful
2025-12-28 22:23:45,849 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:23:45,850 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-28 22:23:45,851 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:45,859 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-28 22:23:45,861 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:45,869 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-28 22:23:45,870 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:45,878 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-28 22:23:45,879 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:45,886 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-28 22:23:45,889 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:45,899 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-28 22:23:45,961 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:45,967 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-28 22:23:45,969 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:45,976 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-28 22:23:45,977 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:23:45,986 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:23:45,990 - app.database - INFO - Database tables initialized successfully
2025-12-28 22:23:47,472 - app.services.notification - INFO - WebSocket client unregistered. Total: 0
2025-12-28 22:23:47,473 - app.main - INFO - WebSocket client disconnected
2025-12-28 22:23:47,473 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-28 22:23:47,581 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-28 22:24:04,458 - app.main - INFO - Starting WiFi Tracker System...
2025-12-28 22:24:04,467 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-28 22:24:04,468 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:24:04,471 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-28 22:24:04,472 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:24:04,475 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-28 22:24:04,480 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:24:04,485 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:24:04,486 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-28 22:24:04,488 - sqlalchemy.engine.Engine - INFO - [generated in 0.00343s] {}
2025-12-28 22:24:04,491 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:24:04,493 - app.main - INFO - Database connection successful
2025-12-28 22:24:04,494 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:24:04,495 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-28 22:24:04,497 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:24:04,534 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-28 22:24:04,540 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:24:04,551 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-28 22:24:04,552 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:24:04,567 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-28 22:24:04,569 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:24:04,593 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-28 22:24:04,594 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:24:04,607 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-28 22:24:04,609 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:24:04,619 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-28 22:24:04,623 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:24:04,656 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-28 22:24:04,659 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:24:04,676 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:24:04,678 - app.database - INFO - Database tables initialized successfully
2025-12-28 22:24:04,685 - app.services.notification - INFO - WebSocket client registered. Total: 1
2025-12-28 22:24:04,686 - app.main - INFO - WebSocket client connected
2025-12-28 22:24:05,062 - app.main - INFO - Starting WiFi Tracker System...
2025-12-28 22:24:05,069 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-28 22:24:05,070 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:24:05,074 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-28 22:24:05,075 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:24:05,077 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-28 22:24:05,078 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:24:05,080 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:24:05,082 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-28 22:24:05,083 - sqlalchemy.engine.Engine - INFO - [generated in 0.00226s] {}
2025-12-28 22:24:05,085 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:24:05,086 - app.main - INFO - Database connection successful
2025-12-28 22:24:05,087 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:24:05,088 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-28 22:24:05,089 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:24:05,111 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-28 22:24:05,113 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:24:05,119 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-28 22:24:05,121 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:24:05,128 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-28 22:24:05,130 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:24:05,138 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-28 22:24:05,140 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:24:05,161 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-28 22:24:05,163 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:24:05,170 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-28 22:24:05,172 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:24:05,179 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-28 22:24:05,181 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:24:05,191 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:24:05,193 - app.database - INFO - Database tables initialized successfully
2025-12-28 22:25:03,600 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-28 22:26:00,359 - app.main - INFO - Starting WiFi Tracker System...
2025-12-28 22:26:00,375 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-28 22:26:00,379 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:26:00,383 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-28 22:26:00,386 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:26:00,391 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-28 22:26:00,394 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:26:00,398 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:26:00,400 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-28 22:26:00,401 - sqlalchemy.engine.Engine - INFO - [generated in 0.00303s] {}
2025-12-28 22:26:00,403 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:26:00,405 - app.main - INFO - Database connection successful
2025-12-28 22:26:00,407 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:26:00,417 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-28 22:26:00,420 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:26:00,449 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-28 22:26:00,454 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:26:00,468 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-28 22:26:00,476 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:26:00,493 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-28 22:26:00,501 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:26:00,516 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-28 22:26:00,526 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:26:00,537 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-28 22:26:00,548 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:26:00,561 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-28 22:26:00,571 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:26:00,603 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-28 22:26:00,605 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:26:00,622 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:26:00,638 - app.database - INFO - Database tables initialized successfully
2025-12-28 22:27:10,199 - app.services.notification - INFO - WebSocket client unregistered. Total: 0
2025-12-28 22:27:10,273 - app.main - INFO - WebSocket client disconnected
2025-12-28 22:27:11,604 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:27:11,626 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:27:11,632 - sqlalchemy.engine.Engine - INFO - [generated in 0.00742s] {'id_1': 1, 'param_1': 1}
2025-12-28 22:27:11,652 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:27:11,804 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:27:11,839 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:27:11,850 - sqlalchemy.engine.Engine - INFO - [cached since 0.2253s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:27:11,913 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:27:11,948 - sqlalchemy.engine.Engine - INFO - [generated in 0.03526s] {}
2025-12-28 22:27:11,975 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:27:12,058 - sqlalchemy.engine.Engine - INFO - [generated in 0.08271s] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 47, 11, 968007)}
2025-12-28 22:27:12,240 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:27:12,256 - sqlalchemy.engine.Engine - INFO - [generated in 0.01559s] {}
2025-12-28 22:27:12,269 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:27:12,291 - sqlalchemy.engine.Engine - INFO - [generated in 0.02233s] {}
2025-12-28 22:27:12,316 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:27:12,318 - sqlalchemy.engine.Engine - INFO - [generated in 0.00187s] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:27:12,337 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:27:12,339 - sqlalchemy.engine.Engine - INFO - [generated in 0.00172s] {}
2025-12-28 22:27:12,356 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:27:12,365 - sqlalchemy.engine.Engine - INFO - [generated in 0.00885s] {}
2025-12-28 22:27:12,381 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:27:12,384 - sqlalchemy.engine.Engine - INFO - [generated in 0.00347s] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:27:12,391 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:27:12,398 - sqlalchemy.engine.Engine - INFO - [generated in 0.00649s] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:27:12,416 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:27:12,417 - sqlalchemy.engine.Engine - INFO - [generated in 0.00168s] {}
2025-12-28 22:27:12,424 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:27:12,437 - app.services.notification - INFO - WebSocket client registered. Total: 1
2025-12-28 22:27:12,439 - app.main - INFO - WebSocket client connected
2025-12-28 22:27:12,454 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:27:12,459 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:27:12,465 - sqlalchemy.engine.Engine - INFO - [cached since 0.8406s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:27:12,481 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:27:12,484 - sqlalchemy.engine.Engine - INFO - [generated in 0.00347s] {'id_1': 7, 'param_1': 1}
2025-12-28 22:27:12,490 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 22:27:12,497 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:27:12,518 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:27:12,520 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:27:12,529 - sqlalchemy.engine.Engine - INFO - [cached since 0.904s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:27:12,536 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:27:12,539 - sqlalchemy.engine.Engine - INFO - [cached since 0.6264s ago] {}
2025-12-28 22:27:12,552 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:27:12,556 - sqlalchemy.engine.Engine - INFO - [cached since 0.5811s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 47, 12, 550405)}
2025-12-28 22:27:12,566 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:27:12,568 - sqlalchemy.engine.Engine - INFO - [cached since 0.3286s ago] {}
2025-12-28 22:27:12,575 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:27:12,589 - sqlalchemy.engine.Engine - INFO - [cached since 0.3201s ago] {}
2025-12-28 22:27:12,601 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:27:12,603 - sqlalchemy.engine.Engine - INFO - [cached since 0.2867s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:27:12,619 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:27:12,621 - sqlalchemy.engine.Engine - INFO - [cached since 0.2843s ago] {}
2025-12-28 22:27:12,627 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:27:12,631 - sqlalchemy.engine.Engine - INFO - [cached since 0.2747s ago] {}
2025-12-28 22:27:12,638 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:27:12,651 - sqlalchemy.engine.Engine - INFO - [cached since 0.2702s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:27:12,660 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:27:12,665 - sqlalchemy.engine.Engine - INFO - [cached since 0.2736s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:27:12,679 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:27:12,683 - sqlalchemy.engine.Engine - INFO - [cached since 0.2676s ago] {}
2025-12-28 22:27:12,699 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:27:12,831 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:27:12,867 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:27:12,874 - sqlalchemy.engine.Engine - INFO - [cached since 1.249s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:27:12,886 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:27:12,899 - sqlalchemy.engine.Engine - INFO - [generated in 0.01241s] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 16, 57, 12, 883102), 'param_1': 100}
2025-12-28 22:27:12,907 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:27:13,588 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:27:13,590 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:27:13,597 - sqlalchemy.engine.Engine - INFO - [cached since 1.972s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:27:13,613 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-28 22:27:13,616 - sqlalchemy.engine.Engine - INFO - [generated in 0.00292s] {'started_at': datetime.datetime(2025, 12, 28, 16, 57, 13, 613647), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'arp', 'network_range': '192.168.1.0/24', 'status': 'running', 'error_message': None}
2025-12-28 22:27:13,630 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:27:13,640 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:27:13,646 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-28 22:27:13,649 - sqlalchemy.engine.Engine - INFO - [generated in 0.00329s] {'pk_1': 25}
2025-12-28 22:27:13,660 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-28 22:27:13,667 - sqlalchemy.engine.Engine - INFO - [generated in 0.00689s] {'pk_1': 1}
2025-12-28 22:27:13,672 - app.routers.scans - INFO - Scan started by admin: 25
2025-12-28 22:27:13,681 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:27:13,684 - sqlalchemy.engine.Engine - INFO - [generated in 0.00351s] {'id_1': 25, 'param_1': 1}
2025-12-28 22:27:13,690 - app.services.scanner - INFO - Starting ARP scan on 192.168.1.0/24
2025-12-28 22:27:13,694 - app.services.scanner - ERROR - ARP scan failed: Sniffing and sending packets is not available at layer 2: winpcap is not installed. You may use conf.L3socket or conf.L3socket6 to access layer 3
2025-12-28 22:28:33,158 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-28 22:28:33,790 - sqlalchemy.engine.Engine - INFO - [generated in 0.63191s] {'mac_address_1': '54:AF:97:FE:1A:C5', 'param_1': 1}
2025-12-28 22:28:33,797 - sqlalchemy.engine.Engine - INFO - INSERT INTO devices (mac_address, hostname, vendor, device_type, first_seen, last_seen, is_trusted, is_suspicious, notes) VALUES (%(mac_address)s, %(hostname)s, %(vendor)s, %(device_type)s, %(first_seen)s, %(last_seen)s, %(is_trusted)s, %(is_suspicious)s, %(notes)s)
2025-12-28 22:28:33,799 - sqlalchemy.engine.Engine - INFO - [generated in 0.00143s] {'mac_address': '54:AF:97:FE:1A:C5', 'hostname': 'DESKTOP-184U73U', 'vendor': None, 'device_type': 'Computer', 'first_seen': datetime.datetime(2025, 12, 28, 16, 58, 33, 797698), 'last_seen': datetime.datetime(2025, 12, 28, 16, 58, 33, 797706), 'is_trusted': 0, 'is_suspicious': 0, 'notes': None}
2025-12-28 22:28:33,813 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-28 22:28:33,815 - sqlalchemy.engine.Engine - INFO - [cached since 0.6571s ago] {'mac_address_1': '96:A4:CB:4D:96:A9', 'param_1': 1}
2025-12-28 22:28:33,821 - sqlalchemy.engine.Engine - INFO - INSERT INTO devices (mac_address, hostname, vendor, device_type, first_seen, last_seen, is_trusted, is_suspicious, notes) VALUES (%(mac_address)s, %(hostname)s, %(vendor)s, %(device_type)s, %(first_seen)s, %(last_seen)s, %(is_trusted)s, %(is_suspicious)s, %(notes)s)
2025-12-28 22:28:33,827 - sqlalchemy.engine.Engine - INFO - [cached since 0.02933s ago] {'mac_address': '96:A4:CB:4D:96:A9', 'hostname': None, 'vendor': None, 'device_type': 'Unknown', 'first_seen': datetime.datetime(2025, 12, 28, 16, 58, 33, 820914), 'last_seen': datetime.datetime(2025, 12, 28, 16, 58, 33, 820929), 'is_trusted': 0, 'is_suspicious': 0, 'notes': None}
2025-12-28 22:28:33,834 - sqlalchemy.engine.Engine - INFO - INSERT INTO alerts (device_id, alert_type, severity, message, details, is_acknowledged, acknowledged_by, created_at, acknowledged_at) VALUES (%(device_id)s, %(alert_type)s, %(severity)s, %(message)s, %(details)s, %(is_acknowledged)s, %(acknowledged_by)s, %(created_at)s, %(acknowledged_at)s)
2025-12-28 22:28:33,837 - sqlalchemy.engine.Engine - INFO - [generated in 0.00419s] {'device_id': 1, 'alert_type': 'NEW_DEVICE', 'severity': 'MEDIUM', 'message': 'New device detected: 54:AF:97:FE:1A:C5', 'details': '{"mac_address": "54:AF:97:FE:1A:C5", "vendor": null}', 'is_acknowledged': 0, 'acknowledged_by': None, 'created_at': datetime.datetime(2025, 12, 28, 16, 58, 33, 833802), 'acknowledged_at': None}
2025-12-28 22:28:33,865 - sqlalchemy.engine.Engine - INFO - INSERT INTO device_activity (device_id, event_type, old_value, new_value, event_timestamp) VALUES (%(device_id)s, %(event_type)s, %(old_value)s, %(new_value)s, %(event_timestamp)s)
2025-12-28 22:28:33,866 - sqlalchemy.engine.Engine - INFO - [generated in 0.00207s] {'device_id': 1, 'event_type': 'CONNECTED', 'old_value': None, 'new_value': '10.18.154.119', 'event_timestamp': datetime.datetime(2025, 12, 28, 16, 58, 33, 864953)}
2025-12-28 22:28:33,876 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-28 22:28:33,878 - sqlalchemy.engine.Engine - INFO - [generated in 0.00295s] {'device_id': 1, 'ip_address': '10.18.154.119', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 28, 16, 58, 33, 875743), 'is_connected': 1, 'response_time_ms': None}
2025-12-28 22:28:33,884 - app.services.notification - INFO - WebSocket client unregistered. Total: 0
2025-12-28 22:28:33,887 - app.main - INFO - WebSocket client disconnected
2025-12-28 22:28:33,898 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-28 22:28:33,900 - sqlalchemy.engine.Engine - INFO - [cached since 0.7419s ago] {'mac_address_1': 'FF:FF:FF:FF:FF:FF', 'param_1': 1}
2025-12-28 22:28:33,936 - sqlalchemy.engine.Engine - INFO - INSERT INTO devices (mac_address, hostname, vendor, device_type, first_seen, last_seen, is_trusted, is_suspicious, notes) VALUES (%(mac_address)s, %(hostname)s, %(vendor)s, %(device_type)s, %(first_seen)s, %(last_seen)s, %(is_trusted)s, %(is_suspicious)s, %(notes)s)
2025-12-28 22:28:33,938 - sqlalchemy.engine.Engine - INFO - [cached since 0.1404s ago] {'mac_address': 'FF:FF:FF:FF:FF:FF', 'hostname': None, 'vendor': None, 'device_type': 'Unknown', 'first_seen': datetime.datetime(2025, 12, 28, 16, 58, 33, 936319), 'last_seen': datetime.datetime(2025, 12, 28, 16, 58, 33, 936334), 'is_trusted': 0, 'is_suspicious': 0, 'notes': None}
2025-12-28 22:28:33,950 - sqlalchemy.engine.Engine - INFO - INSERT INTO alerts (device_id, alert_type, severity, message, details, is_acknowledged, acknowledged_by, created_at, acknowledged_at) VALUES (%(device_id)s, %(alert_type)s, %(severity)s, %(message)s, %(details)s, %(is_acknowledged)s, %(acknowledged_by)s, %(created_at)s, %(acknowledged_at)s)
2025-12-28 22:28:33,952 - sqlalchemy.engine.Engine - INFO - [cached since 0.1187s ago] {'device_id': 2, 'alert_type': 'NEW_DEVICE', 'severity': 'MEDIUM', 'message': 'New device detected: 96:A4:CB:4D:96:A9', 'details': '{"mac_address": "96:A4:CB:4D:96:A9", "vendor": null}', 'is_acknowledged': 0, 'acknowledged_by': None, 'created_at': datetime.datetime(2025, 12, 28, 16, 58, 33, 950365), 'acknowledged_at': None}
2025-12-28 22:28:33,957 - sqlalchemy.engine.Engine - INFO - INSERT INTO device_activity (device_id, event_type, old_value, new_value, event_timestamp) VALUES (%(device_id)s, %(event_type)s, %(old_value)s, %(new_value)s, %(event_timestamp)s)
2025-12-28 22:28:33,964 - sqlalchemy.engine.Engine - INFO - [cached since 0.09932s ago] {'device_id': 2, 'event_type': 'CONNECTED', 'old_value': None, 'new_value': '10.18.154.151', 'event_timestamp': datetime.datetime(2025, 12, 28, 16, 58, 33, 957157)}
2025-12-28 22:28:33,968 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-28 22:28:33,970 - sqlalchemy.engine.Engine - INFO - [cached since 0.09474s ago] {'device_id': 2, 'ip_address': '10.18.154.151', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 28, 16, 58, 33, 968578), 'is_connected': 1, 'response_time_ms': None}
2025-12-28 22:28:33,982 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-28 22:28:33,985 - sqlalchemy.engine.Engine - INFO - [cached since 0.8274s ago] {'mac_address_1': '01:00:5E:00:00:16', 'param_1': 1}
2025-12-28 22:28:33,992 - sqlalchemy.engine.Engine - INFO - INSERT INTO devices (mac_address, hostname, vendor, device_type, first_seen, last_seen, is_trusted, is_suspicious, notes) VALUES (%(mac_address)s, %(hostname)s, %(vendor)s, %(device_type)s, %(first_seen)s, %(last_seen)s, %(is_trusted)s, %(is_suspicious)s, %(notes)s)
2025-12-28 22:28:33,996 - sqlalchemy.engine.Engine - INFO - [cached since 0.1991s ago] {'mac_address': '01:00:5E:00:00:16', 'hostname': 'igmp.mcast.net', 'vendor': None, 'device_type': 'Unknown', 'first_seen': datetime.datetime(2025, 12, 28, 16, 58, 33, 992407), 'last_seen': datetime.datetime(2025, 12, 28, 16, 58, 33, 992422), 'is_trusted': 0, 'is_suspicious': 0, 'notes': None}
2025-12-28 22:28:34,000 - sqlalchemy.engine.Engine - INFO - INSERT INTO alerts (device_id, alert_type, severity, message, details, is_acknowledged, acknowledged_by, created_at, acknowledged_at) VALUES (%(device_id)s, %(alert_type)s, %(severity)s, %(message)s, %(details)s, %(is_acknowledged)s, %(acknowledged_by)s, %(created_at)s, %(acknowledged_at)s)
2025-12-28 22:28:34,003 - sqlalchemy.engine.Engine - INFO - [cached since 0.1696s ago] {'device_id': 3, 'alert_type': 'NEW_DEVICE', 'severity': 'MEDIUM', 'message': 'New device detected: FF:FF:FF:FF:FF:FF', 'details': '{"mac_address": "FF:FF:FF:FF:FF:FF", "vendor": null}', 'is_acknowledged': 0, 'acknowledged_by': None, 'created_at': datetime.datetime(2025, 12, 28, 16, 58, 34, 787), 'acknowledged_at': None}
2025-12-28 22:28:34,012 - sqlalchemy.engine.Engine - INFO - INSERT INTO device_activity (device_id, event_type, old_value, new_value, event_timestamp) VALUES (%(device_id)s, %(event_type)s, %(old_value)s, %(new_value)s, %(event_timestamp)s)
2025-12-28 22:28:34,013 - sqlalchemy.engine.Engine - INFO - [cached since 0.1491s ago] {'device_id': 3, 'event_type': 'CONNECTED', 'old_value': None, 'new_value': '10.18.154.255', 'event_timestamp': datetime.datetime(2025, 12, 28, 16, 58, 34, 12076)}
2025-12-28 22:28:34,017 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-28 22:28:34,022 - sqlalchemy.engine.Engine - INFO - [cached since 0.1466s ago] {'device_id': 3, 'ip_address': '10.18.154.255', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 28, 16, 58, 34, 17030), 'is_connected': 1, 'response_time_ms': None}
2025-12-28 22:28:34,032 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:28:34,034 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:28:34,041 - sqlalchemy.engine.Engine - INFO - [cached since 82.42s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:28:34,046 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:28:34,048 - sqlalchemy.engine.Engine - INFO - [cached since 82.13s ago] {}
2025-12-28 22:28:34,052 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:28:34,056 - sqlalchemy.engine.Engine - INFO - [cached since 82.08s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 48, 34, 51161)}
2025-12-28 22:28:34,062 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:28:34,064 - sqlalchemy.engine.Engine - INFO - [cached since 81.82s ago] {}
2025-12-28 22:28:34,067 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:28:34,074 - sqlalchemy.engine.Engine - INFO - [cached since 81.81s ago] {}
2025-12-28 22:28:34,079 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:28:34,081 - sqlalchemy.engine.Engine - INFO - [cached since 81.77s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:28:34,091 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:28:34,093 - sqlalchemy.engine.Engine - INFO - [cached since 81.76s ago] {}
2025-12-28 22:28:34,097 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:28:34,101 - sqlalchemy.engine.Engine - INFO - [cached since 81.75s ago] {}
2025-12-28 22:28:34,105 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:28:34,107 - sqlalchemy.engine.Engine - INFO - [cached since 81.73s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:28:34,112 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:28:34,118 - sqlalchemy.engine.Engine - INFO - [cached since 81.73s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:28:34,125 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:28:34,126 - sqlalchemy.engine.Engine - INFO - [cached since 81.71s ago] {}
2025-12-28 22:28:34,132 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:28:34,134 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-28 22:28:34,137 - sqlalchemy.engine.Engine - INFO - [cached since 0.9792s ago] {'mac_address_1': '01:00:5E:00:00:FB', 'param_1': 1}
2025-12-28 22:28:34,146 - sqlalchemy.engine.Engine - INFO - INSERT INTO devices (mac_address, hostname, vendor, device_type, first_seen, last_seen, is_trusted, is_suspicious, notes) VALUES (%(mac_address)s, %(hostname)s, %(vendor)s, %(device_type)s, %(first_seen)s, %(last_seen)s, %(is_trusted)s, %(is_suspicious)s, %(notes)s)
2025-12-28 22:28:34,148 - sqlalchemy.engine.Engine - INFO - [cached since 0.351s ago] {'mac_address': '01:00:5E:00:00:FB', 'hostname': 'mdns.mcast.net', 'vendor': None, 'device_type': 'Unknown', 'first_seen': datetime.datetime(2025, 12, 28, 16, 58, 34, 146304), 'last_seen': datetime.datetime(2025, 12, 28, 16, 58, 34, 146325), 'is_trusted': 0, 'is_suspicious': 0, 'notes': None}
2025-12-28 22:28:34,152 - sqlalchemy.engine.Engine - INFO - INSERT INTO alerts (device_id, alert_type, severity, message, details, is_acknowledged, acknowledged_by, created_at, acknowledged_at) VALUES (%(device_id)s, %(alert_type)s, %(severity)s, %(message)s, %(details)s, %(is_acknowledged)s, %(acknowledged_by)s, %(created_at)s, %(acknowledged_at)s)
2025-12-28 22:28:34,154 - sqlalchemy.engine.Engine - INFO - [cached since 0.3206s ago] {'device_id': 4, 'alert_type': 'NEW_DEVICE', 'severity': 'MEDIUM', 'message': 'New device detected: 01:00:5E:00:00:16', 'details': '{"mac_address": "01:00:5E:00:00:16", "vendor": null}', 'is_acknowledged': 0, 'acknowledged_by': None, 'created_at': datetime.datetime(2025, 12, 28, 16, 58, 34, 152458), 'acknowledged_at': None}
2025-12-28 22:28:34,158 - sqlalchemy.engine.Engine - INFO - INSERT INTO device_activity (device_id, event_type, old_value, new_value, event_timestamp) VALUES (%(device_id)s, %(event_type)s, %(old_value)s, %(new_value)s, %(event_timestamp)s)
2025-12-28 22:28:34,167 - sqlalchemy.engine.Engine - INFO - [cached since 0.3025s ago] {'device_id': 4, 'event_type': 'CONNECTED', 'old_value': None, 'new_value': '224.0.0.22', 'event_timestamp': datetime.datetime(2025, 12, 28, 16, 58, 34, 158608)}
2025-12-28 22:28:34,170 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-28 22:28:34,171 - sqlalchemy.engine.Engine - INFO - [cached since 0.2964s ago] {'device_id': 4, 'ip_address': '224.0.0.22', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 28, 16, 58, 34, 170522), 'is_connected': 1, 'response_time_ms': None}
2025-12-28 22:28:34,180 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-28 22:28:34,182 - sqlalchemy.engine.Engine - INFO - [cached since 1.024s ago] {'mac_address_1': '01:00:5E:00:00:FC', 'param_1': 1}
2025-12-28 22:28:34,187 - sqlalchemy.engine.Engine - INFO - INSERT INTO devices (mac_address, hostname, vendor, device_type, first_seen, last_seen, is_trusted, is_suspicious, notes) VALUES (%(mac_address)s, %(hostname)s, %(vendor)s, %(device_type)s, %(first_seen)s, %(last_seen)s, %(is_trusted)s, %(is_suspicious)s, %(notes)s)
2025-12-28 22:28:34,190 - sqlalchemy.engine.Engine - INFO - [cached since 0.3924s ago] {'mac_address': '01:00:5E:00:00:FC', 'hostname': None, 'vendor': None, 'device_type': 'Unknown', 'first_seen': datetime.datetime(2025, 12, 28, 16, 58, 34, 187801), 'last_seen': datetime.datetime(2025, 12, 28, 16, 58, 34, 187811), 'is_trusted': 0, 'is_suspicious': 0, 'notes': None}
2025-12-28 22:28:34,199 - sqlalchemy.engine.Engine - INFO - INSERT INTO alerts (device_id, alert_type, severity, message, details, is_acknowledged, acknowledged_by, created_at, acknowledged_at) VALUES (%(device_id)s, %(alert_type)s, %(severity)s, %(message)s, %(details)s, %(is_acknowledged)s, %(acknowledged_by)s, %(created_at)s, %(acknowledged_at)s)
2025-12-28 22:28:34,200 - sqlalchemy.engine.Engine - INFO - [cached since 0.367s ago] {'device_id': 5, 'alert_type': 'NEW_DEVICE', 'severity': 'MEDIUM', 'message': 'New device detected: 01:00:5E:00:00:FB', 'details': '{"mac_address": "01:00:5E:00:00:FB", "vendor": null}', 'is_acknowledged': 0, 'acknowledged_by': None, 'created_at': datetime.datetime(2025, 12, 28, 16, 58, 34, 198857), 'acknowledged_at': None}
2025-12-28 22:28:34,203 - sqlalchemy.engine.Engine - INFO - INSERT INTO device_activity (device_id, event_type, old_value, new_value, event_timestamp) VALUES (%(device_id)s, %(event_type)s, %(old_value)s, %(new_value)s, %(event_timestamp)s)
2025-12-28 22:28:34,204 - sqlalchemy.engine.Engine - INFO - [cached since 0.3401s ago] {'device_id': 5, 'event_type': 'CONNECTED', 'old_value': None, 'new_value': '224.0.0.251', 'event_timestamp': datetime.datetime(2025, 12, 28, 16, 58, 34, 203555)}
2025-12-28 22:28:34,213 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-28 22:28:34,215 - sqlalchemy.engine.Engine - INFO - [cached since 0.3397s ago] {'device_id': 5, 'ip_address': '224.0.0.251', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 28, 16, 58, 34, 213814), 'is_connected': 1, 'response_time_ms': None}
2025-12-28 22:28:34,292 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:28:36,203 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:28:36,210 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:28:36,217 - sqlalchemy.engine.Engine - INFO - [generated in 0.00726s] {'id_1': 1, 'param_1': 1}
2025-12-28 22:28:36,235 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:28:36,250 - sqlalchemy.engine.Engine - INFO - [generated in 0.01456s] {}
2025-12-28 22:28:36,259 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:28:36,275 - sqlalchemy.engine.Engine - INFO - [generated in 0.01629s] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 48, 36, 253189)}
2025-12-28 22:28:36,282 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:28:36,288 - sqlalchemy.engine.Engine - INFO - [generated in 0.00584s] {}
2025-12-28 22:28:36,298 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:28:36,311 - sqlalchemy.engine.Engine - INFO - [generated in 0.01295s] {}
2025-12-28 22:28:36,317 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:28:36,327 - sqlalchemy.engine.Engine - INFO - [generated in 0.01075s] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:28:36,337 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:28:36,345 - sqlalchemy.engine.Engine - INFO - [generated in 0.00787s] {}
2025-12-28 22:28:36,352 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:28:36,360 - sqlalchemy.engine.Engine - INFO - [generated in 0.00827s] {}
2025-12-28 22:28:36,369 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:28:36,381 - sqlalchemy.engine.Engine - INFO - [generated in 0.01257s] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:28:36,386 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:28:36,397 - sqlalchemy.engine.Engine - INFO - [generated in 0.01068s] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:28:36,403 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:28:36,405 - sqlalchemy.engine.Engine - INFO - [generated in 0.00197s] {}
2025-12-28 22:28:36,413 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:28:36,446 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:28:36,450 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:28:36,467 - sqlalchemy.engine.Engine - INFO - [cached since 0.2568s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:28:36,476 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:28:36,500 - sqlalchemy.engine.Engine - INFO - [generated in 0.02385s] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 16, 58, 36, 471376), 'param_1': 100}
2025-12-28 22:28:36,523 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:28:39,218 - app.services.notification - INFO - WebSocket client registered. Total: 1
2025-12-28 22:28:39,218 - app.main - INFO - WebSocket client connected
2025-12-28 22:28:42,997 - app.services.notification - INFO - WebSocket client unregistered. Total: 0
2025-12-28 22:28:42,998 - app.main - INFO - WebSocket client disconnected
2025-12-28 22:29:11,767 - app.main - INFO - Starting WiFi Tracker System...
2025-12-28 22:29:11,777 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-28 22:29:11,779 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:29:11,785 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-28 22:29:11,786 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:29:11,788 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-28 22:29:11,789 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:29:11,793 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:29:11,794 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-28 22:29:11,795 - sqlalchemy.engine.Engine - INFO - [generated in 0.00283s] {}
2025-12-28 22:29:11,801 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:29:11,803 - app.main - INFO - Database connection successful
2025-12-28 22:29:11,804 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:29:11,805 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-28 22:29:11,806 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:29:11,840 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-28 22:29:11,843 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:29:11,871 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-28 22:29:11,872 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:29:11,884 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-28 22:29:11,886 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:29:11,895 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-28 22:29:11,896 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:29:11,907 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-28 22:29:11,908 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:29:11,919 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-28 22:29:11,921 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:29:11,929 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-28 22:29:11,930 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-28 22:29:11,944 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:29:11,945 - app.database - INFO - Database tables initialized successfully
2025-12-28 22:30:00,866 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:30:00,877 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:30:01,072 - sqlalchemy.engine.Engine - INFO - [cached since 84.86s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:30:01,236 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:30:01,447 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:30:01,514 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:30:01,570 - sqlalchemy.engine.Engine - INFO - [cached since 85.36s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:30:01,596 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:30:01,716 - app.services.notification - INFO - WebSocket client registered. Total: 1
2025-12-28 22:30:01,728 - app.main - INFO - WebSocket client connected
2025-12-28 22:30:01,731 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:30:01,745 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:30:01,759 - sqlalchemy.engine.Engine - INFO - [cached since 85.55s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:30:01,766 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:30:01,782 - sqlalchemy.engine.Engine - INFO - [cached since 85.55s ago] {}
2025-12-28 22:30:01,838 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:30:01,891 - sqlalchemy.engine.Engine - INFO - [cached since 85.63s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 50, 1, 835382)}
2025-12-28 22:30:01,975 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:30:01,995 - sqlalchemy.engine.Engine - INFO - [cached since 85.71s ago] {}
2025-12-28 22:30:02,000 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:30:02,025 - sqlalchemy.engine.Engine - INFO - [cached since 85.73s ago] {}
2025-12-28 22:30:02,075 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:30:02,085 - sqlalchemy.engine.Engine - INFO - [cached since 85.77s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:30:02,094 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:30:02,111 - sqlalchemy.engine.Engine - INFO - [cached since 85.77s ago] {}
2025-12-28 22:30:02,132 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:30:02,150 - sqlalchemy.engine.Engine - INFO - [cached since 85.8s ago] {}
2025-12-28 22:30:02,159 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:30:02,179 - sqlalchemy.engine.Engine - INFO - [cached since 85.81s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:30:02,194 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:30:02,225 - sqlalchemy.engine.Engine - INFO - [cached since 85.84s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:30:02,237 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:30:02,248 - sqlalchemy.engine.Engine - INFO - [cached since 85.85s ago] {}
2025-12-28 22:30:02,269 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:30:02,316 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:30:02,325 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:30:02,330 - sqlalchemy.engine.Engine - INFO - [cached since 86.12s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:30:02,340 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:30:02,347 - sqlalchemy.engine.Engine - INFO - [generated in 0.00689s] {'id_1': 7, 'param_1': 1}
2025-12-28 22:30:02,366 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 22:30:02,373 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:30:02,393 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:30:02,398 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:30:02,410 - sqlalchemy.engine.Engine - INFO - [cached since 86.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:30:02,416 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:30:02,432 - sqlalchemy.engine.Engine - INFO - [cached since 86.2s ago] {}
2025-12-28 22:30:02,441 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:30:02,450 - sqlalchemy.engine.Engine - INFO - [cached since 86.19s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 50, 2, 439796)}
2025-12-28 22:30:02,461 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:30:02,480 - sqlalchemy.engine.Engine - INFO - [cached since 86.2s ago] {}
2025-12-28 22:30:02,496 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:30:02,515 - sqlalchemy.engine.Engine - INFO - [cached since 86.22s ago] {}
2025-12-28 22:30:02,550 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:30:02,575 - sqlalchemy.engine.Engine - INFO - [cached since 86.26s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:30:02,591 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:30:02,616 - sqlalchemy.engine.Engine - INFO - [cached since 86.28s ago] {}
2025-12-28 22:30:02,625 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:30:02,640 - sqlalchemy.engine.Engine - INFO - [cached since 86.29s ago] {}
2025-12-28 22:30:02,646 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:30:02,714 - sqlalchemy.engine.Engine - INFO - [cached since 86.35s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:30:02,862 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:30:02,996 - sqlalchemy.engine.Engine - INFO - [cached since 86.61s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:30:03,113 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:30:03,127 - sqlalchemy.engine.Engine - INFO - [cached since 86.72s ago] {}
2025-12-28 22:30:03,197 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:30:03,335 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:30:03,393 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:30:03,617 - sqlalchemy.engine.Engine - INFO - [cached since 87.41s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:30:03,765 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:30:04,065 - sqlalchemy.engine.Engine - INFO - [cached since 87.59s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 17, 0, 3, 764085), 'param_1': 100}
2025-12-28 22:30:04,190 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:30:06,142 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:30:06,144 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:30:06,149 - sqlalchemy.engine.Engine - INFO - [cached since 89.94s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:30:06,159 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:30:06,172 - sqlalchemy.engine.Engine - INFO - [cached since 89.94s ago] {}
2025-12-28 22:30:06,177 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:30:06,192 - sqlalchemy.engine.Engine - INFO - [cached since 89.93s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 50, 6, 176460)}
2025-12-28 22:30:06,198 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:30:06,212 - sqlalchemy.engine.Engine - INFO - [cached since 89.93s ago] {}
2025-12-28 22:30:06,219 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:30:06,229 - sqlalchemy.engine.Engine - INFO - [cached since 89.93s ago] {}
2025-12-28 22:30:06,235 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:30:06,244 - sqlalchemy.engine.Engine - INFO - [cached since 89.93s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:30:06,251 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:30:06,266 - sqlalchemy.engine.Engine - INFO - [cached since 89.93s ago] {}
2025-12-28 22:30:06,274 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:30:06,289 - sqlalchemy.engine.Engine - INFO - [cached since 89.94s ago] {}
2025-12-28 22:30:06,294 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:30:06,312 - sqlalchemy.engine.Engine - INFO - [cached since 89.94s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:30:06,320 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:30:06,332 - sqlalchemy.engine.Engine - INFO - [cached since 89.95s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:30:06,343 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:30:06,346 - sqlalchemy.engine.Engine - INFO - [cached since 89.94s ago] {}
2025-12-28 22:30:06,356 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:30:06,419 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:30:06,423 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:30:06,427 - sqlalchemy.engine.Engine - INFO - [cached since 90.22s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:30:06,432 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:30:06,443 - sqlalchemy.engine.Engine - INFO - [cached since 4.104s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:30:06,449 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 22:30:06,453 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:30:06,455 - app.services.notification - INFO - WebSocket client registered. Total: 2
2025-12-28 22:30:06,457 - app.main - INFO - WebSocket client connected
2025-12-28 22:30:09,321 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:30:09,351 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:30:09,376 - sqlalchemy.engine.Engine - INFO - [cached since 93.17s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:30:09,395 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:30:09,404 - sqlalchemy.engine.Engine - INFO - [cached since 93.17s ago] {}
2025-12-28 22:30:09,408 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:30:09,415 - sqlalchemy.engine.Engine - INFO - [cached since 93.16s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 50, 9, 406750)}
2025-12-28 22:30:09,421 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:30:09,428 - sqlalchemy.engine.Engine - INFO - [cached since 93.15s ago] {}
2025-12-28 22:30:09,432 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:30:09,444 - sqlalchemy.engine.Engine - INFO - [cached since 93.15s ago] {}
2025-12-28 22:30:09,451 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:30:09,462 - sqlalchemy.engine.Engine - INFO - [cached since 93.15s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:30:09,468 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:30:09,524 - sqlalchemy.engine.Engine - INFO - [cached since 93.19s ago] {}
2025-12-28 22:30:09,528 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:30:09,540 - sqlalchemy.engine.Engine - INFO - [cached since 93.19s ago] {}
2025-12-28 22:30:09,546 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:30:09,559 - sqlalchemy.engine.Engine - INFO - [cached since 93.19s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:30:09,564 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:30:09,587 - sqlalchemy.engine.Engine - INFO - [cached since 93.2s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:30:09,593 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:30:09,598 - sqlalchemy.engine.Engine - INFO - [cached since 93.2s ago] {}
2025-12-28 22:30:09,609 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:30:10,737 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:30:10,739 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:30:10,744 - sqlalchemy.engine.Engine - INFO - [cached since 94.53s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:30:10,750 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:30:10,759 - sqlalchemy.engine.Engine - INFO - [cached since 94.28s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 17, 0, 10, 749285), 'param_1': 100}
2025-12-28 22:30:10,767 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:30:10,774 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:30:10,780 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.username = %(username_1)s 
 LIMIT %(param_1)s
2025-12-28 22:30:10,805 - sqlalchemy.engine.Engine - INFO - [generated in 0.02506s] {'username_1': 'admin', 'param_1': 1}
2025-12-28 22:30:11,372 - sqlalchemy.engine.Engine - INFO - UPDATE users SET last_login=%(last_login)s WHERE users.id = %(users_id)s
2025-12-28 22:30:11,376 - sqlalchemy.engine.Engine - INFO - [generated in 0.00341s] {'last_login': datetime.datetime(2025, 12, 28, 17, 0, 11, 367714), 'users_id': 1}
2025-12-28 22:30:11,381 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:30:11,395 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:30:11,402 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-28 22:30:11,406 - sqlalchemy.engine.Engine - INFO - [generated in 0.00416s] {'pk_1': 1}
2025-12-28 22:30:11,410 - app.routers.auth - INFO - User logged in: admin
2025-12-28 22:30:11,415 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:30:11,422 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:30:11,424 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:30:11,428 - sqlalchemy.engine.Engine - INFO - [cached since 95.22s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:30:11,435 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:30:11,446 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:30:11,462 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:30:11,489 - sqlalchemy.engine.Engine - INFO - [cached since 95.28s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:30:11,505 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:30:11,525 - sqlalchemy.engine.Engine - INFO - [cached since 95.29s ago] {}
2025-12-28 22:30:11,530 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:30:11,546 - sqlalchemy.engine.Engine - INFO - [cached since 95.29s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 50, 11, 528933)}
2025-12-28 22:30:11,557 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:30:11,566 - sqlalchemy.engine.Engine - INFO - [cached since 95.28s ago] {}
2025-12-28 22:30:11,576 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:30:11,595 - sqlalchemy.engine.Engine - INFO - [cached since 95.3s ago] {}
2025-12-28 22:30:11,604 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:30:11,615 - sqlalchemy.engine.Engine - INFO - [cached since 95.3s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:30:11,627 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:30:11,645 - sqlalchemy.engine.Engine - INFO - [cached since 95.31s ago] {}
2025-12-28 22:30:11,660 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:30:11,678 - sqlalchemy.engine.Engine - INFO - [cached since 95.33s ago] {}
2025-12-28 22:30:11,688 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:30:11,706 - sqlalchemy.engine.Engine - INFO - [cached since 95.34s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:30:11,712 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:30:11,728 - sqlalchemy.engine.Engine - INFO - [cached since 95.34s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:30:11,736 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:30:11,742 - sqlalchemy.engine.Engine - INFO - [cached since 95.34s ago] {}
2025-12-28 22:30:11,751 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:30:11,789 - app.services.notification - INFO - WebSocket client registered. Total: 3
2025-12-28 22:30:11,808 - app.main - INFO - WebSocket client connected
2025-12-28 22:30:11,816 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:30:11,827 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:30:11,841 - sqlalchemy.engine.Engine - INFO - [cached since 95.63s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:30:11,848 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:30:11,857 - sqlalchemy.engine.Engine - INFO - [cached since 9.517s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:30:11,861 - app.database - ERROR - Database session error: 404: Device not found
2025-12-28 22:30:11,863 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:30:11,879 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:30:11,883 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:30:11,893 - sqlalchemy.engine.Engine - INFO - [cached since 95.68s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:30:11,898 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:30:11,911 - sqlalchemy.engine.Engine - INFO - [cached since 95.68s ago] {}
2025-12-28 22:30:11,915 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:30:11,928 - sqlalchemy.engine.Engine - INFO - [cached since 95.67s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 50, 11, 914522)}
2025-12-28 22:30:11,939 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:30:11,948 - sqlalchemy.engine.Engine - INFO - [cached since 95.67s ago] {}
2025-12-28 22:30:11,956 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:30:11,964 - sqlalchemy.engine.Engine - INFO - [cached since 95.67s ago] {}
2025-12-28 22:30:11,976 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:30:11,995 - sqlalchemy.engine.Engine - INFO - [cached since 95.68s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:30:12,002 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:30:12,011 - sqlalchemy.engine.Engine - INFO - [cached since 95.67s ago] {}
2025-12-28 22:30:12,020 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:30:12,029 - sqlalchemy.engine.Engine - INFO - [cached since 95.68s ago] {}
2025-12-28 22:30:12,035 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:30:12,047 - sqlalchemy.engine.Engine - INFO - [cached since 95.68s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:30:12,055 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:30:12,064 - sqlalchemy.engine.Engine - INFO - [cached since 95.68s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:30:12,076 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:30:12,079 - sqlalchemy.engine.Engine - INFO - [cached since 95.68s ago] {}
2025-12-28 22:30:12,088 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:30:12,111 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:30:12,115 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:30:12,130 - sqlalchemy.engine.Engine - INFO - [cached since 95.92s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:30:12,139 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:30:12,148 - sqlalchemy.engine.Engine - INFO - [cached since 95.67s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 17, 0, 12, 138495), 'param_1': 100}
2025-12-28 22:30:12,160 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:30:43,697 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:30:43,699 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:30:43,707 - sqlalchemy.engine.Engine - INFO - [cached since 127.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:30:43,725 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-28 22:30:43,732 - sqlalchemy.engine.Engine - INFO - [generated in 0.00784s] {'started_at': datetime.datetime(2025, 12, 28, 17, 0, 43, 724931), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'arp', 'network_range': '192.168.1.0/24', 'status': 'running', 'error_message': None}
2025-12-28 22:30:43,739 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:30:43,745 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:30:43,748 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-28 22:30:43,754 - sqlalchemy.engine.Engine - INFO - [generated in 0.00581s] {'pk_1': 26}
2025-12-28 22:30:43,759 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-28 22:30:43,766 - sqlalchemy.engine.Engine - INFO - [cached since 32.36s ago] {'pk_1': 1}
2025-12-28 22:30:43,769 - app.routers.scans - INFO - Scan started by admin: 26
2025-12-28 22:30:43,777 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:30:43,787 - sqlalchemy.engine.Engine - INFO - [generated in 0.01077s] {'id_1': 26, 'param_1': 1}
2025-12-28 22:30:43,794 - app.services.scanner - INFO - Starting ARP scan on 192.168.1.0/24
2025-12-28 22:30:43,797 - app.services.scanner - ERROR - ARP scan failed: Sniffing and sending packets is not available at layer 2: winpcap is not installed. You may use conf.L3socket or conf.L3socket6 to access layer 3
2025-12-28 22:31:33,282 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:33,286 - sqlalchemy.engine.Engine - INFO - [generated in 0.00414s] {'mac_address_1': '54:AF:97:FE:1A:C5', 'param_1': 1}
2025-12-28 22:31:33,293 - sqlalchemy.engine.Engine - INFO - INSERT INTO devices (mac_address, hostname, vendor, device_type, first_seen, last_seen, is_trusted, is_suspicious, notes) VALUES (%(mac_address)s, %(hostname)s, %(vendor)s, %(device_type)s, %(first_seen)s, %(last_seen)s, %(is_trusted)s, %(is_suspicious)s, %(notes)s)
2025-12-28 22:31:33,298 - sqlalchemy.engine.Engine - INFO - [generated in 0.00589s] {'mac_address': '54:AF:97:FE:1A:C5', 'hostname': 'DESKTOP-184U73U', 'vendor': None, 'device_type': 'Computer', 'first_seen': datetime.datetime(2025, 12, 28, 17, 1, 33, 293004), 'last_seen': datetime.datetime(2025, 12, 28, 17, 1, 33, 293020), 'is_trusted': 0, 'is_suspicious': 0, 'notes': None}
2025-12-28 22:31:33,312 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:33,334 - sqlalchemy.engine.Engine - INFO - [cached since 0.05212s ago] {'mac_address_1': '96:A4:CB:4D:96:A9', 'param_1': 1}
2025-12-28 22:31:33,349 - sqlalchemy.engine.Engine - INFO - INSERT INTO devices (mac_address, hostname, vendor, device_type, first_seen, last_seen, is_trusted, is_suspicious, notes) VALUES (%(mac_address)s, %(hostname)s, %(vendor)s, %(device_type)s, %(first_seen)s, %(last_seen)s, %(is_trusted)s, %(is_suspicious)s, %(notes)s)
2025-12-28 22:31:33,359 - sqlalchemy.engine.Engine - INFO - [cached since 0.06638s ago] {'mac_address': '96:A4:CB:4D:96:A9', 'hostname': None, 'vendor': None, 'device_type': 'Unknown', 'first_seen': datetime.datetime(2025, 12, 28, 17, 1, 33, 349335), 'last_seen': datetime.datetime(2025, 12, 28, 17, 1, 33, 349351), 'is_trusted': 0, 'is_suspicious': 0, 'notes': None}
2025-12-28 22:31:33,385 - sqlalchemy.engine.Engine - INFO - INSERT INTO alerts (device_id, alert_type, severity, message, details, is_acknowledged, acknowledged_by, created_at, acknowledged_at) VALUES (%(device_id)s, %(alert_type)s, %(severity)s, %(message)s, %(details)s, %(is_acknowledged)s, %(acknowledged_by)s, %(created_at)s, %(acknowledged_at)s)
2025-12-28 22:31:33,397 - sqlalchemy.engine.Engine - INFO - [generated in 0.01225s] {'device_id': 7, 'alert_type': 'NEW_DEVICE', 'severity': 'MEDIUM', 'message': 'New device detected: 54:AF:97:FE:1A:C5', 'details': '{"mac_address": "54:AF:97:FE:1A:C5", "vendor": null}', 'is_acknowledged': 0, 'acknowledged_by': None, 'created_at': datetime.datetime(2025, 12, 28, 17, 1, 33, 384978), 'acknowledged_at': None}
2025-12-28 22:31:33,410 - sqlalchemy.engine.Engine - INFO - INSERT INTO device_activity (device_id, event_type, old_value, new_value, event_timestamp) VALUES (%(device_id)s, %(event_type)s, %(old_value)s, %(new_value)s, %(event_timestamp)s)
2025-12-28 22:31:33,414 - sqlalchemy.engine.Engine - INFO - [generated in 0.00439s] {'device_id': 7, 'event_type': 'CONNECTED', 'old_value': None, 'new_value': '10.18.154.119', 'event_timestamp': datetime.datetime(2025, 12, 28, 17, 1, 33, 410092)}
2025-12-28 22:31:33,422 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-28 22:31:33,431 - sqlalchemy.engine.Engine - INFO - [generated in 0.00932s] {'device_id': 7, 'ip_address': '10.18.154.119', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 28, 17, 1, 33, 422361), 'is_connected': 1, 'response_time_ms': None}
2025-12-28 22:31:33,458 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:33,474 - sqlalchemy.engine.Engine - INFO - [cached since 0.1922s ago] {'mac_address_1': 'FF:FF:FF:FF:FF:FF', 'param_1': 1}
2025-12-28 22:31:33,487 - sqlalchemy.engine.Engine - INFO - INSERT INTO devices (mac_address, hostname, vendor, device_type, first_seen, last_seen, is_trusted, is_suspicious, notes) VALUES (%(mac_address)s, %(hostname)s, %(vendor)s, %(device_type)s, %(first_seen)s, %(last_seen)s, %(is_trusted)s, %(is_suspicious)s, %(notes)s)
2025-12-28 22:31:33,494 - sqlalchemy.engine.Engine - INFO - [cached since 0.2012s ago] {'mac_address': 'FF:FF:FF:FF:FF:FF', 'hostname': None, 'vendor': None, 'device_type': 'Unknown', 'first_seen': datetime.datetime(2025, 12, 28, 17, 1, 33, 487397), 'last_seen': datetime.datetime(2025, 12, 28, 17, 1, 33, 487416), 'is_trusted': 0, 'is_suspicious': 0, 'notes': None}
2025-12-28 22:31:33,505 - sqlalchemy.engine.Engine - INFO - INSERT INTO alerts (device_id, alert_type, severity, message, details, is_acknowledged, acknowledged_by, created_at, acknowledged_at) VALUES (%(device_id)s, %(alert_type)s, %(severity)s, %(message)s, %(details)s, %(is_acknowledged)s, %(acknowledged_by)s, %(created_at)s, %(acknowledged_at)s)
2025-12-28 22:31:33,509 - sqlalchemy.engine.Engine - INFO - [cached since 0.1241s ago] {'device_id': 8, 'alert_type': 'NEW_DEVICE', 'severity': 'MEDIUM', 'message': 'New device detected: 96:A4:CB:4D:96:A9', 'details': '{"mac_address": "96:A4:CB:4D:96:A9", "vendor": null}', 'is_acknowledged': 0, 'acknowledged_by': None, 'created_at': datetime.datetime(2025, 12, 28, 17, 1, 33, 504940), 'acknowledged_at': None}
2025-12-28 22:31:33,517 - sqlalchemy.engine.Engine - INFO - INSERT INTO device_activity (device_id, event_type, old_value, new_value, event_timestamp) VALUES (%(device_id)s, %(event_type)s, %(old_value)s, %(new_value)s, %(event_timestamp)s)
2025-12-28 22:31:33,522 - sqlalchemy.engine.Engine - INFO - [cached since 0.112s ago] {'device_id': 8, 'event_type': 'CONNECTED', 'old_value': None, 'new_value': '10.18.154.151', 'event_timestamp': datetime.datetime(2025, 12, 28, 17, 1, 33, 517052)}
2025-12-28 22:31:33,527 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-28 22:31:33,535 - sqlalchemy.engine.Engine - INFO - [cached since 0.1135s ago] {'device_id': 8, 'ip_address': '10.18.154.151', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 28, 17, 1, 33, 527297), 'is_connected': 1, 'response_time_ms': None}
2025-12-28 22:31:33,544 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:33,561 - sqlalchemy.engine.Engine - INFO - [cached since 0.2784s ago] {'mac_address_1': '01:00:5E:00:00:16', 'param_1': 1}
2025-12-28 22:31:33,572 - sqlalchemy.engine.Engine - INFO - INSERT INTO devices (mac_address, hostname, vendor, device_type, first_seen, last_seen, is_trusted, is_suspicious, notes) VALUES (%(mac_address)s, %(hostname)s, %(vendor)s, %(device_type)s, %(first_seen)s, %(last_seen)s, %(is_trusted)s, %(is_suspicious)s, %(notes)s)
2025-12-28 22:31:33,577 - sqlalchemy.engine.Engine - INFO - [cached since 0.2849s ago] {'mac_address': '01:00:5E:00:00:16', 'hostname': 'igmp.mcast.net', 'vendor': None, 'device_type': 'Unknown', 'first_seen': datetime.datetime(2025, 12, 28, 17, 1, 33, 571914), 'last_seen': datetime.datetime(2025, 12, 28, 17, 1, 33, 571929), 'is_trusted': 0, 'is_suspicious': 0, 'notes': None}
2025-12-28 22:31:33,587 - sqlalchemy.engine.Engine - INFO - INSERT INTO alerts (device_id, alert_type, severity, message, details, is_acknowledged, acknowledged_by, created_at, acknowledged_at) VALUES (%(device_id)s, %(alert_type)s, %(severity)s, %(message)s, %(details)s, %(is_acknowledged)s, %(acknowledged_by)s, %(created_at)s, %(acknowledged_at)s)
2025-12-28 22:31:33,593 - sqlalchemy.engine.Engine - INFO - [cached since 0.2086s ago] {'device_id': 9, 'alert_type': 'NEW_DEVICE', 'severity': 'MEDIUM', 'message': 'New device detected: FF:FF:FF:FF:FF:FF', 'details': '{"mac_address": "FF:FF:FF:FF:FF:FF", "vendor": null}', 'is_acknowledged': 0, 'acknowledged_by': None, 'created_at': datetime.datetime(2025, 12, 28, 17, 1, 33, 587728), 'acknowledged_at': None}
2025-12-28 22:31:33,604 - sqlalchemy.engine.Engine - INFO - INSERT INTO device_activity (device_id, event_type, old_value, new_value, event_timestamp) VALUES (%(device_id)s, %(event_type)s, %(old_value)s, %(new_value)s, %(event_timestamp)s)
2025-12-28 22:31:33,608 - sqlalchemy.engine.Engine - INFO - [cached since 0.1989s ago] {'device_id': 9, 'event_type': 'CONNECTED', 'old_value': None, 'new_value': '10.18.154.255', 'event_timestamp': datetime.datetime(2025, 12, 28, 17, 1, 33, 604738)}
2025-12-28 22:31:33,618 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-28 22:31:33,623 - sqlalchemy.engine.Engine - INFO - [cached since 0.2016s ago] {'device_id': 9, 'ip_address': '10.18.154.255', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 28, 17, 1, 33, 618427), 'is_connected': 1, 'response_time_ms': None}
2025-12-28 22:31:33,634 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:33,644 - sqlalchemy.engine.Engine - INFO - [cached since 0.3614s ago] {'mac_address_1': '01:00:5E:00:00:FB', 'param_1': 1}
2025-12-28 22:31:33,653 - sqlalchemy.engine.Engine - INFO - INSERT INTO devices (mac_address, hostname, vendor, device_type, first_seen, last_seen, is_trusted, is_suspicious, notes) VALUES (%(mac_address)s, %(hostname)s, %(vendor)s, %(device_type)s, %(first_seen)s, %(last_seen)s, %(is_trusted)s, %(is_suspicious)s, %(notes)s)
2025-12-28 22:31:33,662 - sqlalchemy.engine.Engine - INFO - [cached since 0.3695s ago] {'mac_address': '01:00:5E:00:00:FB', 'hostname': 'mdns.mcast.net', 'vendor': None, 'device_type': 'Unknown', 'first_seen': datetime.datetime(2025, 12, 28, 17, 1, 33, 653825), 'last_seen': datetime.datetime(2025, 12, 28, 17, 1, 33, 653841), 'is_trusted': 0, 'is_suspicious': 0, 'notes': None}
2025-12-28 22:31:33,690 - sqlalchemy.engine.Engine - INFO - INSERT INTO alerts (device_id, alert_type, severity, message, details, is_acknowledged, acknowledged_by, created_at, acknowledged_at) VALUES (%(device_id)s, %(alert_type)s, %(severity)s, %(message)s, %(details)s, %(is_acknowledged)s, %(acknowledged_by)s, %(created_at)s, %(acknowledged_at)s)
2025-12-28 22:31:33,696 - sqlalchemy.engine.Engine - INFO - [cached since 0.3112s ago] {'device_id': 10, 'alert_type': 'NEW_DEVICE', 'severity': 'MEDIUM', 'message': 'New device detected: 01:00:5E:00:00:16', 'details': '{"mac_address": "01:00:5E:00:00:16", "vendor": null}', 'is_acknowledged': 0, 'acknowledged_by': None, 'created_at': datetime.datetime(2025, 12, 28, 17, 1, 33, 690052), 'acknowledged_at': None}
2025-12-28 22:31:33,707 - sqlalchemy.engine.Engine - INFO - INSERT INTO device_activity (device_id, event_type, old_value, new_value, event_timestamp) VALUES (%(device_id)s, %(event_type)s, %(old_value)s, %(new_value)s, %(event_timestamp)s)
2025-12-28 22:31:33,712 - sqlalchemy.engine.Engine - INFO - [cached since 0.3028s ago] {'device_id': 10, 'event_type': 'CONNECTED', 'old_value': None, 'new_value': '224.0.0.22', 'event_timestamp': datetime.datetime(2025, 12, 28, 17, 1, 33, 707847)}
2025-12-28 22:31:33,724 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-28 22:31:33,739 - sqlalchemy.engine.Engine - INFO - [cached since 0.3167s ago] {'device_id': 10, 'ip_address': '224.0.0.22', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 28, 17, 1, 33, 724088), 'is_connected': 1, 'response_time_ms': None}
2025-12-28 22:31:33,752 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:33,768 - sqlalchemy.engine.Engine - INFO - [cached since 0.4856s ago] {'mac_address_1': '01:00:5E:00:00:FC', 'param_1': 1}
2025-12-28 22:31:33,778 - sqlalchemy.engine.Engine - INFO - INSERT INTO devices (mac_address, hostname, vendor, device_type, first_seen, last_seen, is_trusted, is_suspicious, notes) VALUES (%(mac_address)s, %(hostname)s, %(vendor)s, %(device_type)s, %(first_seen)s, %(last_seen)s, %(is_trusted)s, %(is_suspicious)s, %(notes)s)
2025-12-28 22:31:33,789 - sqlalchemy.engine.Engine - INFO - [cached since 0.4966s ago] {'mac_address': '01:00:5E:00:00:FC', 'hostname': None, 'vendor': None, 'device_type': 'Unknown', 'first_seen': datetime.datetime(2025, 12, 28, 17, 1, 33, 778029), 'last_seen': datetime.datetime(2025, 12, 28, 17, 1, 33, 778044), 'is_trusted': 0, 'is_suspicious': 0, 'notes': None}
2025-12-28 22:31:33,808 - sqlalchemy.engine.Engine - INFO - INSERT INTO alerts (device_id, alert_type, severity, message, details, is_acknowledged, acknowledged_by, created_at, acknowledged_at) VALUES (%(device_id)s, %(alert_type)s, %(severity)s, %(message)s, %(details)s, %(is_acknowledged)s, %(acknowledged_by)s, %(created_at)s, %(acknowledged_at)s)
2025-12-28 22:31:33,812 - sqlalchemy.engine.Engine - INFO - [cached since 0.4276s ago] {'device_id': 11, 'alert_type': 'NEW_DEVICE', 'severity': 'MEDIUM', 'message': 'New device detected: 01:00:5E:00:00:FB', 'details': '{"mac_address": "01:00:5E:00:00:FB", "vendor": null}', 'is_acknowledged': 0, 'acknowledged_by': None, 'created_at': datetime.datetime(2025, 12, 28, 17, 1, 33, 808109), 'acknowledged_at': None}
2025-12-28 22:31:33,827 - sqlalchemy.engine.Engine - INFO - INSERT INTO device_activity (device_id, event_type, old_value, new_value, event_timestamp) VALUES (%(device_id)s, %(event_type)s, %(old_value)s, %(new_value)s, %(event_timestamp)s)
2025-12-28 22:31:33,838 - sqlalchemy.engine.Engine - INFO - [cached since 0.4287s ago] {'device_id': 11, 'event_type': 'CONNECTED', 'old_value': None, 'new_value': '224.0.0.251', 'event_timestamp': datetime.datetime(2025, 12, 28, 17, 1, 33, 827680)}
2025-12-28 22:31:33,844 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-28 22:31:33,855 - sqlalchemy.engine.Engine - INFO - [cached since 0.4331s ago] {'device_id': 11, 'ip_address': '224.0.0.251', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 28, 17, 1, 33, 844556), 'is_connected': 1, 'response_time_ms': None}
2025-12-28 22:31:33,869 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:33,887 - sqlalchemy.engine.Engine - INFO - [cached since 0.6044s ago] {'mac_address_1': '01:00:5E:7F:66:12', 'param_1': 1}
2025-12-28 22:31:33,895 - sqlalchemy.engine.Engine - INFO - INSERT INTO devices (mac_address, hostname, vendor, device_type, first_seen, last_seen, is_trusted, is_suspicious, notes) VALUES (%(mac_address)s, %(hostname)s, %(vendor)s, %(device_type)s, %(first_seen)s, %(last_seen)s, %(is_trusted)s, %(is_suspicious)s, %(notes)s)
2025-12-28 22:31:33,907 - sqlalchemy.engine.Engine - INFO - [cached since 0.6144s ago] {'mac_address': '01:00:5E:7F:66:12', 'hostname': None, 'vendor': None, 'device_type': 'Unknown', 'first_seen': datetime.datetime(2025, 12, 28, 17, 1, 33, 895229), 'last_seen': datetime.datetime(2025, 12, 28, 17, 1, 33, 895246), 'is_trusted': 0, 'is_suspicious': 0, 'notes': None}
2025-12-28 22:31:33,915 - sqlalchemy.engine.Engine - INFO - INSERT INTO alerts (device_id, alert_type, severity, message, details, is_acknowledged, acknowledged_by, created_at, acknowledged_at) VALUES (%(device_id)s, %(alert_type)s, %(severity)s, %(message)s, %(details)s, %(is_acknowledged)s, %(acknowledged_by)s, %(created_at)s, %(acknowledged_at)s)
2025-12-28 22:31:33,922 - sqlalchemy.engine.Engine - INFO - [cached since 0.5379s ago] {'device_id': 12, 'alert_type': 'NEW_DEVICE', 'severity': 'MEDIUM', 'message': 'New device detected: 01:00:5E:00:00:FC', 'details': '{"mac_address": "01:00:5E:00:00:FC", "vendor": null}', 'is_acknowledged': 0, 'acknowledged_by': None, 'created_at': datetime.datetime(2025, 12, 28, 17, 1, 33, 914946), 'acknowledged_at': None}
2025-12-28 22:31:33,928 - sqlalchemy.engine.Engine - INFO - INSERT INTO device_activity (device_id, event_type, old_value, new_value, event_timestamp) VALUES (%(device_id)s, %(event_type)s, %(old_value)s, %(new_value)s, %(event_timestamp)s)
2025-12-28 22:31:33,937 - sqlalchemy.engine.Engine - INFO - [cached since 0.527s ago] {'device_id': 12, 'event_type': 'CONNECTED', 'old_value': None, 'new_value': '224.0.0.252', 'event_timestamp': datetime.datetime(2025, 12, 28, 17, 1, 33, 928319)}
2025-12-28 22:31:33,941 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-28 22:31:33,944 - sqlalchemy.engine.Engine - INFO - [cached since 0.5223s ago] {'device_id': 12, 'ip_address': '224.0.0.252', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 28, 17, 1, 33, 941456), 'is_connected': 1, 'response_time_ms': None}
2025-12-28 22:31:33,956 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:33,977 - sqlalchemy.engine.Engine - INFO - [cached since 0.6942s ago] {'mac_address_1': '01:00:5E:7F:FF:FA', 'param_1': 1}
2025-12-28 22:31:33,984 - sqlalchemy.engine.Engine - INFO - INSERT INTO devices (mac_address, hostname, vendor, device_type, first_seen, last_seen, is_trusted, is_suspicious, notes) VALUES (%(mac_address)s, %(hostname)s, %(vendor)s, %(device_type)s, %(first_seen)s, %(last_seen)s, %(is_trusted)s, %(is_suspicious)s, %(notes)s)
2025-12-28 22:31:34,001 - sqlalchemy.engine.Engine - INFO - [cached since 0.7081s ago] {'mac_address': '01:00:5E:7F:FF:FA', 'hostname': None, 'vendor': None, 'device_type': 'Unknown', 'first_seen': datetime.datetime(2025, 12, 28, 17, 1, 33, 984862), 'last_seen': datetime.datetime(2025, 12, 28, 17, 1, 33, 984877), 'is_trusted': 0, 'is_suspicious': 0, 'notes': None}
2025-12-28 22:31:34,016 - sqlalchemy.engine.Engine - INFO - INSERT INTO alerts (device_id, alert_type, severity, message, details, is_acknowledged, acknowledged_by, created_at, acknowledged_at) VALUES (%(device_id)s, %(alert_type)s, %(severity)s, %(message)s, %(details)s, %(is_acknowledged)s, %(acknowledged_by)s, %(created_at)s, %(acknowledged_at)s)
2025-12-28 22:31:34,022 - sqlalchemy.engine.Engine - INFO - [cached since 0.6372s ago] {'device_id': 13, 'alert_type': 'NEW_DEVICE', 'severity': 'MEDIUM', 'message': 'New device detected: 01:00:5E:7F:66:12', 'details': '{"mac_address": "01:00:5E:7F:66:12", "vendor": null}', 'is_acknowledged': 0, 'acknowledged_by': None, 'created_at': datetime.datetime(2025, 12, 28, 17, 1, 34, 16494), 'acknowledged_at': None}
2025-12-28 22:31:34,028 - sqlalchemy.engine.Engine - INFO - INSERT INTO device_activity (device_id, event_type, old_value, new_value, event_timestamp) VALUES (%(device_id)s, %(event_type)s, %(old_value)s, %(new_value)s, %(event_timestamp)s)
2025-12-28 22:31:34,035 - sqlalchemy.engine.Engine - INFO - [cached since 0.6257s ago] {'device_id': 13, 'event_type': 'CONNECTED', 'old_value': None, 'new_value': '239.255.102.18', 'event_timestamp': datetime.datetime(2025, 12, 28, 17, 1, 34, 28764)}
2025-12-28 22:31:34,041 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-28 22:31:34,045 - sqlalchemy.engine.Engine - INFO - [cached since 0.6228s ago] {'device_id': 13, 'ip_address': '239.255.102.18', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 28, 17, 1, 34, 40987), 'is_connected': 1, 'response_time_ms': None}
2025-12-28 22:31:34,056 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:34,062 - sqlalchemy.engine.Engine - INFO - [cached since 0.7794s ago] {'mac_address_1': 'FF:FF:FF:FF:FF:FF', 'param_1': 1}
2025-12-28 22:31:34,077 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:34,101 - sqlalchemy.engine.Engine - INFO - [generated in 0.02383s] {'device_id_1': 9, 'param_1': 1}
2025-12-28 22:31:34,112 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:34,128 - sqlalchemy.engine.Engine - INFO - [cached since 0.8459s ago] {'mac_address_1': '01:00:5E:00:00:16', 'param_1': 1}
2025-12-28 22:31:34,137 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:34,151 - sqlalchemy.engine.Engine - INFO - [cached since 0.07349s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-28 22:31:34,158 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:34,172 - sqlalchemy.engine.Engine - INFO - [cached since 0.8892s ago] {'mac_address_1': '01:00:5E:00:00:FB', 'param_1': 1}
2025-12-28 22:31:34,177 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:34,192 - sqlalchemy.engine.Engine - INFO - [cached since 0.1146s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-28 22:31:34,198 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:34,210 - sqlalchemy.engine.Engine - INFO - [cached since 0.9273s ago] {'mac_address_1': '01:00:5E:00:00:FC', 'param_1': 1}
2025-12-28 22:31:34,216 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:34,225 - sqlalchemy.engine.Engine - INFO - [cached since 0.1475s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-28 22:31:34,230 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:34,241 - sqlalchemy.engine.Engine - INFO - [cached since 0.9589s ago] {'mac_address_1': '01:00:5E:7F:66:12', 'param_1': 1}
2025-12-28 22:31:34,250 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:34,260 - sqlalchemy.engine.Engine - INFO - [cached since 0.1826s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-28 22:31:34,266 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:34,278 - sqlalchemy.engine.Engine - INFO - [cached since 0.9958s ago] {'mac_address_1': 'FF:FF:FF:FF:FF:FF', 'param_1': 1}
2025-12-28 22:31:34,299 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:34,336 - sqlalchemy.engine.Engine - INFO - [cached since 0.259s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-28 22:31:34,348 - sqlalchemy.engine.Engine - INFO - UPDATE devices SET last_seen=%(last_seen)s WHERE devices.id = %(devices_id)s
2025-12-28 22:31:34,352 - sqlalchemy.engine.Engine - INFO - [generated in 0.00462s] [{'last_seen': datetime.datetime(2025, 12, 28, 17, 1, 34, 343266), 'devices_id': 9}, {'last_seen': datetime.datetime(2025, 12, 28, 17, 1, 34, 156665), 'devices_id': 10}, {'last_seen': datetime.datetime(2025, 12, 28, 17, 1, 34, 195308), 'devices_id': 11}, {'last_seen': datetime.datetime(2025, 12, 28, 17, 1, 34, 228539), 'devices_id': 12}, {'last_seen': datetime.datetime(2025, 12, 28, 17, 1, 34, 264477), 'devices_id': 13}]
2025-12-28 22:31:34,371 - sqlalchemy.engine.Engine - INFO - UPDATE scan_sessions SET completed_at=%(completed_at)s, total_devices_found=%(total_devices_found)s, new_devices_found=%(new_devices_found)s, status=%(status)s WHERE scan_sessions.id = %(scan_sessions_id)s
2025-12-28 22:31:34,377 - sqlalchemy.engine.Engine - INFO - [generated in 0.00607s] {'completed_at': datetime.datetime(2025, 12, 28, 17, 1, 34, 343909), 'total_devices_found': 14, 'new_devices_found': 8, 'status': 'completed', 'scan_sessions_id': 26}
2025-12-28 22:31:34,389 - sqlalchemy.engine.Engine - INFO - INSERT INTO alerts (device_id, alert_type, severity, message, details, is_acknowledged, acknowledged_by, created_at, acknowledged_at) VALUES (%(device_id)s, %(alert_type)s, %(severity)s, %(message)s, %(details)s, %(is_acknowledged)s, %(acknowledged_by)s, %(created_at)s, %(acknowledged_at)s)
2025-12-28 22:31:34,394 - sqlalchemy.engine.Engine - INFO - [cached since 1.01s ago] {'device_id': 14, 'alert_type': 'NEW_DEVICE', 'severity': 'MEDIUM', 'message': 'New device detected: 01:00:5E:7F:FF:FA', 'details': '{"mac_address": "01:00:5E:7F:FF:FA", "vendor": null}', 'is_acknowledged': 0, 'acknowledged_by': None, 'created_at': datetime.datetime(2025, 12, 28, 17, 1, 34, 389109), 'acknowledged_at': None}
2025-12-28 22:31:34,405 - sqlalchemy.engine.Engine - INFO - INSERT INTO device_activity (device_id, event_type, old_value, new_value, event_timestamp) VALUES (%(device_id)s, %(event_type)s, %(old_value)s, %(new_value)s, %(event_timestamp)s)
2025-12-28 22:31:34,409 - sqlalchemy.engine.Engine - INFO - [cached since 0.9992s ago] {'device_id': 14, 'event_type': 'CONNECTED', 'old_value': None, 'new_value': '239.255.255.250', 'event_timestamp': datetime.datetime(2025, 12, 28, 17, 1, 34, 405276)}
2025-12-28 22:31:34,414 - sqlalchemy.engine.Engine - INFO - INSERT INTO device_activity (device_id, event_type, old_value, new_value, event_timestamp) VALUES (%(device_id)s, %(event_type)s, %(old_value)s, %(new_value)s, %(event_timestamp)s)
2025-12-28 22:31:34,419 - sqlalchemy.engine.Engine - INFO - [cached since 1.009s ago] {'device_id': 9, 'event_type': 'IP_CHANGED', 'old_value': '10.18.154.255', 'new_value': '255.255.255.255', 'event_timestamp': datetime.datetime(2025, 12, 28, 17, 1, 34, 413994)}
2025-12-28 22:31:34,425 - sqlalchemy.engine.Engine - INFO - INSERT INTO device_activity (device_id, event_type, old_value, new_value, event_timestamp) VALUES (%(device_id)s, %(event_type)s, %(old_value)s, %(new_value)s, %(event_timestamp)s)
2025-12-28 22:31:34,428 - sqlalchemy.engine.Engine - INFO - [cached since 1.018s ago] {'device_id': 9, 'event_type': 'IP_CHANGED', 'old_value': '10.18.154.255', 'new_value': '255.255.255.255', 'event_timestamp': datetime.datetime(2025, 12, 28, 17, 1, 34, 425326)}
2025-12-28 22:31:34,436 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-28 22:31:34,442 - sqlalchemy.engine.Engine - INFO - [cached since 1.02s ago] {'device_id': 14, 'ip_address': '239.255.255.250', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 28, 17, 1, 34, 436882), 'is_connected': 1, 'response_time_ms': None}
2025-12-28 22:31:34,447 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-28 22:31:34,452 - sqlalchemy.engine.Engine - INFO - [cached since 1.031s ago] {'device_id': 9, 'ip_address': '255.255.255.255', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 28, 17, 1, 34, 447732), 'is_connected': 1, 'response_time_ms': None}
2025-12-28 22:31:34,458 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-28 22:31:34,462 - sqlalchemy.engine.Engine - INFO - [cached since 1.04s ago] {'device_id': 10, 'ip_address': '224.0.0.22', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 28, 17, 1, 34, 458852), 'is_connected': 1, 'response_time_ms': None}
2025-12-28 22:31:34,470 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-28 22:31:34,475 - sqlalchemy.engine.Engine - INFO - [cached since 1.053s ago] {'device_id': 11, 'ip_address': '224.0.0.251', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 28, 17, 1, 34, 470428), 'is_connected': 1, 'response_time_ms': None}
2025-12-28 22:31:34,479 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-28 22:31:34,486 - sqlalchemy.engine.Engine - INFO - [cached since 1.064s ago] {'device_id': 12, 'ip_address': '224.0.0.252', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 28, 17, 1, 34, 479709), 'is_connected': 1, 'response_time_ms': None}
2025-12-28 22:31:34,490 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-28 22:31:34,493 - sqlalchemy.engine.Engine - INFO - [cached since 1.071s ago] {'device_id': 13, 'ip_address': '239.255.102.18', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 28, 17, 1, 34, 490215), 'is_connected': 1, 'response_time_ms': None}
2025-12-28 22:31:34,498 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-28 22:31:34,502 - sqlalchemy.engine.Engine - INFO - [cached since 1.081s ago] {'device_id': 9, 'ip_address': '255.255.255.255', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 28, 17, 1, 34, 497853), 'is_connected': 1, 'response_time_ms': None}
2025-12-28 22:31:34,508 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:31:34,515 - app.routers.scans - INFO - Scan completed: 14 devices, 8 new
2025-12-28 22:31:34,846 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:31:34,905 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:34,986 - sqlalchemy.engine.Engine - INFO - [cached since 178.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:31:34,992 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:31:34,998 - sqlalchemy.engine.Engine - INFO - [cached since 178.8s ago] {}
2025-12-28 22:31:35,004 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:31:35,009 - sqlalchemy.engine.Engine - INFO - [cached since 178.7s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 51, 35, 2765)}
2025-12-28 22:31:35,014 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:31:35,035 - sqlalchemy.engine.Engine - INFO - [cached since 178.8s ago] {}
2025-12-28 22:31:35,076 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:31:35,092 - sqlalchemy.engine.Engine - INFO - [cached since 178.8s ago] {}
2025-12-28 22:31:35,097 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:31:35,107 - sqlalchemy.engine.Engine - INFO - [cached since 178.8s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:31:35,111 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:31:35,120 - sqlalchemy.engine.Engine - INFO - [cached since 178.8s ago] {}
2025-12-28 22:31:35,123 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:31:35,132 - sqlalchemy.engine.Engine - INFO - [cached since 178.8s ago] {}
2025-12-28 22:31:35,138 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:31:35,147 - sqlalchemy.engine.Engine - INFO - [cached since 178.8s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:31:35,151 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:35,159 - sqlalchemy.engine.Engine - INFO - [cached since 178.8s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:31:35,163 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:31:35,167 - sqlalchemy.engine.Engine - INFO - [cached since 178.8s ago] {}
2025-12-28 22:31:35,172 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:31:35,185 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:31:35,188 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:35,195 - sqlalchemy.engine.Engine - INFO - [cached since 179s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:31:35,203 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:31:35,212 - sqlalchemy.engine.Engine - INFO - [cached since 179s ago] {}
2025-12-28 22:31:35,219 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:31:35,227 - sqlalchemy.engine.Engine - INFO - [cached since 179s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 51, 35, 217843)}
2025-12-28 22:31:35,234 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:31:35,245 - sqlalchemy.engine.Engine - INFO - [cached since 179s ago] {}
2025-12-28 22:31:35,251 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:31:35,259 - sqlalchemy.engine.Engine - INFO - [cached since 179s ago] {}
2025-12-28 22:31:35,263 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:31:35,276 - sqlalchemy.engine.Engine - INFO - [cached since 179s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:31:35,281 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:31:35,289 - sqlalchemy.engine.Engine - INFO - [cached since 179s ago] {}
2025-12-28 22:31:35,292 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:31:35,302 - sqlalchemy.engine.Engine - INFO - [cached since 178.9s ago] {}
2025-12-28 22:31:35,306 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:31:35,317 - sqlalchemy.engine.Engine - INFO - [cached since 178.9s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:31:35,322 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:35,338 - sqlalchemy.engine.Engine - INFO - [cached since 179s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:31:35,343 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:31:35,348 - sqlalchemy.engine.Engine - INFO - [cached since 178.9s ago] {}
2025-12-28 22:31:35,357 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:31:35,359 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:31:35,371 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:35,380 - sqlalchemy.engine.Engine - INFO - [cached since 179.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:31:35,389 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:35,398 - sqlalchemy.engine.Engine - INFO - [cached since 93.06s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:31:35,406 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:35,411 - sqlalchemy.engine.Engine - INFO - [generated in 0.00563s] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 21, 17, 1, 35, 403624), 'param_1': 100}
2025-12-28 22:31:35,420 - app.database - ERROR - Database session error: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:31:35,421 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:31:35,423 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:31:35,425 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:35,433 - sqlalchemy.engine.Engine - INFO - [cached since 179.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:31:35,436 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:31:35,441 - sqlalchemy.engine.Engine - INFO - [cached since 179.2s ago] {}
2025-12-28 22:31:35,444 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:31:35,456 - sqlalchemy.engine.Engine - INFO - [cached since 179.2s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 51, 35, 443830)}
2025-12-28 22:31:35,461 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:31:35,471 - sqlalchemy.engine.Engine - INFO - [cached since 179.2s ago] {}
2025-12-28 22:31:35,475 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:31:35,483 - sqlalchemy.engine.Engine - INFO - [cached since 179.2s ago] {}
2025-12-28 22:31:35,486 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:31:35,492 - sqlalchemy.engine.Engine - INFO - [cached since 179.2s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:31:35,496 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:31:35,507 - sqlalchemy.engine.Engine - INFO - [cached since 179.2s ago] {}
2025-12-28 22:31:35,510 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:31:35,520 - sqlalchemy.engine.Engine - INFO - [cached since 179.2s ago] {}
2025-12-28 22:31:35,524 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:31:35,536 - sqlalchemy.engine.Engine - INFO - [cached since 179.2s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:31:35,541 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:35,552 - sqlalchemy.engine.Engine - INFO - [cached since 179.2s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:31:35,557 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:31:35,560 - sqlalchemy.engine.Engine - INFO - [cached since 179.2s ago] {}
2025-12-28 22:31:35,568 - app.main - ERROR - Unhandled exception: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'connected'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\devices.py", line 246, in get_device_history
    ).order_by(DeviceActivity.event_timestamp.desc()).limit(100).all()
                                                                 ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:31:35,726 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:31:35,732 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:31:35,734 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:35,740 - sqlalchemy.engine.Engine - INFO - [cached since 179.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:31:35,743 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:35,749 - sqlalchemy.engine.Engine - INFO - [cached since 93.41s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:31:35,753 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:35,758 - sqlalchemy.engine.Engine - INFO - [cached since 0.3528s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 21, 17, 1, 35, 752398), 'param_1': 100}
2025-12-28 22:31:35,763 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:31:35,766 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:35,770 - sqlalchemy.engine.Engine - INFO - [cached since 179.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:31:35,774 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:31:35,778 - sqlalchemy.engine.Engine - INFO - [cached since 179.5s ago] {}
2025-12-28 22:31:35,781 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:31:35,788 - sqlalchemy.engine.Engine - INFO - [cached since 179.5s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 51, 35, 780697)}
2025-12-28 22:31:35,791 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:31:35,795 - sqlalchemy.engine.Engine - INFO - [cached since 179.5s ago] {}
2025-12-28 22:31:35,801 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:31:35,807 - sqlalchemy.engine.Engine - INFO - [cached since 179.5s ago] {}
2025-12-28 22:31:35,810 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:31:35,817 - sqlalchemy.engine.Engine - INFO - [cached since 179.5s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:31:35,820 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:31:35,824 - sqlalchemy.engine.Engine - INFO - [cached since 179.5s ago] {}
2025-12-28 22:31:35,827 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:31:35,835 - sqlalchemy.engine.Engine - INFO - [cached since 179.5s ago] {}
2025-12-28 22:31:35,839 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:31:35,851 - sqlalchemy.engine.Engine - INFO - [cached since 179.5s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:31:35,855 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:35,869 - sqlalchemy.engine.Engine - INFO - [cached since 179.5s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:31:35,873 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:31:35,877 - sqlalchemy.engine.Engine - INFO - [cached since 179.5s ago] {}
2025-12-28 22:31:35,883 - app.database - ERROR - Database session error: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:31:35,884 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:31:35,890 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:31:35,908 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:31:35,910 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:35,923 - sqlalchemy.engine.Engine - INFO - [cached since 179.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:31:35,927 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:35,935 - sqlalchemy.engine.Engine - INFO - [cached since 93.59s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:31:35,938 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:35,943 - sqlalchemy.engine.Engine - INFO - [cached since 0.5375s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 21, 17, 1, 35, 937934), 'param_1': 100}
2025-12-28 22:31:35,947 - app.main - ERROR - Unhandled exception: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'connected'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\devices.py", line 246, in get_device_history
    ).order_by(DeviceActivity.event_timestamp.desc()).limit(100).all()
                                                                 ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:31:36,065 - app.database - ERROR - Database session error: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:31:36,068 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:31:36,071 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:31:36,074 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:36,077 - sqlalchemy.engine.Engine - INFO - [cached since 179.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:31:36,081 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:36,087 - sqlalchemy.engine.Engine - INFO - [cached since 179.6s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 17, 1, 36, 80012), 'param_1': 100}
2025-12-28 22:31:36,094 - app.main - ERROR - Unhandled exception: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'connected'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\devices.py", line 246, in get_device_history
    ).order_by(DeviceActivity.event_timestamp.desc()).limit(100).all()
                                                                 ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:31:36,218 - app.database - ERROR - Database session error: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:31:36,223 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:31:36,224 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:31:36,228 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:36,239 - sqlalchemy.engine.Engine - INFO - [cached since 180s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:31:36,244 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:36,256 - sqlalchemy.engine.Engine - INFO - [cached since 93.92s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:31:36,261 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:36,274 - sqlalchemy.engine.Engine - INFO - [cached since 0.8689s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 21, 17, 1, 36, 260723), 'param_1': 100}
2025-12-28 22:31:36,280 - app.main - ERROR - Unhandled exception: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'ip_changed'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\dashboard.py", line 96, in get_activity_timeline
    ).order_by(DeviceActivity.event_timestamp.desc()).limit(100).all()
                                                                 ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:31:36,400 - app.database - ERROR - Database session error: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:31:36,401 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:31:36,402 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:31:36,403 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:36,409 - sqlalchemy.engine.Engine - INFO - [cached since 180.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:31:36,412 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:31:36,422 - sqlalchemy.engine.Engine - INFO - [cached since 180.2s ago] {}
2025-12-28 22:31:36,425 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:31:36,432 - sqlalchemy.engine.Engine - INFO - [cached since 180.2s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 51, 36, 424936)}
2025-12-28 22:31:36,438 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:31:36,445 - sqlalchemy.engine.Engine - INFO - [cached since 180.2s ago] {}
2025-12-28 22:31:36,452 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:31:36,461 - sqlalchemy.engine.Engine - INFO - [cached since 180.2s ago] {}
2025-12-28 22:31:36,471 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:31:36,478 - sqlalchemy.engine.Engine - INFO - [cached since 180.2s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:31:36,484 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:31:36,490 - sqlalchemy.engine.Engine - INFO - [cached since 180.2s ago] {}
2025-12-28 22:31:36,493 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:31:36,501 - sqlalchemy.engine.Engine - INFO - [cached since 180.1s ago] {}
2025-12-28 22:31:36,504 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:31:36,511 - sqlalchemy.engine.Engine - INFO - [cached since 180.1s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:31:36,517 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:36,526 - sqlalchemy.engine.Engine - INFO - [cached since 180.1s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:31:36,530 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:31:36,534 - sqlalchemy.engine.Engine - INFO - [cached since 180.1s ago] {}
2025-12-28 22:31:36,539 - app.main - ERROR - Unhandled exception: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'connected'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\devices.py", line 246, in get_device_history
    ).order_by(DeviceActivity.event_timestamp.desc()).limit(100).all()
                                                                 ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:31:36,678 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:31:36,684 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:31:36,686 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:36,690 - sqlalchemy.engine.Engine - INFO - [cached since 180.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:31:36,692 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:36,699 - sqlalchemy.engine.Engine - INFO - [cached since 180.2s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 17, 1, 36, 692236), 'param_1': 100}
2025-12-28 22:31:36,703 - app.database - ERROR - Database session error: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:31:36,705 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:31:36,707 - app.main - ERROR - Unhandled exception: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'ip_changed'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\dashboard.py", line 96, in get_activity_timeline
    ).order_by(DeviceActivity.event_timestamp.desc()).limit(100).all()
                                                                 ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:31:36,999 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:31:37,000 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:37,003 - sqlalchemy.engine.Engine - INFO - [cached since 180.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:31:37,006 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:37,008 - sqlalchemy.engine.Engine - INFO - [cached since 94.67s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:31:37,012 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:37,020 - sqlalchemy.engine.Engine - INFO - [cached since 1.615s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 21, 17, 1, 37, 11778), 'param_1': 100}
2025-12-28 22:31:37,024 - app.database - ERROR - Database session error: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:31:37,025 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:31:37,028 - app.main - ERROR - Unhandled exception: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'connected'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\devices.py", line 246, in get_device_history
    ).order_by(DeviceActivity.event_timestamp.desc()).limit(100).all()
                                                                 ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:31:37,146 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:31:37,150 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:37,160 - sqlalchemy.engine.Engine - INFO - [cached since 181s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:31:37,166 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:31:37,174 - sqlalchemy.engine.Engine - INFO - [cached since 180.9s ago] {}
2025-12-28 22:31:37,177 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:31:37,185 - sqlalchemy.engine.Engine - INFO - [cached since 180.9s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 16, 51, 37, 176313)}
2025-12-28 22:31:37,189 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:31:37,193 - sqlalchemy.engine.Engine - INFO - [cached since 180.9s ago] {}
2025-12-28 22:31:37,195 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:31:37,203 - sqlalchemy.engine.Engine - INFO - [cached since 180.9s ago] {}
2025-12-28 22:31:37,206 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:31:37,210 - sqlalchemy.engine.Engine - INFO - [cached since 180.9s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:31:37,213 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:31:37,219 - sqlalchemy.engine.Engine - INFO - [cached since 180.9s ago] {}
2025-12-28 22:31:37,223 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:31:37,227 - sqlalchemy.engine.Engine - INFO - [cached since 180.9s ago] {}
2025-12-28 22:31:37,232 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:31:37,282 - sqlalchemy.engine.Engine - INFO - [cached since 180.9s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:31:37,296 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:37,340 - sqlalchemy.engine.Engine - INFO - [cached since 181s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:31:37,378 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:31:37,402 - sqlalchemy.engine.Engine - INFO - [cached since 181s ago] {}
2025-12-28 22:31:37,410 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:31:37,444 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:31:37,455 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:37,460 - sqlalchemy.engine.Engine - INFO - [cached since 181.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:31:37,470 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:37,483 - sqlalchemy.engine.Engine - INFO - [cached since 181s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 17, 1, 37, 469754), 'param_1': 100}
2025-12-28 22:31:37,490 - app.database - ERROR - Database session error: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:31:37,492 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:31:37,495 - app.main - ERROR - Unhandled exception: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'ip_changed'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\dashboard.py", line 96, in get_activity_timeline
    ).order_by(DeviceActivity.event_timestamp.desc()).limit(100).all()
                                                                 ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:31:46,238 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:31:46,240 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:46,249 - sqlalchemy.engine.Engine - INFO - [cached since 190s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:31:46,254 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:31:46,267 - sqlalchemy.engine.Engine - INFO - [cached since 190s ago] {}
2025-12-28 22:31:46,272 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-28 22:31:46,297 - sqlalchemy.engine.Engine - INFO - [generated in 0.02523s] {'param_1': 0, 'param_2': 20}
2025-12-28 22:31:46,302 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:46,307 - sqlalchemy.engine.Engine - INFO - [cached since 12.23s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-28 22:31:46,312 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:46,319 - sqlalchemy.engine.Engine - INFO - [cached since 12.24s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-28 22:31:46,324 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:46,331 - sqlalchemy.engine.Engine - INFO - [cached since 12.25s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-28 22:31:46,335 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:46,341 - sqlalchemy.engine.Engine - INFO - [cached since 12.26s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-28 22:31:46,347 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:46,354 - sqlalchemy.engine.Engine - INFO - [cached since 12.28s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-28 22:31:46,357 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:46,367 - sqlalchemy.engine.Engine - INFO - [cached since 12.29s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-28 22:31:46,372 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:46,382 - sqlalchemy.engine.Engine - INFO - [cached since 12.3s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-28 22:31:46,385 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:46,391 - sqlalchemy.engine.Engine - INFO - [cached since 12.31s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-28 22:31:46,398 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:31:46,402 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:31:46,407 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:31:46,416 - sqlalchemy.engine.Engine - INFO - [cached since 190.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:31:46,422 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:31:46,436 - sqlalchemy.engine.Engine - INFO - [cached since 190.2s ago] {}
2025-12-28 22:31:46,441 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-28 22:31:46,457 - sqlalchemy.engine.Engine - INFO - [cached since 0.1848s ago] {'param_1': 0, 'param_2': 20}
2025-12-28 22:31:46,471 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:46,491 - sqlalchemy.engine.Engine - INFO - [cached since 12.41s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-28 22:31:46,511 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:46,536 - sqlalchemy.engine.Engine - INFO - [cached since 12.46s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-28 22:31:46,544 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:46,569 - sqlalchemy.engine.Engine - INFO - [cached since 12.49s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-28 22:31:46,604 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:46,615 - sqlalchemy.engine.Engine - INFO - [cached since 12.54s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-28 22:31:46,620 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:46,626 - sqlalchemy.engine.Engine - INFO - [cached since 12.55s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-28 22:31:46,636 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:46,642 - sqlalchemy.engine.Engine - INFO - [cached since 12.56s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-28 22:31:46,650 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:46,656 - sqlalchemy.engine.Engine - INFO - [cached since 12.58s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-28 22:31:46,661 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:31:46,669 - sqlalchemy.engine.Engine - INFO - [cached since 12.59s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-28 22:31:46,675 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:32:32,249 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:32:32,258 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:32:32,264 - sqlalchemy.engine.Engine - INFO - [cached since 236.1s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:32:32,272 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:32:32,280 - sqlalchemy.engine.Engine - INFO - [cached since 149.9s ago] {'id_1': 10, 'param_1': 1}
2025-12-28 22:32:32,288 - app.database - ERROR - Database session error: 400: ML models not trained. Train models first.
2025-12-28 22:32:32,289 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:32:39,558 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:32:39,559 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:32:39,561 - sqlalchemy.engine.Engine - INFO - [cached since 243.4s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:32:39,565 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:32:39,574 - sqlalchemy.engine.Engine - INFO - [cached since 157.2s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:32:39,577 - app.database - ERROR - Database session error: 400: ML models not trained. Train models first.
2025-12-28 22:32:39,578 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:32:53,720 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:32:53,722 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:32:53,726 - sqlalchemy.engine.Engine - INFO - [cached since 257.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:32:53,734 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:32:53,739 - sqlalchemy.engine.Engine - INFO - [cached since 171.4s ago] {'id_1': 12, 'param_1': 1}
2025-12-28 22:32:53,742 - app.database - ERROR - Database session error: 400: ML models not trained. Train models first.
2025-12-28 22:32:53,743 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:32:57,490 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:32:57,492 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:32:57,529 - sqlalchemy.engine.Engine - INFO - [cached since 261.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:32:57,541 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:32:57,553 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:32:57,555 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:32:57,559 - sqlalchemy.engine.Engine - INFO - [cached since 261.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:32:57,572 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:32:59,309 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:32:59,315 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:32:59,324 - sqlalchemy.engine.Engine - INFO - [cached since 263.1s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:32:59,332 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices
2025-12-28 22:32:59,340 - sqlalchemy.engine.Engine - INFO - [generated in 0.00745s] {}
2025-12-28 22:32:59,347 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-28 22:32:59,355 - sqlalchemy.engine.Engine - INFO - [generated in 0.00836s] {'device_id_1': 7}
2025-12-28 22:32:59,361 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-28 22:32:59,369 - sqlalchemy.engine.Engine - INFO - [generated in 0.00828s] {'device_id_1': 7}
2025-12-28 22:32:59,375 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:32:59,378 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:32:59,384 - sqlalchemy.engine.Engine - INFO - [cached since 263.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:32:59,389 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices
2025-12-28 22:32:59,396 - sqlalchemy.engine.Engine - INFO - [cached since 0.06346s ago] {}
2025-12-28 22:32:59,400 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-28 22:32:59,406 - sqlalchemy.engine.Engine - INFO - [cached since 0.05897s ago] {'device_id_1': 7}
2025-12-28 22:32:59,410 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-28 22:32:59,417 - sqlalchemy.engine.Engine - INFO - [cached since 0.05622s ago] {'device_id_1': 7}
2025-12-28 22:32:59,421 - app.database - ERROR - Database session error: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:32:59,422 - app.database - ERROR - Database session error: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:32:59,423 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:32:59,424 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:32:59,428 - app.main - ERROR - Unhandled exception: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'connected'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\dashboard.py", line 164, in train_ml_models
    ).all()
      ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:32:59,549 - app.main - ERROR - Unhandled exception: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'connected'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\dashboard.py", line 164, in train_ml_models
    ).all()
      ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:33:04,763 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:33:04,765 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:33:04,769 - sqlalchemy.engine.Engine - INFO - [cached since 268.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:33:04,774 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices
2025-12-28 22:33:04,785 - sqlalchemy.engine.Engine - INFO - [cached since 5.453s ago] {}
2025-12-28 22:33:04,790 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-28 22:33:04,799 - sqlalchemy.engine.Engine - INFO - [cached since 5.452s ago] {'device_id_1': 7}
2025-12-28 22:33:04,804 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-28 22:33:04,812 - sqlalchemy.engine.Engine - INFO - [cached since 5.451s ago] {'device_id_1': 7}
2025-12-28 22:33:04,817 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:33:04,822 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:33:04,833 - sqlalchemy.engine.Engine - INFO - [cached since 268.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:33:04,840 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices
2025-12-28 22:33:04,851 - sqlalchemy.engine.Engine - INFO - [cached since 5.519s ago] {}
2025-12-28 22:33:04,856 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-28 22:33:04,865 - sqlalchemy.engine.Engine - INFO - [cached since 5.518s ago] {'device_id_1': 7}
2025-12-28 22:33:04,869 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-28 22:33:04,873 - sqlalchemy.engine.Engine - INFO - [cached since 5.512s ago] {'device_id_1': 7}
2025-12-28 22:33:04,877 - app.database - ERROR - Database session error: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:33:04,878 - app.database - ERROR - Database session error: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:33:04,879 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:33:04,880 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:33:04,884 - app.main - ERROR - Unhandled exception: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'connected'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\dashboard.py", line 164, in train_ml_models
    ).all()
      ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:33:04,987 - app.main - ERROR - Unhandled exception: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'connected'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\dashboard.py", line 164, in train_ml_models
    ).all()
      ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:33:07,817 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:33:07,818 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:33:07,821 - sqlalchemy.engine.Engine - INFO - [cached since 271.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:33:07,824 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices
2025-12-28 22:33:07,838 - sqlalchemy.engine.Engine - INFO - [cached since 8.506s ago] {}
2025-12-28 22:33:07,860 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-28 22:33:07,881 - sqlalchemy.engine.Engine - INFO - [cached since 8.534s ago] {'device_id_1': 7}
2025-12-28 22:33:07,887 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-28 22:33:07,890 - sqlalchemy.engine.Engine - INFO - [cached since 8.53s ago] {'device_id_1': 7}
2025-12-28 22:33:07,895 - app.database - ERROR - Database session error: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:33:07,897 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:33:07,899 - app.main - ERROR - Unhandled exception: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'connected'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\dashboard.py", line 164, in train_ml_models
    ).all()
      ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:33:08,127 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:33:08,129 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:33:08,134 - sqlalchemy.engine.Engine - INFO - [cached since 271.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:33:08,138 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices
2025-12-28 22:33:08,157 - sqlalchemy.engine.Engine - INFO - [cached since 8.825s ago] {}
2025-12-28 22:33:08,166 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-28 22:33:08,177 - sqlalchemy.engine.Engine - INFO - [cached since 8.83s ago] {'device_id_1': 7}
2025-12-28 22:33:08,181 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-28 22:33:08,188 - sqlalchemy.engine.Engine - INFO - [cached since 8.827s ago] {'device_id_1': 7}
2025-12-28 22:33:08,193 - app.database - ERROR - Database session error: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:33:08,196 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:33:08,198 - app.main - ERROR - Unhandled exception: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'connected'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\dashboard.py", line 164, in train_ml_models
    ).all()
      ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:39:58,528 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:39:58,531 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:39:58,538 - sqlalchemy.engine.Engine - INFO - [cached since 682.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:39:58,545 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:39:58,552 - sqlalchemy.engine.Engine - INFO - [cached since 682.2s ago] {}
2025-12-28 22:39:58,555 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:39:58,565 - sqlalchemy.engine.Engine - INFO - [cached since 682.2s ago] {}
2025-12-28 22:39:58,572 - sqlalchemy.engine.Engine - INFO - SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts ORDER BY alerts.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-28 22:39:58,578 - sqlalchemy.engine.Engine - INFO - [generated in 0.00600s] {'param_1': 0, 'param_2': 20}
2025-12-28 22:39:58,585 - app.database - ERROR - Database session error: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
2025-12-28 22:39:58,587 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:39:58,589 - app.main - ERROR - Unhandled exception: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'new_device'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\alerts.py", line 65, in list_alerts
    alerts = query.offset(offset).limit(page_size).all()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
2025-12-28 22:39:58,735 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:39:58,737 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:39:58,739 - sqlalchemy.engine.Engine - INFO - [cached since 682.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:39:58,749 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:39:58,756 - sqlalchemy.engine.Engine - INFO - [cached since 682.4s ago] {}
2025-12-28 22:39:58,759 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:39:58,773 - sqlalchemy.engine.Engine - INFO - [cached since 682.4s ago] {}
2025-12-28 22:39:58,780 - sqlalchemy.engine.Engine - INFO - SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts ORDER BY alerts.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-28 22:39:58,790 - sqlalchemy.engine.Engine - INFO - [cached since 0.218s ago] {'param_1': 0, 'param_2': 20}
2025-12-28 22:39:58,797 - app.database - ERROR - Database session error: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
2025-12-28 22:39:58,800 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:39:58,808 - app.main - ERROR - Unhandled exception: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'new_device'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\alerts.py", line 65, in list_alerts
    alerts = query.offset(offset).limit(page_size).all()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
2025-12-28 22:39:58,962 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:39:58,966 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:39:58,971 - sqlalchemy.engine.Engine - INFO - [cached since 682.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:39:58,976 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:39:58,983 - sqlalchemy.engine.Engine - INFO - [cached since 682.6s ago] {}
2025-12-28 22:39:58,987 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:39:58,991 - sqlalchemy.engine.Engine - INFO - [cached since 682.6s ago] {}
2025-12-28 22:39:58,998 - sqlalchemy.engine.Engine - INFO - SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts ORDER BY alerts.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-28 22:39:59,003 - sqlalchemy.engine.Engine - INFO - [cached since 0.4306s ago] {'param_1': 0, 'param_2': 20}
2025-12-28 22:39:59,007 - app.database - ERROR - Database session error: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
2025-12-28 22:39:59,008 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:39:59,015 - app.main - ERROR - Unhandled exception: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'new_device'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\alerts.py", line 65, in list_alerts
    alerts = query.offset(offset).limit(page_size).all()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
2025-12-28 22:40:02,618 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:02,619 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:02,622 - sqlalchemy.engine.Engine - INFO - [cached since 686.4s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:02,625 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:40:02,633 - sqlalchemy.engine.Engine - INFO - [cached since 686.4s ago] {}
2025-12-28 22:40:02,635 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:40:02,640 - sqlalchemy.engine.Engine - INFO - [cached since 686.4s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 17, 0, 2, 635228)}
2025-12-28 22:40:02,645 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:40:02,651 - sqlalchemy.engine.Engine - INFO - [cached since 686.4s ago] {}
2025-12-28 22:40:02,654 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:40:02,665 - sqlalchemy.engine.Engine - INFO - [cached since 686.4s ago] {}
2025-12-28 22:40:02,670 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:40:02,689 - sqlalchemy.engine.Engine - INFO - [cached since 686.4s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:40:02,699 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:40:02,719 - sqlalchemy.engine.Engine - INFO - [cached since 686.4s ago] {}
2025-12-28 22:40:02,805 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:40:02,832 - sqlalchemy.engine.Engine - INFO - [cached since 686.5s ago] {}
2025-12-28 22:40:02,859 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:40:02,891 - sqlalchemy.engine.Engine - INFO - [cached since 686.5s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:40:02,943 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:02,954 - sqlalchemy.engine.Engine - INFO - [cached since 686.6s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:40:02,967 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:40:02,970 - sqlalchemy.engine.Engine - INFO - [cached since 686.6s ago] {}
2025-12-28 22:40:02,980 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:02,992 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:02,997 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:03,003 - sqlalchemy.engine.Engine - INFO - [cached since 686.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:03,007 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-28 22:40:03,018 - sqlalchemy.engine.Engine - INFO - [cached since 559.3s ago] {'started_at': datetime.datetime(2025, 12, 28, 17, 10, 3, 7808), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'arp', 'network_range': '192.168.1.0/24', 'status': 'running', 'error_message': None}
2025-12-28 22:40:03,033 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:40:03,040 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:03,044 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-28 22:40:03,056 - sqlalchemy.engine.Engine - INFO - [cached since 559.3s ago] {'pk_1': 27}
2025-12-28 22:40:03,064 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-28 22:40:03,071 - sqlalchemy.engine.Engine - INFO - [cached since 591.7s ago] {'pk_1': 1}
2025-12-28 22:40:03,075 - app.routers.scans - INFO - Scan started by admin: 27
2025-12-28 22:40:03,082 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:03,094 - sqlalchemy.engine.Engine - INFO - [cached since 559.3s ago] {'id_1': 27, 'param_1': 1}
2025-12-28 22:40:03,099 - app.services.scanner - INFO - Starting ARP scan on 192.168.1.0/24
2025-12-28 22:40:03,101 - app.services.scanner - ERROR - ARP scan failed: Sniffing and sending packets is not available at layer 2: winpcap is not installed. You may use conf.L3socket or conf.L3socket6 to access layer 3
2025-12-28 22:40:28,268 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:28,273 - sqlalchemy.engine.Engine - INFO - [cached since 535s ago] {'mac_address_1': '54:AF:97:FE:1A:C5', 'param_1': 1}
2025-12-28 22:40:28,277 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:28,283 - sqlalchemy.engine.Engine - INFO - [cached since 534.2s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-28 22:40:28,290 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:28,295 - sqlalchemy.engine.Engine - INFO - [cached since 535s ago] {'mac_address_1': '96:A4:CB:4D:96:A9', 'param_1': 1}
2025-12-28 22:40:28,299 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:28,306 - sqlalchemy.engine.Engine - INFO - [cached since 534.2s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-28 22:40:28,310 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:28,315 - sqlalchemy.engine.Engine - INFO - [cached since 535s ago] {'mac_address_1': 'FF:FF:FF:FF:FF:FF', 'param_1': 1}
2025-12-28 22:40:28,318 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:28,326 - sqlalchemy.engine.Engine - INFO - [cached since 534.2s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-28 22:40:28,330 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:28,334 - sqlalchemy.engine.Engine - INFO - [cached since 535.1s ago] {'mac_address_1': '01:00:5E:00:00:16', 'param_1': 1}
2025-12-28 22:40:28,340 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:28,346 - sqlalchemy.engine.Engine - INFO - [cached since 534.3s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-28 22:40:28,350 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:28,355 - sqlalchemy.engine.Engine - INFO - [cached since 535.1s ago] {'mac_address_1': '01:00:5E:00:00:FB', 'param_1': 1}
2025-12-28 22:40:28,358 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:28,362 - sqlalchemy.engine.Engine - INFO - [cached since 534.3s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-28 22:40:28,366 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:28,371 - sqlalchemy.engine.Engine - INFO - [cached since 535.1s ago] {'mac_address_1': '01:00:5E:00:00:FC', 'param_1': 1}
2025-12-28 22:40:28,376 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:28,381 - sqlalchemy.engine.Engine - INFO - [cached since 534.3s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-28 22:40:28,384 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:28,392 - sqlalchemy.engine.Engine - INFO - [cached since 535.1s ago] {'mac_address_1': '01:00:5E:7F:66:12', 'param_1': 1}
2025-12-28 22:40:28,398 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:28,407 - sqlalchemy.engine.Engine - INFO - [cached since 534.3s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-28 22:40:28,416 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:28,427 - sqlalchemy.engine.Engine - INFO - [cached since 535.1s ago] {'mac_address_1': '01:00:5E:7F:FF:FA', 'param_1': 1}
2025-12-28 22:40:28,434 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:28,445 - sqlalchemy.engine.Engine - INFO - [cached since 534.4s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-28 22:40:28,450 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:28,461 - sqlalchemy.engine.Engine - INFO - [cached since 535.2s ago] {'mac_address_1': 'FF:FF:FF:FF:FF:FF', 'param_1': 1}
2025-12-28 22:40:28,465 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:28,474 - sqlalchemy.engine.Engine - INFO - [cached since 534.4s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-28 22:40:28,480 - sqlalchemy.engine.Engine - INFO - UPDATE devices SET last_seen=%(last_seen)s WHERE devices.id = %(devices_id)s
2025-12-28 22:40:28,482 - sqlalchemy.engine.Engine - INFO - [cached since 534.1s ago] [{'last_seen': datetime.datetime(2025, 12, 28, 17, 10, 28, 288291), 'devices_id': 7}, {'last_seen': datetime.datetime(2025, 12, 28, 17, 10, 28, 309174), 'devices_id': 8}, {'last_seen': datetime.datetime(2025, 12, 28, 17, 10, 28, 477794), 'devices_id': 9}, {'last_seen': datetime.datetime(2025, 12, 28, 17, 10, 28, 349060), 'devices_id': 10}, {'last_seen': datetime.datetime(2025, 12, 28, 17, 10, 28, 364859), 'devices_id': 11}, {'last_seen': datetime.datetime(2025, 12, 28, 17, 10, 28, 383456), 'devices_id': 12}, {'last_seen': datetime.datetime(2025, 12, 28, 17, 10, 28, 414594), 'devices_id': 13}, {'last_seen': datetime.datetime(2025, 12, 28, 17, 10, 28, 449471), 'devices_id': 14}]
2025-12-28 22:40:28,506 - sqlalchemy.engine.Engine - INFO - UPDATE scan_sessions SET completed_at=%(completed_at)s, total_devices_found=%(total_devices_found)s, status=%(status)s WHERE scan_sessions.id = %(scan_sessions_id)s
2025-12-28 22:40:28,508 - sqlalchemy.engine.Engine - INFO - [generated in 0.00225s] {'completed_at': datetime.datetime(2025, 12, 28, 17, 10, 28, 478491), 'total_devices_found': 9, 'status': 'completed', 'scan_sessions_id': 27}
2025-12-28 22:40:28,512 - sqlalchemy.engine.Engine - INFO - INSERT INTO device_activity (device_id, event_type, old_value, new_value, event_timestamp) VALUES (%(device_id)s, %(event_type)s, %(old_value)s, %(new_value)s, %(event_timestamp)s)
2025-12-28 22:40:28,514 - sqlalchemy.engine.Engine - INFO - [cached since 535.1s ago] {'device_id': 9, 'event_type': 'IP_CHANGED', 'old_value': '255.255.255.255', 'new_value': '10.18.154.255', 'event_timestamp': datetime.datetime(2025, 12, 28, 17, 10, 28, 512439)}
2025-12-28 22:40:28,517 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-28 22:40:28,522 - sqlalchemy.engine.Engine - INFO - [cached since 535.1s ago] {'device_id': 7, 'ip_address': '10.18.154.119', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 28, 17, 10, 28, 517207), 'is_connected': 1, 'response_time_ms': None}
2025-12-28 22:40:28,526 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-28 22:40:28,529 - sqlalchemy.engine.Engine - INFO - [cached since 535.1s ago] {'device_id': 8, 'ip_address': '10.18.154.151', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 28, 17, 10, 28, 526468), 'is_connected': 1, 'response_time_ms': None}
2025-12-28 22:40:28,532 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-28 22:40:28,534 - sqlalchemy.engine.Engine - INFO - [cached since 535.1s ago] {'device_id': 9, 'ip_address': '10.18.154.255', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 28, 17, 10, 28, 532903), 'is_connected': 1, 'response_time_ms': None}
2025-12-28 22:40:28,541 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-28 22:40:28,546 - sqlalchemy.engine.Engine - INFO - [cached since 535.1s ago] {'device_id': 10, 'ip_address': '224.0.0.22', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 28, 17, 10, 28, 541709), 'is_connected': 1, 'response_time_ms': None}
2025-12-28 22:40:28,550 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-28 22:40:28,556 - sqlalchemy.engine.Engine - INFO - [cached since 535.1s ago] {'device_id': 11, 'ip_address': '224.0.0.251', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 28, 17, 10, 28, 550435), 'is_connected': 1, 'response_time_ms': None}
2025-12-28 22:40:28,561 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-28 22:40:28,566 - sqlalchemy.engine.Engine - INFO - [cached since 535.1s ago] {'device_id': 12, 'ip_address': '224.0.0.252', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 28, 17, 10, 28, 561720), 'is_connected': 1, 'response_time_ms': None}
2025-12-28 22:40:28,569 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-28 22:40:28,575 - sqlalchemy.engine.Engine - INFO - [cached since 535.2s ago] {'device_id': 13, 'ip_address': '239.255.102.18', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 28, 17, 10, 28, 569761), 'is_connected': 1, 'response_time_ms': None}
2025-12-28 22:40:28,581 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-28 22:40:28,584 - sqlalchemy.engine.Engine - INFO - [cached since 535.2s ago] {'device_id': 14, 'ip_address': '239.255.255.250', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 28, 17, 10, 28, 581291), 'is_connected': 1, 'response_time_ms': None}
2025-12-28 22:40:28,590 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-28 22:40:28,592 - sqlalchemy.engine.Engine - INFO - [cached since 535.2s ago] {'device_id': 9, 'ip_address': '255.255.255.255', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 28, 17, 10, 28, 589953), 'is_connected': 1, 'response_time_ms': None}
2025-12-28 22:40:28,597 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:40:28,602 - app.routers.scans - INFO - Scan completed: 9 devices, 0 new
2025-12-28 22:40:28,617 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:28,620 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:28,625 - sqlalchemy.engine.Engine - INFO - [cached since 712.4s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:28,631 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:40:28,636 - sqlalchemy.engine.Engine - INFO - [cached since 712.4s ago] {}
2025-12-28 22:40:28,644 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:40:28,651 - sqlalchemy.engine.Engine - INFO - [cached since 712.4s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 17, 0, 28, 643239)}
2025-12-28 22:40:28,658 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:40:28,664 - sqlalchemy.engine.Engine - INFO - [cached since 712.4s ago] {}
2025-12-28 22:40:28,667 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:40:28,676 - sqlalchemy.engine.Engine - INFO - [cached since 712.4s ago] {}
2025-12-28 22:40:28,679 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:40:28,682 - sqlalchemy.engine.Engine - INFO - [cached since 712.4s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:40:28,685 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:40:28,697 - sqlalchemy.engine.Engine - INFO - [cached since 712.4s ago] {}
2025-12-28 22:40:28,700 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:40:28,709 - sqlalchemy.engine.Engine - INFO - [cached since 712.4s ago] {}
2025-12-28 22:40:28,712 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:40:28,716 - sqlalchemy.engine.Engine - INFO - [cached since 712.3s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:40:28,722 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:28,733 - sqlalchemy.engine.Engine - INFO - [cached since 712.3s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:40:28,739 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:40:28,743 - sqlalchemy.engine.Engine - INFO - [cached since 712.3s ago] {}
2025-12-28 22:40:28,750 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:28,772 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:28,780 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:28,785 - sqlalchemy.engine.Engine - INFO - [cached since 712.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:28,793 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:28,801 - sqlalchemy.engine.Engine - INFO - [cached since 626.5s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:40:28,811 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:28,822 - sqlalchemy.engine.Engine - INFO - [cached since 533.4s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 21, 17, 10, 28, 810559), 'param_1': 100}
2025-12-28 22:40:28,829 - app.database - ERROR - Database session error: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:28,833 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:28,842 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:28,844 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:28,850 - sqlalchemy.engine.Engine - INFO - [cached since 712.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:28,860 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:40:28,867 - sqlalchemy.engine.Engine - INFO - [cached since 712.6s ago] {}
2025-12-28 22:40:28,871 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:40:28,881 - sqlalchemy.engine.Engine - INFO - [cached since 712.6s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 17, 0, 28, 869839)}
2025-12-28 22:40:28,883 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:40:28,893 - sqlalchemy.engine.Engine - INFO - [cached since 712.6s ago] {}
2025-12-28 22:40:28,896 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:40:28,900 - sqlalchemy.engine.Engine - INFO - [cached since 712.6s ago] {}
2025-12-28 22:40:28,902 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:40:28,911 - sqlalchemy.engine.Engine - INFO - [cached since 712.6s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:40:28,915 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:40:28,918 - sqlalchemy.engine.Engine - INFO - [cached since 712.6s ago] {}
2025-12-28 22:40:28,926 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:40:28,931 - sqlalchemy.engine.Engine - INFO - [cached since 712.6s ago] {}
2025-12-28 22:40:28,933 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:40:28,942 - sqlalchemy.engine.Engine - INFO - [cached since 712.6s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:40:28,948 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:28,957 - sqlalchemy.engine.Engine - INFO - [cached since 712.6s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:40:28,961 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:40:28,964 - sqlalchemy.engine.Engine - INFO - [cached since 712.6s ago] {}
2025-12-28 22:40:28,968 - app.main - ERROR - Unhandled exception: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'connected'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\devices.py", line 246, in get_device_history
    ).order_by(DeviceActivity.event_timestamp.desc()).limit(100).all()
                                                                 ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:29,103 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:29,112 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:29,114 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:29,121 - sqlalchemy.engine.Engine - INFO - [cached since 712.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:29,126 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:40:29,133 - sqlalchemy.engine.Engine - INFO - [cached since 712.9s ago] {}
2025-12-28 22:40:29,137 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:40:29,145 - sqlalchemy.engine.Engine - INFO - [cached since 712.9s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 17, 0, 29, 135316)}
2025-12-28 22:40:29,148 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:40:29,155 - sqlalchemy.engine.Engine - INFO - [cached since 712.9s ago] {}
2025-12-28 22:40:29,158 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:40:29,163 - sqlalchemy.engine.Engine - INFO - [cached since 712.9s ago] {}
2025-12-28 22:40:29,166 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:40:29,174 - sqlalchemy.engine.Engine - INFO - [cached since 712.9s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:40:29,176 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:40:29,181 - sqlalchemy.engine.Engine - INFO - [cached since 712.8s ago] {}
2025-12-28 22:40:29,183 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:40:29,192 - sqlalchemy.engine.Engine - INFO - [cached since 712.8s ago] {}
2025-12-28 22:40:29,196 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:40:29,201 - sqlalchemy.engine.Engine - INFO - [cached since 712.8s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:40:29,207 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:29,213 - sqlalchemy.engine.Engine - INFO - [cached since 712.8s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:40:29,216 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:40:29,218 - sqlalchemy.engine.Engine - INFO - [cached since 712.8s ago] {}
2025-12-28 22:40:29,226 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:29,230 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:29,235 - sqlalchemy.engine.Engine - INFO - [cached since 713s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:29,242 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:29,251 - sqlalchemy.engine.Engine - INFO - [cached since 626.9s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:40:29,255 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:29,263 - sqlalchemy.engine.Engine - INFO - [cached since 533.9s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 21, 17, 10, 29, 254765), 'param_1': 100}
2025-12-28 22:40:29,267 - app.database - ERROR - Database session error: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:29,267 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:29,270 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:29,273 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:29,279 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:29,300 - sqlalchemy.engine.Engine - INFO - [cached since 713.1s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:29,311 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:40:29,327 - sqlalchemy.engine.Engine - INFO - [cached since 713.1s ago] {}
2025-12-28 22:40:29,335 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:40:29,350 - sqlalchemy.engine.Engine - INFO - [cached since 713.1s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 17, 0, 29, 334365)}
2025-12-28 22:40:29,359 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:40:29,374 - sqlalchemy.engine.Engine - INFO - [cached since 713.1s ago] {}
2025-12-28 22:40:29,382 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:40:29,393 - sqlalchemy.engine.Engine - INFO - [cached since 713.1s ago] {}
2025-12-28 22:40:29,401 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:40:29,411 - sqlalchemy.engine.Engine - INFO - [cached since 713.1s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:40:29,416 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:40:29,426 - sqlalchemy.engine.Engine - INFO - [cached since 713.1s ago] {}
2025-12-28 22:40:29,431 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:40:29,439 - sqlalchemy.engine.Engine - INFO - [cached since 713.1s ago] {}
2025-12-28 22:40:29,443 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:40:29,451 - sqlalchemy.engine.Engine - INFO - [cached since 713.1s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:40:29,460 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:29,468 - sqlalchemy.engine.Engine - INFO - [cached since 713.1s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:40:29,475 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:40:29,478 - sqlalchemy.engine.Engine - INFO - [cached since 713.1s ago] {}
2025-12-28 22:40:29,482 - app.main - ERROR - Unhandled exception: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'connected'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\devices.py", line 246, in get_device_history
    ).order_by(DeviceActivity.event_timestamp.desc()).limit(100).all()
                                                                 ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:29,601 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:29,609 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:29,611 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:29,614 - sqlalchemy.engine.Engine - INFO - [cached since 713.4s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:29,616 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:40:29,625 - sqlalchemy.engine.Engine - INFO - [cached since 713.4s ago] {}
2025-12-28 22:40:29,628 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:40:29,632 - sqlalchemy.engine.Engine - INFO - [cached since 713.4s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 17, 0, 29, 627171)}
2025-12-28 22:40:29,635 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:40:29,648 - sqlalchemy.engine.Engine - INFO - [cached since 713.4s ago] {}
2025-12-28 22:40:29,652 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:40:29,665 - sqlalchemy.engine.Engine - INFO - [cached since 713.4s ago] {}
2025-12-28 22:40:29,668 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:40:29,679 - sqlalchemy.engine.Engine - INFO - [cached since 713.4s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:40:29,684 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:40:29,693 - sqlalchemy.engine.Engine - INFO - [cached since 713.4s ago] {}
2025-12-28 22:40:29,696 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:40:29,706 - sqlalchemy.engine.Engine - INFO - [cached since 713.4s ago] {}
2025-12-28 22:40:29,709 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:40:29,718 - sqlalchemy.engine.Engine - INFO - [cached since 713.3s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:40:29,725 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:29,732 - sqlalchemy.engine.Engine - INFO - [cached since 713.3s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:40:29,738 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:40:29,742 - sqlalchemy.engine.Engine - INFO - [cached since 713.3s ago] {}
2025-12-28 22:40:29,747 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:29,750 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:29,762 - sqlalchemy.engine.Engine - INFO - [cached since 713.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:29,774 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:29,780 - sqlalchemy.engine.Engine - INFO - [cached since 627.4s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:40:29,784 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:29,791 - sqlalchemy.engine.Engine - INFO - [cached since 534.4s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 21, 17, 10, 29, 784203), 'param_1': 100}
2025-12-28 22:40:29,795 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:29,796 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:29,799 - sqlalchemy.engine.Engine - INFO - [cached since 713.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:29,804 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:29,808 - sqlalchemy.engine.Engine - INFO - [cached since 627.5s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:40:29,811 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:29,815 - sqlalchemy.engine.Engine - INFO - [cached since 534.4s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 21, 17, 10, 29, 811084), 'param_1': 100}
2025-12-28 22:40:29,822 - app.database - ERROR - Database session error: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:29,821 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:29,826 - app.database - ERROR - Database session error: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:29,826 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:29,830 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:29,831 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:29,833 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:29,841 - sqlalchemy.engine.Engine - INFO - [cached since 713.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:29,846 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:40:29,850 - sqlalchemy.engine.Engine - INFO - [cached since 713.6s ago] {}
2025-12-28 22:40:29,860 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:40:29,865 - sqlalchemy.engine.Engine - INFO - [cached since 713.6s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 17, 0, 29, 858939)}
2025-12-28 22:40:29,868 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:40:29,877 - sqlalchemy.engine.Engine - INFO - [cached since 713.6s ago] {}
2025-12-28 22:40:29,880 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:40:29,885 - sqlalchemy.engine.Engine - INFO - [cached since 713.6s ago] {}
2025-12-28 22:40:29,890 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:40:29,897 - sqlalchemy.engine.Engine - INFO - [cached since 713.6s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:40:29,899 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:40:29,924 - sqlalchemy.engine.Engine - INFO - [cached since 713.6s ago] {}
2025-12-28 22:40:29,931 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:40:29,956 - sqlalchemy.engine.Engine - INFO - [cached since 713.6s ago] {}
2025-12-28 22:40:29,962 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:40:29,983 - sqlalchemy.engine.Engine - INFO - [cached since 713.6s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:40:29,992 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:30,001 - sqlalchemy.engine.Engine - INFO - [cached since 713.6s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:40:30,009 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:40:30,014 - sqlalchemy.engine.Engine - INFO - [cached since 713.6s ago] {}
2025-12-28 22:40:30,024 - app.main - ERROR - Unhandled exception: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'connected'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\devices.py", line 246, in get_device_history
    ).order_by(DeviceActivity.event_timestamp.desc()).limit(100).all()
                                                                 ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:30,158 - app.main - ERROR - Unhandled exception: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'connected'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\devices.py", line 246, in get_device_history
    ).order_by(DeviceActivity.event_timestamp.desc()).limit(100).all()
                                                                 ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:30,262 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:30,266 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:30,267 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:30,277 - sqlalchemy.engine.Engine - INFO - [cached since 714.1s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:30,283 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:30,294 - sqlalchemy.engine.Engine - INFO - [cached since 713.8s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 17, 10, 30, 283051), 'param_1': 100}
2025-12-28 22:40:30,300 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:30,304 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:30,313 - sqlalchemy.engine.Engine - INFO - [cached since 714.1s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:30,398 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:40:30,422 - sqlalchemy.engine.Engine - INFO - [cached since 714.2s ago] {}
2025-12-28 22:40:30,458 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:40:30,468 - sqlalchemy.engine.Engine - INFO - [cached since 714.2s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 17, 0, 30, 457784)}
2025-12-28 22:40:30,547 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:40:30,592 - sqlalchemy.engine.Engine - INFO - [cached since 714.3s ago] {}
2025-12-28 22:40:30,600 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:40:30,613 - sqlalchemy.engine.Engine - INFO - [cached since 714.3s ago] {}
2025-12-28 22:40:30,617 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:40:30,665 - sqlalchemy.engine.Engine - INFO - [cached since 714.3s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:40:30,678 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:40:30,682 - sqlalchemy.engine.Engine - INFO - [cached since 714.3s ago] {}
2025-12-28 22:40:30,688 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:40:30,696 - sqlalchemy.engine.Engine - INFO - [cached since 714.3s ago] {}
2025-12-28 22:40:30,701 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:40:30,715 - sqlalchemy.engine.Engine - INFO - [cached since 714.3s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:40:30,722 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:30,732 - sqlalchemy.engine.Engine - INFO - [cached since 714.3s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:40:30,737 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:40:30,741 - sqlalchemy.engine.Engine - INFO - [cached since 714.3s ago] {}
2025-12-28 22:40:30,747 - app.database - ERROR - Database session error: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:30,752 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:30,754 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:30,755 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:30,760 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:30,780 - sqlalchemy.engine.Engine - INFO - [cached since 714.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:30,786 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:30,795 - sqlalchemy.engine.Engine - INFO - [cached since 628.5s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:40:30,800 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:30,810 - sqlalchemy.engine.Engine - INFO - [cached since 535.4s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 21, 17, 10, 30, 799346), 'param_1': 100}
2025-12-28 22:40:30,817 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:30,821 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:30,827 - sqlalchemy.engine.Engine - INFO - [cached since 714.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:30,831 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:30,838 - sqlalchemy.engine.Engine - INFO - [cached since 628.5s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:40:30,842 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:30,849 - sqlalchemy.engine.Engine - INFO - [cached since 535.4s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 21, 17, 10, 30, 842080), 'param_1': 100}
2025-12-28 22:40:30,854 - app.main - ERROR - Unhandled exception: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'ip_changed'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\dashboard.py", line 96, in get_activity_timeline
    ).order_by(DeviceActivity.event_timestamp.desc()).limit(100).all()
                                                                 ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:30,980 - app.database - ERROR - Database session error: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:30,982 - app.database - ERROR - Database session error: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:30,984 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:30,984 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:30,990 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:30,992 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:30,999 - sqlalchemy.engine.Engine - INFO - [cached since 714.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:31,004 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:31,013 - sqlalchemy.engine.Engine - INFO - [cached since 714.5s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 17, 10, 31, 3105), 'param_1': 100}
2025-12-28 22:40:31,017 - app.main - ERROR - Unhandled exception: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'connected'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\devices.py", line 246, in get_device_history
    ).order_by(DeviceActivity.event_timestamp.desc()).limit(100).all()
                                                                 ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:31,125 - app.main - ERROR - Unhandled exception: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'connected'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\devices.py", line 246, in get_device_history
    ).order_by(DeviceActivity.event_timestamp.desc()).limit(100).all()
                                                                 ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:31,226 - app.database - ERROR - Database session error: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:31,229 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:31,230 - app.main - ERROR - Unhandled exception: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'ip_changed'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\dashboard.py", line 96, in get_activity_timeline
    ).order_by(DeviceActivity.event_timestamp.desc()).limit(100).all()
                                                                 ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:31,351 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:31,355 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:31,362 - sqlalchemy.engine.Engine - INFO - [cached since 715.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:31,365 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:40:31,376 - sqlalchemy.engine.Engine - INFO - [cached since 715.1s ago] {}
2025-12-28 22:40:31,379 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:40:31,383 - sqlalchemy.engine.Engine - INFO - [cached since 715.1s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 17, 0, 31, 378478)}
2025-12-28 22:40:31,390 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:40:31,395 - sqlalchemy.engine.Engine - INFO - [cached since 715.1s ago] {}
2025-12-28 22:40:31,398 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:40:31,404 - sqlalchemy.engine.Engine - INFO - [cached since 715.1s ago] {}
2025-12-28 22:40:31,408 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:40:31,413 - sqlalchemy.engine.Engine - INFO - [cached since 715.1s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:40:31,417 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:40:31,426 - sqlalchemy.engine.Engine - INFO - [cached since 715.1s ago] {}
2025-12-28 22:40:31,429 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:40:31,433 - sqlalchemy.engine.Engine - INFO - [cached since 715.1s ago] {}
2025-12-28 22:40:31,437 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:40:31,446 - sqlalchemy.engine.Engine - INFO - [cached since 715.1s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:40:31,449 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:31,459 - sqlalchemy.engine.Engine - INFO - [cached since 715.1s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:40:31,463 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:40:31,464 - sqlalchemy.engine.Engine - INFO - [cached since 715.1s ago] {}
2025-12-28 22:40:31,469 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:31,477 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:31,480 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:31,493 - sqlalchemy.engine.Engine - INFO - [cached since 715.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:31,498 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:31,503 - sqlalchemy.engine.Engine - INFO - [cached since 629.2s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:40:31,511 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:31,515 - sqlalchemy.engine.Engine - INFO - [cached since 536.1s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 21, 17, 10, 31, 510485), 'param_1': 100}
2025-12-28 22:40:31,518 - app.database - ERROR - Database session error: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:31,522 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:31,524 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:31,525 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:31,530 - sqlalchemy.engine.Engine - INFO - [cached since 715.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:31,532 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:31,543 - sqlalchemy.engine.Engine - INFO - [cached since 715.1s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 17, 10, 31, 532262), 'param_1': 100}
2025-12-28 22:40:31,549 - app.main - ERROR - Unhandled exception: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'connected'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\devices.py", line 246, in get_device_history
    ).order_by(DeviceActivity.event_timestamp.desc()).limit(100).all()
                                                                 ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:31,673 - app.database - ERROR - Database session error: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:31,675 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:31,678 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:31,680 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:31,683 - sqlalchemy.engine.Engine - INFO - [cached since 715.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:31,687 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:31,695 - sqlalchemy.engine.Engine - INFO - [cached since 629.4s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:40:31,700 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:31,707 - sqlalchemy.engine.Engine - INFO - [cached since 536.3s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 21, 17, 10, 31, 699312), 'param_1': 100}
2025-12-28 22:40:31,712 - app.main - ERROR - Unhandled exception: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'ip_changed'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\dashboard.py", line 96, in get_activity_timeline
    ).order_by(DeviceActivity.event_timestamp.desc()).limit(100).all()
                                                                 ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:31,833 - app.database - ERROR - Database session error: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:31,836 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:31,840 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:31,844 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:31,851 - sqlalchemy.engine.Engine - INFO - [cached since 715.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:31,859 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:31,868 - sqlalchemy.engine.Engine - INFO - [cached since 715.4s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 17, 10, 31, 858622), 'param_1': 100}
2025-12-28 22:40:31,882 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:31,884 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:31,894 - sqlalchemy.engine.Engine - INFO - [cached since 715.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:31,899 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:31,910 - sqlalchemy.engine.Engine - INFO - [cached since 715.4s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 17, 10, 31, 898532), 'param_1': 100}
2025-12-28 22:40:31,915 - app.main - ERROR - Unhandled exception: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'connected'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\devices.py", line 246, in get_device_history
    ).order_by(DeviceActivity.event_timestamp.desc()).limit(100).all()
                                                                 ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:32,064 - app.database - ERROR - Database session error: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:32,065 - app.database - ERROR - Database session error: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:32,067 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:32,070 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:32,073 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:32,076 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:32,082 - sqlalchemy.engine.Engine - INFO - [cached since 715.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:32,086 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:40:32,094 - sqlalchemy.engine.Engine - INFO - [cached since 715.9s ago] {}
2025-12-28 22:40:32,097 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-28 22:40:32,103 - sqlalchemy.engine.Engine - INFO - [cached since 715.8s ago] {'last_seen_1': datetime.datetime(2025, 12, 28, 17, 0, 32, 96528)}
2025-12-28 22:40:32,108 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-28 22:40:32,113 - sqlalchemy.engine.Engine - INFO - [cached since 715.8s ago] {}
2025-12-28 22:40:32,116 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-28 22:40:32,125 - sqlalchemy.engine.Engine - INFO - [cached since 715.8s ago] {}
2025-12-28 22:40:32,128 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-28 22:40:32,132 - sqlalchemy.engine.Engine - INFO - [cached since 715.8s ago] {'first_seen_1': datetime.datetime(2025, 12, 28, 0, 0)}
2025-12-28 22:40:32,135 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:40:32,146 - sqlalchemy.engine.Engine - INFO - [cached since 715.8s ago] {}
2025-12-28 22:40:32,149 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:40:32,163 - sqlalchemy.engine.Engine - INFO - [cached since 715.8s ago] {}
2025-12-28 22:40:32,167 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-28 22:40:32,184 - sqlalchemy.engine.Engine - INFO - [cached since 715.8s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>}
2025-12-28 22:40:32,191 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:32,197 - sqlalchemy.engine.Engine - INFO - [cached since 715.8s ago] {'status_1': <ScanStatus.COMPLETED: 'completed'>, 'param_1': 1}
2025-12-28 22:40:32,203 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-28 22:40:32,206 - sqlalchemy.engine.Engine - INFO - [cached since 715.8s ago] {}
2025-12-28 22:40:32,210 - app.main - ERROR - Unhandled exception: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'ip_changed'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\dashboard.py", line 96, in get_activity_timeline
    ).order_by(DeviceActivity.event_timestamp.desc()).limit(100).all()
                                                                 ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:32,328 - app.main - ERROR - Unhandled exception: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'ip_changed'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\dashboard.py", line 96, in get_activity_timeline
    ).order_by(DeviceActivity.event_timestamp.desc()).limit(100).all()
                                                                 ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:32,464 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:32,472 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:32,476 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:32,489 - sqlalchemy.engine.Engine - INFO - [cached since 716.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:32,494 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:32,498 - sqlalchemy.engine.Engine - INFO - [cached since 716s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 17, 10, 32, 493156), 'param_1': 100}
2025-12-28 22:40:32,505 - app.database - ERROR - Database session error: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:32,507 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:32,509 - app.main - ERROR - Unhandled exception: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'ip_changed'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\dashboard.py", line 96, in get_activity_timeline
    ).order_by(DeviceActivity.event_timestamp.desc()).limit(100).all()
                                                                 ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:32,832 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:32,942 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:33,021 - sqlalchemy.engine.Engine - INFO - [cached since 716.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:33,166 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:33,211 - sqlalchemy.engine.Engine - INFO - [cached since 716.7s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 17, 10, 33, 165075), 'param_1': 100}
2025-12-28 22:40:33,220 - app.database - ERROR - Database session error: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:33,225 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:33,229 - app.main - ERROR - Unhandled exception: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'ip_changed'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\dashboard.py", line 96, in get_activity_timeline
    ).order_by(DeviceActivity.event_timestamp.desc()).limit(100).all()
                                                                 ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:33,470 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:33,473 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:33,482 - sqlalchemy.engine.Engine - INFO - [cached since 717.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:33,488 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:33,496 - sqlalchemy.engine.Engine - INFO - [cached since 717s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 27, 17, 10, 33, 487774), 'param_1': 100}
2025-12-28 22:40:33,505 - app.database - ERROR - Database session error: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:33,507 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:33,509 - app.main - ERROR - Unhandled exception: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'ip_changed'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\dashboard.py", line 96, in get_activity_timeline
    ).order_by(DeviceActivity.event_timestamp.desc()).limit(100).all()
                                                                 ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'ip_changed' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:33,907 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:33,953 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:34,027 - sqlalchemy.engine.Engine - INFO - [cached since 717.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:34,097 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:40:34,128 - sqlalchemy.engine.Engine - INFO - [cached since 717.9s ago] {}
2025-12-28 22:40:34,133 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-28 22:40:34,145 - sqlalchemy.engine.Engine - INFO - [cached since 527.9s ago] {'param_1': 0, 'param_2': 20}
2025-12-28 22:40:34,152 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:34,162 - sqlalchemy.engine.Engine - INFO - [cached since 540.1s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-28 22:40:34,185 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:34,199 - sqlalchemy.engine.Engine - INFO - [cached since 540.1s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-28 22:40:34,223 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:34,232 - sqlalchemy.engine.Engine - INFO - [cached since 540.2s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-28 22:40:34,237 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:34,248 - sqlalchemy.engine.Engine - INFO - [cached since 540.2s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-28 22:40:34,257 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:34,266 - sqlalchemy.engine.Engine - INFO - [cached since 540.2s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-28 22:40:34,275 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:34,291 - sqlalchemy.engine.Engine - INFO - [cached since 540.2s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-28 22:40:34,315 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:34,331 - sqlalchemy.engine.Engine - INFO - [cached since 540.3s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-28 22:40:34,336 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:34,347 - sqlalchemy.engine.Engine - INFO - [cached since 540.3s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-28 22:40:34,357 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:34,360 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:34,364 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:34,380 - sqlalchemy.engine.Engine - INFO - [cached since 718.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:34,387 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:40:34,410 - sqlalchemy.engine.Engine - INFO - [cached since 718.2s ago] {}
2025-12-28 22:40:34,424 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-28 22:40:34,461 - sqlalchemy.engine.Engine - INFO - [cached since 528.2s ago] {'param_1': 0, 'param_2': 20}
2025-12-28 22:40:34,472 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:34,489 - sqlalchemy.engine.Engine - INFO - [cached since 540.4s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-28 22:40:34,496 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:34,508 - sqlalchemy.engine.Engine - INFO - [cached since 540.4s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-28 22:40:34,514 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:34,525 - sqlalchemy.engine.Engine - INFO - [cached since 540.4s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-28 22:40:34,531 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:34,542 - sqlalchemy.engine.Engine - INFO - [cached since 540.5s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-28 22:40:34,547 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:34,558 - sqlalchemy.engine.Engine - INFO - [cached since 540.5s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-28 22:40:34,563 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:34,573 - sqlalchemy.engine.Engine - INFO - [cached since 540.5s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-28 22:40:34,579 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:34,594 - sqlalchemy.engine.Engine - INFO - [cached since 540.5s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-28 22:40:34,599 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:34,612 - sqlalchemy.engine.Engine - INFO - [cached since 540.5s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-28 22:40:34,630 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:36,207 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:36,208 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:36,210 - sqlalchemy.engine.Engine - INFO - [cached since 720s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:36,213 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:36,223 - sqlalchemy.engine.Engine - INFO - [cached since 633.9s ago] {'id_1': 7, 'param_1': 1}
2025-12-28 22:40:36,226 - app.database - ERROR - Database session error: 400: ML models not trained. Train models first.
2025-12-28 22:40:36,227 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:38,858 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:38,860 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:38,862 - sqlalchemy.engine.Engine - INFO - [cached since 722.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:38,869 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:38,876 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:38,881 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:38,906 - sqlalchemy.engine.Engine - INFO - [cached since 722.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:38,913 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:40,377 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:40,379 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:40,387 - sqlalchemy.engine.Engine - INFO - [cached since 724.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:40,392 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices
2025-12-28 22:40:40,396 - sqlalchemy.engine.Engine - INFO - [cached since 461.1s ago] {}
2025-12-28 22:40:40,398 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-28 22:40:40,406 - sqlalchemy.engine.Engine - INFO - [cached since 461.1s ago] {'device_id_1': 7}
2025-12-28 22:40:40,409 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-28 22:40:40,413 - sqlalchemy.engine.Engine - INFO - [cached since 461.1s ago] {'device_id_1': 7}
2025-12-28 22:40:40,415 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:40,420 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:40,424 - sqlalchemy.engine.Engine - INFO - [cached since 724.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:40,428 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices
2025-12-28 22:40:40,431 - sqlalchemy.engine.Engine - INFO - [cached since 461.1s ago] {}
2025-12-28 22:40:40,436 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-28 22:40:40,443 - sqlalchemy.engine.Engine - INFO - [cached since 461.1s ago] {'device_id_1': 7}
2025-12-28 22:40:40,446 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-28 22:40:40,449 - sqlalchemy.engine.Engine - INFO - [cached since 461.1s ago] {'device_id_1': 7}
2025-12-28 22:40:40,455 - app.database - ERROR - Database session error: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:40,456 - app.database - ERROR - Database session error: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:40,457 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:40,458 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:40,461 - app.main - ERROR - Unhandled exception: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'connected'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\dashboard.py", line 164, in train_ml_models
    ).all()
      ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:40,577 - app.main - ERROR - Unhandled exception: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'connected'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\dashboard.py", line 164, in train_ml_models
    ).all()
      ~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'connected' is not among the defined enum values. Enum name: eventtype. Possible values: CONNECTED, DISCONNECTE.., IP_CHANGED, HOSTNAME_CH..
2025-12-28 22:40:45,086 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:45,087 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:45,089 - sqlalchemy.engine.Engine - INFO - [cached since 728.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:45,092 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:40:45,097 - sqlalchemy.engine.Engine - INFO - [cached since 728.8s ago] {}
2025-12-28 22:40:45,104 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:40:45,111 - sqlalchemy.engine.Engine - INFO - [cached since 728.8s ago] {}
2025-12-28 22:40:45,114 - sqlalchemy.engine.Engine - INFO - SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts ORDER BY alerts.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-28 22:40:45,123 - sqlalchemy.engine.Engine - INFO - [cached since 46.55s ago] {'param_1': 0, 'param_2': 20}
2025-12-28 22:40:45,128 - app.database - ERROR - Database session error: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
2025-12-28 22:40:45,129 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:45,131 - app.main - ERROR - Unhandled exception: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'new_device'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\alerts.py", line 65, in list_alerts
    alerts = query.offset(offset).limit(page_size).all()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
2025-12-28 22:40:45,338 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:45,341 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:45,347 - sqlalchemy.engine.Engine - INFO - [cached since 729.1s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:45,358 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:40:45,373 - sqlalchemy.engine.Engine - INFO - [cached since 729s ago] {}
2025-12-28 22:40:45,377 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:40:45,390 - sqlalchemy.engine.Engine - INFO - [cached since 729s ago] {}
2025-12-28 22:40:45,393 - sqlalchemy.engine.Engine - INFO - SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts ORDER BY alerts.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-28 22:40:45,405 - sqlalchemy.engine.Engine - INFO - [cached since 46.83s ago] {'param_1': 0, 'param_2': 20}
2025-12-28 22:40:45,410 - app.database - ERROR - Database session error: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
2025-12-28 22:40:45,412 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:45,416 - app.main - ERROR - Unhandled exception: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'new_device'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\alerts.py", line 65, in list_alerts
    alerts = query.offset(offset).limit(page_size).all()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
2025-12-28 22:40:47,655 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:47,656 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:47,658 - sqlalchemy.engine.Engine - INFO - [cached since 731.4s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:47,662 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:47,670 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:47,675 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:47,691 - sqlalchemy.engine.Engine - INFO - [cached since 731.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:47,699 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:48,788 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:48,789 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:48,792 - sqlalchemy.engine.Engine - INFO - [cached since 732.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:48,796 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:40:48,809 - sqlalchemy.engine.Engine - INFO - [cached since 732.5s ago] {}
2025-12-28 22:40:48,812 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:40:48,823 - sqlalchemy.engine.Engine - INFO - [cached since 732.5s ago] {}
2025-12-28 22:40:48,828 - sqlalchemy.engine.Engine - INFO - SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts ORDER BY alerts.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-28 22:40:48,840 - sqlalchemy.engine.Engine - INFO - [cached since 50.27s ago] {'param_1': 0, 'param_2': 20}
2025-12-28 22:40:48,846 - app.database - ERROR - Database session error: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
2025-12-28 22:40:48,852 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:48,855 - app.main - ERROR - Unhandled exception: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'new_device'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\alerts.py", line 65, in list_alerts
    alerts = query.offset(offset).limit(page_size).all()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
2025-12-28 22:40:48,996 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:49,004 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:49,011 - sqlalchemy.engine.Engine - INFO - [cached since 732.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:49,023 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:40:49,031 - sqlalchemy.engine.Engine - INFO - [cached since 732.7s ago] {}
2025-12-28 22:40:49,040 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:40:49,053 - sqlalchemy.engine.Engine - INFO - [cached since 732.7s ago] {}
2025-12-28 22:40:49,057 - sqlalchemy.engine.Engine - INFO - SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts ORDER BY alerts.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-28 22:40:49,071 - sqlalchemy.engine.Engine - INFO - [cached since 50.5s ago] {'param_1': 0, 'param_2': 20}
2025-12-28 22:40:49,079 - app.database - ERROR - Database session error: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
2025-12-28 22:40:49,085 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:49,088 - app.main - ERROR - Unhandled exception: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'new_device'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\alerts.py", line 65, in list_alerts
    alerts = query.offset(offset).limit(page_size).all()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
2025-12-28 22:40:49,520 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:49,522 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:49,525 - sqlalchemy.engine.Engine - INFO - [cached since 733.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:49,528 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:40:49,541 - sqlalchemy.engine.Engine - INFO - [cached since 733.2s ago] {}
2025-12-28 22:40:49,549 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:40:49,571 - sqlalchemy.engine.Engine - INFO - [cached since 733.2s ago] {}
2025-12-28 22:40:49,575 - sqlalchemy.engine.Engine - INFO - SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts ORDER BY alerts.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-28 22:40:49,585 - sqlalchemy.engine.Engine - INFO - [cached since 51.01s ago] {'param_1': 0, 'param_2': 20}
2025-12-28 22:40:49,590 - app.database - ERROR - Database session error: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
2025-12-28 22:40:49,592 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:49,594 - app.main - ERROR - Unhandled exception: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'new_device'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\alerts.py", line 65, in list_alerts
    alerts = query.offset(offset).limit(page_size).all()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
2025-12-28 22:40:50,199 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:50,204 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:50,213 - sqlalchemy.engine.Engine - INFO - [cached since 734s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:50,230 - sqlalchemy.engine.Engine - INFO - UPDATE alerts SET is_acknowledged=%(is_acknowledged)s, acknowledged_by=%(acknowledged_by)s, acknowledged_at=%(acknowledged_at)s WHERE alerts.is_acknowledged = false
2025-12-28 22:40:50,239 - sqlalchemy.engine.Engine - INFO - [generated in 0.00860s] {'is_acknowledged': 1, 'acknowledged_by': 1, 'acknowledged_at': datetime.datetime(2025, 12, 28, 17, 10, 50, 224810)}
2025-12-28 22:40:50,270 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:40:50,278 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:50,281 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-28 22:40:50,296 - sqlalchemy.engine.Engine - INFO - [cached since 638.9s ago] {'pk_1': 1}
2025-12-28 22:40:50,306 - app.routers.alerts - INFO - 8 alerts acknowledged by admin
2025-12-28 22:40:50,310 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:50,317 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:50,323 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:50,335 - sqlalchemy.engine.Engine - INFO - [cached since 734.1s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:50,341 - sqlalchemy.engine.Engine - INFO - UPDATE alerts SET is_acknowledged=%(is_acknowledged)s, acknowledged_by=%(acknowledged_by)s, acknowledged_at=%(acknowledged_at)s WHERE alerts.is_acknowledged = false
2025-12-28 22:40:50,344 - sqlalchemy.engine.Engine - INFO - [cached since 0.1139s ago] {'is_acknowledged': 1, 'acknowledged_by': 1, 'acknowledged_at': datetime.datetime(2025, 12, 28, 17, 10, 50, 339994)}
2025-12-28 22:40:50,351 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:40:50,354 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:50,356 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-28 22:40:50,360 - sqlalchemy.engine.Engine - INFO - [cached since 639s ago] {'pk_1': 1}
2025-12-28 22:40:50,365 - app.routers.alerts - INFO - 0 alerts acknowledged by admin
2025-12-28 22:40:50,370 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:50,375 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:50,379 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:50,386 - sqlalchemy.engine.Engine - INFO - [cached since 734.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:50,392 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:40:50,405 - sqlalchemy.engine.Engine - INFO - [cached since 734.1s ago] {}
2025-12-28 22:40:50,411 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:40:50,426 - sqlalchemy.engine.Engine - INFO - [cached since 734.1s ago] {}
2025-12-28 22:40:50,430 - sqlalchemy.engine.Engine - INFO - SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts ORDER BY alerts.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-28 22:40:50,446 - sqlalchemy.engine.Engine - INFO - [cached since 51.87s ago] {'param_1': 0, 'param_2': 20}
2025-12-28 22:40:50,455 - app.database - ERROR - Database session error: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
2025-12-28 22:40:50,456 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:50,459 - app.main - ERROR - Unhandled exception: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'new_device'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\alerts.py", line 65, in list_alerts
    alerts = query.offset(offset).limit(page_size).all()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
2025-12-28 22:40:50,660 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:50,663 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:50,673 - sqlalchemy.engine.Engine - INFO - [cached since 734.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:50,678 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:40:50,687 - sqlalchemy.engine.Engine - INFO - [cached since 734.4s ago] {}
2025-12-28 22:40:50,690 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:40:50,696 - sqlalchemy.engine.Engine - INFO - [cached since 734.3s ago] {}
2025-12-28 22:40:50,703 - sqlalchemy.engine.Engine - INFO - SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts ORDER BY alerts.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-28 22:40:50,710 - sqlalchemy.engine.Engine - INFO - [cached since 52.14s ago] {'param_1': 0, 'param_2': 20}
2025-12-28 22:40:50,715 - app.database - ERROR - Database session error: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
2025-12-28 22:40:50,718 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:50,720 - app.main - ERROR - Unhandled exception: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'new_device'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\alerts.py", line 65, in list_alerts
    alerts = query.offset(offset).limit(page_size).all()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
2025-12-28 22:40:55,539 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:55,542 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:55,553 - sqlalchemy.engine.Engine - INFO - [cached since 739.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:55,560 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:40:55,569 - sqlalchemy.engine.Engine - INFO - [cached since 739.3s ago] {}
2025-12-28 22:40:55,573 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-28 22:40:55,585 - sqlalchemy.engine.Engine - INFO - [cached since 549.3s ago] {'param_1': 0, 'param_2': 20}
2025-12-28 22:40:55,590 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:55,595 - sqlalchemy.engine.Engine - INFO - [cached since 561.5s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-28 22:40:55,604 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:55,609 - sqlalchemy.engine.Engine - INFO - [cached since 561.5s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-28 22:40:55,614 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:55,626 - sqlalchemy.engine.Engine - INFO - [cached since 561.5s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-28 22:40:55,630 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:55,642 - sqlalchemy.engine.Engine - INFO - [cached since 561.6s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-28 22:40:55,646 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:55,659 - sqlalchemy.engine.Engine - INFO - [cached since 561.6s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-28 22:40:55,665 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:55,674 - sqlalchemy.engine.Engine - INFO - [cached since 561.6s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-28 22:40:55,677 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:55,688 - sqlalchemy.engine.Engine - INFO - [cached since 561.6s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-28 22:40:55,691 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:55,699 - sqlalchemy.engine.Engine - INFO - [cached since 561.6s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-28 22:40:55,705 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:40:55,709 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:40:55,711 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:40:55,718 - sqlalchemy.engine.Engine - INFO - [cached since 739.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:40:55,725 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:40:55,736 - sqlalchemy.engine.Engine - INFO - [cached since 739.5s ago] {}
2025-12-28 22:40:55,741 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-28 22:40:55,761 - sqlalchemy.engine.Engine - INFO - [cached since 549.5s ago] {'param_1': 0, 'param_2': 20}
2025-12-28 22:40:55,773 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:55,783 - sqlalchemy.engine.Engine - INFO - [cached since 561.7s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-28 22:40:55,787 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:55,794 - sqlalchemy.engine.Engine - INFO - [cached since 561.7s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-28 22:40:55,802 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:55,809 - sqlalchemy.engine.Engine - INFO - [cached since 561.7s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-28 22:40:55,817 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:55,824 - sqlalchemy.engine.Engine - INFO - [cached since 561.7s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-28 22:40:55,827 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:55,837 - sqlalchemy.engine.Engine - INFO - [cached since 561.8s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-28 22:40:55,840 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:55,844 - sqlalchemy.engine.Engine - INFO - [cached since 561.8s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-28 22:40:55,848 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:55,866 - sqlalchemy.engine.Engine - INFO - [cached since 561.8s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-28 22:40:55,875 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:40:55,892 - sqlalchemy.engine.Engine - INFO - [cached since 561.8s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-28 22:40:55,901 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:41:08,904 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:41:08,906 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:41:08,909 - sqlalchemy.engine.Engine - INFO - [cached since 752.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:41:08,916 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:41:08,921 - sqlalchemy.engine.Engine - INFO - [cached since 666.6s ago] {'id_1': 14, 'param_1': 1}
2025-12-28 22:41:08,923 - app.database - ERROR - Database session error: 400: ML models not trained. Train models first.
2025-12-28 22:41:08,924 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:48:21,283 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:48:21,284 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:48:21,295 - sqlalchemy.engine.Engine - INFO - [cached since 1185s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:48:21,302 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:48:21,311 - sqlalchemy.engine.Engine - INFO - [cached since 1099s ago] {'id_1': 10, 'param_1': 1}
2025-12-28 22:48:21,315 - sqlalchemy.engine.Engine - INFO - UPDATE devices SET last_seen=%(last_seen)s, is_trusted=%(is_trusted)s WHERE devices.id = %(devices_id)s
2025-12-28 22:48:21,318 - sqlalchemy.engine.Engine - INFO - [generated in 0.00220s] {'last_seen': datetime.datetime(2025, 12, 28, 17, 18, 21, 315872), 'is_trusted': 1, 'devices_id': 10}
2025-12-28 22:48:21,322 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:48:21,328 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:48:21,331 - sqlalchemy.engine.Engine - INFO - SELECT devices.id, devices.mac_address, devices.hostname, devices.vendor, devices.device_type, devices.first_seen, devices.last_seen, devices.is_trusted, devices.is_suspicious, devices.notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-28 22:48:21,335 - sqlalchemy.engine.Engine - INFO - [generated in 0.00388s] {'pk_1': 10}
2025-12-28 22:48:21,338 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-28 22:48:21,345 - sqlalchemy.engine.Engine - INFO - [cached since 1090s ago] {'pk_1': 1}
2025-12-28 22:48:21,348 - app.routers.devices - INFO - Device 01:00:5E:00:00:16 updated by admin
2025-12-28 22:48:21,352 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:48:21,374 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:48:21,379 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:48:21,390 - sqlalchemy.engine.Engine - INFO - [cached since 1185s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:48:21,402 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:48:21,428 - sqlalchemy.engine.Engine - INFO - [cached since 1185s ago] {}
2025-12-28 22:48:21,432 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-28 22:48:21,439 - sqlalchemy.engine.Engine - INFO - [cached since 995.2s ago] {'param_1': 0, 'param_2': 20}
2025-12-28 22:48:21,447 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:48:21,454 - sqlalchemy.engine.Engine - INFO - [cached since 1007s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-28 22:48:21,459 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:48:21,467 - sqlalchemy.engine.Engine - INFO - [cached since 1007s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-28 22:48:21,474 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:48:21,483 - sqlalchemy.engine.Engine - INFO - [cached since 1007s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-28 22:48:21,488 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:48:21,495 - sqlalchemy.engine.Engine - INFO - [cached since 1007s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-28 22:48:21,502 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:48:21,518 - sqlalchemy.engine.Engine - INFO - [cached since 1007s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-28 22:48:21,523 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:48:21,535 - sqlalchemy.engine.Engine - INFO - [cached since 1007s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-28 22:48:21,542 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:48:21,561 - sqlalchemy.engine.Engine - INFO - [cached since 1007s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-28 22:48:21,567 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:48:21,578 - sqlalchemy.engine.Engine - INFO - [cached since 1008s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-28 22:48:21,586 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:48:26,128 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:48:26,129 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:48:26,132 - sqlalchemy.engine.Engine - INFO - [cached since 1190s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:48:26,134 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:48:26,143 - sqlalchemy.engine.Engine - INFO - [cached since 1104s ago] {'id_1': 10, 'param_1': 1}
2025-12-28 22:48:26,147 - sqlalchemy.engine.Engine - INFO - UPDATE devices SET last_seen=%(last_seen)s, is_trusted=%(is_trusted)s WHERE devices.id = %(devices_id)s
2025-12-28 22:48:26,149 - sqlalchemy.engine.Engine - INFO - [cached since 4.834s ago] {'last_seen': datetime.datetime(2025, 12, 28, 17, 18, 26, 147047), 'is_trusted': 0, 'devices_id': 10}
2025-12-28 22:48:26,154 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-28 22:48:26,163 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:48:26,166 - sqlalchemy.engine.Engine - INFO - SELECT devices.id, devices.mac_address, devices.hostname, devices.vendor, devices.device_type, devices.first_seen, devices.last_seen, devices.is_trusted, devices.is_suspicious, devices.notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-28 22:48:26,171 - sqlalchemy.engine.Engine - INFO - [cached since 4.84s ago] {'pk_1': 10}
2025-12-28 22:48:26,177 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-28 22:48:26,184 - sqlalchemy.engine.Engine - INFO - [cached since 1095s ago] {'pk_1': 1}
2025-12-28 22:48:26,188 - app.routers.devices - INFO - Device 01:00:5E:00:00:16 updated by admin
2025-12-28 22:48:26,194 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:48:26,205 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:48:26,215 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:48:26,225 - sqlalchemy.engine.Engine - INFO - [cached since 1190s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:48:26,234 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-28 22:48:26,244 - sqlalchemy.engine.Engine - INFO - [cached since 1190s ago] {}
2025-12-28 22:48:26,248 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-28 22:48:26,255 - sqlalchemy.engine.Engine - INFO - [cached since 1000s ago] {'param_1': 0, 'param_2': 20}
2025-12-28 22:48:26,263 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:48:26,269 - sqlalchemy.engine.Engine - INFO - [cached since 1012s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-28 22:48:26,275 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:48:26,282 - sqlalchemy.engine.Engine - INFO - [cached since 1012s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-28 22:48:26,286 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:48:26,298 - sqlalchemy.engine.Engine - INFO - [cached since 1012s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-28 22:48:26,302 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:48:26,312 - sqlalchemy.engine.Engine - INFO - [cached since 1012s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-28 22:48:26,316 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:48:26,326 - sqlalchemy.engine.Engine - INFO - [cached since 1012s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-28 22:48:26,330 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:48:26,336 - sqlalchemy.engine.Engine - INFO - [cached since 1012s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-28 22:48:26,340 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:48:26,349 - sqlalchemy.engine.Engine - INFO - [cached since 1012s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-28 22:48:26,353 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-28 22:48:26,361 - sqlalchemy.engine.Engine - INFO - [cached since 1012s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-28 22:48:26,366 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:48:28,032 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:48:28,033 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:48:28,042 - sqlalchemy.engine.Engine - INFO - [cached since 1192s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:48:28,048 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:48:28,057 - sqlalchemy.engine.Engine - INFO - [cached since 1106s ago] {'id_1': 10, 'param_1': 1}
2025-12-28 22:48:28,061 - app.database - ERROR - Database session error: 400: ML models not trained. Train models first.
2025-12-28 22:48:28,062 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:48:33,112 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:48:33,113 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:48:33,115 - sqlalchemy.engine.Engine - INFO - [cached since 1197s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:48:33,119 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:48:33,135 - sqlalchemy.engine.Engine - INFO - [cached since 1197s ago] {}
2025-12-28 22:48:33,141 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:48:33,150 - sqlalchemy.engine.Engine - INFO - [cached since 1197s ago] {}
2025-12-28 22:48:33,153 - sqlalchemy.engine.Engine - INFO - SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts ORDER BY alerts.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-28 22:48:33,164 - sqlalchemy.engine.Engine - INFO - [cached since 514.6s ago] {'param_1': 0, 'param_2': 20}
2025-12-28 22:48:33,169 - app.database - ERROR - Database session error: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
2025-12-28 22:48:33,172 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:48:33,177 - app.main - ERROR - Unhandled exception: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'new_device'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\alerts.py", line 65, in list_alerts
    alerts = query.offset(offset).limit(page_size).all()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
2025-12-28 22:48:33,557 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:48:33,561 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:48:33,568 - sqlalchemy.engine.Engine - INFO - [cached since 1197s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:48:33,579 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:48:33,595 - sqlalchemy.engine.Engine - INFO - [cached since 1197s ago] {}
2025-12-28 22:48:33,601 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:48:33,634 - sqlalchemy.engine.Engine - INFO - [cached since 1197s ago] {}
2025-12-28 22:48:33,650 - sqlalchemy.engine.Engine - INFO - SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts ORDER BY alerts.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-28 22:48:33,667 - sqlalchemy.engine.Engine - INFO - [cached since 515.1s ago] {'param_1': 0, 'param_2': 20}
2025-12-28 22:48:33,674 - app.database - ERROR - Database session error: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
2025-12-28 22:48:33,677 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:48:33,681 - app.main - ERROR - Unhandled exception: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'new_device'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\alerts.py", line 65, in list_alerts
    alerts = query.offset(offset).limit(page_size).all()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
2025-12-28 22:48:33,858 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:48:33,860 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:48:33,867 - sqlalchemy.engine.Engine - INFO - [cached since 1198s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:48:33,874 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-28 22:48:33,883 - sqlalchemy.engine.Engine - INFO - [cached since 1198s ago] {}
2025-12-28 22:48:33,887 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-28 22:48:33,899 - sqlalchemy.engine.Engine - INFO - [cached since 1198s ago] {}
2025-12-28 22:48:33,904 - sqlalchemy.engine.Engine - INFO - SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts ORDER BY alerts.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-28 22:48:33,925 - sqlalchemy.engine.Engine - INFO - [cached since 515.4s ago] {'param_1': 0, 'param_2': 20}
2025-12-28 22:48:33,932 - app.database - ERROR - Database session error: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
2025-12-28 22:48:33,934 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:48:33,936 - app.main - ERROR - Unhandled exception: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1709, in _object_value_for_elem
    return self._object_lookup[elem]  # type: ignore[return-value]
           ~~~~~~~~~~~~~~~~~~~^^^^^^
KeyError: 'new_device'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\alerts.py", line 65, in list_alerts
    alerts = query.offset(offset).limit(page_size).all()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\query.py", line 2704, in all
    return self._iter().all()  # type: ignore
           ~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1774, in all
    return self._allrows()
           ~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 548, in _allrows
    rows = self._fetchall_impl()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 1681, in _fetchall_impl
    return self._real_result._fetchall_impl()
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 2275, in _fetchall_impl
    return list(self.iterator)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\orm\loading.py", line 220, in chunks
    fetch = cursor._raw_all_rows()
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\engine\result.py", line 541, in _raw_all_rows
    return [make_row(row) for row in rows]
            ~~~~~~~~^^^^^
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 22, in sqlalchemy.cyextension.resultproxy.BaseRow.__init__
  File "lib/sqlalchemy/cyextension/resultproxy.pyx", line 79, in sqlalchemy.cyextension.resultproxy._apply_processors
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1829, in process
    value = self._object_value_for_elem(value)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\dialects\mysql\enumerated.py", line 110, in _object_value_for_elem
    return super()._object_value_for_elem(elem)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\sqlalchemy\sql\sqltypes.py", line 1711, in _object_value_for_elem
    raise LookupError(
    ...<7 lines>...
    ) from err
LookupError: 'new_device' is not among the defined enum values. Enum name: alerttype. Possible values: NEW_DEVICE, SUSPICIOUS_.., ANOMALY_DET.., ..., UNAUTHORIZE..
2025-12-28 22:48:34,502 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:48:34,507 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:48:34,525 - sqlalchemy.engine.Engine - INFO - [cached since 1198s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:48:34,533 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:48:34,545 - sqlalchemy.engine.Engine - INFO - [cached since 1198s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-28 22:48:34,553 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:48:34,563 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:48:34,566 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:48:34,574 - sqlalchemy.engine.Engine - INFO - [cached since 1198s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:48:34,581 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-28 22:48:34,594 - sqlalchemy.engine.Engine - INFO - [cached since 1198s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-28 22:48:34,602 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:48:34,619 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:48:34,626 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:48:34,636 - sqlalchemy.engine.Engine - INFO - [cached since 1198s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:48:34,648 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:48:34,652 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:48:34,661 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:48:34,674 - sqlalchemy.engine.Engine - INFO - [cached since 1198s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:48:34,682 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:49:51,378 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-28 22:49:51,383 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-28 22:49:51,400 - sqlalchemy.engine.Engine - INFO - [cached since 1275s ago] {'id_1': 1, 'param_1': 1}
2025-12-28 22:49:51,418 - app.database - ERROR - Database session error: 1 validation error:
  {'type': 'value_error', 'loc': ('body', 'network_range'), 'msg': 'Value error, Invalid network range format. Expected: X.X.X.X/XX', 'input': '10.18.154.139', 'ctx': {'error': ValueError('Invalid network range format. Expected: X.X.X.X/XX')}}

  File "E:\wifi-tracker\backend\app\routers\scans.py", line 166, in start_scan
    POST /api/scans/start
2025-12-28 22:49:51,430 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-28 22:51:41,085 - app.services.notification - INFO - WebSocket client unregistered. Total: 2
2025-12-28 22:51:41,088 - app.main - INFO - WebSocket client disconnected
2025-12-28 22:51:47,735 - app.services.notification - INFO - WebSocket client unregistered. Total: 1
2025-12-28 22:51:47,740 - app.main - INFO - WebSocket client disconnected
2025-12-28 22:51:47,743 - app.services.notification - INFO - WebSocket client unregistered. Total: 0
2025-12-28 22:51:47,749 - app.main - INFO - WebSocket client disconnected
2025-12-29 10:56:48,827 - app.main - INFO - Starting WiFi Tracker System...
2025-12-29 10:56:48,849 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-29 10:56:48,850 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 10:56:48,855 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-29 10:56:48,857 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 10:56:48,858 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-29 10:56:48,859 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 10:56:48,863 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 10:56:48,864 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-29 10:56:48,867 - sqlalchemy.engine.Engine - INFO - [generated in 0.00459s] {}
2025-12-29 10:56:48,869 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 10:56:48,870 - app.main - INFO - Database connection successful
2025-12-29 10:56:48,871 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 10:56:48,873 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-29 10:56:48,875 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 10:56:48,926 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-29 10:56:48,928 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 10:56:48,940 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-29 10:56:48,943 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 10:56:48,968 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-29 10:56:48,969 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 10:56:48,982 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-29 10:56:48,983 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 10:56:48,992 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-29 10:56:48,993 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 10:56:49,004 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-29 10:56:49,008 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 10:56:49,033 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-29 10:56:49,035 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 10:56:49,062 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 10:56:49,064 - app.database - INFO - Database tables initialized successfully
2025-12-29 11:00:00,736 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:00:00,766 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.username = %(username_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:00,770 - sqlalchemy.engine.Engine - INFO - [generated in 0.00389s] {'username_1': 'admin', 'param_1': 1}
2025-12-29 11:00:01,344 - sqlalchemy.engine.Engine - INFO - UPDATE users SET last_login=%(last_login)s WHERE users.id = %(users_id)s
2025-12-29 11:00:01,347 - sqlalchemy.engine.Engine - INFO - [generated in 0.00356s] {'last_login': datetime.datetime(2025, 12, 29, 5, 30, 1, 338961), 'users_id': 1}
2025-12-29 11:00:01,359 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:00:01,368 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:00:01,372 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-29 11:00:01,374 - sqlalchemy.engine.Engine - INFO - [generated in 0.00178s] {'pk_1': 1}
2025-12-29 11:00:01,385 - app.routers.auth - INFO - User logged in: admin
2025-12-29 11:00:01,395 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:00:01,443 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:00:01,451 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:01,454 - sqlalchemy.engine.Engine - INFO - [generated in 0.00370s] {'id_1': 1, 'param_1': 1}
2025-12-29 11:00:01,469 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:00:01,520 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:00:01,526 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:01,530 - sqlalchemy.engine.Engine - INFO - [cached since 0.07964s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:00:01,551 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:00:01,554 - sqlalchemy.engine.Engine - INFO - [generated in 0.00301s] {}
2025-12-29 11:00:01,570 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:00:01,572 - sqlalchemy.engine.Engine - INFO - [generated in 0.00232s] {'last_seen_1': datetime.datetime(2025, 12, 29, 5, 20, 1, 562192)}
2025-12-29 11:00:01,590 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:00:01,595 - sqlalchemy.engine.Engine - INFO - [generated in 0.00457s] {}
2025-12-29 11:00:01,605 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:00:01,613 - sqlalchemy.engine.Engine - INFO - [generated in 0.00755s] {}
2025-12-29 11:00:01,652 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:00:01,656 - sqlalchemy.engine.Engine - INFO - [generated in 0.00454s] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:00:01,680 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:00:01,685 - sqlalchemy.engine.Engine - INFO - [generated in 0.00541s] {}
2025-12-29 11:00:01,701 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:00:01,703 - sqlalchemy.engine.Engine - INFO - [generated in 0.00211s] {}
2025-12-29 11:00:01,719 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:00:01,721 - sqlalchemy.engine.Engine - INFO - [generated in 0.00225s] {'status_1': 'completed'}
2025-12-29 11:00:01,733 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:00:01,735 - sqlalchemy.engine.Engine - INFO - [generated in 0.00216s] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:00:01,747 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:00:01,750 - sqlalchemy.engine.Engine - INFO - [generated in 0.00268s] {}
2025-12-29 11:00:01,771 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:00:01,844 - app.services.notification - INFO - WebSocket client registered. Total: 1
2025-12-29 11:00:01,873 - app.main - INFO - WebSocket client connected
2025-12-29 11:00:01,937 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:00:01,940 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:01,949 - sqlalchemy.engine.Engine - INFO - [cached since 0.4981s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:00:01,974 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:01,989 - sqlalchemy.engine.Engine - INFO - [generated in 0.01565s] {'id_1': 7, 'param_1': 1}
2025-12-29 11:00:02,014 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:00:02,016 - sqlalchemy.engine.Engine - INFO - [generated in 0.00222s] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 22, 5, 30, 2, 8492), 'param_1': 100}
2025-12-29 11:00:02,048 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s AND scan_results.scan_timestamp >= %(scan_timestamp_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:00:02,137 - sqlalchemy.engine.Engine - INFO - [generated in 0.08843s] {'device_id_1': 7, 'scan_timestamp_1': datetime.datetime(2025, 12, 22, 5, 30, 2, 8492), 'param_1': 100}
2025-12-29 11:00:02,166 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:00:02,231 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:00:02,251 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:02,256 - sqlalchemy.engine.Engine - INFO - [cached since 0.8055s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:00:02,269 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:00:02,272 - sqlalchemy.engine.Engine - INFO - [cached since 0.7212s ago] {}
2025-12-29 11:00:02,296 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:00:02,301 - sqlalchemy.engine.Engine - INFO - [cached since 0.7309s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 5, 20, 2, 290558)}
2025-12-29 11:00:02,323 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:00:02,326 - sqlalchemy.engine.Engine - INFO - [cached since 0.7357s ago] {}
2025-12-29 11:00:02,339 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:00:02,347 - sqlalchemy.engine.Engine - INFO - [cached since 0.7421s ago] {}
2025-12-29 11:00:02,354 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:00:02,356 - sqlalchemy.engine.Engine - INFO - [cached since 0.7044s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:00:02,367 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:00:02,371 - sqlalchemy.engine.Engine - INFO - [cached since 0.691s ago] {}
2025-12-29 11:00:02,385 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:00:02,389 - sqlalchemy.engine.Engine - INFO - [cached since 0.6875s ago] {}
2025-12-29 11:00:02,401 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:00:02,413 - sqlalchemy.engine.Engine - INFO - [cached since 0.6943s ago] {'status_1': 'completed'}
2025-12-29 11:00:02,421 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:00:02,423 - sqlalchemy.engine.Engine - INFO - [cached since 0.6896s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:00:02,433 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:00:02,440 - sqlalchemy.engine.Engine - INFO - [cached since 0.6928s ago] {}
2025-12-29 11:00:02,449 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:00:02,588 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:00:02,592 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:02,612 - sqlalchemy.engine.Engine - INFO - [cached since 1.161s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:00:02,633 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:00:02,638 - sqlalchemy.engine.Engine - INFO - [generated in 0.00511s] {'event_timestamp_1': datetime.datetime(2025, 12, 28, 5, 30, 2, 630106), 'param_1': 100}
2025-12-29 11:00:02,650 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:02,653 - sqlalchemy.engine.Engine - INFO - [cached since 0.6795s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:00:02,664 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:02,667 - sqlalchemy.engine.Engine - INFO - [cached since 0.6931s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:00:02,686 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:02,688 - sqlalchemy.engine.Engine - INFO - [cached since 0.7148s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:00:02,706 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:02,737 - sqlalchemy.engine.Engine - INFO - [cached since 0.7628s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:00:02,773 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:02,800 - sqlalchemy.engine.Engine - INFO - [cached since 0.8261s ago] {'id_1': 13, 'param_1': 1}
2025-12-29 11:00:02,836 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:02,867 - sqlalchemy.engine.Engine - INFO - [cached since 0.8932s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:00:02,897 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:02,987 - sqlalchemy.engine.Engine - INFO - [cached since 1.014s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:00:03,152 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:03,167 - sqlalchemy.engine.Engine - INFO - [cached since 1.193s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:00:03,201 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:03,218 - sqlalchemy.engine.Engine - INFO - [cached since 1.244s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:00:03,237 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:03,254 - sqlalchemy.engine.Engine - INFO - [cached since 1.281s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:00:03,316 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:03,323 - sqlalchemy.engine.Engine - INFO - [cached since 1.349s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:00:03,339 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:00:05,249 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:00:05,256 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:05,266 - sqlalchemy.engine.Engine - INFO - [cached since 3.815s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:00:05,294 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-29 11:00:05,303 - sqlalchemy.engine.Engine - INFO - [generated in 0.01028s] {'started_at': datetime.datetime(2025, 12, 29, 5, 30, 5, 293963), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'arp', 'network_range': '192.168.1.0/24', 'status': 'running', 'error_message': None}
2025-12-29 11:00:05,315 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:00:05,324 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:00:05,338 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-29 11:00:05,349 - sqlalchemy.engine.Engine - INFO - [generated in 0.01155s] {'pk_1': 28}
2025-12-29 11:00:05,359 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-29 11:00:05,367 - sqlalchemy.engine.Engine - INFO - [cached since 3.994s ago] {'pk_1': 1}
2025-12-29 11:00:05,372 - app.routers.scans - INFO - Scan started by admin: 28
2025-12-29 11:00:05,398 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:05,415 - sqlalchemy.engine.Engine - INFO - [generated in 0.01700s] {'id_1': 28, 'param_1': 1}
2025-12-29 11:00:05,434 - app.services.scanner - INFO - Starting ARP scan on 192.168.1.0/24
2025-12-29 11:00:05,436 - app.services.scanner - ERROR - ARP scan failed: Sniffing and sending packets is not available at layer 2: winpcap is not installed. You may use conf.L3socket or conf.L3socket6 to access layer 3
2025-12-29 11:00:25,926 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:25,931 - sqlalchemy.engine.Engine - INFO - [generated in 0.00529s] {'mac_address_1': '96:A4:CB:4D:96:A9', 'param_1': 1}
2025-12-29 11:00:25,946 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:00:25,951 - sqlalchemy.engine.Engine - INFO - [generated in 0.00492s] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:00:25,963 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:25,965 - sqlalchemy.engine.Engine - INFO - [cached since 0.03949s ago] {'mac_address_1': 'FF:FF:FF:FF:FF:FF', 'param_1': 1}
2025-12-29 11:00:25,971 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:00:25,978 - sqlalchemy.engine.Engine - INFO - [cached since 0.03162s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:00:25,984 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:25,992 - sqlalchemy.engine.Engine - INFO - [cached since 0.06709s ago] {'mac_address_1': '01:00:5E:00:00:16', 'param_1': 1}
2025-12-29 11:00:25,998 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:00:26,000 - sqlalchemy.engine.Engine - INFO - [cached since 0.05424s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:00:26,015 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:26,017 - sqlalchemy.engine.Engine - INFO - [cached since 0.09191s ago] {'mac_address_1': '01:00:5E:00:00:FB', 'param_1': 1}
2025-12-29 11:00:26,025 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:00:26,031 - sqlalchemy.engine.Engine - INFO - [cached since 0.08423s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:00:26,039 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:26,045 - sqlalchemy.engine.Engine - INFO - [cached since 0.1199s ago] {'mac_address_1': '01:00:5E:00:00:FC', 'param_1': 1}
2025-12-29 11:00:26,051 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:00:26,056 - sqlalchemy.engine.Engine - INFO - [cached since 0.1094s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:00:26,070 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:26,076 - sqlalchemy.engine.Engine - INFO - [cached since 0.1511s ago] {'mac_address_1': '01:00:5E:7F:66:12', 'param_1': 1}
2025-12-29 11:00:26,085 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:00:26,094 - sqlalchemy.engine.Engine - INFO - [cached since 0.1473s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:00:26,099 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:26,103 - sqlalchemy.engine.Engine - INFO - [cached since 0.1764s ago] {'mac_address_1': '01:00:5E:7F:FF:FA', 'param_1': 1}
2025-12-29 11:00:26,113 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:00:26,118 - sqlalchemy.engine.Engine - INFO - [cached since 0.1719s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:00:26,127 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:26,130 - sqlalchemy.engine.Engine - INFO - [cached since 0.2043s ago] {'mac_address_1': 'FF:FF:FF:FF:FF:FF', 'param_1': 1}
2025-12-29 11:00:26,135 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:00:26,138 - sqlalchemy.engine.Engine - INFO - [cached since 0.1917s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:00:26,157 - sqlalchemy.engine.Engine - INFO - UPDATE devices SET last_seen=%(last_seen)s WHERE devices.id = %(devices_id)s
2025-12-29 11:00:26,159 - sqlalchemy.engine.Engine - INFO - [generated in 0.00200s] [{'last_seen': datetime.datetime(2025, 12, 29, 5, 30, 25, 959524), 'devices_id': 8}, {'last_seen': datetime.datetime(2025, 12, 29, 5, 30, 26, 150767), 'devices_id': 9}, {'last_seen': datetime.datetime(2025, 12, 29, 5, 30, 26, 13130), 'devices_id': 10}, {'last_seen': datetime.datetime(2025, 12, 29, 5, 30, 26, 35314), 'devices_id': 11}, {'last_seen': datetime.datetime(2025, 12, 29, 5, 30, 26, 67463), 'devices_id': 12}, {'last_seen': datetime.datetime(2025, 12, 29, 5, 30, 26, 98041), 'devices_id': 13}, {'last_seen': datetime.datetime(2025, 12, 29, 5, 30, 26, 125708), 'devices_id': 14}]
2025-12-29 11:00:26,178 - sqlalchemy.engine.Engine - INFO - UPDATE scan_sessions SET completed_at=%(completed_at)s, total_devices_found=%(total_devices_found)s, status=%(status)s WHERE scan_sessions.id = %(scan_sessions_id)s
2025-12-29 11:00:26,181 - sqlalchemy.engine.Engine - INFO - [generated in 0.00222s] {'completed_at': datetime.datetime(2025, 12, 29, 5, 30, 26, 151401), 'total_devices_found': 8, 'status': 'completed', 'scan_sessions_id': 28}
2025-12-29 11:00:26,187 - sqlalchemy.engine.Engine - INFO - INSERT INTO device_activity (device_id, event_type, old_value, new_value, event_timestamp) VALUES (%(device_id)s, %(event_type)s, %(old_value)s, %(new_value)s, %(event_timestamp)s)
2025-12-29 11:00:26,192 - sqlalchemy.engine.Engine - INFO - [generated in 0.00599s] {'device_id': 8, 'event_type': 'ip_changed', 'old_value': '10.18.154.151', 'new_value': '10.41.243.123', 'event_timestamp': datetime.datetime(2025, 12, 29, 5, 30, 26, 187333)}
2025-12-29 11:00:26,197 - sqlalchemy.engine.Engine - INFO - INSERT INTO device_activity (device_id, event_type, old_value, new_value, event_timestamp) VALUES (%(device_id)s, %(event_type)s, %(old_value)s, %(new_value)s, %(event_timestamp)s)
2025-12-29 11:00:26,199 - sqlalchemy.engine.Engine - INFO - [cached since 0.01303s ago] {'device_id': 9, 'event_type': 'ip_changed', 'old_value': '255.255.255.255', 'new_value': '10.41.243.255', 'event_timestamp': datetime.datetime(2025, 12, 29, 5, 30, 26, 197766)}
2025-12-29 11:00:26,206 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:00:26,211 - sqlalchemy.engine.Engine - INFO - [generated in 0.00519s] {'device_id': 8, 'ip_address': '10.41.243.123', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 5, 30, 26, 206295), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:00:26,220 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:00:26,226 - sqlalchemy.engine.Engine - INFO - [cached since 0.02031s ago] {'device_id': 9, 'ip_address': '10.41.243.255', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 5, 30, 26, 220728), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:00:26,230 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:00:26,231 - sqlalchemy.engine.Engine - INFO - [cached since 0.02571s ago] {'device_id': 10, 'ip_address': '224.0.0.22', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 5, 30, 26, 229997), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:00:26,235 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:00:26,244 - sqlalchemy.engine.Engine - INFO - [cached since 0.03835s ago] {'device_id': 11, 'ip_address': '224.0.0.251', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 5, 30, 26, 235094), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:00:26,247 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:00:26,249 - sqlalchemy.engine.Engine - INFO - [cached since 0.04365s ago] {'device_id': 12, 'ip_address': '224.0.0.252', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 5, 30, 26, 247733), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:00:26,255 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:00:26,262 - sqlalchemy.engine.Engine - INFO - [cached since 0.05644s ago] {'device_id': 13, 'ip_address': '239.255.102.18', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 5, 30, 26, 255641), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:00:26,266 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:00:26,268 - sqlalchemy.engine.Engine - INFO - [cached since 0.0624s ago] {'device_id': 14, 'ip_address': '239.255.255.250', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 5, 30, 26, 266670), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:00:26,273 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:00:26,280 - sqlalchemy.engine.Engine - INFO - [cached since 0.07427s ago] {'device_id': 9, 'ip_address': '255.255.255.255', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 5, 30, 26, 273488), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:00:26,284 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:00:26,291 - app.routers.scans - INFO - Scan completed: 8 devices, 0 new
2025-12-29 11:00:26,619 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:00:26,629 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:26,632 - sqlalchemy.engine.Engine - INFO - [cached since 25.18s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:00:26,639 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:00:26,646 - sqlalchemy.engine.Engine - INFO - [cached since 25.1s ago] {}
2025-12-29 11:00:26,654 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:00:26,661 - sqlalchemy.engine.Engine - INFO - [cached since 25.09s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 5, 20, 26, 651404)}
2025-12-29 11:00:26,671 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:00:26,680 - sqlalchemy.engine.Engine - INFO - [cached since 25.09s ago] {}
2025-12-29 11:00:26,688 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:00:26,694 - sqlalchemy.engine.Engine - INFO - [cached since 25.09s ago] {}
2025-12-29 11:00:26,700 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:00:26,706 - sqlalchemy.engine.Engine - INFO - [cached since 25.05s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:00:26,725 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:00:26,727 - sqlalchemy.engine.Engine - INFO - [cached since 25.05s ago] {}
2025-12-29 11:00:26,742 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:00:26,744 - sqlalchemy.engine.Engine - INFO - [cached since 25.04s ago] {}
2025-12-29 11:00:26,748 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:00:26,750 - sqlalchemy.engine.Engine - INFO - [cached since 25.03s ago] {'status_1': 'completed'}
2025-12-29 11:00:26,761 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:00:26,769 - sqlalchemy.engine.Engine - INFO - [cached since 25.04s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:00:26,782 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:00:26,786 - sqlalchemy.engine.Engine - INFO - [cached since 25.04s ago] {}
2025-12-29 11:00:26,797 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:00:26,829 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:00:26,832 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:26,835 - sqlalchemy.engine.Engine - INFO - [cached since 25.38s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:00:26,858 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:26,860 - sqlalchemy.engine.Engine - INFO - [cached since 24.89s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:00:26,871 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:00:26,875 - sqlalchemy.engine.Engine - INFO - [cached since 24.86s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 22, 5, 30, 26, 868541), 'param_1': 100}
2025-12-29 11:00:26,897 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s AND scan_results.scan_timestamp >= %(scan_timestamp_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:00:26,908 - sqlalchemy.engine.Engine - INFO - [cached since 24.86s ago] {'device_id_1': 7, 'scan_timestamp_1': datetime.datetime(2025, 12, 22, 5, 30, 26, 868541), 'param_1': 100}
2025-12-29 11:00:26,917 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:00:26,954 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:00:26,958 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:26,962 - sqlalchemy.engine.Engine - INFO - [cached since 25.51s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:00:26,970 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:00:26,977 - sqlalchemy.engine.Engine - INFO - [cached since 25.43s ago] {}
2025-12-29 11:00:26,984 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:00:26,993 - sqlalchemy.engine.Engine - INFO - [cached since 25.42s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 5, 20, 26, 982812)}
2025-12-29 11:00:26,999 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:00:27,001 - sqlalchemy.engine.Engine - INFO - [cached since 25.41s ago] {}
2025-12-29 11:00:27,017 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:00:27,021 - sqlalchemy.engine.Engine - INFO - [cached since 25.42s ago] {}
2025-12-29 11:00:27,034 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:00:27,039 - sqlalchemy.engine.Engine - INFO - [cached since 25.39s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:00:27,054 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:00:27,059 - sqlalchemy.engine.Engine - INFO - [cached since 25.38s ago] {}
2025-12-29 11:00:27,067 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:00:27,075 - sqlalchemy.engine.Engine - INFO - [cached since 25.37s ago] {}
2025-12-29 11:00:27,108 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:00:27,111 - sqlalchemy.engine.Engine - INFO - [cached since 25.39s ago] {'status_1': 'completed'}
2025-12-29 11:00:27,117 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:00:27,124 - sqlalchemy.engine.Engine - INFO - [cached since 25.39s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:00:27,130 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:00:27,137 - sqlalchemy.engine.Engine - INFO - [cached since 25.39s ago] {}
2025-12-29 11:00:27,144 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:00:27,188 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:00:27,193 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:27,197 - sqlalchemy.engine.Engine - INFO - [cached since 25.75s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:00:27,202 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:00:27,207 - sqlalchemy.engine.Engine - INFO - [cached since 24.57s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 28, 5, 30, 27, 200918), 'param_1': 100}
2025-12-29 11:00:27,218 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:27,222 - sqlalchemy.engine.Engine - INFO - [cached since 25.25s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:00:27,227 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:27,230 - sqlalchemy.engine.Engine - INFO - [cached since 25.26s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:00:27,234 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:27,240 - sqlalchemy.engine.Engine - INFO - [cached since 25.27s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:00:27,251 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:27,255 - sqlalchemy.engine.Engine - INFO - [cached since 25.28s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:00:27,264 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:27,266 - sqlalchemy.engine.Engine - INFO - [cached since 25.29s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:00:27,274 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:27,277 - sqlalchemy.engine.Engine - INFO - [cached since 25.3s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:00:27,282 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:27,284 - sqlalchemy.engine.Engine - INFO - [cached since 25.31s ago] {'id_1': 13, 'param_1': 1}
2025-12-29 11:00:27,292 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:27,296 - sqlalchemy.engine.Engine - INFO - [cached since 25.32s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:00:27,301 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:27,305 - sqlalchemy.engine.Engine - INFO - [cached since 25.33s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:00:27,310 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:27,312 - sqlalchemy.engine.Engine - INFO - [cached since 25.34s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:00:27,317 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:27,329 - sqlalchemy.engine.Engine - INFO - [cached since 25.36s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:00:27,334 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:27,339 - sqlalchemy.engine.Engine - INFO - [cached since 25.37s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:00:27,344 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:00:27,346 - sqlalchemy.engine.Engine - INFO - [cached since 25.37s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:00:27,362 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:01:32,409 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:01:32,411 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:01:32,413 - sqlalchemy.engine.Engine - INFO - [cached since 90.96s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:01:32,418 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:01:32,421 - sqlalchemy.engine.Engine - INFO - [cached since 90.87s ago] {}
2025-12-29 11:01:32,427 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:01:32,431 - sqlalchemy.engine.Engine - INFO - [generated in 0.00427s] {'param_1': 0, 'param_2': 20}
2025-12-29 11:01:32,438 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:01:32,445 - sqlalchemy.engine.Engine - INFO - [cached since 66.5s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:01:32,449 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:01:32,451 - sqlalchemy.engine.Engine - INFO - [cached since 66.5s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:01:32,456 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:01:32,462 - sqlalchemy.engine.Engine - INFO - [cached since 66.52s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:01:32,465 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:01:32,467 - sqlalchemy.engine.Engine - INFO - [cached since 66.52s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:01:32,472 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:01:32,479 - sqlalchemy.engine.Engine - INFO - [cached since 66.53s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:01:32,483 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:01:32,485 - sqlalchemy.engine.Engine - INFO - [cached since 66.54s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:01:32,495 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:01:32,497 - sqlalchemy.engine.Engine - INFO - [cached since 66.55s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:01:32,502 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:01:32,509 - sqlalchemy.engine.Engine - INFO - [cached since 66.56s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-29 11:01:32,516 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:01:35,814 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:01:35,816 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:01:35,818 - sqlalchemy.engine.Engine - INFO - [cached since 94.37s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:01:35,831 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:01:37,398 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:01:37,400 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:01:37,401 - sqlalchemy.engine.Engine - INFO - [cached since 95.95s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:01:37,407 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices
2025-12-29 11:01:37,411 - sqlalchemy.engine.Engine - INFO - [generated in 0.00423s] {}
2025-12-29 11:01:37,416 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:01:37,417 - sqlalchemy.engine.Engine - INFO - [generated in 0.00133s] {'device_id_1': 7}
2025-12-29 11:01:37,424 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:01:37,427 - sqlalchemy.engine.Engine - INFO - [generated in 0.00296s] {'device_id_1': 7}
2025-12-29 11:01:37,430 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:01:37,432 - sqlalchemy.engine.Engine - INFO - [cached since 0.01564s ago] {'device_id_1': 8}
2025-12-29 11:01:37,434 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:01:37,438 - sqlalchemy.engine.Engine - INFO - [cached since 0.01376s ago] {'device_id_1': 8}
2025-12-29 11:01:37,444 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:01:37,445 - sqlalchemy.engine.Engine - INFO - [cached since 0.02945s ago] {'device_id_1': 9}
2025-12-29 11:01:37,448 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:01:37,450 - sqlalchemy.engine.Engine - INFO - [cached since 0.02576s ago] {'device_id_1': 9}
2025-12-29 11:01:37,455 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:01:37,459 - sqlalchemy.engine.Engine - INFO - [cached since 0.04267s ago] {'device_id_1': 10}
2025-12-29 11:01:37,462 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:01:37,463 - sqlalchemy.engine.Engine - INFO - [cached since 0.03946s ago] {'device_id_1': 10}
2025-12-29 11:01:37,466 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:01:37,467 - sqlalchemy.engine.Engine - INFO - [cached since 0.05143s ago] {'device_id_1': 11}
2025-12-29 11:01:37,473 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:01:37,477 - sqlalchemy.engine.Engine - INFO - [cached since 0.05335s ago] {'device_id_1': 11}
2025-12-29 11:01:37,480 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:01:37,481 - sqlalchemy.engine.Engine - INFO - [cached since 0.06535s ago] {'device_id_1': 12}
2025-12-29 11:01:37,484 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:01:37,490 - sqlalchemy.engine.Engine - INFO - [cached since 0.0664s ago] {'device_id_1': 12}
2025-12-29 11:01:37,494 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:01:37,495 - sqlalchemy.engine.Engine - INFO - [cached since 0.07907s ago] {'device_id_1': 13}
2025-12-29 11:01:37,498 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:01:37,499 - sqlalchemy.engine.Engine - INFO - [cached since 0.07502s ago] {'device_id_1': 13}
2025-12-29 11:01:37,502 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:01:37,507 - sqlalchemy.engine.Engine - INFO - [cached since 0.09105s ago] {'device_id_1': 14}
2025-12-29 11:01:37,510 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:01:37,511 - sqlalchemy.engine.Engine - INFO - [cached since 0.08693s ago] {'device_id_1': 14}
2025-12-29 11:01:37,513 - app.ml.detector - INFO - Training anomaly detector with 8 devices
2025-12-29 11:01:37,516 - app.ml.isolation_forest - INFO - Training Isolation Forest with 8 samples
2025-12-29 11:01:37,844 - app.ml.isolation_forest - INFO - Model saved to E:\wifi-tracker\backend\data\models\isolation_forest.pkl
2025-12-29 11:01:37,870 - app.ml.isolation_forest - INFO - Training complete: {'model_type': 'isolation_forest', 'samples_trained': 8, 'contamination': 0.1, 'n_estimators': 100, 'anomalies_in_training': 1, 'score_mean': 0.19161028401358515, 'score_std': 0.12584851618758217, 'trained_at': '2025-12-29T05:31:37.870901'}
2025-12-29 11:01:37,871 - app.ml.autoencoder - INFO - Training Autoencoder with 8 samples
2025-12-29 11:01:41,480 - app.ml.autoencoder - INFO - Epoch 20/100, Loss: 0.403836
2025-12-29 11:01:41,561 - app.ml.autoencoder - INFO - Epoch 40/100, Loss: 0.405480
2025-12-29 11:01:41,647 - app.ml.autoencoder - INFO - Epoch 60/100, Loss: 0.393193
2025-12-29 11:01:41,731 - app.ml.autoencoder - INFO - Epoch 80/100, Loss: 0.380807
2025-12-29 11:01:41,812 - app.ml.autoencoder - INFO - Epoch 100/100, Loss: 0.365998
2025-12-29 11:01:41,950 - app.ml.autoencoder - INFO - Autoencoder saved to E:\wifi-tracker\backend\data\models\autoencoder.pth
2025-12-29 11:01:41,951 - app.ml.autoencoder - INFO - Training complete: {'model_type': 'autoencoder', 'samples_trained': 8, 'input_dim': 15, 'encoding_dim': 8, 'epochs': 100, 'final_loss': 0.36599820852279663, 'threshold': 1.2267732620239258, 'threshold_percentile': 95, 'trained_at': '2025-12-29T05:31:41.951007'}
2025-12-29 11:01:41,954 - app.routers.dashboard - INFO - ML training initiated by admin: {'status': 'success', 'models': {'isolation_forest': {'model_type': 'isolation_forest', 'samples_trained': 8, 'contamination': 0.1, 'n_estimators': 100, 'anomalies_in_training': 1, 'score_mean': 0.19161028401358515, 'score_std': 0.12584851618758217, 'trained_at': '2025-12-29T05:31:37.870901'}, 'autoencoder': {'model_type': 'autoencoder', 'samples_trained': 8, 'input_dim': 15, 'encoding_dim': 8, 'epochs': 100, 'final_loss': 0.36599820852279663, 'threshold': 1.2267732620239258, 'threshold_percentile': 95, 'trained_at': '2025-12-29T05:31:41.951007'}}, 'trained_at': '2025-12-29T05:31:41.953934', 'total_samples': 8}
2025-12-29 11:01:41,957 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:01:41,977 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:01:41,980 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:01:41,982 - sqlalchemy.engine.Engine - INFO - [cached since 100.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:01:41,994 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:01:46,194 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:01:46,196 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:01:46,198 - sqlalchemy.engine.Engine - INFO - [cached since 104.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:01:46,205 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:01:46,207 - sqlalchemy.engine.Engine - INFO - [cached since 104.7s ago] {}
2025-12-29 11:01:46,210 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:01:46,211 - sqlalchemy.engine.Engine - INFO - [cached since 13.78s ago] {'param_1': 0, 'param_2': 20}
2025-12-29 11:01:46,214 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:01:46,216 - sqlalchemy.engine.Engine - INFO - [cached since 80.27s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:01:46,222 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:01:46,227 - sqlalchemy.engine.Engine - INFO - [cached since 80.28s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:01:46,230 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:01:46,232 - sqlalchemy.engine.Engine - INFO - [cached since 80.29s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:01:46,239 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:01:46,242 - sqlalchemy.engine.Engine - INFO - [cached since 80.3s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:01:46,246 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:01:46,247 - sqlalchemy.engine.Engine - INFO - [cached since 80.3s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:01:46,257 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:01:46,260 - sqlalchemy.engine.Engine - INFO - [cached since 80.31s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:01:46,264 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:01:46,268 - sqlalchemy.engine.Engine - INFO - [cached since 80.32s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:01:46,276 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:01:46,277 - sqlalchemy.engine.Engine - INFO - [cached since 80.33s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-29 11:01:46,281 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:01:47,593 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:01:47,594 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:01:47,596 - sqlalchemy.engine.Engine - INFO - [cached since 106.1s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:01:47,598 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:01:47,601 - sqlalchemy.engine.Engine - INFO - [cached since 105.6s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:01:47,608 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:01:47,610 - sqlalchemy.engine.Engine - INFO - [cached since 10.19s ago] {'device_id_1': 9}
2025-12-29 11:01:47,612 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:01:47,614 - sqlalchemy.engine.Engine - INFO - [cached since 10.19s ago] {'device_id_1': 9}
2025-12-29 11:01:47,652 - app.database - ERROR - Database session error: [TypeError("'numpy.bool' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')]
2025-12-29 11:01:47,653 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:01:47,658 - app.main - ERROR - Unhandled exception: [TypeError("'numpy.bool' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')]
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 327, in jsonable_encoder
    data = dict(obj)
TypeError: 'numpy.bool' object is not iterable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 332, in jsonable_encoder
    data = vars(obj)
TypeError: vars() argument must have __dict__ attribute

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 232, in serialize_response
    return jsonable_encoder(response_content)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 288, in jsonable_encoder
    encoded_value = jsonable_encoder(
        value,
    ...<4 lines>...
        sqlalchemy_safe=sqlalchemy_safe,
    )
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 288, in jsonable_encoder
    encoded_value = jsonable_encoder(
        value,
    ...<4 lines>...
        sqlalchemy_safe=sqlalchemy_safe,
    )
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 288, in jsonable_encoder
    encoded_value = jsonable_encoder(
        value,
    ...<4 lines>...
        sqlalchemy_safe=sqlalchemy_safe,
    )
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 335, in jsonable_encoder
    raise ValueError(errors) from e
ValueError: [TypeError("'numpy.bool' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')]
2025-12-29 11:01:52,147 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:01:52,149 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:01:52,152 - sqlalchemy.engine.Engine - INFO - [cached since 110.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:01:52,155 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:01:52,156 - sqlalchemy.engine.Engine - INFO - [cached since 110.2s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:01:52,159 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:01:52,160 - sqlalchemy.engine.Engine - INFO - [cached since 14.74s ago] {'device_id_1': 9}
2025-12-29 11:01:52,162 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:01:52,164 - sqlalchemy.engine.Engine - INFO - [cached since 14.74s ago] {'device_id_1': 9}
2025-12-29 11:01:52,196 - app.database - ERROR - Database session error: [TypeError("'numpy.bool' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')]
2025-12-29 11:01:52,196 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:01:52,202 - app.main - ERROR - Unhandled exception: [TypeError("'numpy.bool' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')]
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 327, in jsonable_encoder
    data = dict(obj)
TypeError: 'numpy.bool' object is not iterable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 332, in jsonable_encoder
    data = vars(obj)
TypeError: vars() argument must have __dict__ attribute

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 232, in serialize_response
    return jsonable_encoder(response_content)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 288, in jsonable_encoder
    encoded_value = jsonable_encoder(
        value,
    ...<4 lines>...
        sqlalchemy_safe=sqlalchemy_safe,
    )
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 288, in jsonable_encoder
    encoded_value = jsonable_encoder(
        value,
    ...<4 lines>...
        sqlalchemy_safe=sqlalchemy_safe,
    )
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 288, in jsonable_encoder
    encoded_value = jsonable_encoder(
        value,
    ...<4 lines>...
        sqlalchemy_safe=sqlalchemy_safe,
    )
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 335, in jsonable_encoder
    raise ValueError(errors) from e
ValueError: [TypeError("'numpy.bool' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')]
2025-12-29 11:01:55,942 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:01:55,943 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:01:55,944 - sqlalchemy.engine.Engine - INFO - [cached since 114.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:01:55,951 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:02:03,480 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:02:03,485 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:02:03,488 - sqlalchemy.engine.Engine - INFO - [cached since 122s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:02:03,493 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:02:03,495 - sqlalchemy.engine.Engine - INFO - [cached since 121.8s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:02:03,506 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:02:03,525 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:02:03,527 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:02:03,528 - sqlalchemy.engine.Engine - INFO - [cached since 122.1s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:02:03,541 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:02:06,248 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:02:06,271 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:02:06,273 - sqlalchemy.engine.Engine - INFO - [cached since 124.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:02:06,279 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:02:06,286 - sqlalchemy.engine.Engine - INFO - [cached since 124.7s ago] {}
2025-12-29 11:02:06,290 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:02:06,292 - sqlalchemy.engine.Engine - INFO - [cached since 33.87s ago] {'param_1': 0, 'param_2': 20}
2025-12-29 11:02:06,301 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:02:06,305 - sqlalchemy.engine.Engine - INFO - [cached since 100.4s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:02:06,331 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:02:06,333 - sqlalchemy.engine.Engine - INFO - [cached since 100.4s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:02:06,338 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:02:06,339 - sqlalchemy.engine.Engine - INFO - [cached since 100.4s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:02:06,344 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:02:06,347 - sqlalchemy.engine.Engine - INFO - [cached since 100.4s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:02:06,357 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:02:06,359 - sqlalchemy.engine.Engine - INFO - [cached since 100.4s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:02:06,365 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:02:06,367 - sqlalchemy.engine.Engine - INFO - [cached since 100.4s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:02:06,370 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:02:06,372 - sqlalchemy.engine.Engine - INFO - [cached since 100.4s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:02:06,376 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:02:06,377 - sqlalchemy.engine.Engine - INFO - [cached since 100.4s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-29 11:02:06,388 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:02:11,669 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:02:11,671 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:02:11,672 - sqlalchemy.engine.Engine - INFO - [cached since 130.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:02:11,675 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:02:11,676 - sqlalchemy.engine.Engine - INFO - [cached since 129.7s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:02:11,684 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:02:11,685 - sqlalchemy.engine.Engine - INFO - [cached since 34.27s ago] {'device_id_1': 9}
2025-12-29 11:02:11,688 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:02:11,689 - sqlalchemy.engine.Engine - INFO - [cached since 34.27s ago] {'device_id_1': 9}
2025-12-29 11:02:11,720 - app.database - ERROR - Database session error: [TypeError("'numpy.bool' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')]
2025-12-29 11:07:05,343 - app.main - INFO - Starting WiFi Tracker System...
2025-12-29 11:07:05,468 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-29 11:07:05,494 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:07:05,499 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-29 11:07:05,500 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:07:05,503 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-29 11:07:05,506 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:07:05,512 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:07:05,516 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-29 11:07:05,530 - sqlalchemy.engine.Engine - INFO - [generated in 0.01766s] {}
2025-12-29 11:07:05,533 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:07:05,537 - app.main - INFO - Database connection successful
2025-12-29 11:07:05,538 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:07:05,540 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-29 11:07:05,541 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:07:05,623 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-29 11:07:05,632 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:07:05,667 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-29 11:07:05,672 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:07:05,693 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-29 11:07:05,695 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:07:05,710 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-29 11:07:05,712 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:07:05,724 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-29 11:07:05,727 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:07:05,738 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-29 11:07:05,739 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:07:05,761 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-29 11:07:05,763 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:07:05,799 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:07:05,810 - app.database - INFO - Database tables initialized successfully
2025-12-29 11:09:25,654 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-29 11:09:45,679 - app.main - INFO - Starting WiFi Tracker System...
2025-12-29 11:09:45,689 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-29 11:09:45,690 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:09:45,693 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-29 11:09:45,694 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:09:45,696 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-29 11:09:45,697 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:09:45,700 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:09:45,702 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-29 11:09:45,707 - sqlalchemy.engine.Engine - INFO - [generated in 0.00640s] {}
2025-12-29 11:09:45,709 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:09:45,711 - app.main - INFO - Database connection successful
2025-12-29 11:09:45,712 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:09:45,713 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-29 11:09:45,714 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:09:45,748 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-29 11:09:45,751 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:09:45,762 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-29 11:09:45,764 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:09:45,772 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-29 11:09:45,774 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:09:45,784 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-29 11:09:45,785 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:09:45,793 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-29 11:09:45,796 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:09:45,806 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-29 11:09:45,808 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:09:45,817 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-29 11:09:45,818 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:09:45,828 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:09:45,830 - app.database - INFO - Database tables initialized successfully
2025-12-29 11:09:54,868 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-29 11:10:10,240 - app.main - INFO - Starting WiFi Tracker System...
2025-12-29 11:10:10,253 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-29 11:10:10,255 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:10:10,260 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-29 11:10:10,261 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:10:10,264 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-29 11:10:10,268 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:10:10,273 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:10:10,274 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-29 11:10:10,275 - sqlalchemy.engine.Engine - INFO - [generated in 0.00287s] {}
2025-12-29 11:10:10,277 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:10:10,279 - app.main - INFO - Database connection successful
2025-12-29 11:10:10,283 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:10:10,285 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-29 11:10:10,286 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:10:10,313 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-29 11:10:10,317 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:10:10,327 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-29 11:10:10,329 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:10:10,355 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-29 11:10:10,356 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:10:10,370 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-29 11:10:10,371 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:10:10,383 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-29 11:10:10,385 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:10:10,396 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-29 11:10:10,397 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:10:10,409 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-29 11:10:10,410 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:10:10,421 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:10:10,423 - app.database - INFO - Database tables initialized successfully
2025-12-29 11:10:33,830 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-29 11:10:51,244 - app.main - INFO - Starting WiFi Tracker System...
2025-12-29 11:10:51,252 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-29 11:10:51,254 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:10:51,260 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-29 11:10:51,263 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:10:51,265 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-29 11:10:51,266 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:10:51,270 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:10:51,276 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-29 11:10:51,278 - sqlalchemy.engine.Engine - INFO - [generated in 0.00741s] {}
2025-12-29 11:10:51,280 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:10:51,282 - app.main - INFO - Database connection successful
2025-12-29 11:10:51,283 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:10:51,287 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-29 11:10:51,292 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:10:51,321 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-29 11:10:51,326 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:10:51,341 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-29 11:10:51,343 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:10:51,383 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-29 11:10:51,392 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:10:51,407 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-29 11:10:51,408 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:10:51,420 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-29 11:10:51,423 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:10:51,437 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-29 11:10:51,441 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:10:51,454 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-29 11:10:51,456 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:10:51,469 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:10:51,478 - app.database - INFO - Database tables initialized successfully
2025-12-29 11:11:45,170 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-29 11:11:59,089 - app.main - INFO - Starting WiFi Tracker System...
2025-12-29 11:11:59,098 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-29 11:11:59,100 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:11:59,105 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-29 11:11:59,107 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:11:59,110 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-29 11:11:59,111 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:11:59,114 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:11:59,115 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-29 11:11:59,117 - sqlalchemy.engine.Engine - INFO - [generated in 0.00273s] {}
2025-12-29 11:11:59,119 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:11:59,125 - app.main - INFO - Database connection successful
2025-12-29 11:11:59,126 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:11:59,128 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-29 11:11:59,129 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:11:59,207 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-29 11:11:59,217 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:11:59,247 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-29 11:11:59,252 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:11:59,267 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-29 11:11:59,269 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:11:59,280 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-29 11:11:59,281 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:11:59,306 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-29 11:11:59,308 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:11:59,316 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-29 11:11:59,318 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:11:59,330 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-29 11:11:59,333 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:11:59,349 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:11:59,352 - app.database - INFO - Database tables initialized successfully
2025-12-29 11:13:07,638 - app.main - INFO - Starting WiFi Tracker System...
2025-12-29 11:13:07,647 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-29 11:13:07,650 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:13:07,652 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-29 11:13:07,653 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:13:07,656 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-29 11:13:07,658 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:13:07,663 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:13:07,664 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-29 11:13:07,665 - sqlalchemy.engine.Engine - INFO - [generated in 0.00267s] {}
2025-12-29 11:13:07,668 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:13:07,670 - app.main - INFO - Database connection successful
2025-12-29 11:13:07,672 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:13:07,677 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-29 11:13:07,678 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:13:07,708 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-29 11:13:07,710 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:13:07,723 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-29 11:13:07,731 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:13:07,744 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-29 11:13:07,753 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:13:07,766 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-29 11:13:07,770 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:13:07,781 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-29 11:13:07,786 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:13:07,799 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-29 11:13:07,805 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:13:07,819 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-29 11:13:07,831 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:13:07,847 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:13:07,855 - app.database - INFO - Database tables initialized successfully
2025-12-29 11:13:07,864 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-29 11:13:39,045 - app.main - INFO - Starting WiFi Tracker System...
2025-12-29 11:13:39,071 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-29 11:13:39,072 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:13:39,075 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-29 11:13:39,076 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:13:39,077 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-29 11:13:39,080 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:13:39,084 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:13:39,086 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-29 11:13:39,087 - sqlalchemy.engine.Engine - INFO - [generated in 0.00269s] {}
2025-12-29 11:13:39,089 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:13:39,091 - app.main - INFO - Database connection successful
2025-12-29 11:13:39,092 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:13:39,093 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-29 11:13:39,094 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:13:39,119 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-29 11:13:39,120 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:13:39,144 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-29 11:13:39,153 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:13:39,165 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-29 11:13:39,171 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:13:39,180 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-29 11:13:39,186 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:13:39,195 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-29 11:13:39,202 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:13:39,211 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-29 11:13:39,225 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:13:39,234 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-29 11:13:39,239 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:13:39,248 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:13:39,251 - app.database - INFO - Database tables initialized successfully
2025-12-29 11:13:39,255 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-29 11:14:31,201 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-29 11:14:47,117 - app.main - INFO - Starting WiFi Tracker System...
2025-12-29 11:14:47,127 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-29 11:14:47,128 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:14:47,135 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-29 11:14:47,136 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:14:47,140 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-29 11:14:47,141 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:14:47,146 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:14:47,152 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-29 11:14:47,153 - sqlalchemy.engine.Engine - INFO - [generated in 0.00762s] {}
2025-12-29 11:14:47,156 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:14:47,158 - app.main - INFO - Database connection successful
2025-12-29 11:14:47,159 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:14:47,160 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-29 11:14:47,166 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:14:47,196 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-29 11:14:47,239 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:14:47,270 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-29 11:14:47,272 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:14:47,288 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-29 11:14:47,289 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:14:47,302 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-29 11:14:47,303 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:14:47,316 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-29 11:14:47,318 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:14:47,330 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-29 11:14:47,332 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:14:47,346 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-29 11:14:47,348 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:14:47,364 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:14:47,367 - app.database - INFO - Database tables initialized successfully
2025-12-29 11:15:11,525 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-29 11:15:28,905 - app.main - INFO - Starting WiFi Tracker System...
2025-12-29 11:15:28,916 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-29 11:15:28,917 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:15:28,923 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-29 11:15:28,925 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:15:28,927 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-29 11:15:28,930 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:15:28,938 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:15:28,940 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-29 11:15:28,941 - sqlalchemy.engine.Engine - INFO - [generated in 0.00334s] {}
2025-12-29 11:15:28,944 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:15:28,947 - app.main - INFO - Database connection successful
2025-12-29 11:15:28,950 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:15:28,952 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-29 11:15:28,953 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:15:28,988 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-29 11:15:28,990 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:15:29,001 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-29 11:15:29,002 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:15:29,029 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-29 11:15:29,032 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:15:29,049 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-29 11:15:29,051 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:15:29,062 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-29 11:15:29,065 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:15:29,077 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-29 11:15:29,078 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:15:29,124 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-29 11:15:29,128 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:15:29,142 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:15:29,145 - app.database - INFO - Database tables initialized successfully
2025-12-29 11:17:16,847 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-29 11:18:08,881 - app.main - INFO - Starting WiFi Tracker System...
2025-12-29 11:18:09,246 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-29 11:18:09,250 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:18:09,259 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-29 11:18:09,262 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:18:09,272 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-29 11:18:09,275 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:18:09,282 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:18:09,288 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-29 11:18:09,291 - sqlalchemy.engine.Engine - INFO - [generated in 0.00942s] {}
2025-12-29 11:18:09,296 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:18:09,299 - app.main - INFO - Database connection successful
2025-12-29 11:18:09,302 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:18:09,309 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-29 11:18:09,314 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:18:09,384 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-29 11:18:09,389 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:18:09,414 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-29 11:18:09,418 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:18:09,434 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-29 11:18:09,437 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:18:09,466 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-29 11:18:09,469 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:18:09,480 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-29 11:18:09,481 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:18:09,515 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-29 11:18:09,520 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:18:09,534 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-29 11:18:09,537 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:18:09,548 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:18:09,551 - app.database - INFO - Database tables initialized successfully
2025-12-29 11:18:43,251 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:18:43,260 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:43,262 - sqlalchemy.engine.Engine - INFO - [generated in 0.00236s] {'id_1': 1, 'param_1': 1}
2025-12-29 11:18:43,350 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:18:43,355 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:18:43,356 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:43,357 - sqlalchemy.engine.Engine - INFO - [cached since 0.09776s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:18:43,364 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:18:43,492 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:18:43,494 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:43,495 - sqlalchemy.engine.Engine - INFO - [cached since 0.2354s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:18:43,510 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:18:43,512 - sqlalchemy.engine.Engine - INFO - [generated in 0.00167s] {}
2025-12-29 11:18:43,521 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:18:43,523 - sqlalchemy.engine.Engine - INFO - [generated in 0.00186s] {'last_seen_1': datetime.datetime(2025, 12, 29, 5, 38, 43, 515119)}
2025-12-29 11:18:43,536 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:18:43,538 - sqlalchemy.engine.Engine - INFO - [generated in 0.00188s] {}
2025-12-29 11:18:43,549 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:18:43,551 - sqlalchemy.engine.Engine - INFO - [generated in 0.00162s] {}
2025-12-29 11:18:43,560 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:18:43,563 - sqlalchemy.engine.Engine - INFO - [generated in 0.00378s] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:18:43,583 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:18:43,584 - sqlalchemy.engine.Engine - INFO - [generated in 0.00162s] {}
2025-12-29 11:18:43,598 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:18:43,600 - sqlalchemy.engine.Engine - INFO - [generated in 0.00226s] {}
2025-12-29 11:18:43,613 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:18:43,615 - sqlalchemy.engine.Engine - INFO - [generated in 0.00157s] {'status_1': 'completed'}
2025-12-29 11:18:43,620 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:18:43,621 - sqlalchemy.engine.Engine - INFO - [generated in 0.00135s] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:18:43,628 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:18:43,630 - sqlalchemy.engine.Engine - INFO - [generated in 0.00191s] {}
2025-12-29 11:18:43,637 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:18:43,646 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:18:43,647 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:43,648 - sqlalchemy.engine.Engine - INFO - [cached since 0.3888s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:18:43,659 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:18:43,661 - sqlalchemy.engine.Engine - INFO - [cached since 0.1513s ago] {}
2025-12-29 11:18:43,669 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:18:43,670 - sqlalchemy.engine.Engine - INFO - [cached since 0.1496s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 5, 38, 43, 667934)}
2025-12-29 11:18:43,676 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:18:43,678 - sqlalchemy.engine.Engine - INFO - [cached since 0.142s ago] {}
2025-12-29 11:18:43,681 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:18:43,683 - sqlalchemy.engine.Engine - INFO - [cached since 0.1333s ago] {}
2025-12-29 11:18:43,686 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:18:43,688 - sqlalchemy.engine.Engine - INFO - [cached since 0.1283s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:18:43,694 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:18:43,696 - sqlalchemy.engine.Engine - INFO - [cached since 0.113s ago] {}
2025-12-29 11:18:43,700 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:18:43,701 - sqlalchemy.engine.Engine - INFO - [cached since 0.1026s ago] {}
2025-12-29 11:18:43,705 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:18:43,706 - sqlalchemy.engine.Engine - INFO - [cached since 0.09284s ago] {'status_1': 'completed'}
2025-12-29 11:18:43,709 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:18:43,711 - sqlalchemy.engine.Engine - INFO - [cached since 0.09079s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:18:43,714 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:18:43,716 - sqlalchemy.engine.Engine - INFO - [cached since 0.08748s ago] {}
2025-12-29 11:18:43,721 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:18:43,740 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:18:43,746 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:43,752 - sqlalchemy.engine.Engine - INFO - [cached since 0.4927s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:18:43,766 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:43,769 - sqlalchemy.engine.Engine - INFO - [generated in 0.00331s] {'id_1': 7, 'param_1': 1}
2025-12-29 11:18:43,781 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:18:43,784 - sqlalchemy.engine.Engine - INFO - [generated in 0.00273s] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 22, 5, 48, 43, 776269), 'param_1': 100}
2025-12-29 11:18:43,814 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s AND scan_results.scan_timestamp >= %(scan_timestamp_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:18:43,821 - sqlalchemy.engine.Engine - INFO - [generated in 0.00747s] {'device_id_1': 7, 'scan_timestamp_1': datetime.datetime(2025, 12, 22, 5, 48, 43, 776269), 'param_1': 100}
2025-12-29 11:18:43,973 - app.services.notification - INFO - WebSocket client registered. Total: 1
2025-12-29 11:18:44,012 - app.main - INFO - WebSocket client connected
2025-12-29 11:18:43,940 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:18:44,030 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:18:44,036 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,039 - sqlalchemy.engine.Engine - INFO - [cached since 0.7797s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:18:44,053 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,055 - sqlalchemy.engine.Engine - INFO - [cached since 0.2889s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:18:44,061 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:18:44,083 - sqlalchemy.engine.Engine - INFO - [cached since 0.3015s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 22, 5, 48, 44, 58942), 'param_1': 100}
2025-12-29 11:18:44,089 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s AND scan_results.scan_timestamp >= %(scan_timestamp_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:18:44,091 - sqlalchemy.engine.Engine - INFO - [cached since 0.2771s ago] {'device_id_1': 7, 'scan_timestamp_1': datetime.datetime(2025, 12, 22, 5, 48, 44, 58942), 'param_1': 100}
2025-12-29 11:18:44,101 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:18:44,104 - app.services.notification - INFO - WebSocket client registered. Total: 2
2025-12-29 11:18:44,119 - app.main - INFO - WebSocket client connected
2025-12-29 11:18:44,130 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:18:44,131 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,133 - sqlalchemy.engine.Engine - INFO - [cached since 0.8731s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:18:44,137 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:18:44,139 - sqlalchemy.engine.Engine - INFO - [cached since 0.629s ago] {}
2025-12-29 11:18:44,144 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:18:44,146 - sqlalchemy.engine.Engine - INFO - [cached since 0.6255s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 5, 38, 44, 142478)}
2025-12-29 11:18:44,151 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:18:44,154 - sqlalchemy.engine.Engine - INFO - [cached since 0.6179s ago] {}
2025-12-29 11:18:44,159 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:18:44,161 - sqlalchemy.engine.Engine - INFO - [cached since 0.6119s ago] {}
2025-12-29 11:18:44,166 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:18:44,167 - sqlalchemy.engine.Engine - INFO - [cached since 0.6073s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:18:44,172 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:18:44,174 - sqlalchemy.engine.Engine - INFO - [cached since 0.5905s ago] {}
2025-12-29 11:18:44,181 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:18:44,182 - sqlalchemy.engine.Engine - INFO - [cached since 0.584s ago] {}
2025-12-29 11:18:44,187 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:18:44,188 - sqlalchemy.engine.Engine - INFO - [cached since 0.5752s ago] {'status_1': 'completed'}
2025-12-29 11:18:44,193 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:18:44,195 - sqlalchemy.engine.Engine - INFO - [cached since 0.5753s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:18:44,199 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:18:44,200 - sqlalchemy.engine.Engine - INFO - [cached since 0.5722s ago] {}
2025-12-29 11:18:44,207 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:18:44,216 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:18:44,217 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,218 - sqlalchemy.engine.Engine - INFO - [cached since 0.9586s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:18:44,223 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:18:44,225 - sqlalchemy.engine.Engine - INFO - [cached since 0.7143s ago] {}
2025-12-29 11:18:44,233 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:18:44,235 - sqlalchemy.engine.Engine - INFO - [cached since 0.7141s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 5, 38, 44, 231929)}
2025-12-29 11:18:44,240 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:18:44,245 - sqlalchemy.engine.Engine - INFO - [cached since 0.7088s ago] {}
2025-12-29 11:18:44,249 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:18:44,250 - sqlalchemy.engine.Engine - INFO - [cached since 0.701s ago] {}
2025-12-29 11:18:44,254 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:18:44,255 - sqlalchemy.engine.Engine - INFO - [cached since 0.6954s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:18:44,259 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:18:44,263 - sqlalchemy.engine.Engine - INFO - [cached since 0.6805s ago] {}
2025-12-29 11:18:44,267 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:18:44,270 - sqlalchemy.engine.Engine - INFO - [cached since 0.6716s ago] {}
2025-12-29 11:18:44,273 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:18:44,277 - sqlalchemy.engine.Engine - INFO - [cached since 0.6644s ago] {'status_1': 'completed'}
2025-12-29 11:18:44,281 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:18:44,283 - sqlalchemy.engine.Engine - INFO - [cached since 0.6633s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:18:44,287 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:18:44,290 - sqlalchemy.engine.Engine - INFO - [cached since 0.6615s ago] {}
2025-12-29 11:18:44,303 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:18:44,314 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:18:44,318 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,319 - sqlalchemy.engine.Engine - INFO - [cached since 1.06s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:18:44,329 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:18:44,331 - sqlalchemy.engine.Engine - INFO - [generated in 0.00281s] {'event_timestamp_1': datetime.datetime(2025, 12, 28, 5, 48, 44, 325793), 'param_1': 100}
2025-12-29 11:18:44,336 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,338 - sqlalchemy.engine.Engine - INFO - [cached since 0.5723s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:18:44,342 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,343 - sqlalchemy.engine.Engine - INFO - [cached since 0.5778s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:18:44,348 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,352 - sqlalchemy.engine.Engine - INFO - [cached since 0.5864s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:18:44,359 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,360 - sqlalchemy.engine.Engine - INFO - [cached since 0.5948s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:18:44,366 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,369 - sqlalchemy.engine.Engine - INFO - [cached since 0.6029s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:18:44,374 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,380 - sqlalchemy.engine.Engine - INFO - [cached since 0.6141s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:18:44,384 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,385 - sqlalchemy.engine.Engine - INFO - [cached since 0.6195s ago] {'id_1': 13, 'param_1': 1}
2025-12-29 11:18:44,389 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,393 - sqlalchemy.engine.Engine - INFO - [cached since 0.6274s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:18:44,400 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,402 - sqlalchemy.engine.Engine - INFO - [cached since 0.6362s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:18:44,405 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,407 - sqlalchemy.engine.Engine - INFO - [cached since 0.6412s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:18:44,413 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,415 - sqlalchemy.engine.Engine - INFO - [cached since 0.6492s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:18:44,419 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,420 - sqlalchemy.engine.Engine - INFO - [cached since 0.6545s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:18:44,424 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,428 - sqlalchemy.engine.Engine - INFO - [cached since 0.6621s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:18:44,436 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:18:44,865 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:18:44,866 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,868 - sqlalchemy.engine.Engine - INFO - [cached since 1.609s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:18:44,872 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:18:44,874 - sqlalchemy.engine.Engine - INFO - [cached since 0.5457s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 28, 5, 48, 44, 871377), 'param_1': 100}
2025-12-29 11:18:44,885 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,886 - sqlalchemy.engine.Engine - INFO - [cached since 1.12s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:18:44,890 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,891 - sqlalchemy.engine.Engine - INFO - [cached since 1.125s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:18:44,900 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,901 - sqlalchemy.engine.Engine - INFO - [cached since 1.135s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:18:44,905 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,906 - sqlalchemy.engine.Engine - INFO - [cached since 1.14s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:18:44,911 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,913 - sqlalchemy.engine.Engine - INFO - [cached since 1.148s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:18:44,918 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,919 - sqlalchemy.engine.Engine - INFO - [cached since 1.153s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:18:44,922 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,923 - sqlalchemy.engine.Engine - INFO - [cached since 1.157s ago] {'id_1': 13, 'param_1': 1}
2025-12-29 11:18:44,928 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,932 - sqlalchemy.engine.Engine - INFO - [cached since 1.166s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:18:44,935 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,936 - sqlalchemy.engine.Engine - INFO - [cached since 1.171s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:18:44,940 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,945 - sqlalchemy.engine.Engine - INFO - [cached since 1.18s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:18:44,950 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,951 - sqlalchemy.engine.Engine - INFO - [cached since 1.186s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:18:44,955 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,957 - sqlalchemy.engine.Engine - INFO - [cached since 1.191s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:18:44,967 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:44,969 - sqlalchemy.engine.Engine - INFO - [cached since 1.203s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:18:44,975 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:18:48,186 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:18:48,188 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:48,189 - sqlalchemy.engine.Engine - INFO - [cached since 4.93s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:18:48,205 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-29 11:18:48,207 - sqlalchemy.engine.Engine - INFO - [generated in 0.00183s] {'started_at': datetime.datetime(2025, 12, 29, 5, 48, 48, 205298), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'arp', 'network_range': '192.168.1.0/24', 'status': 'running', 'error_message': None}
2025-12-29 11:18:48,216 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:18:48,222 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:18:48,227 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-29 11:18:48,228 - sqlalchemy.engine.Engine - INFO - [generated in 0.00182s] {'pk_1': 29}
2025-12-29 11:18:48,234 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-29 11:18:48,236 - sqlalchemy.engine.Engine - INFO - [generated in 0.00146s] {'pk_1': 1}
2025-12-29 11:18:48,239 - app.routers.scans - INFO - Scan started by admin: 29
2025-12-29 11:18:48,247 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:18:48,249 - sqlalchemy.engine.Engine - INFO - [generated in 0.00154s] {'id_1': 29, 'param_1': 1}
2025-12-29 11:18:48,251 - app.services.scanner - INFO - Starting ARP scan on 192.168.1.0/24
2025-12-29 11:18:48,253 - app.services.scanner - INFO - Starting fallback scan on 192.168.1.0/24 (ping + ARP table)
2025-12-29 11:19:16,423 - app.services.scanner - INFO - Fallback scan complete: 8 devices found
2025-12-29 11:19:16,428 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:16,431 - sqlalchemy.engine.Engine - INFO - [generated in 0.00242s] {'mac_address_1': '96:A4:CB:4D:96:A9', 'param_1': 1}
2025-12-29 11:19:16,438 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:16,440 - sqlalchemy.engine.Engine - INFO - [generated in 0.00164s] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:19:16,447 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:16,448 - sqlalchemy.engine.Engine - INFO - [cached since 0.02032s ago] {'mac_address_1': 'FF:FF:FF:FF:FF:FF', 'param_1': 1}
2025-12-29 11:19:16,453 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:16,454 - sqlalchemy.engine.Engine - INFO - [cached since 0.01634s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:19:16,459 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:16,460 - sqlalchemy.engine.Engine - INFO - [cached since 0.03192s ago] {'mac_address_1': '01:00:5E:00:00:16', 'param_1': 1}
2025-12-29 11:19:16,464 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:16,465 - sqlalchemy.engine.Engine - INFO - [cached since 0.02693s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:19:16,470 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:16,471 - sqlalchemy.engine.Engine - INFO - [cached since 0.04326s ago] {'mac_address_1': '01:00:5E:00:00:FB', 'param_1': 1}
2025-12-29 11:19:16,475 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:16,476 - sqlalchemy.engine.Engine - INFO - [cached since 0.03816s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:19:16,480 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:16,482 - sqlalchemy.engine.Engine - INFO - [cached since 0.05375s ago] {'mac_address_1': '01:00:5E:00:00:FC', 'param_1': 1}
2025-12-29 11:19:16,487 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:16,489 - sqlalchemy.engine.Engine - INFO - [cached since 0.051s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:19:16,493 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:16,496 - sqlalchemy.engine.Engine - INFO - [cached since 0.06755s ago] {'mac_address_1': '01:00:5E:7F:66:12', 'param_1': 1}
2025-12-29 11:19:16,499 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:16,504 - sqlalchemy.engine.Engine - INFO - [cached since 0.06606s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:19:16,509 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:16,510 - sqlalchemy.engine.Engine - INFO - [cached since 0.08188s ago] {'mac_address_1': '01:00:5E:7F:FF:FA', 'param_1': 1}
2025-12-29 11:19:16,514 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:16,516 - sqlalchemy.engine.Engine - INFO - [cached since 0.07825s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:19:16,523 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:16,525 - sqlalchemy.engine.Engine - INFO - [cached since 0.09654s ago] {'mac_address_1': 'FF:FF:FF:FF:FF:FF', 'param_1': 1}
2025-12-29 11:19:16,528 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:16,530 - sqlalchemy.engine.Engine - INFO - [cached since 0.09168s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:19:16,542 - sqlalchemy.engine.Engine - INFO - UPDATE devices SET last_seen=%(last_seen)s WHERE devices.id = %(devices_id)s
2025-12-29 11:19:16,543 - sqlalchemy.engine.Engine - INFO - [generated in 0.00139s] [{'last_seen': datetime.datetime(2025, 12, 29, 5, 49, 16, 442866), 'devices_id': 8}, {'last_seen': datetime.datetime(2025, 12, 29, 5, 49, 16, 532669), 'devices_id': 9}, {'last_seen': datetime.datetime(2025, 12, 29, 5, 49, 16, 468135), 'devices_id': 10}, {'last_seen': datetime.datetime(2025, 12, 29, 5, 49, 16, 478984), 'devices_id': 11}, {'last_seen': datetime.datetime(2025, 12, 29, 5, 49, 16, 491917), 'devices_id': 12}, {'last_seen': datetime.datetime(2025, 12, 29, 5, 49, 16, 507420), 'devices_id': 13}, {'last_seen': datetime.datetime(2025, 12, 29, 5, 49, 16, 521896), 'devices_id': 14}]
2025-12-29 11:19:16,559 - sqlalchemy.engine.Engine - INFO - UPDATE scan_sessions SET completed_at=%(completed_at)s, total_devices_found=%(total_devices_found)s, status=%(status)s WHERE scan_sessions.id = %(scan_sessions_id)s
2025-12-29 11:19:16,560 - sqlalchemy.engine.Engine - INFO - [generated in 0.00125s] {'completed_at': datetime.datetime(2025, 12, 29, 5, 49, 16, 533315), 'total_devices_found': 8, 'status': 'completed', 'scan_sessions_id': 29}
2025-12-29 11:19:16,564 - sqlalchemy.engine.Engine - INFO - INSERT INTO device_activity (device_id, event_type, old_value, new_value, event_timestamp) VALUES (%(device_id)s, %(event_type)s, %(old_value)s, %(new_value)s, %(event_timestamp)s)
2025-12-29 11:19:16,565 - sqlalchemy.engine.Engine - INFO - [generated in 0.00125s] {'device_id': 9, 'event_type': 'ip_changed', 'old_value': '255.255.255.255', 'new_value': '10.41.243.255', 'event_timestamp': datetime.datetime(2025, 12, 29, 5, 49, 16, 564634)}
2025-12-29 11:19:16,572 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:19:16,573 - sqlalchemy.engine.Engine - INFO - [generated in 0.00139s] {'device_id': 8, 'ip_address': '10.41.243.123', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 5, 49, 16, 572468), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:19:16,576 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:19:16,578 - sqlalchemy.engine.Engine - INFO - [cached since 0.005861s ago] {'device_id': 9, 'ip_address': '10.41.243.255', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 5, 49, 16, 576827), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:19:16,580 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:19:16,581 - sqlalchemy.engine.Engine - INFO - [cached since 0.009124s ago] {'device_id': 10, 'ip_address': '224.0.0.22', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 5, 49, 16, 580289), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:19:16,587 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:19:16,588 - sqlalchemy.engine.Engine - INFO - [cached since 0.0165s ago] {'device_id': 11, 'ip_address': '224.0.0.251', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 5, 49, 16, 587600), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:19:16,592 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:19:16,593 - sqlalchemy.engine.Engine - INFO - [cached since 0.021s ago] {'device_id': 12, 'ip_address': '224.0.0.252', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 5, 49, 16, 592215), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:19:16,595 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:19:16,597 - sqlalchemy.engine.Engine - INFO - [cached since 0.02543s ago] {'device_id': 13, 'ip_address': '239.255.102.18', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 5, 49, 16, 595185), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:19:16,599 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:19:16,603 - sqlalchemy.engine.Engine - INFO - [cached since 0.03105s ago] {'device_id': 14, 'ip_address': '239.255.255.250', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 5, 49, 16, 599703), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:19:16,606 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:19:16,607 - sqlalchemy.engine.Engine - INFO - [cached since 0.03534s ago] {'device_id': 9, 'ip_address': '255.255.255.255', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 5, 49, 16, 606546), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:19:16,611 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:19:16,620 - app.routers.scans - INFO - Scan completed: 8 devices, 0 new
2025-12-29 11:19:16,643 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:19:16,645 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:16,647 - sqlalchemy.engine.Engine - INFO - [cached since 33.39s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:19:16,652 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:19:16,654 - sqlalchemy.engine.Engine - INFO - [cached since 33.14s ago] {}
2025-12-29 11:19:16,659 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:19:16,660 - sqlalchemy.engine.Engine - INFO - [generated in 0.00135s] {'param_1': 0, 'param_2': 20}
2025-12-29 11:19:16,665 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:16,666 - sqlalchemy.engine.Engine - INFO - [cached since 0.2282s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:19:16,674 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:16,675 - sqlalchemy.engine.Engine - INFO - [cached since 0.2374s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:19:16,679 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:16,680 - sqlalchemy.engine.Engine - INFO - [cached since 0.2421s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:19:16,684 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:16,686 - sqlalchemy.engine.Engine - INFO - [cached since 0.2479s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:19:16,690 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:16,693 - sqlalchemy.engine.Engine - INFO - [cached since 0.2547s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:19:16,696 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:16,698 - sqlalchemy.engine.Engine - INFO - [cached since 0.2601s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:19:16,702 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:16,704 - sqlalchemy.engine.Engine - INFO - [cached since 0.2658s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:19:16,709 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:16,711 - sqlalchemy.engine.Engine - INFO - [cached since 0.2725s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-29 11:19:16,724 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:19:16,726 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:19:16,728 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:16,729 - sqlalchemy.engine.Engine - INFO - [cached since 33.47s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:19:16,735 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:19:16,745 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:19:16,747 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:16,748 - sqlalchemy.engine.Engine - INFO - [cached since 33.49s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:19:16,754 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:19:16,755 - sqlalchemy.engine.Engine - INFO - [cached since 33.24s ago] {}
2025-12-29 11:19:16,764 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:19:16,765 - sqlalchemy.engine.Engine - INFO - [cached since 33.24s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 5, 39, 16, 762826)}
2025-12-29 11:19:16,774 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:19:16,775 - sqlalchemy.engine.Engine - INFO - [cached since 33.24s ago] {}
2025-12-29 11:19:16,779 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:19:16,782 - sqlalchemy.engine.Engine - INFO - [cached since 33.23s ago] {}
2025-12-29 11:19:16,793 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:19:16,795 - sqlalchemy.engine.Engine - INFO - [cached since 33.24s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:19:16,799 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:19:16,802 - sqlalchemy.engine.Engine - INFO - [cached since 33.22s ago] {}
2025-12-29 11:19:16,807 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:19:16,808 - sqlalchemy.engine.Engine - INFO - [cached since 33.21s ago] {}
2025-12-29 11:19:16,811 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:19:16,812 - sqlalchemy.engine.Engine - INFO - [cached since 33.2s ago] {'status_1': 'completed'}
2025-12-29 11:19:16,815 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:16,816 - sqlalchemy.engine.Engine - INFO - [cached since 33.2s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:19:16,821 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:19:16,823 - sqlalchemy.engine.Engine - INFO - [cached since 33.19s ago] {}
2025-12-29 11:19:16,827 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:19:16,834 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:19:16,838 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:16,839 - sqlalchemy.engine.Engine - INFO - [cached since 33.58s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:19:16,844 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:19:16,845 - sqlalchemy.engine.Engine - INFO - [cached since 33.33s ago] {}
2025-12-29 11:19:16,848 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:19:16,849 - sqlalchemy.engine.Engine - INFO - [cached since 33.33s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 5, 39, 16, 846932)}
2025-12-29 11:19:16,857 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:19:16,858 - sqlalchemy.engine.Engine - INFO - [cached since 33.32s ago] {}
2025-12-29 11:19:16,861 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:19:16,862 - sqlalchemy.engine.Engine - INFO - [cached since 33.31s ago] {}
2025-12-29 11:19:16,865 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:19:16,866 - sqlalchemy.engine.Engine - INFO - [cached since 33.31s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:19:16,869 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:19:16,872 - sqlalchemy.engine.Engine - INFO - [cached since 33.29s ago] {}
2025-12-29 11:19:16,875 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:19:16,876 - sqlalchemy.engine.Engine - INFO - [cached since 33.28s ago] {}
2025-12-29 11:19:16,878 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:19:16,879 - sqlalchemy.engine.Engine - INFO - [cached since 33.27s ago] {'status_1': 'completed'}
2025-12-29 11:19:16,882 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:16,883 - sqlalchemy.engine.Engine - INFO - [cached since 33.26s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:19:16,889 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:19:16,890 - sqlalchemy.engine.Engine - INFO - [cached since 33.26s ago] {}
2025-12-29 11:19:16,894 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:19:16,906 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:19:16,908 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:16,911 - sqlalchemy.engine.Engine - INFO - [cached since 33.65s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:19:16,913 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:16,914 - sqlalchemy.engine.Engine - INFO - [cached since 33.15s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:19:16,922 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:16,924 - sqlalchemy.engine.Engine - INFO - [cached since 33.14s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 22, 5, 49, 16, 921535), 'param_1': 100}
2025-12-29 11:19:16,926 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s AND scan_results.scan_timestamp >= %(scan_timestamp_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:16,928 - sqlalchemy.engine.Engine - INFO - [cached since 33.11s ago] {'device_id_1': 7, 'scan_timestamp_1': datetime.datetime(2025, 12, 22, 5, 49, 16, 921535), 'param_1': 100}
2025-12-29 11:19:16,935 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:19:16,945 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:19:16,946 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:16,947 - sqlalchemy.engine.Engine - INFO - [cached since 33.69s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:19:16,950 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:16,954 - sqlalchemy.engine.Engine - INFO - [cached since 33.19s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:19:16,957 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:16,959 - sqlalchemy.engine.Engine - INFO - [cached since 33.18s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 22, 5, 49, 16, 957098), 'param_1': 100}
2025-12-29 11:19:16,962 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s AND scan_results.scan_timestamp >= %(scan_timestamp_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:16,964 - sqlalchemy.engine.Engine - INFO - [cached since 33.15s ago] {'device_id_1': 7, 'scan_timestamp_1': datetime.datetime(2025, 12, 22, 5, 49, 16, 957098), 'param_1': 100}
2025-12-29 11:19:16,972 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:19:16,978 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:19:16,979 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:16,980 - sqlalchemy.engine.Engine - INFO - [cached since 33.72s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:19:16,983 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:19:16,984 - sqlalchemy.engine.Engine - INFO - [cached since 33.47s ago] {}
2025-12-29 11:19:16,991 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:19:16,993 - sqlalchemy.engine.Engine - INFO - [cached since 33.47s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 5, 39, 16, 990282)}
2025-12-29 11:19:16,995 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:19:16,997 - sqlalchemy.engine.Engine - INFO - [cached since 33.46s ago] {}
2025-12-29 11:19:17,008 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:19:17,013 - sqlalchemy.engine.Engine - INFO - [cached since 33.46s ago] {}
2025-12-29 11:19:17,020 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:19:17,021 - sqlalchemy.engine.Engine - INFO - [cached since 33.46s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:19:17,026 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:19:17,027 - sqlalchemy.engine.Engine - INFO - [cached since 33.44s ago] {}
2025-12-29 11:19:17,031 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:19:17,032 - sqlalchemy.engine.Engine - INFO - [cached since 33.43s ago] {}
2025-12-29 11:19:17,037 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:19:17,039 - sqlalchemy.engine.Engine - INFO - [cached since 33.43s ago] {'status_1': 'completed'}
2025-12-29 11:19:17,043 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:17,044 - sqlalchemy.engine.Engine - INFO - [cached since 33.42s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:19:17,047 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:19:17,048 - sqlalchemy.engine.Engine - INFO - [cached since 33.42s ago] {}
2025-12-29 11:19:17,055 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:19:17,064 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:19:17,066 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:17,070 - sqlalchemy.engine.Engine - INFO - [cached since 33.81s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:19:17,074 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:19:17,078 - sqlalchemy.engine.Engine - INFO - [cached since 33.57s ago] {}
2025-12-29 11:19:17,080 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:19:17,081 - sqlalchemy.engine.Engine - INFO - [cached since 33.56s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 5, 39, 17, 80069)}
2025-12-29 11:19:17,088 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:19:17,090 - sqlalchemy.engine.Engine - INFO - [cached since 33.55s ago] {}
2025-12-29 11:19:17,093 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:19:17,094 - sqlalchemy.engine.Engine - INFO - [cached since 33.54s ago] {}
2025-12-29 11:19:17,097 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:19:17,097 - sqlalchemy.engine.Engine - INFO - [cached since 33.54s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:19:17,101 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:19:17,104 - sqlalchemy.engine.Engine - INFO - [cached since 33.52s ago] {}
2025-12-29 11:19:17,108 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:19:17,109 - sqlalchemy.engine.Engine - INFO - [cached since 33.51s ago] {}
2025-12-29 11:19:17,112 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:19:17,113 - sqlalchemy.engine.Engine - INFO - [cached since 33.5s ago] {'status_1': 'completed'}
2025-12-29 11:19:17,115 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:17,116 - sqlalchemy.engine.Engine - INFO - [cached since 33.5s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:19:17,123 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:19:17,124 - sqlalchemy.engine.Engine - INFO - [cached since 33.5s ago] {}
2025-12-29 11:19:17,129 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:19:17,136 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:19:17,138 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:17,139 - sqlalchemy.engine.Engine - INFO - [cached since 33.88s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:19:17,143 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:17,144 - sqlalchemy.engine.Engine - INFO - [cached since 32.82s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 28, 5, 49, 17, 142336), 'param_1': 100}
2025-12-29 11:19:17,148 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:17,150 - sqlalchemy.engine.Engine - INFO - [cached since 33.38s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:19:17,155 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:17,157 - sqlalchemy.engine.Engine - INFO - [cached since 33.39s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:19:17,159 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:17,160 - sqlalchemy.engine.Engine - INFO - [cached since 33.39s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:19:17,164 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:17,165 - sqlalchemy.engine.Engine - INFO - [cached since 33.4s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:19:17,169 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:17,171 - sqlalchemy.engine.Engine - INFO - [cached since 33.41s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:19:17,175 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:17,176 - sqlalchemy.engine.Engine - INFO - [cached since 33.41s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:19:17,178 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:17,179 - sqlalchemy.engine.Engine - INFO - [cached since 33.41s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:19:17,181 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:17,182 - sqlalchemy.engine.Engine - INFO - [cached since 33.42s ago] {'id_1': 13, 'param_1': 1}
2025-12-29 11:19:17,186 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:17,188 - sqlalchemy.engine.Engine - INFO - [cached since 33.42s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:19:17,191 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:17,193 - sqlalchemy.engine.Engine - INFO - [cached since 33.43s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:19:17,196 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:17,198 - sqlalchemy.engine.Engine - INFO - [cached since 33.43s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:19:17,201 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:17,203 - sqlalchemy.engine.Engine - INFO - [cached since 33.44s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:19:17,206 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:17,209 - sqlalchemy.engine.Engine - INFO - [cached since 33.44s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:19:17,213 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:17,214 - sqlalchemy.engine.Engine - INFO - [cached since 33.45s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:19:17,223 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:19:17,231 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:19:17,232 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:17,233 - sqlalchemy.engine.Engine - INFO - [cached since 33.97s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:19:17,236 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:17,238 - sqlalchemy.engine.Engine - INFO - [cached since 32.91s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 28, 5, 49, 17, 235911), 'param_1': 100}
2025-12-29 11:19:17,244 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:17,245 - sqlalchemy.engine.Engine - INFO - [cached since 33.48s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:19:17,247 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:17,248 - sqlalchemy.engine.Engine - INFO - [cached since 33.48s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:19:17,252 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:17,253 - sqlalchemy.engine.Engine - INFO - [cached since 33.49s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:19:17,256 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:17,257 - sqlalchemy.engine.Engine - INFO - [cached since 33.49s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:19:17,259 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:17,260 - sqlalchemy.engine.Engine - INFO - [cached since 33.49s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:19:17,262 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:17,263 - sqlalchemy.engine.Engine - INFO - [cached since 33.5s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:19:17,265 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:17,266 - sqlalchemy.engine.Engine - INFO - [cached since 33.5s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:19:17,272 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:17,273 - sqlalchemy.engine.Engine - INFO - [cached since 33.51s ago] {'id_1': 13, 'param_1': 1}
2025-12-29 11:19:17,277 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:17,278 - sqlalchemy.engine.Engine - INFO - [cached since 33.51s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:19:17,280 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:17,281 - sqlalchemy.engine.Engine - INFO - [cached since 33.52s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:19:17,286 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:17,287 - sqlalchemy.engine.Engine - INFO - [cached since 33.52s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:19:17,290 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:17,291 - sqlalchemy.engine.Engine - INFO - [cached since 33.53s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:19:17,293 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:17,294 - sqlalchemy.engine.Engine - INFO - [cached since 33.53s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:19:17,296 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:17,297 - sqlalchemy.engine.Engine - INFO - [cached since 33.53s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:19:17,301 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:19:19,211 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:19:19,213 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:19,214 - sqlalchemy.engine.Engine - INFO - [cached since 35.95s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:19:19,219 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices
2025-12-29 11:19:19,222 - sqlalchemy.engine.Engine - INFO - [generated in 0.00278s] {}
2025-12-29 11:19:19,229 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:19:19,230 - sqlalchemy.engine.Engine - INFO - [generated in 0.00154s] {'device_id_1': 7}
2025-12-29 11:19:19,236 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:19:19,238 - sqlalchemy.engine.Engine - INFO - [generated in 0.00193s] {'device_id_1': 7}
2025-12-29 11:19:19,242 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:19:19,243 - sqlalchemy.engine.Engine - INFO - [cached since 0.01445s ago] {'device_id_1': 8}
2025-12-29 11:19:19,246 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:19:19,247 - sqlalchemy.engine.Engine - INFO - [cached since 0.01099s ago] {'device_id_1': 8}
2025-12-29 11:19:19,252 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:19:19,253 - sqlalchemy.engine.Engine - INFO - [cached since 0.0246s ago] {'device_id_1': 9}
2025-12-29 11:19:19,257 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:19:19,258 - sqlalchemy.engine.Engine - INFO - [cached since 0.02173s ago] {'device_id_1': 9}
2025-12-29 11:19:19,261 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:19:19,262 - sqlalchemy.engine.Engine - INFO - [cached since 0.03351s ago] {'device_id_1': 10}
2025-12-29 11:19:19,266 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:19:19,268 - sqlalchemy.engine.Engine - INFO - [cached since 0.03225s ago] {'device_id_1': 10}
2025-12-29 11:19:19,272 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:19:19,273 - sqlalchemy.engine.Engine - INFO - [cached since 0.04423s ago] {'device_id_1': 11}
2025-12-29 11:19:19,277 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:19:19,278 - sqlalchemy.engine.Engine - INFO - [cached since 0.04174s ago] {'device_id_1': 11}
2025-12-29 11:19:19,281 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:19:19,282 - sqlalchemy.engine.Engine - INFO - [cached since 0.05302s ago] {'device_id_1': 12}
2025-12-29 11:19:19,287 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:19:19,288 - sqlalchemy.engine.Engine - INFO - [cached since 0.05222s ago] {'device_id_1': 12}
2025-12-29 11:19:19,292 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:19:19,293 - sqlalchemy.engine.Engine - INFO - [cached since 0.06448s ago] {'device_id_1': 13}
2025-12-29 11:19:19,296 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:19:19,297 - sqlalchemy.engine.Engine - INFO - [cached since 0.06106s ago] {'device_id_1': 13}
2025-12-29 11:19:19,301 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:19:19,302 - sqlalchemy.engine.Engine - INFO - [cached since 0.07375s ago] {'device_id_1': 14}
2025-12-29 11:19:19,305 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:19:19,307 - sqlalchemy.engine.Engine - INFO - [cached since 0.07082s ago] {'device_id_1': 14}
2025-12-29 11:19:19,309 - app.ml.detector - INFO - Training anomaly detector with 8 devices
2025-12-29 11:19:19,316 - app.ml.isolation_forest - INFO - Training Isolation Forest with 8 samples
2025-12-29 11:19:19,923 - app.ml.isolation_forest - INFO - Model saved to E:\wifi-tracker\backend\data\models\isolation_forest.pkl
2025-12-29 11:19:19,961 - app.ml.isolation_forest - INFO - Training complete: {'model_type': 'isolation_forest', 'samples_trained': 8, 'contamination': 0.1, 'n_estimators': 100, 'anomalies_in_training': 1, 'score_mean': 0.20380418094807246, 'score_std': 0.1301994919376182, 'trained_at': '2025-12-29T05:49:19.961373'}
2025-12-29 11:19:19,962 - app.ml.autoencoder - INFO - Training Autoencoder with 8 samples
2025-12-29 11:19:24,640 - app.ml.autoencoder - INFO - Epoch 20/100, Loss: 0.399973
2025-12-29 11:19:24,781 - app.ml.autoencoder - INFO - Epoch 40/100, Loss: 0.400121
2025-12-29 11:19:24,912 - app.ml.autoencoder - INFO - Epoch 60/100, Loss: 0.387193
2025-12-29 11:19:25,023 - app.ml.autoencoder - INFO - Epoch 80/100, Loss: 0.323427
2025-12-29 11:19:25,115 - app.ml.autoencoder - INFO - Epoch 100/100, Loss: 0.319220
2025-12-29 11:19:25,140 - app.ml.autoencoder - INFO - Autoencoder saved to E:\wifi-tracker\backend\data\models\autoencoder.pth
2025-12-29 11:19:25,140 - app.ml.autoencoder - INFO - Training complete: {'model_type': 'autoencoder', 'samples_trained': 8, 'input_dim': 15, 'encoding_dim': 8, 'epochs': 100, 'final_loss': 0.3192204236984253, 'threshold': 0.7460395693778992, 'threshold_percentile': 95, 'trained_at': '2025-12-29T05:49:25.140633'}
2025-12-29 11:19:25,141 - app.routers.dashboard - INFO - ML training initiated by admin: {'status': 'success', 'models': {'isolation_forest': {'model_type': 'isolation_forest', 'samples_trained': 8, 'contamination': 0.1, 'n_estimators': 100, 'anomalies_in_training': 1, 'score_mean': 0.20380418094807246, 'score_std': 0.1301994919376182, 'trained_at': '2025-12-29T05:49:19.961373'}, 'autoencoder': {'model_type': 'autoencoder', 'samples_trained': 8, 'input_dim': 15, 'encoding_dim': 8, 'epochs': 100, 'final_loss': 0.3192204236984253, 'threshold': 0.7460395693778992, 'threshold_percentile': 95, 'trained_at': '2025-12-29T05:49:25.140633'}}, 'trained_at': '2025-12-29T05:49:25.141553', 'total_samples': 8}
2025-12-29 11:19:25,144 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:19:25,157 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:19:25,159 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:25,160 - sqlalchemy.engine.Engine - INFO - [cached since 41.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:19:25,166 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:19:28,020 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:19:28,022 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:28,023 - sqlalchemy.engine.Engine - INFO - [cached since 44.76s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:19:28,028 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:19:28,029 - sqlalchemy.engine.Engine - INFO - [cached since 44.52s ago] {}
2025-12-29 11:19:28,032 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:19:28,035 - sqlalchemy.engine.Engine - INFO - [cached since 11.38s ago] {'param_1': 0, 'param_2': 20}
2025-12-29 11:19:28,041 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:28,043 - sqlalchemy.engine.Engine - INFO - [cached since 11.6s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:19:28,046 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:28,049 - sqlalchemy.engine.Engine - INFO - [cached since 11.61s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:19:28,054 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:28,056 - sqlalchemy.engine.Engine - INFO - [cached since 11.62s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:19:28,059 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:28,061 - sqlalchemy.engine.Engine - INFO - [cached since 11.62s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:19:28,065 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:28,067 - sqlalchemy.engine.Engine - INFO - [cached since 11.63s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:19:28,071 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:28,072 - sqlalchemy.engine.Engine - INFO - [cached since 11.63s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:19:28,075 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:28,077 - sqlalchemy.engine.Engine - INFO - [cached since 11.64s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:19:28,080 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:19:28,083 - sqlalchemy.engine.Engine - INFO - [cached since 11.64s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-29 11:19:28,089 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:19:29,575 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:19:29,576 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:29,577 - sqlalchemy.engine.Engine - INFO - [cached since 46.32s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:19:29,583 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:29,585 - sqlalchemy.engine.Engine - INFO - [cached since 45.82s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:19:29,589 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:19:29,590 - sqlalchemy.engine.Engine - INFO - [cached since 10.36s ago] {'device_id_1': 8}
2025-12-29 11:19:29,593 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:19:29,595 - sqlalchemy.engine.Engine - INFO - [cached since 10.36s ago] {'device_id_1': 8}
2025-12-29 11:19:29,665 - app.database - ERROR - Database session error: [TypeError("'numpy.bool' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')]
2025-12-29 11:19:29,666 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:19:29,669 - app.main - ERROR - Unhandled exception: [TypeError("'numpy.bool' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')]
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 327, in jsonable_encoder
    data = dict(obj)
TypeError: 'numpy.bool' object is not iterable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 332, in jsonable_encoder
    data = vars(obj)
TypeError: vars() argument must have __dict__ attribute

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 232, in serialize_response
    return jsonable_encoder(response_content)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 288, in jsonable_encoder
    encoded_value = jsonable_encoder(
        value,
    ...<4 lines>...
        sqlalchemy_safe=sqlalchemy_safe,
    )
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 288, in jsonable_encoder
    encoded_value = jsonable_encoder(
        value,
    ...<4 lines>...
        sqlalchemy_safe=sqlalchemy_safe,
    )
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 288, in jsonable_encoder
    encoded_value = jsonable_encoder(
        value,
    ...<4 lines>...
        sqlalchemy_safe=sqlalchemy_safe,
    )
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 335, in jsonable_encoder
    raise ValueError(errors) from e
ValueError: [TypeError("'numpy.bool' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')]
2025-12-29 11:19:38,389 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:19:38,392 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:38,393 - sqlalchemy.engine.Engine - INFO - [cached since 55.13s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:19:38,402 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:19:38,404 - sqlalchemy.engine.Engine - INFO - [cached since 54.64s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:19:38,409 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:19:38,411 - sqlalchemy.engine.Engine - INFO - [cached since 19.18s ago] {'device_id_1': 10}
2025-12-29 11:19:38,416 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:19:38,418 - sqlalchemy.engine.Engine - INFO - [cached since 19.18s ago] {'device_id_1': 10}
2025-12-29 11:19:38,470 - app.database - ERROR - Database session error: [TypeError("'numpy.bool' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')]
2025-12-29 11:19:38,471 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:19:38,474 - app.main - ERROR - Unhandled exception: [TypeError("'numpy.bool' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')]
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 327, in jsonable_encoder
    data = dict(obj)
TypeError: 'numpy.bool' object is not iterable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 332, in jsonable_encoder
    data = vars(obj)
TypeError: vars() argument must have __dict__ attribute

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 232, in serialize_response
    return jsonable_encoder(response_content)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 288, in jsonable_encoder
    encoded_value = jsonable_encoder(
        value,
    ...<4 lines>...
        sqlalchemy_safe=sqlalchemy_safe,
    )
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 288, in jsonable_encoder
    encoded_value = jsonable_encoder(
        value,
    ...<4 lines>...
        sqlalchemy_safe=sqlalchemy_safe,
    )
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 288, in jsonable_encoder
    encoded_value = jsonable_encoder(
        value,
    ...<4 lines>...
        sqlalchemy_safe=sqlalchemy_safe,
    )
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 335, in jsonable_encoder
    raise ValueError(errors) from e
ValueError: [TypeError("'numpy.bool' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')]
2025-12-29 11:20:47,733 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:20:47,735 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:20:47,736 - sqlalchemy.engine.Engine - INFO - [cached since 124.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:20:47,739 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:20:47,741 - sqlalchemy.engine.Engine - INFO - [cached since 124s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:20:47,743 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:20:47,744 - sqlalchemy.engine.Engine - INFO - [cached since 88.52s ago] {'device_id_1': 7}
2025-12-29 11:20:47,749 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:20:47,750 - sqlalchemy.engine.Engine - INFO - [cached since 88.51s ago] {'device_id_1': 7}
2025-12-29 11:20:47,800 - app.database - ERROR - Database session error: [TypeError("'numpy.bool' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')]
2025-12-29 11:20:47,800 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:20:47,802 - app.main - ERROR - Unhandled exception: [TypeError("'numpy.bool' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')]
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 327, in jsonable_encoder
    data = dict(obj)
TypeError: 'numpy.bool' object is not iterable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 332, in jsonable_encoder
    data = vars(obj)
TypeError: vars() argument must have __dict__ attribute

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 232, in serialize_response
    return jsonable_encoder(response_content)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 288, in jsonable_encoder
    encoded_value = jsonable_encoder(
        value,
    ...<4 lines>...
        sqlalchemy_safe=sqlalchemy_safe,
    )
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 288, in jsonable_encoder
    encoded_value = jsonable_encoder(
        value,
    ...<4 lines>...
        sqlalchemy_safe=sqlalchemy_safe,
    )
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 288, in jsonable_encoder
    encoded_value = jsonable_encoder(
        value,
    ...<4 lines>...
        sqlalchemy_safe=sqlalchemy_safe,
    )
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 335, in jsonable_encoder
    raise ValueError(errors) from e
ValueError: [TypeError("'numpy.bool' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')]
2025-12-29 11:20:57,967 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:20:57,971 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:20:57,974 - sqlalchemy.engine.Engine - INFO - [cached since 134.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:20:57,984 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:20:57,987 - sqlalchemy.engine.Engine - INFO - [cached since 134.2s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:20:57,992 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:20:57,996 - sqlalchemy.engine.Engine - INFO - [cached since 98.77s ago] {'device_id_1': 11}
2025-12-29 11:20:58,003 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:20:58,005 - sqlalchemy.engine.Engine - INFO - [cached since 98.77s ago] {'device_id_1': 11}
2025-12-29 11:20:58,056 - app.database - ERROR - Database session error: [TypeError("'numpy.bool' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')]
2025-12-29 11:20:58,057 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:20:58,058 - app.main - ERROR - Unhandled exception: [TypeError("'numpy.bool' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')]
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 327, in jsonable_encoder
    data = dict(obj)
TypeError: 'numpy.bool' object is not iterable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 332, in jsonable_encoder
    data = vars(obj)
TypeError: vars() argument must have __dict__ attribute

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 377, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<10 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 232, in serialize_response
    return jsonable_encoder(response_content)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 288, in jsonable_encoder
    encoded_value = jsonable_encoder(
        value,
    ...<4 lines>...
        sqlalchemy_safe=sqlalchemy_safe,
    )
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 288, in jsonable_encoder
    encoded_value = jsonable_encoder(
        value,
    ...<4 lines>...
        sqlalchemy_safe=sqlalchemy_safe,
    )
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 288, in jsonable_encoder
    encoded_value = jsonable_encoder(
        value,
    ...<4 lines>...
        sqlalchemy_safe=sqlalchemy_safe,
    )
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\encoders.py", line 335, in jsonable_encoder
    raise ValueError(errors) from e
ValueError: [TypeError("'numpy.bool' object is not iterable"), TypeError('vars() argument must have __dict__ attribute')]
2025-12-29 11:22:40,342 - app.services.notification - INFO - WebSocket client unregistered. Total: 1
2025-12-29 11:22:40,344 - app.main - INFO - WebSocket client disconnected
2025-12-29 11:22:40,346 - app.services.notification - INFO - WebSocket client unregistered. Total: 0
2025-12-29 11:22:40,347 - app.main - INFO - WebSocket client disconnected
2025-12-29 11:22:40,454 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-29 11:22:59,265 - app.main - INFO - Starting WiFi Tracker System...
2025-12-29 11:22:59,284 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-29 11:22:59,284 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:22:59,286 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-29 11:22:59,287 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:22:59,288 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-29 11:22:59,289 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:22:59,291 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:22:59,292 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-29 11:22:59,292 - sqlalchemy.engine.Engine - INFO - [generated in 0.00147s] {}
2025-12-29 11:22:59,294 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:22:59,295 - app.main - INFO - Database connection successful
2025-12-29 11:22:59,295 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:22:59,296 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-29 11:22:59,297 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:22:59,320 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-29 11:22:59,321 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:22:59,328 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-29 11:22:59,329 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:22:59,337 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-29 11:22:59,338 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:22:59,345 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-29 11:22:59,346 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:22:59,354 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-29 11:22:59,355 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:22:59,363 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-29 11:22:59,364 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:22:59,370 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-29 11:22:59,371 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:22:59,379 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:22:59,380 - app.database - INFO - Database tables initialized successfully
2025-12-29 11:22:59,385 - app.services.notification - INFO - WebSocket client registered. Total: 1
2025-12-29 11:22:59,385 - app.main - INFO - WebSocket client connected
2025-12-29 11:22:59,409 - app.services.notification - INFO - WebSocket client registered. Total: 2
2025-12-29 11:22:59,410 - app.main - INFO - WebSocket client connected
2025-12-29 11:23:06,188 - app.services.notification - INFO - WebSocket client unregistered. Total: 1
2025-12-29 11:23:06,189 - app.main - INFO - WebSocket client disconnected
2025-12-29 11:23:06,189 - app.services.notification - INFO - WebSocket client unregistered. Total: 0
2025-12-29 11:23:06,191 - app.main - INFO - WebSocket client disconnected
2025-12-29 11:23:06,297 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-29 11:23:20,282 - app.main - INFO - Starting WiFi Tracker System...
2025-12-29 11:23:20,304 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-29 11:23:20,305 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:20,308 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-29 11:23:20,309 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:20,311 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-29 11:23:20,312 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:20,315 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:23:20,316 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-29 11:23:20,317 - sqlalchemy.engine.Engine - INFO - [generated in 0.00221s] {}
2025-12-29 11:23:20,319 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:23:20,320 - app.main - INFO - Database connection successful
2025-12-29 11:23:20,321 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:23:20,322 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-29 11:23:20,323 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:20,352 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-29 11:23:20,354 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:20,365 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-29 11:23:20,366 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:20,375 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-29 11:23:20,376 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:20,386 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-29 11:23:20,387 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:20,396 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-29 11:23:20,397 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:20,407 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-29 11:23:20,408 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:20,417 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-29 11:23:20,418 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:20,427 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:23:20,429 - app.database - INFO - Database tables initialized successfully
2025-12-29 11:23:20,435 - app.services.notification - INFO - WebSocket client registered. Total: 1
2025-12-29 11:23:20,436 - app.main - INFO - WebSocket client connected
2025-12-29 11:23:20,454 - app.services.notification - INFO - WebSocket client registered. Total: 2
2025-12-29 11:23:20,455 - app.main - INFO - WebSocket client connected
2025-12-29 11:23:26,825 - app.services.notification - INFO - WebSocket client unregistered. Total: 1
2025-12-29 11:23:26,826 - app.main - INFO - WebSocket client disconnected
2025-12-29 11:23:26,827 - app.services.notification - INFO - WebSocket client unregistered. Total: 0
2025-12-29 11:23:26,829 - app.main - INFO - WebSocket client disconnected
2025-12-29 11:23:26,962 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-29 11:23:40,642 - app.main - INFO - Starting WiFi Tracker System...
2025-12-29 11:23:40,650 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-29 11:23:40,650 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:40,652 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-29 11:23:40,653 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:40,656 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-29 11:23:40,656 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:40,659 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:23:40,660 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-29 11:23:40,661 - sqlalchemy.engine.Engine - INFO - [generated in 0.00206s] {}
2025-12-29 11:23:40,663 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:23:40,664 - app.main - INFO - Database connection successful
2025-12-29 11:23:40,664 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:23:40,665 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-29 11:23:40,666 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:40,693 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-29 11:23:40,694 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:40,705 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-29 11:23:40,706 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:40,717 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-29 11:23:40,720 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:40,753 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-29 11:23:40,755 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:40,770 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-29 11:23:40,771 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:40,781 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-29 11:23:40,782 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:40,793 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-29 11:23:40,794 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:40,804 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:23:40,806 - app.database - INFO - Database tables initialized successfully
2025-12-29 11:23:40,813 - app.services.notification - INFO - WebSocket client registered. Total: 1
2025-12-29 11:23:40,813 - app.main - INFO - WebSocket client connected
2025-12-29 11:23:40,831 - app.services.notification - INFO - WebSocket client registered. Total: 2
2025-12-29 11:23:40,832 - app.main - INFO - WebSocket client connected
2025-12-29 11:23:59,671 - app.main - INFO - Starting WiFi Tracker System...
2025-12-29 11:23:59,679 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-29 11:23:59,680 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:59,682 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-29 11:23:59,684 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:59,686 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-29 11:23:59,687 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:59,690 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:23:59,692 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-29 11:23:59,696 - sqlalchemy.engine.Engine - INFO - [generated in 0.00611s] {}
2025-12-29 11:23:59,700 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:23:59,703 - app.main - INFO - Database connection successful
2025-12-29 11:23:59,704 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:23:59,706 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-29 11:23:59,708 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:59,741 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-29 11:23:59,743 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:59,754 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-29 11:23:59,758 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:59,785 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-29 11:23:59,790 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:59,799 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-29 11:23:59,804 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:59,816 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-29 11:23:59,818 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:59,827 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-29 11:23:59,830 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:59,839 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-29 11:23:59,841 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:23:59,853 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:23:59,855 - app.database - INFO - Database tables initialized successfully
2025-12-29 11:23:59,858 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-29 11:25:00,460 - app.main - INFO - Starting WiFi Tracker System...
2025-12-29 11:25:00,486 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-29 11:25:00,488 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:25:00,491 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-29 11:25:00,492 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:25:00,493 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-29 11:25:00,494 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:25:00,497 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:25:00,502 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-29 11:25:00,503 - sqlalchemy.engine.Engine - INFO - [generated in 0.00572s] {}
2025-12-29 11:25:00,505 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:25:00,506 - app.main - INFO - Database connection successful
2025-12-29 11:25:00,507 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:25:00,508 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-29 11:25:00,509 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:25:00,548 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-29 11:25:00,549 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:25:00,572 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-29 11:25:00,575 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:25:00,617 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-29 11:25:00,622 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:25:00,649 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-29 11:25:00,653 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:25:00,667 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-29 11:25:00,675 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:25:00,690 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-29 11:25:00,693 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:25:00,709 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-29 11:25:00,712 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:25:00,726 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:25:00,730 - app.database - INFO - Database tables initialized successfully
2025-12-29 11:25:00,738 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-29 11:26:10,495 - app.services.notification - INFO - WebSocket client unregistered. Total: 1
2025-12-29 11:26:10,496 - app.main - INFO - WebSocket client disconnected
2025-12-29 11:26:10,507 - app.services.notification - INFO - WebSocket client unregistered. Total: 0
2025-12-29 11:26:10,529 - app.main - INFO - WebSocket client disconnected
2025-12-29 11:26:10,601 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-29 11:26:25,147 - app.main - INFO - Starting WiFi Tracker System...
2025-12-29 11:26:25,154 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-29 11:26:25,155 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:26:25,157 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-29 11:26:25,158 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:26:25,159 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-29 11:26:25,159 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:26:25,162 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:26:25,163 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-29 11:26:25,163 - sqlalchemy.engine.Engine - INFO - [generated in 0.00137s] {}
2025-12-29 11:26:25,164 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:26:25,165 - app.main - INFO - Database connection successful
2025-12-29 11:26:25,166 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:26:25,167 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-29 11:26:25,167 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:26:25,189 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-29 11:26:25,190 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:26:25,218 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-29 11:26:25,219 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:26:25,228 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-29 11:26:25,229 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:26:25,238 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-29 11:26:25,239 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:26:25,249 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-29 11:26:25,250 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:26:25,262 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-29 11:26:25,263 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:26:25,272 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-29 11:26:25,273 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:26:25,284 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:26:25,286 - app.database - INFO - Database tables initialized successfully
2025-12-29 11:26:25,291 - app.services.notification - INFO - WebSocket client registered. Total: 1
2025-12-29 11:26:25,292 - app.main - INFO - WebSocket client connected
2025-12-29 11:26:25,318 - app.services.notification - INFO - WebSocket client registered. Total: 2
2025-12-29 11:26:25,319 - app.main - INFO - WebSocket client connected
2025-12-29 11:26:43,055 - app.services.notification - INFO - WebSocket client unregistered. Total: 1
2025-12-29 11:26:43,060 - app.main - INFO - WebSocket client disconnected
2025-12-29 11:26:43,064 - app.services.notification - INFO - WebSocket client unregistered. Total: 0
2025-12-29 11:26:43,065 - app.main - INFO - WebSocket client disconnected
2025-12-29 11:26:43,167 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-29 11:26:43,839 - app.main - INFO - Starting WiFi Tracker System...
2025-12-29 11:26:43,847 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-29 11:26:43,848 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:26:43,851 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-29 11:26:43,853 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:26:43,855 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-29 11:26:43,857 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:26:43,862 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:26:43,865 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-29 11:26:43,869 - sqlalchemy.engine.Engine - INFO - [generated in 0.00739s] {}
2025-12-29 11:26:43,874 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:26:43,875 - app.main - INFO - Database connection successful
2025-12-29 11:26:43,876 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:26:43,879 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-29 11:26:43,882 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:26:43,912 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-29 11:26:43,917 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:26:43,944 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-29 11:26:43,951 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:26:43,959 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-29 11:26:43,965 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:26:43,976 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-29 11:26:43,979 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:26:43,990 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-29 11:26:43,996 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:26:44,007 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-29 11:26:44,009 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:26:44,039 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-29 11:26:44,040 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:26:44,074 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:26:44,076 - app.database - INFO - Database tables initialized successfully
2025-12-29 11:26:44,084 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-29 11:28:09,611 - app.main - INFO - Starting WiFi Tracker System...
2025-12-29 11:28:09,623 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-29 11:28:09,628 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:28:09,631 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-29 11:28:09,634 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:28:09,639 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-29 11:28:09,642 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:28:09,648 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:28:09,649 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-29 11:28:09,651 - sqlalchemy.engine.Engine - INFO - [generated in 0.00338s] {}
2025-12-29 11:28:09,655 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:28:09,658 - app.main - INFO - Database connection successful
2025-12-29 11:28:09,660 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:28:09,663 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-29 11:28:09,664 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:28:09,702 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-29 11:28:09,704 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:28:09,740 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-29 11:28:09,745 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:28:09,761 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-29 11:28:09,766 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:28:09,784 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-29 11:28:09,788 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:28:09,800 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-29 11:28:09,802 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:28:09,810 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-29 11:28:09,814 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:28:09,823 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-29 11:28:09,827 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:28:09,837 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:28:09,839 - app.database - INFO - Database tables initialized successfully
2025-12-29 11:28:10,087 - app.services.notification - INFO - WebSocket client registered. Total: 1
2025-12-29 11:28:10,101 - app.main - INFO - WebSocket client connected
2025-12-29 11:28:10,568 - app.services.notification - INFO - WebSocket client registered. Total: 2
2025-12-29 11:28:10,571 - app.main - INFO - WebSocket client connected
2025-12-29 11:28:56,694 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:28:56,699 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-29 11:28:56,701 - sqlalchemy.engine.Engine - INFO - [cached since 47.05s ago] {}
2025-12-29 11:28:56,708 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:29:40,049 - app.services.notification - INFO - WebSocket client unregistered. Total: 1
2025-12-29 11:29:40,126 - app.main - INFO - WebSocket client disconnected
2025-12-29 11:29:40,999 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:29:41,017 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:29:41,027 - sqlalchemy.engine.Engine - INFO - [generated in 0.01033s] {'id_1': 1, 'param_1': 1}
2025-12-29 11:29:41,035 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:29:41,075 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:29:41,080 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:29:41,098 - sqlalchemy.engine.Engine - INFO - [cached since 0.0815s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:29:41,121 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:29:41,156 - sqlalchemy.engine.Engine - INFO - [generated in 0.03536s] {}
2025-12-29 11:29:41,169 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:29:41,193 - sqlalchemy.engine.Engine - INFO - [generated in 0.02449s] {'last_seen_1': datetime.datetime(2025, 12, 29, 5, 49, 41, 161770)}
2025-12-29 11:29:41,210 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:29:41,223 - sqlalchemy.engine.Engine - INFO - [generated in 0.01340s] {}
2025-12-29 11:29:41,231 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:29:41,246 - sqlalchemy.engine.Engine - INFO - [generated in 0.01514s] {}
2025-12-29 11:29:41,262 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:29:41,275 - sqlalchemy.engine.Engine - INFO - [generated in 0.01425s] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:29:41,291 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:29:41,302 - sqlalchemy.engine.Engine - INFO - [generated in 0.01020s] {}
2025-12-29 11:29:41,315 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:29:41,329 - sqlalchemy.engine.Engine - INFO - [generated in 0.01471s] {}
2025-12-29 11:29:41,343 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:29:41,364 - sqlalchemy.engine.Engine - INFO - [generated in 0.02109s] {'status_1': 'completed'}
2025-12-29 11:29:41,375 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:29:41,398 - sqlalchemy.engine.Engine - INFO - [generated in 0.02255s] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:29:41,412 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:29:41,425 - sqlalchemy.engine.Engine - INFO - [generated in 0.01379s] {}
2025-12-29 11:29:41,457 - app.services.notification - INFO - WebSocket client registered. Total: 2
2025-12-29 11:29:41,484 - app.main - INFO - WebSocket client connected
2025-12-29 11:29:41,456 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:29:41,511 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:29:41,515 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:29:41,525 - sqlalchemy.engine.Engine - INFO - [cached since 0.5082s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:29:41,533 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:29:41,541 - sqlalchemy.engine.Engine - INFO - [generated in 0.00781s] {'id_1': 7, 'param_1': 1}
2025-12-29 11:29:41,553 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:29:41,564 - sqlalchemy.engine.Engine - INFO - [generated in 0.01128s] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 22, 5, 59, 41, 548466), 'param_1': 100}
2025-12-29 11:29:41,578 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s AND scan_results.scan_timestamp >= %(scan_timestamp_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:29:41,592 - sqlalchemy.engine.Engine - INFO - [generated in 0.01419s] {'device_id_1': 7, 'scan_timestamp_1': datetime.datetime(2025, 12, 22, 5, 59, 41, 548466), 'param_1': 100}
2025-12-29 11:29:41,605 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:29:41,632 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:29:41,641 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:29:41,658 - sqlalchemy.engine.Engine - INFO - [cached since 0.6413s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:29:41,667 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:29:41,681 - sqlalchemy.engine.Engine - INFO - [cached since 0.5599s ago] {}
2025-12-29 11:29:41,691 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:29:41,701 - sqlalchemy.engine.Engine - INFO - [cached since 0.5325s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 5, 49, 41, 689513)}
2025-12-29 11:29:41,710 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:29:41,724 - sqlalchemy.engine.Engine - INFO - [cached since 0.5145s ago] {}
2025-12-29 11:29:41,729 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:29:41,742 - sqlalchemy.engine.Engine - INFO - [cached since 0.511s ago] {}
2025-12-29 11:29:41,749 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:29:41,761 - sqlalchemy.engine.Engine - INFO - [cached since 0.4997s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:29:41,766 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:29:41,774 - sqlalchemy.engine.Engine - INFO - [cached since 0.4828s ago] {}
2025-12-29 11:29:41,779 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:29:41,783 - sqlalchemy.engine.Engine - INFO - [cached since 0.4686s ago] {}
2025-12-29 11:29:41,789 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:29:41,795 - sqlalchemy.engine.Engine - INFO - [cached since 0.4528s ago] {'status_1': 'completed'}
2025-12-29 11:29:41,801 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:29:41,808 - sqlalchemy.engine.Engine - INFO - [cached since 0.4326s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:29:41,813 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:29:41,816 - sqlalchemy.engine.Engine - INFO - [cached since 0.4048s ago] {}
2025-12-29 11:29:41,825 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:29:41,939 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:29:41,955 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:29:41,966 - sqlalchemy.engine.Engine - INFO - [cached since 0.9497s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:29:41,979 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:29:41,991 - sqlalchemy.engine.Engine - INFO - [generated in 0.01176s] {'event_timestamp_1': datetime.datetime(2025, 12, 28, 5, 59, 41, 977641), 'param_1': 100}
2025-12-29 11:29:41,998 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:29:42,008 - sqlalchemy.engine.Engine - INFO - [cached since 0.4745s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:29:42,012 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:29:42,028 - sqlalchemy.engine.Engine - INFO - [cached since 0.4954s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:29:42,036 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:29:42,047 - sqlalchemy.engine.Engine - INFO - [cached since 0.5139s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:29:42,055 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:29:42,062 - sqlalchemy.engine.Engine - INFO - [cached since 0.5295s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:29:42,070 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:29:42,077 - sqlalchemy.engine.Engine - INFO - [cached since 0.5444s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:29:42,082 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:29:42,094 - sqlalchemy.engine.Engine - INFO - [cached since 0.5615s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:29:42,099 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:29:42,107 - sqlalchemy.engine.Engine - INFO - [cached since 0.5739s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:29:42,115 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:29:42,129 - sqlalchemy.engine.Engine - INFO - [cached since 0.5958s ago] {'id_1': 13, 'param_1': 1}
2025-12-29 11:29:42,137 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:29:42,149 - sqlalchemy.engine.Engine - INFO - [cached since 0.6161s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:29:42,159 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:29:42,175 - sqlalchemy.engine.Engine - INFO - [cached since 0.6418s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:29:42,181 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:29:42,198 - sqlalchemy.engine.Engine - INFO - [cached since 0.6648s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:29:42,208 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:29:42,224 - sqlalchemy.engine.Engine - INFO - [cached since 0.6907s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:29:42,230 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:29:42,248 - sqlalchemy.engine.Engine - INFO - [cached since 0.7146s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:29:42,257 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:29:42,272 - sqlalchemy.engine.Engine - INFO - [cached since 0.7392s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:29:42,280 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:29:46,596 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:29:46,626 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:29:46,695 - sqlalchemy.engine.Engine - INFO - [cached since 5.678s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:29:46,727 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-29 11:29:46,853 - sqlalchemy.engine.Engine - INFO - [generated in 0.12581s] {'started_at': datetime.datetime(2025, 12, 29, 5, 59, 46, 727562), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'arp', 'network_range': '192.168.1.0/24', 'status': 'running', 'error_message': None}
2025-12-29 11:29:46,905 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:29:46,912 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:29:46,919 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-29 11:29:46,949 - sqlalchemy.engine.Engine - INFO - [generated in 0.03044s] {'pk_1': 30}
2025-12-29 11:29:46,991 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-29 11:29:46,999 - sqlalchemy.engine.Engine - INFO - [generated in 0.00852s] {'pk_1': 1}
2025-12-29 11:29:47,005 - app.routers.scans - INFO - Scan started by admin: 30
2025-12-29 11:29:47,010 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:29:47,022 - sqlalchemy.engine.Engine - INFO - [generated in 0.01211s] {'id_1': 30, 'param_1': 1}
2025-12-29 11:29:47,026 - app.services.scanner - INFO - Starting ARP scan on 192.168.1.0/24
2025-12-29 11:29:47,027 - app.services.scanner - INFO - Starting fallback scan on 192.168.1.0/24 (ping + ARP table)
2025-12-29 11:30:16,384 - app.services.scanner - INFO - Fallback scan complete: 8 devices found
2025-12-29 11:30:16,389 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:16,398 - sqlalchemy.engine.Engine - INFO - [generated in 0.00889s] {'mac_address_1': '96:A4:CB:4D:96:A9', 'param_1': 1}
2025-12-29 11:30:16,404 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:30:16,414 - sqlalchemy.engine.Engine - INFO - [generated in 0.01004s] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:30:16,419 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:16,430 - sqlalchemy.engine.Engine - INFO - [cached since 0.04124s ago] {'mac_address_1': 'FF:FF:FF:FF:FF:FF', 'param_1': 1}
2025-12-29 11:30:16,435 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:30:16,445 - sqlalchemy.engine.Engine - INFO - [cached since 0.04163s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:30:16,452 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:16,463 - sqlalchemy.engine.Engine - INFO - [cached since 0.0741s ago] {'mac_address_1': '01:00:5E:00:00:16', 'param_1': 1}
2025-12-29 11:30:16,468 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:30:16,474 - sqlalchemy.engine.Engine - INFO - [cached since 0.07051s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:30:16,484 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:16,497 - sqlalchemy.engine.Engine - INFO - [cached since 0.1079s ago] {'mac_address_1': '01:00:5E:00:00:FB', 'param_1': 1}
2025-12-29 11:30:16,502 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:30:16,511 - sqlalchemy.engine.Engine - INFO - [cached since 0.1079s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:30:16,517 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:16,530 - sqlalchemy.engine.Engine - INFO - [cached since 0.1414s ago] {'mac_address_1': '01:00:5E:00:00:FC', 'param_1': 1}
2025-12-29 11:30:16,536 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:30:16,550 - sqlalchemy.engine.Engine - INFO - [cached since 0.1463s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:30:16,555 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:16,566 - sqlalchemy.engine.Engine - INFO - [cached since 0.1768s ago] {'mac_address_1': '01:00:5E:7F:66:12', 'param_1': 1}
2025-12-29 11:30:16,570 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:30:16,579 - sqlalchemy.engine.Engine - INFO - [cached since 0.176s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:30:16,585 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:16,604 - sqlalchemy.engine.Engine - INFO - [cached since 0.2148s ago] {'mac_address_1': '01:00:5E:7F:FF:FA', 'param_1': 1}
2025-12-29 11:30:16,610 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:30:16,628 - sqlalchemy.engine.Engine - INFO - [cached since 0.2249s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:30:16,635 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:16,649 - sqlalchemy.engine.Engine - INFO - [cached since 0.2602s ago] {'mac_address_1': 'FF:FF:FF:FF:FF:FF', 'param_1': 1}
2025-12-29 11:30:16,655 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:30:16,662 - sqlalchemy.engine.Engine - INFO - [cached since 0.2581s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:30:16,672 - sqlalchemy.engine.Engine - INFO - UPDATE devices SET last_seen=%(last_seen)s WHERE devices.id = %(devices_id)s
2025-12-29 11:30:16,674 - sqlalchemy.engine.Engine - INFO - [generated in 0.00162s] [{'last_seen': datetime.datetime(2025, 12, 29, 6, 0, 16, 417542), 'devices_id': 8}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 0, 16, 665873), 'devices_id': 9}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 0, 16, 483010), 'devices_id': 10}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 0, 16, 515587), 'devices_id': 11}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 0, 16, 554116), 'devices_id': 12}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 0, 16, 584241), 'devices_id': 13}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 0, 16, 633454), 'devices_id': 14}]
2025-12-29 11:30:16,694 - sqlalchemy.engine.Engine - INFO - UPDATE scan_sessions SET completed_at=%(completed_at)s, total_devices_found=%(total_devices_found)s, status=%(status)s WHERE scan_sessions.id = %(scan_sessions_id)s
2025-12-29 11:30:16,698 - sqlalchemy.engine.Engine - INFO - [generated in 0.00389s] {'completed_at': datetime.datetime(2025, 12, 29, 6, 0, 16, 666463), 'total_devices_found': 8, 'status': 'completed', 'scan_sessions_id': 30}
2025-12-29 11:30:16,704 - sqlalchemy.engine.Engine - INFO - INSERT INTO device_activity (device_id, event_type, old_value, new_value, event_timestamp) VALUES (%(device_id)s, %(event_type)s, %(old_value)s, %(new_value)s, %(event_timestamp)s)
2025-12-29 11:30:16,707 - sqlalchemy.engine.Engine - INFO - [generated in 0.00282s] {'device_id': 9, 'event_type': 'ip_changed', 'old_value': '255.255.255.255', 'new_value': '10.41.243.255', 'event_timestamp': datetime.datetime(2025, 12, 29, 6, 0, 16, 704241)}
2025-12-29 11:30:16,713 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:30:16,716 - sqlalchemy.engine.Engine - INFO - [generated in 0.00331s] {'device_id': 8, 'ip_address': '10.41.243.123', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 0, 16, 713426), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:30:16,720 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:30:16,722 - sqlalchemy.engine.Engine - INFO - [cached since 0.009545s ago] {'device_id': 9, 'ip_address': '10.41.243.255', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 0, 16, 720105), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:30:16,726 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:30:16,730 - sqlalchemy.engine.Engine - INFO - [cached since 0.01729s ago] {'device_id': 10, 'ip_address': '224.0.0.22', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 0, 16, 726637), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:30:16,734 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:30:16,737 - sqlalchemy.engine.Engine - INFO - [cached since 0.02379s ago] {'device_id': 11, 'ip_address': '224.0.0.251', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 0, 16, 734740), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:30:16,745 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:30:16,753 - sqlalchemy.engine.Engine - INFO - [cached since 0.04004s ago] {'device_id': 12, 'ip_address': '224.0.0.252', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 0, 16, 745300), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:30:16,758 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:30:16,766 - sqlalchemy.engine.Engine - INFO - [cached since 0.05301s ago] {'device_id': 13, 'ip_address': '239.255.102.18', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 0, 16, 758799), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:30:16,772 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:30:16,781 - sqlalchemy.engine.Engine - INFO - [cached since 0.06803s ago] {'device_id': 14, 'ip_address': '239.255.255.250', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 0, 16, 772517), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:30:16,787 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:30:16,791 - sqlalchemy.engine.Engine - INFO - [cached since 0.07792s ago] {'device_id': 9, 'ip_address': '255.255.255.255', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 0, 16, 787161), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:30:16,800 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:30:16,806 - app.routers.scans - INFO - Scan completed: 8 devices, 0 new
2025-12-29 11:30:17,212 - app.database - ERROR - Database session error: 401: Could not validate credentials
2025-12-29 11:30:17,237 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:30:17,240 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:17,252 - sqlalchemy.engine.Engine - INFO - [cached since 36.24s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:30:17,277 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:30:17,291 - app.database - ERROR - Database session error: 401: Could not validate credentials
2025-12-29 11:30:17,304 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:30:17,306 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:17,319 - sqlalchemy.engine.Engine - INFO - [cached since 36.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:30:17,325 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:30:17,337 - sqlalchemy.engine.Engine - INFO - [cached since 36.22s ago] {}
2025-12-29 11:30:17,342 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:30:17,350 - sqlalchemy.engine.Engine - INFO - [cached since 36.18s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 5, 50, 17, 340607)}
2025-12-29 11:30:17,356 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:30:17,367 - sqlalchemy.engine.Engine - INFO - [cached since 36.16s ago] {}
2025-12-29 11:30:17,372 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:30:17,383 - sqlalchemy.engine.Engine - INFO - [cached since 36.15s ago] {}
2025-12-29 11:30:17,389 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:30:17,404 - sqlalchemy.engine.Engine - INFO - [cached since 36.14s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:30:17,457 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:30:17,521 - sqlalchemy.engine.Engine - INFO - [cached since 36.23s ago] {}
2025-12-29 11:30:17,654 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:30:17,702 - sqlalchemy.engine.Engine - INFO - [cached since 36.39s ago] {}
2025-12-29 11:30:17,797 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:30:17,814 - sqlalchemy.engine.Engine - INFO - [cached since 36.47s ago] {'status_1': 'completed'}
2025-12-29 11:30:17,819 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:30:17,834 - sqlalchemy.engine.Engine - INFO - [cached since 36.46s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:30:17,869 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:30:17,892 - sqlalchemy.engine.Engine - INFO - [cached since 36.48s ago] {}
2025-12-29 11:30:17,901 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:30:17,906 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:30:17,925 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:17,940 - sqlalchemy.engine.Engine - INFO - [cached since 36.92s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:30:17,957 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:30:17,969 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:30:17,972 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:17,981 - sqlalchemy.engine.Engine - INFO - [cached since 36.96s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:30:17,986 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:17,996 - sqlalchemy.engine.Engine - INFO - [cached since 36.46s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:30:18,003 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:30:18,013 - sqlalchemy.engine.Engine - INFO - [cached since 36.46s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 22, 6, 0, 18, 2094), 'param_1': 100}
2025-12-29 11:30:18,019 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s AND scan_results.scan_timestamp >= %(scan_timestamp_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:30:18,035 - sqlalchemy.engine.Engine - INFO - [cached since 36.46s ago] {'device_id_1': 7, 'scan_timestamp_1': datetime.datetime(2025, 12, 22, 6, 0, 18, 2094), 'param_1': 100}
2025-12-29 11:30:18,048 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:30:18,072 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:30:18,083 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:18,097 - sqlalchemy.engine.Engine - INFO - [cached since 37.08s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:30:18,107 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:30:18,115 - sqlalchemy.engine.Engine - INFO - [cached since 36.99s ago] {}
2025-12-29 11:30:18,120 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:30:18,130 - sqlalchemy.engine.Engine - INFO - [cached since 36.96s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 5, 50, 18, 119422)}
2025-12-29 11:30:18,135 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:30:18,144 - sqlalchemy.engine.Engine - INFO - [cached since 36.93s ago] {}
2025-12-29 11:30:18,148 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:30:18,155 - sqlalchemy.engine.Engine - INFO - [cached since 36.92s ago] {}
2025-12-29 11:30:18,159 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:30:18,169 - sqlalchemy.engine.Engine - INFO - [cached since 36.91s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:30:18,174 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:30:18,185 - sqlalchemy.engine.Engine - INFO - [cached since 36.89s ago] {}
2025-12-29 11:30:18,188 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:30:18,199 - sqlalchemy.engine.Engine - INFO - [cached since 36.88s ago] {}
2025-12-29 11:30:18,202 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:30:18,216 - sqlalchemy.engine.Engine - INFO - [cached since 36.87s ago] {'status_1': 'completed'}
2025-12-29 11:30:18,220 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:30:18,232 - sqlalchemy.engine.Engine - INFO - [cached since 36.86s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:30:18,238 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:30:18,241 - sqlalchemy.engine.Engine - INFO - [cached since 36.83s ago] {}
2025-12-29 11:30:18,248 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:30:18,253 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:30:18,256 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:18,262 - sqlalchemy.engine.Engine - INFO - [cached since 37.25s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:30:18,269 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:30:18,289 - sqlalchemy.engine.Engine - INFO - [cached since 37.17s ago] {}
2025-12-29 11:30:18,298 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:30:18,308 - sqlalchemy.engine.Engine - INFO - [cached since 37.14s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 5, 50, 18, 296616)}
2025-12-29 11:30:18,314 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:30:18,323 - sqlalchemy.engine.Engine - INFO - [cached since 37.11s ago] {}
2025-12-29 11:30:18,327 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:30:18,335 - sqlalchemy.engine.Engine - INFO - [cached since 37.1s ago] {}
2025-12-29 11:30:18,340 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:30:18,350 - sqlalchemy.engine.Engine - INFO - [cached since 37.09s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:30:18,355 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:30:18,360 - sqlalchemy.engine.Engine - INFO - [cached since 37.07s ago] {}
2025-12-29 11:30:18,365 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:30:18,374 - sqlalchemy.engine.Engine - INFO - [cached since 37.06s ago] {}
2025-12-29 11:30:18,382 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:30:18,389 - sqlalchemy.engine.Engine - INFO - [cached since 37.05s ago] {'status_1': 'completed'}
2025-12-29 11:30:18,396 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:30:18,404 - sqlalchemy.engine.Engine - INFO - [cached since 37.03s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:30:18,408 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:30:18,413 - sqlalchemy.engine.Engine - INFO - [cached since 37s ago] {}
2025-12-29 11:30:18,422 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:30:18,433 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:30:18,435 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:18,444 - sqlalchemy.engine.Engine - INFO - [cached since 37.43s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:30:18,470 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:18,481 - sqlalchemy.engine.Engine - INFO - [cached since 36.95s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:30:18,486 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:30:18,492 - sqlalchemy.engine.Engine - INFO - [cached since 36.94s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 22, 6, 0, 18, 484971), 'param_1': 100}
2025-12-29 11:30:18,499 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s AND scan_results.scan_timestamp >= %(scan_timestamp_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:30:18,505 - sqlalchemy.engine.Engine - INFO - [cached since 36.93s ago] {'device_id_1': 7, 'scan_timestamp_1': datetime.datetime(2025, 12, 22, 6, 0, 18, 484971), 'param_1': 100}
2025-12-29 11:30:18,513 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:30:18,521 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:30:18,524 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:18,532 - sqlalchemy.engine.Engine - INFO - [cached since 37.52s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:30:18,536 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:30:18,546 - sqlalchemy.engine.Engine - INFO - [cached since 36.57s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 28, 6, 0, 18, 535797), 'param_1': 100}
2025-12-29 11:30:18,552 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:18,564 - sqlalchemy.engine.Engine - INFO - [cached since 37.03s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:30:18,570 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:18,580 - sqlalchemy.engine.Engine - INFO - [cached since 37.05s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:30:18,586 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:18,595 - sqlalchemy.engine.Engine - INFO - [cached since 37.06s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:30:18,599 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:18,613 - sqlalchemy.engine.Engine - INFO - [cached since 37.08s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:30:18,622 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:18,634 - sqlalchemy.engine.Engine - INFO - [cached since 37.1s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:30:18,639 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:18,647 - sqlalchemy.engine.Engine - INFO - [cached since 37.11s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:30:18,651 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:18,658 - sqlalchemy.engine.Engine - INFO - [cached since 37.12s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:30:18,663 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:18,670 - sqlalchemy.engine.Engine - INFO - [cached since 37.14s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:30:18,673 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:18,683 - sqlalchemy.engine.Engine - INFO - [cached since 37.15s ago] {'id_1': 13, 'param_1': 1}
2025-12-29 11:30:18,688 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:18,694 - sqlalchemy.engine.Engine - INFO - [cached since 37.16s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:30:18,699 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:18,705 - sqlalchemy.engine.Engine - INFO - [cached since 37.17s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:30:18,710 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:18,717 - sqlalchemy.engine.Engine - INFO - [cached since 37.18s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:30:18,722 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:18,731 - sqlalchemy.engine.Engine - INFO - [cached since 37.2s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:30:18,735 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:18,748 - sqlalchemy.engine.Engine - INFO - [cached since 37.21s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:30:18,753 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:18,762 - sqlalchemy.engine.Engine - INFO - [cached since 37.23s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:30:18,770 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:30:18,782 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:30:18,785 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:18,791 - sqlalchemy.engine.Engine - INFO - [cached since 37.77s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:30:18,798 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:30:18,804 - sqlalchemy.engine.Engine - INFO - [cached since 37.68s ago] {}
2025-12-29 11:30:18,808 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:30:18,814 - sqlalchemy.engine.Engine - INFO - [cached since 37.65s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 5, 50, 18, 807291)}
2025-12-29 11:30:18,819 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:30:18,824 - sqlalchemy.engine.Engine - INFO - [cached since 37.61s ago] {}
2025-12-29 11:30:18,830 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:30:18,834 - sqlalchemy.engine.Engine - INFO - [cached since 37.6s ago] {}
2025-12-29 11:30:18,839 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:30:18,845 - sqlalchemy.engine.Engine - INFO - [cached since 37.58s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:30:18,849 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:30:18,853 - sqlalchemy.engine.Engine - INFO - [cached since 37.56s ago] {}
2025-12-29 11:30:18,858 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:30:18,864 - sqlalchemy.engine.Engine - INFO - [cached since 37.55s ago] {}
2025-12-29 11:30:18,867 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:30:18,873 - sqlalchemy.engine.Engine - INFO - [cached since 37.53s ago] {'status_1': 'completed'}
2025-12-29 11:30:18,880 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:30:18,889 - sqlalchemy.engine.Engine - INFO - [cached since 37.51s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:30:18,895 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:30:18,899 - sqlalchemy.engine.Engine - INFO - [cached since 37.49s ago] {}
2025-12-29 11:30:18,905 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:30:18,953 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:30:18,955 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:18,961 - sqlalchemy.engine.Engine - INFO - [cached since 37.94s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:30:18,967 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:30:18,980 - sqlalchemy.engine.Engine - INFO - [cached since 37s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 28, 6, 0, 18, 966149), 'param_1': 100}
2025-12-29 11:30:18,985 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:18,992 - sqlalchemy.engine.Engine - INFO - [cached since 37.46s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:30:18,998 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:19,014 - sqlalchemy.engine.Engine - INFO - [cached since 37.48s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:30:19,019 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:19,029 - sqlalchemy.engine.Engine - INFO - [cached since 37.5s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:30:19,033 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:19,047 - sqlalchemy.engine.Engine - INFO - [cached since 37.51s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:30:19,050 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:19,061 - sqlalchemy.engine.Engine - INFO - [cached since 37.53s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:30:19,066 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:19,078 - sqlalchemy.engine.Engine - INFO - [cached since 37.55s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:30:19,084 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:19,092 - sqlalchemy.engine.Engine - INFO - [cached since 37.56s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:30:19,099 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:19,106 - sqlalchemy.engine.Engine - INFO - [cached since 37.57s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:30:19,112 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:19,119 - sqlalchemy.engine.Engine - INFO - [cached since 37.59s ago] {'id_1': 13, 'param_1': 1}
2025-12-29 11:30:19,122 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:19,131 - sqlalchemy.engine.Engine - INFO - [cached since 37.6s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:30:19,136 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:19,142 - sqlalchemy.engine.Engine - INFO - [cached since 37.61s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:30:19,149 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:19,156 - sqlalchemy.engine.Engine - INFO - [cached since 37.62s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:30:19,163 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:19,172 - sqlalchemy.engine.Engine - INFO - [cached since 37.64s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:30:19,177 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:19,185 - sqlalchemy.engine.Engine - INFO - [cached since 37.65s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:30:19,190 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:19,200 - sqlalchemy.engine.Engine - INFO - [cached since 37.67s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:30:19,209 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:30:54,828 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:30:54,832 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:54,842 - sqlalchemy.engine.Engine - INFO - [cached since 73.83s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:30:54,848 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:30:57,029 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:30:57,057 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:30:57,070 - sqlalchemy.engine.Engine - INFO - [cached since 76.05s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:30:57,077 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices
2025-12-29 11:30:57,089 - sqlalchemy.engine.Engine - INFO - [generated in 0.01205s] {}
2025-12-29 11:30:57,097 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:30:57,109 - sqlalchemy.engine.Engine - INFO - [generated in 0.01186s] {'device_id_1': 7}
2025-12-29 11:30:57,118 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:30:57,122 - sqlalchemy.engine.Engine - INFO - [generated in 0.00370s] {'device_id_1': 7}
2025-12-29 11:30:57,126 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:30:57,129 - sqlalchemy.engine.Engine - INFO - [cached since 0.03207s ago] {'device_id_1': 8}
2025-12-29 11:30:57,135 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:30:57,143 - sqlalchemy.engine.Engine - INFO - [cached since 0.02476s ago] {'device_id_1': 8}
2025-12-29 11:30:57,147 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:30:57,158 - sqlalchemy.engine.Engine - INFO - [cached since 0.06029s ago] {'device_id_1': 9}
2025-12-29 11:30:57,164 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:30:57,173 - sqlalchemy.engine.Engine - INFO - [cached since 0.05439s ago] {'device_id_1': 9}
2025-12-29 11:30:57,179 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:30:57,189 - sqlalchemy.engine.Engine - INFO - [cached since 0.09191s ago] {'device_id_1': 10}
2025-12-29 11:30:57,194 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:30:57,204 - sqlalchemy.engine.Engine - INFO - [cached since 0.08564s ago] {'device_id_1': 10}
2025-12-29 11:30:57,210 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:30:57,220 - sqlalchemy.engine.Engine - INFO - [cached since 0.1225s ago] {'device_id_1': 11}
2025-12-29 11:30:57,224 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:30:57,232 - sqlalchemy.engine.Engine - INFO - [cached since 0.1134s ago] {'device_id_1': 11}
2025-12-29 11:30:57,239 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:30:57,245 - sqlalchemy.engine.Engine - INFO - [cached since 0.148s ago] {'device_id_1': 12}
2025-12-29 11:30:57,250 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:30:57,259 - sqlalchemy.engine.Engine - INFO - [cached since 0.1408s ago] {'device_id_1': 12}
2025-12-29 11:30:57,264 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:30:57,274 - sqlalchemy.engine.Engine - INFO - [cached since 0.1764s ago] {'device_id_1': 13}
2025-12-29 11:30:57,279 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:30:57,288 - sqlalchemy.engine.Engine - INFO - [cached since 0.1693s ago] {'device_id_1': 13}
2025-12-29 11:30:57,293 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:30:57,303 - sqlalchemy.engine.Engine - INFO - [cached since 0.2052s ago] {'device_id_1': 14}
2025-12-29 11:30:57,307 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:30:57,317 - sqlalchemy.engine.Engine - INFO - [cached since 0.1988s ago] {'device_id_1': 14}
2025-12-29 11:30:57,322 - app.ml.detector - INFO - Training anomaly detector with 8 devices
2025-12-29 11:30:57,328 - app.ml.isolation_forest - INFO - Training Isolation Forest with 8 samples
2025-12-29 11:30:57,963 - app.ml.isolation_forest - INFO - Model saved to E:\wifi-tracker\backend\data\models\isolation_forest.pkl
2025-12-29 11:30:58,014 - app.ml.isolation_forest - INFO - Training complete: {'model_type': 'isolation_forest', 'samples_trained': 8, 'contamination': 0.1, 'n_estimators': 100, 'anomalies_in_training': 1, 'score_mean': 0.21015675137291778, 'score_std': 0.13516027572808917, 'trained_at': '2025-12-29T06:00:58.014867'}
2025-12-29 11:30:58,019 - app.ml.autoencoder - INFO - Training Autoencoder with 8 samples
2025-12-29 11:31:03,823 - app.ml.autoencoder - INFO - Epoch 20/100, Loss: 0.397127
2025-12-29 11:31:04,006 - app.ml.autoencoder - INFO - Epoch 40/100, Loss: 0.390861
2025-12-29 11:31:04,177 - app.ml.autoencoder - INFO - Epoch 60/100, Loss: 0.390569
2025-12-29 11:31:04,339 - app.ml.autoencoder - INFO - Epoch 80/100, Loss: 0.343623
2025-12-29 11:31:04,523 - app.ml.autoencoder - INFO - Epoch 100/100, Loss: 0.220835
2025-12-29 11:31:04,537 - app.ml.autoencoder - INFO - Autoencoder saved to E:\wifi-tracker\backend\data\models\autoencoder.pth
2025-12-29 11:31:04,539 - app.ml.autoencoder - INFO - Training complete: {'model_type': 'autoencoder', 'samples_trained': 8, 'input_dim': 15, 'encoding_dim': 8, 'epochs': 100, 'final_loss': 0.22083482146263123, 'threshold': 0.9447397589683533, 'threshold_percentile': 95, 'trained_at': '2025-12-29T06:01:04.539089'}
2025-12-29 11:31:04,541 - app.routers.dashboard - INFO - ML training initiated by admin: {'status': 'success', 'models': {'isolation_forest': {'model_type': 'isolation_forest', 'samples_trained': 8, 'contamination': 0.1, 'n_estimators': 100, 'anomalies_in_training': 1, 'score_mean': 0.21015675137291778, 'score_std': 0.13516027572808917, 'trained_at': '2025-12-29T06:00:58.014867'}, 'autoencoder': {'model_type': 'autoencoder', 'samples_trained': 8, 'input_dim': 15, 'encoding_dim': 8, 'epochs': 100, 'final_loss': 0.22083482146263123, 'threshold': 0.9447397589683533, 'threshold_percentile': 95, 'trained_at': '2025-12-29T06:01:04.539089'}}, 'trained_at': '2025-12-29T06:01:04.541574', 'total_samples': 8}
2025-12-29 11:31:04,555 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:31:04,584 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:31:04,589 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:31:04,603 - sqlalchemy.engine.Engine - INFO - [cached since 83.59s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:31:04,612 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:31:09,608 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:31:09,619 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:31:09,630 - sqlalchemy.engine.Engine - INFO - [cached since 88.61s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:31:09,642 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:31:09,652 - sqlalchemy.engine.Engine - INFO - [cached since 88.53s ago] {}
2025-12-29 11:31:09,658 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:31:09,672 - sqlalchemy.engine.Engine - INFO - [generated in 0.01425s] {'param_1': 0, 'param_2': 20}
2025-12-29 11:31:09,678 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:31:09,696 - sqlalchemy.engine.Engine - INFO - [cached since 53.29s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:31:09,705 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:31:09,716 - sqlalchemy.engine.Engine - INFO - [cached since 53.31s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:31:09,723 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:31:09,738 - sqlalchemy.engine.Engine - INFO - [cached since 53.33s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:31:09,746 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:31:09,765 - sqlalchemy.engine.Engine - INFO - [cached since 53.36s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:31:09,770 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:31:09,784 - sqlalchemy.engine.Engine - INFO - [cached since 53.38s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:31:09,790 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:31:09,805 - sqlalchemy.engine.Engine - INFO - [cached since 53.4s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:31:09,810 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:31:09,824 - sqlalchemy.engine.Engine - INFO - [cached since 53.42s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:31:09,834 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:31:09,847 - sqlalchemy.engine.Engine - INFO - [cached since 53.44s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-29 11:31:09,859 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:31:14,625 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:31:14,651 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:31:14,666 - sqlalchemy.engine.Engine - INFO - [cached since 93.65s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:31:14,680 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:31:14,711 - sqlalchemy.engine.Engine - INFO - [cached since 93.18s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:31:14,720 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:31:14,734 - sqlalchemy.engine.Engine - INFO - [cached since 17.64s ago] {'device_id_1': 10}
2025-12-29 11:31:14,738 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:31:14,745 - sqlalchemy.engine.Engine - INFO - [cached since 17.63s ago] {'device_id_1': 10}
2025-12-29 11:31:14,815 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:31:20,187 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:31:20,209 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:31:20,238 - sqlalchemy.engine.Engine - INFO - [cached since 99.22s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:31:20,245 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:31:20,254 - sqlalchemy.engine.Engine - INFO - [cached since 98.72s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:31:20,259 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:31:20,271 - sqlalchemy.engine.Engine - INFO - [cached since 23.17s ago] {'device_id_1': 11}
2025-12-29 11:31:20,278 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:31:20,289 - sqlalchemy.engine.Engine - INFO - [cached since 23.17s ago] {'device_id_1': 11}
2025-12-29 11:31:20,371 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:31:23,335 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:31:23,344 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:31:23,363 - sqlalchemy.engine.Engine - INFO - [cached since 102.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:31:23,371 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:31:23,392 - sqlalchemy.engine.Engine - INFO - [cached since 101.9s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:31:23,400 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:31:23,411 - sqlalchemy.engine.Engine - INFO - [cached since 26.31s ago] {'device_id_1': 9}
2025-12-29 11:31:23,418 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:31:23,426 - sqlalchemy.engine.Engine - INFO - [cached since 26.31s ago] {'device_id_1': 9}
2025-12-29 11:31:23,506 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:31:28,752 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:31:28,761 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:31:28,802 - sqlalchemy.engine.Engine - INFO - [cached since 107.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:31:28,811 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:31:28,825 - sqlalchemy.engine.Engine - INFO - [cached since 107.3s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:31:28,834 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:31:28,854 - sqlalchemy.engine.Engine - INFO - [cached since 31.76s ago] {'device_id_1': 7}
2025-12-29 11:31:28,862 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:31:28,875 - sqlalchemy.engine.Engine - INFO - [cached since 31.76s ago] {'device_id_1': 7}
2025-12-29 11:31:29,014 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:31:34,746 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:31:34,752 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:31:34,765 - sqlalchemy.engine.Engine - INFO - [cached since 113.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:31:34,771 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:31:34,805 - sqlalchemy.engine.Engine - INFO - [cached since 113.3s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:31:34,820 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:31:34,839 - sqlalchemy.engine.Engine - INFO - [cached since 37.74s ago] {'device_id_1': 14}
2025-12-29 11:31:34,854 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:31:34,872 - sqlalchemy.engine.Engine - INFO - [cached since 37.75s ago] {'device_id_1': 14}
2025-12-29 11:31:34,982 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:31:43,561 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:31:43,569 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:31:43,589 - sqlalchemy.engine.Engine - INFO - [cached since 122.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:31:43,596 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:31:43,605 - sqlalchemy.engine.Engine - INFO - [cached since 122.1s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:31:43,612 - sqlalchemy.engine.Engine - INFO - UPDATE devices SET last_seen=%(last_seen)s, is_trusted=%(is_trusted)s WHERE devices.id = %(devices_id)s
2025-12-29 11:31:43,615 - sqlalchemy.engine.Engine - INFO - [generated in 0.00326s] {'last_seen': datetime.datetime(2025, 12, 29, 6, 1, 43, 612115), 'is_trusted': 1, 'devices_id': 11}
2025-12-29 11:31:43,630 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:31:43,637 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:31:43,646 - sqlalchemy.engine.Engine - INFO - SELECT devices.id, devices.mac_address, devices.hostname, devices.vendor, devices.device_type, devices.first_seen, devices.last_seen, devices.is_trusted, devices.is_suspicious, devices.notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:31:43,654 - sqlalchemy.engine.Engine - INFO - [generated in 0.00867s] {'pk_1': 11}
2025-12-29 11:31:43,663 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-29 11:31:43,671 - sqlalchemy.engine.Engine - INFO - [cached since 116.7s ago] {'pk_1': 1}
2025-12-29 11:31:43,676 - app.routers.devices - INFO - Device 01:00:5E:00:00:FB updated by admin
2025-12-29 11:31:43,680 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:31:43,696 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:31:43,699 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:31:43,705 - sqlalchemy.engine.Engine - INFO - [cached since 122.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:31:43,713 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:31:43,726 - sqlalchemy.engine.Engine - INFO - [cached since 122.6s ago] {}
2025-12-29 11:31:43,729 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:31:43,738 - sqlalchemy.engine.Engine - INFO - [cached since 34.08s ago] {'param_1': 0, 'param_2': 20}
2025-12-29 11:31:43,747 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:31:43,758 - sqlalchemy.engine.Engine - INFO - [cached since 87.35s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:31:43,764 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:31:43,781 - sqlalchemy.engine.Engine - INFO - [cached since 87.38s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:31:43,799 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:31:43,812 - sqlalchemy.engine.Engine - INFO - [cached since 87.41s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:31:43,819 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:31:43,839 - sqlalchemy.engine.Engine - INFO - [cached since 87.43s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:31:43,846 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:31:43,855 - sqlalchemy.engine.Engine - INFO - [cached since 87.45s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:31:43,862 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:31:43,871 - sqlalchemy.engine.Engine - INFO - [cached since 87.47s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:31:43,880 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:31:43,888 - sqlalchemy.engine.Engine - INFO - [cached since 87.48s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:31:43,896 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:31:43,905 - sqlalchemy.engine.Engine - INFO - [cached since 87.5s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-29 11:31:43,916 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:31:51,856 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:31:51,867 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:31:51,912 - sqlalchemy.engine.Engine - INFO - [cached since 130.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:31:51,930 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:31:51,956 - sqlalchemy.engine.Engine - INFO - [cached since 130.4s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:31:51,965 - sqlalchemy.engine.Engine - INFO - UPDATE devices SET last_seen=%(last_seen)s, is_trusted=%(is_trusted)s WHERE devices.id = %(devices_id)s
2025-12-29 11:31:51,968 - sqlalchemy.engine.Engine - INFO - [cached since 8.357s ago] {'last_seen': datetime.datetime(2025, 12, 29, 6, 1, 51, 965545), 'is_trusted': 0, 'devices_id': 11}
2025-12-29 11:31:51,977 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:31:51,985 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:31:51,990 - sqlalchemy.engine.Engine - INFO - SELECT devices.id, devices.mac_address, devices.hostname, devices.vendor, devices.device_type, devices.first_seen, devices.last_seen, devices.is_trusted, devices.is_suspicious, devices.notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:31:51,996 - sqlalchemy.engine.Engine - INFO - [cached since 8.351s ago] {'pk_1': 11}
2025-12-29 11:31:52,001 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-29 11:31:52,009 - sqlalchemy.engine.Engine - INFO - [cached since 125s ago] {'pk_1': 1}
2025-12-29 11:31:52,013 - app.routers.devices - INFO - Device 01:00:5E:00:00:FB updated by admin
2025-12-29 11:31:52,016 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:31:52,034 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:31:52,036 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:31:52,043 - sqlalchemy.engine.Engine - INFO - [cached since 131s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:31:52,048 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:31:52,059 - sqlalchemy.engine.Engine - INFO - [cached since 130.9s ago] {}
2025-12-29 11:31:52,063 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:31:52,076 - sqlalchemy.engine.Engine - INFO - [cached since 42.42s ago] {'param_1': 0, 'param_2': 20}
2025-12-29 11:31:52,083 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:31:52,095 - sqlalchemy.engine.Engine - INFO - [cached since 95.69s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:31:52,102 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:31:52,116 - sqlalchemy.engine.Engine - INFO - [cached since 95.71s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:31:52,122 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:31:52,131 - sqlalchemy.engine.Engine - INFO - [cached since 95.73s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:31:52,137 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:31:52,147 - sqlalchemy.engine.Engine - INFO - [cached since 95.74s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:31:52,152 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:31:52,163 - sqlalchemy.engine.Engine - INFO - [cached since 95.76s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:31:52,170 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:31:52,179 - sqlalchemy.engine.Engine - INFO - [cached since 95.78s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:31:52,185 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:31:52,195 - sqlalchemy.engine.Engine - INFO - [cached since 95.79s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:31:52,201 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:31:52,212 - sqlalchemy.engine.Engine - INFO - [cached since 95.81s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-29 11:31:52,219 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:31:54,917 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:31:54,960 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:31:55,000 - sqlalchemy.engine.Engine - INFO - [cached since 134s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:31:55,015 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:31:55,030 - sqlalchemy.engine.Engine - INFO - [cached since 133.7s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:31:55,041 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:31:55,056 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:31:55,059 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:31:55,067 - sqlalchemy.engine.Engine - INFO - [cached since 134.1s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:31:55,078 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:32:00,354 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:32:00,359 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:32:00,372 - sqlalchemy.engine.Engine - INFO - [cached since 139.4s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:32:00,379 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:32:00,394 - sqlalchemy.engine.Engine - INFO - [cached since 139.3s ago] {}
2025-12-29 11:32:00,399 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:32:00,413 - sqlalchemy.engine.Engine - INFO - [cached since 50.76s ago] {'param_1': 0, 'param_2': 20}
2025-12-29 11:32:00,422 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:32:00,433 - sqlalchemy.engine.Engine - INFO - [cached since 104s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:32:00,442 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:32:00,456 - sqlalchemy.engine.Engine - INFO - [cached since 104.1s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:32:00,463 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:32:00,476 - sqlalchemy.engine.Engine - INFO - [cached since 104.1s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:32:00,482 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:32:00,517 - sqlalchemy.engine.Engine - INFO - [cached since 104.1s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:32:00,527 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:32:00,541 - sqlalchemy.engine.Engine - INFO - [cached since 104.1s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:32:00,546 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:32:00,561 - sqlalchemy.engine.Engine - INFO - [cached since 104.2s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:32:00,566 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:32:00,579 - sqlalchemy.engine.Engine - INFO - [cached since 104.2s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:32:00,586 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:32:00,605 - sqlalchemy.engine.Engine - INFO - [cached since 104.2s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-29 11:32:00,616 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:32:05,947 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:32:05,969 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:32:06,028 - sqlalchemy.engine.Engine - INFO - [cached since 145s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:32:06,037 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:32:06,056 - sqlalchemy.engine.Engine - INFO - [cached since 144.7s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:32:06,066 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:32:06,085 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:32:06,090 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:32:06,099 - sqlalchemy.engine.Engine - INFO - [cached since 145.1s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:32:06,111 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:32:23,964 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:32:23,973 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:32:24,006 - sqlalchemy.engine.Engine - INFO - [cached since 163s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:32:24,034 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:32:24,055 - sqlalchemy.engine.Engine - INFO - [cached since 162.9s ago] {}
2025-12-29 11:32:24,059 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:32:24,068 - sqlalchemy.engine.Engine - INFO - [cached since 74.41s ago] {'param_1': 0, 'param_2': 20}
2025-12-29 11:32:24,074 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:32:24,087 - sqlalchemy.engine.Engine - INFO - [cached since 127.7s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:32:24,091 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:32:24,100 - sqlalchemy.engine.Engine - INFO - [cached since 127.7s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:32:24,109 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:32:24,124 - sqlalchemy.engine.Engine - INFO - [cached since 127.7s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:32:24,130 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:32:24,141 - sqlalchemy.engine.Engine - INFO - [cached since 127.7s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:32:24,151 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:32:24,168 - sqlalchemy.engine.Engine - INFO - [cached since 127.8s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:32:24,173 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:32:24,187 - sqlalchemy.engine.Engine - INFO - [cached since 127.8s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:32:24,193 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:32:24,203 - sqlalchemy.engine.Engine - INFO - [cached since 127.8s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:32:24,209 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:32:24,222 - sqlalchemy.engine.Engine - INFO - [cached since 127.8s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-29 11:32:24,231 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:32:39,953 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:32:39,996 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:32:40,013 - sqlalchemy.engine.Engine - INFO - [cached since 179s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:32:40,024 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:32:40,049 - sqlalchemy.engine.Engine - INFO - [cached since 178.7s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:32:40,062 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:32:40,083 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:32:40,086 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:32:40,098 - sqlalchemy.engine.Engine - INFO - [cached since 179.1s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:32:40,107 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:32:55,429 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:32:55,438 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:32:55,479 - sqlalchemy.engine.Engine - INFO - [cached since 194.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:32:55,512 - app.database - ERROR - Database session error: 1 validation error:
  {'type': 'value_error', 'loc': ('body', 'network_range'), 'msg': 'Value error, Invalid network range format. Expected: X.X.X.X/XX', 'input': '10.41.243.123', 'ctx': {'error': ValueError('Invalid network range format. Expected: X.X.X.X/XX')}}

  File "E:\wifi-tracker\backend\app\routers\scans.py", line 166, in start_scan
    POST /api/scans/start
2025-12-29 11:32:55,517 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:33:01,335 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:33:01,356 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:33:01,393 - sqlalchemy.engine.Engine - INFO - [cached since 200.4s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:33:01,402 - app.database - ERROR - Database session error: 1 validation error:
  {'type': 'value_error', 'loc': ('body', 'network_range'), 'msg': 'Value error, Invalid network range format. Expected: X.X.X.X/XX', 'input': '10.41.243.123', 'ctx': {'error': ValueError('Invalid network range format. Expected: X.X.X.X/XX')}}

  File "E:\wifi-tracker\backend\app\routers\scans.py", line 166, in start_scan
    POST /api/scans/start
2025-12-29 11:33:01,410 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:36:37,304 - app.services.notification - INFO - WebSocket client unregistered. Total: 1
2025-12-29 11:36:37,393 - app.main - INFO - WebSocket client disconnected
2025-12-29 11:36:37,805 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:36:37,814 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:36:37,833 - sqlalchemy.engine.Engine - INFO - [cached since 416.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:36:37,846 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:36:37,873 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:36:37,878 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:36:37,891 - sqlalchemy.engine.Engine - INFO - [cached since 416.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:36:37,899 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:36:37,928 - sqlalchemy.engine.Engine - INFO - [cached since 416.8s ago] {}
2025-12-29 11:36:37,939 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:36:37,965 - sqlalchemy.engine.Engine - INFO - [cached since 416.8s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 5, 56, 37, 938242)}
2025-12-29 11:36:37,977 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:36:37,994 - sqlalchemy.engine.Engine - INFO - [cached since 416.8s ago] {}
2025-12-29 11:36:37,999 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:36:38,017 - sqlalchemy.engine.Engine - INFO - [cached since 416.8s ago] {}
2025-12-29 11:36:38,036 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:36:38,059 - sqlalchemy.engine.Engine - INFO - [cached since 416.8s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:36:38,069 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:36:38,080 - sqlalchemy.engine.Engine - INFO - [cached since 416.8s ago] {}
2025-12-29 11:36:38,084 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:36:38,098 - sqlalchemy.engine.Engine - INFO - [cached since 416.8s ago] {}
2025-12-29 11:36:38,107 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:36:38,118 - sqlalchemy.engine.Engine - INFO - [cached since 416.8s ago] {'status_1': 'completed'}
2025-12-29 11:36:38,126 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:36:38,138 - sqlalchemy.engine.Engine - INFO - [cached since 416.8s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:36:38,144 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:36:38,148 - sqlalchemy.engine.Engine - INFO - [cached since 416.7s ago] {}
2025-12-29 11:36:38,158 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:36:38,167 - app.services.notification - INFO - WebSocket client registered. Total: 2
2025-12-29 11:36:38,173 - app.main - INFO - WebSocket client connected
2025-12-29 11:36:38,198 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:36:38,200 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:36:38,244 - sqlalchemy.engine.Engine - INFO - [cached since 417.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:36:38,251 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:36:38,265 - sqlalchemy.engine.Engine - INFO - [cached since 416.7s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:36:38,272 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:36:38,280 - sqlalchemy.engine.Engine - INFO - [cached since 416.7s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 22, 6, 6, 38, 269959), 'param_1': 100}
2025-12-29 11:36:38,288 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s AND scan_results.scan_timestamp >= %(scan_timestamp_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:36:38,297 - sqlalchemy.engine.Engine - INFO - [cached since 416.7s ago] {'device_id_1': 7, 'scan_timestamp_1': datetime.datetime(2025, 12, 22, 6, 6, 38, 269959), 'param_1': 100}
2025-12-29 11:36:38,307 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:36:38,326 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:36:38,328 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:36:38,340 - sqlalchemy.engine.Engine - INFO - [cached since 417.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:36:38,346 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:36:38,356 - sqlalchemy.engine.Engine - INFO - [cached since 417.2s ago] {}
2025-12-29 11:36:38,361 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:36:38,371 - sqlalchemy.engine.Engine - INFO - [cached since 417.2s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 5, 56, 38, 360106)}
2025-12-29 11:36:38,377 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:36:38,388 - sqlalchemy.engine.Engine - INFO - [cached since 417.2s ago] {}
2025-12-29 11:36:38,392 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:36:38,406 - sqlalchemy.engine.Engine - INFO - [cached since 417.2s ago] {}
2025-12-29 11:36:38,410 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:36:38,417 - sqlalchemy.engine.Engine - INFO - [cached since 417.2s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:36:38,426 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:36:38,433 - sqlalchemy.engine.Engine - INFO - [cached since 417.1s ago] {}
2025-12-29 11:36:38,437 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:36:38,445 - sqlalchemy.engine.Engine - INFO - [cached since 417.1s ago] {}
2025-12-29 11:36:38,449 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:36:38,460 - sqlalchemy.engine.Engine - INFO - [cached since 417.1s ago] {'status_1': 'completed'}
2025-12-29 11:36:38,465 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:36:38,480 - sqlalchemy.engine.Engine - INFO - [cached since 417.1s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:36:38,488 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:36:38,496 - sqlalchemy.engine.Engine - INFO - [cached since 417.1s ago] {}
2025-12-29 11:36:38,505 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:36:38,588 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:36:38,591 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:36:38,598 - sqlalchemy.engine.Engine - INFO - [cached since 417.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:36:38,605 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:36:38,616 - sqlalchemy.engine.Engine - INFO - [cached since 416.6s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 28, 6, 6, 38, 603182), 'param_1': 100}
2025-12-29 11:36:38,627 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:36:38,640 - sqlalchemy.engine.Engine - INFO - [cached since 417.1s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:36:38,645 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:36:38,655 - sqlalchemy.engine.Engine - INFO - [cached since 417.1s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:36:38,757 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:36:38,793 - sqlalchemy.engine.Engine - INFO - [cached since 417.3s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:36:38,893 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:36:38,909 - sqlalchemy.engine.Engine - INFO - [cached since 417.4s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:36:38,994 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:36:39,018 - sqlalchemy.engine.Engine - INFO - [cached since 417.5s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:36:39,031 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:36:39,226 - sqlalchemy.engine.Engine - INFO - [cached since 417.7s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:36:39,281 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:36:39,290 - sqlalchemy.engine.Engine - INFO - [cached since 417.8s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:36:39,296 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:36:39,324 - sqlalchemy.engine.Engine - INFO - [cached since 417.8s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:36:39,329 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:36:39,339 - sqlalchemy.engine.Engine - INFO - [cached since 417.8s ago] {'id_1': 13, 'param_1': 1}
2025-12-29 11:36:39,344 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:36:39,351 - sqlalchemy.engine.Engine - INFO - [cached since 417.8s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:36:39,357 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:36:39,365 - sqlalchemy.engine.Engine - INFO - [cached since 417.8s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:36:39,371 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:36:39,378 - sqlalchemy.engine.Engine - INFO - [cached since 417.8s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:36:39,383 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:36:39,394 - sqlalchemy.engine.Engine - INFO - [cached since 417.9s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:36:39,400 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:36:39,412 - sqlalchemy.engine.Engine - INFO - [cached since 417.9s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:36:39,417 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:36:39,430 - sqlalchemy.engine.Engine - INFO - [cached since 417.9s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:36:39,443 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:36:43,523 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:36:43,527 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:36:43,538 - sqlalchemy.engine.Engine - INFO - [cached since 422.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:36:43,544 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-29 11:36:43,549 - sqlalchemy.engine.Engine - INFO - [cached since 416.8s ago] {'started_at': datetime.datetime(2025, 12, 29, 6, 6, 43, 544806), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'arp', 'network_range': '192.168.1.0/24', 'status': 'running', 'error_message': None}
2025-12-29 11:36:43,561 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:36:43,566 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:36:43,572 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-29 11:36:43,577 - sqlalchemy.engine.Engine - INFO - [cached since 416.7s ago] {'pk_1': 31}
2025-12-29 11:36:43,581 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-29 11:36:43,589 - sqlalchemy.engine.Engine - INFO - [cached since 416.6s ago] {'pk_1': 1}
2025-12-29 11:36:43,593 - app.routers.scans - INFO - Scan started by admin: 31
2025-12-29 11:36:43,597 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:36:43,611 - sqlalchemy.engine.Engine - INFO - [cached since 416.6s ago] {'id_1': 31, 'param_1': 1}
2025-12-29 11:36:43,615 - app.services.scanner - INFO - Starting ARP scan on 192.168.1.0/24
2025-12-29 11:36:43,617 - app.services.scanner - INFO - Starting fallback scan on 192.168.1.0/24 (ping + ARP table)
2025-12-29 11:37:10,509 - app.services.scanner - INFO - Fallback scan complete: 8 devices found
2025-12-29 11:37:10,514 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:10,531 - sqlalchemy.engine.Engine - INFO - [cached since 414.1s ago] {'mac_address_1': '96:A4:CB:4D:96:A9', 'param_1': 1}
2025-12-29 11:37:10,539 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:37:10,552 - sqlalchemy.engine.Engine - INFO - [cached since 414.1s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:37:10,558 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:10,566 - sqlalchemy.engine.Engine - INFO - [cached since 414.2s ago] {'mac_address_1': 'FF:FF:FF:FF:FF:FF', 'param_1': 1}
2025-12-29 11:37:10,570 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:37:10,579 - sqlalchemy.engine.Engine - INFO - [cached since 414.2s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:37:10,584 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:10,591 - sqlalchemy.engine.Engine - INFO - [cached since 414.2s ago] {'mac_address_1': '01:00:5E:00:00:16', 'param_1': 1}
2025-12-29 11:37:10,596 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:37:10,603 - sqlalchemy.engine.Engine - INFO - [cached since 414.2s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:37:10,608 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:10,616 - sqlalchemy.engine.Engine - INFO - [cached since 414.2s ago] {'mac_address_1': '01:00:5E:00:00:FB', 'param_1': 1}
2025-12-29 11:37:10,619 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:37:10,625 - sqlalchemy.engine.Engine - INFO - [cached since 414.2s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:37:10,632 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:10,639 - sqlalchemy.engine.Engine - INFO - [cached since 414.2s ago] {'mac_address_1': '01:00:5E:00:00:FC', 'param_1': 1}
2025-12-29 11:37:10,642 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:37:10,650 - sqlalchemy.engine.Engine - INFO - [cached since 414.2s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:37:10,656 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:10,664 - sqlalchemy.engine.Engine - INFO - [cached since 414.3s ago] {'mac_address_1': '01:00:5E:7F:66:12', 'param_1': 1}
2025-12-29 11:37:10,669 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:37:10,682 - sqlalchemy.engine.Engine - INFO - [cached since 414.3s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:37:10,689 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:10,699 - sqlalchemy.engine.Engine - INFO - [cached since 414.3s ago] {'mac_address_1': '01:00:5E:7F:FF:FA', 'param_1': 1}
2025-12-29 11:37:10,704 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:37:10,715 - sqlalchemy.engine.Engine - INFO - [cached since 414.3s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:37:10,720 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:10,726 - sqlalchemy.engine.Engine - INFO - [cached since 414.3s ago] {'mac_address_1': 'FF:FF:FF:FF:FF:FF', 'param_1': 1}
2025-12-29 11:37:10,733 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:37:10,740 - sqlalchemy.engine.Engine - INFO - [cached since 414.3s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:37:10,748 - sqlalchemy.engine.Engine - INFO - UPDATE devices SET last_seen=%(last_seen)s WHERE devices.id = %(devices_id)s
2025-12-29 11:37:10,750 - sqlalchemy.engine.Engine - INFO - [cached since 414.1s ago] [{'last_seen': datetime.datetime(2025, 12, 29, 6, 7, 10, 556649), 'devices_id': 8}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 7, 10, 744488), 'devices_id': 9}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 7, 10, 607555), 'devices_id': 10}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 7, 10, 631301), 'devices_id': 11}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 7, 10, 654662), 'devices_id': 12}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 7, 10, 687871), 'devices_id': 13}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 7, 10, 718784), 'devices_id': 14}]
2025-12-29 11:37:10,772 - sqlalchemy.engine.Engine - INFO - UPDATE scan_sessions SET completed_at=%(completed_at)s, total_devices_found=%(total_devices_found)s, status=%(status)s WHERE scan_sessions.id = %(scan_sessions_id)s
2025-12-29 11:37:10,775 - sqlalchemy.engine.Engine - INFO - [cached since 414.1s ago] {'completed_at': datetime.datetime(2025, 12, 29, 6, 7, 10, 745287), 'total_devices_found': 8, 'status': 'completed', 'scan_sessions_id': 31}
2025-12-29 11:37:10,781 - sqlalchemy.engine.Engine - INFO - INSERT INTO device_activity (device_id, event_type, old_value, new_value, event_timestamp) VALUES (%(device_id)s, %(event_type)s, %(old_value)s, %(new_value)s, %(event_timestamp)s)
2025-12-29 11:37:10,785 - sqlalchemy.engine.Engine - INFO - [cached since 414.1s ago] {'device_id': 9, 'event_type': 'ip_changed', 'old_value': '255.255.255.255', 'new_value': '10.41.243.255', 'event_timestamp': datetime.datetime(2025, 12, 29, 6, 7, 10, 781743)}
2025-12-29 11:37:10,791 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:37:10,797 - sqlalchemy.engine.Engine - INFO - [cached since 414.1s ago] {'device_id': 8, 'ip_address': '10.41.243.123', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 7, 10, 791348), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:37:10,802 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:37:10,806 - sqlalchemy.engine.Engine - INFO - [cached since 414.1s ago] {'device_id': 9, 'ip_address': '10.41.243.255', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 7, 10, 802673), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:37:10,815 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:37:10,818 - sqlalchemy.engine.Engine - INFO - [cached since 414.1s ago] {'device_id': 10, 'ip_address': '224.0.0.22', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 7, 10, 815555), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:37:10,824 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:37:10,831 - sqlalchemy.engine.Engine - INFO - [cached since 414.1s ago] {'device_id': 11, 'ip_address': '224.0.0.251', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 7, 10, 824160), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:37:10,836 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:37:10,841 - sqlalchemy.engine.Engine - INFO - [cached since 414.1s ago] {'device_id': 12, 'ip_address': '224.0.0.252', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 7, 10, 836186), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:37:10,848 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:37:10,852 - sqlalchemy.engine.Engine - INFO - [cached since 414.1s ago] {'device_id': 13, 'ip_address': '239.255.102.18', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 7, 10, 848535), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:37:10,858 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:37:10,865 - sqlalchemy.engine.Engine - INFO - [cached since 414.2s ago] {'device_id': 14, 'ip_address': '239.255.255.250', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 7, 10, 858460), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:37:10,871 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:37:10,878 - sqlalchemy.engine.Engine - INFO - [cached since 414.2s ago] {'device_id': 9, 'ip_address': '255.255.255.255', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 7, 10, 871149), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:37:10,888 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:37:10,893 - app.routers.scans - INFO - Scan completed: 8 devices, 0 new
2025-12-29 11:37:11,290 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:37:11,304 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:11,325 - sqlalchemy.engine.Engine - INFO - [cached since 450.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:37:11,333 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:37:11,342 - sqlalchemy.engine.Engine - INFO - [cached since 450.2s ago] {}
2025-12-29 11:37:11,354 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:37:11,366 - sqlalchemy.engine.Engine - INFO - [cached since 450.2s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 5, 57, 11, 352830)}
2025-12-29 11:37:11,373 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:37:11,386 - sqlalchemy.engine.Engine - INFO - [cached since 450.2s ago] {}
2025-12-29 11:37:11,390 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:37:11,400 - sqlalchemy.engine.Engine - INFO - [cached since 450.2s ago] {}
2025-12-29 11:37:11,406 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:37:11,416 - sqlalchemy.engine.Engine - INFO - [cached since 450.2s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:37:11,419 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:37:11,426 - sqlalchemy.engine.Engine - INFO - [cached since 450.1s ago] {}
2025-12-29 11:37:11,432 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:37:11,441 - sqlalchemy.engine.Engine - INFO - [cached since 450.1s ago] {}
2025-12-29 11:37:11,446 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:37:11,454 - sqlalchemy.engine.Engine - INFO - [cached since 450.1s ago] {'status_1': 'completed'}
2025-12-29 11:37:11,458 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:37:11,468 - sqlalchemy.engine.Engine - INFO - [cached since 450.1s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:37:11,473 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:37:11,475 - sqlalchemy.engine.Engine - INFO - [cached since 450.1s ago] {}
2025-12-29 11:37:11,481 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:37:11,491 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:37:11,493 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:11,503 - sqlalchemy.engine.Engine - INFO - [cached since 450.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:37:11,510 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:37:11,526 - sqlalchemy.engine.Engine - INFO - [cached since 450.4s ago] {}
2025-12-29 11:37:11,535 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:37:11,550 - sqlalchemy.engine.Engine - INFO - [cached since 450.4s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 5, 57, 11, 534482)}
2025-12-29 11:37:11,554 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:37:11,562 - sqlalchemy.engine.Engine - INFO - [cached since 450.4s ago] {}
2025-12-29 11:37:11,566 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:37:11,573 - sqlalchemy.engine.Engine - INFO - [cached since 450.3s ago] {}
2025-12-29 11:37:11,577 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:37:11,586 - sqlalchemy.engine.Engine - INFO - [cached since 450.3s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:37:11,591 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:37:11,600 - sqlalchemy.engine.Engine - INFO - [cached since 450.3s ago] {}
2025-12-29 11:37:11,604 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:37:11,610 - sqlalchemy.engine.Engine - INFO - [cached since 450.3s ago] {}
2025-12-29 11:37:11,616 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:37:11,625 - sqlalchemy.engine.Engine - INFO - [cached since 450.3s ago] {'status_1': 'completed'}
2025-12-29 11:37:11,633 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:37:11,641 - sqlalchemy.engine.Engine - INFO - [cached since 450.3s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:37:11,646 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:37:11,649 - sqlalchemy.engine.Engine - INFO - [cached since 450.2s ago] {}
2025-12-29 11:37:11,656 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:37:11,659 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:37:11,663 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:11,668 - sqlalchemy.engine.Engine - INFO - [cached since 450.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:37:11,675 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:11,686 - sqlalchemy.engine.Engine - INFO - [cached since 450.2s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:37:11,692 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:37:11,706 - sqlalchemy.engine.Engine - INFO - [cached since 450.2s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 22, 6, 7, 11, 690824), 'param_1': 100}
2025-12-29 11:37:11,713 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s AND scan_results.scan_timestamp >= %(scan_timestamp_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:37:11,724 - sqlalchemy.engine.Engine - INFO - [cached since 450.1s ago] {'device_id_1': 7, 'scan_timestamp_1': datetime.datetime(2025, 12, 22, 6, 7, 11, 690824), 'param_1': 100}
2025-12-29 11:37:11,736 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:37:11,748 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:37:11,750 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:11,755 - sqlalchemy.engine.Engine - INFO - [cached since 450.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:37:11,761 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:11,769 - sqlalchemy.engine.Engine - INFO - [cached since 450.2s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:37:11,775 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:37:11,786 - sqlalchemy.engine.Engine - INFO - [cached since 450.2s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 22, 6, 7, 11, 774384), 'param_1': 100}
2025-12-29 11:37:11,793 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s AND scan_results.scan_timestamp >= %(scan_timestamp_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:37:11,806 - sqlalchemy.engine.Engine - INFO - [cached since 450.2s ago] {'device_id_1': 7, 'scan_timestamp_1': datetime.datetime(2025, 12, 22, 6, 7, 11, 774384), 'param_1': 100}
2025-12-29 11:37:11,818 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:37:11,820 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:37:11,822 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:11,829 - sqlalchemy.engine.Engine - INFO - [cached since 450.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:37:11,835 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:37:11,843 - sqlalchemy.engine.Engine - INFO - [cached since 450.7s ago] {}
2025-12-29 11:37:11,850 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:37:11,859 - sqlalchemy.engine.Engine - INFO - [cached since 450.7s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 5, 57, 11, 848720)}
2025-12-29 11:37:11,867 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:37:11,876 - sqlalchemy.engine.Engine - INFO - [cached since 450.7s ago] {}
2025-12-29 11:37:11,882 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:37:11,890 - sqlalchemy.engine.Engine - INFO - [cached since 450.7s ago] {}
2025-12-29 11:37:11,896 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:37:11,905 - sqlalchemy.engine.Engine - INFO - [cached since 450.6s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:37:11,911 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:37:11,919 - sqlalchemy.engine.Engine - INFO - [cached since 450.6s ago] {}
2025-12-29 11:37:11,923 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:37:11,933 - sqlalchemy.engine.Engine - INFO - [cached since 450.6s ago] {}
2025-12-29 11:37:11,938 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:37:11,951 - sqlalchemy.engine.Engine - INFO - [cached since 450.6s ago] {'status_1': 'completed'}
2025-12-29 11:37:11,955 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:37:11,968 - sqlalchemy.engine.Engine - INFO - [cached since 450.6s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:37:11,973 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:37:11,976 - sqlalchemy.engine.Engine - INFO - [cached since 450.6s ago] {}
2025-12-29 11:37:11,986 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:37:12,001 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:37:12,018 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:12,029 - sqlalchemy.engine.Engine - INFO - [cached since 451s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:37:12,146 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:37:12,181 - sqlalchemy.engine.Engine - INFO - [cached since 451.1s ago] {}
2025-12-29 11:37:12,230 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:37:12,302 - sqlalchemy.engine.Engine - INFO - [cached since 451.1s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 5, 57, 12, 229294)}
2025-12-29 11:37:12,380 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:37:12,392 - sqlalchemy.engine.Engine - INFO - [cached since 451.2s ago] {}
2025-12-29 11:37:12,404 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:37:12,419 - sqlalchemy.engine.Engine - INFO - [cached since 451.2s ago] {}
2025-12-29 11:37:12,424 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:37:12,469 - sqlalchemy.engine.Engine - INFO - [cached since 451.2s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:37:12,509 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:37:12,529 - sqlalchemy.engine.Engine - INFO - [cached since 451.2s ago] {}
2025-12-29 11:37:12,533 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:37:12,540 - sqlalchemy.engine.Engine - INFO - [cached since 451.2s ago] {}
2025-12-29 11:37:12,545 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:37:12,553 - sqlalchemy.engine.Engine - INFO - [cached since 451.2s ago] {'status_1': 'completed'}
2025-12-29 11:37:12,558 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:37:12,569 - sqlalchemy.engine.Engine - INFO - [cached since 451.2s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:37:12,574 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:37:12,580 - sqlalchemy.engine.Engine - INFO - [cached since 451.2s ago] {}
2025-12-29 11:37:12,587 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:37:12,597 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:37:12,599 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:12,604 - sqlalchemy.engine.Engine - INFO - [cached since 451.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:37:12,609 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:37:12,618 - sqlalchemy.engine.Engine - INFO - [cached since 450.6s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 28, 6, 7, 12, 608225), 'param_1': 100}
2025-12-29 11:37:12,623 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:12,629 - sqlalchemy.engine.Engine - INFO - [cached since 451.1s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:37:12,634 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:12,638 - sqlalchemy.engine.Engine - INFO - [cached since 451.1s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:37:12,642 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:12,648 - sqlalchemy.engine.Engine - INFO - [cached since 451.1s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:37:12,652 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:12,658 - sqlalchemy.engine.Engine - INFO - [cached since 451.1s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:37:12,664 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:12,669 - sqlalchemy.engine.Engine - INFO - [cached since 451.1s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:37:12,675 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:12,685 - sqlalchemy.engine.Engine - INFO - [cached since 451.2s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:37:12,690 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:12,700 - sqlalchemy.engine.Engine - INFO - [cached since 451.2s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:37:12,705 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:12,714 - sqlalchemy.engine.Engine - INFO - [cached since 451.2s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:37:12,720 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:12,732 - sqlalchemy.engine.Engine - INFO - [cached since 451.2s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:37:12,737 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:12,751 - sqlalchemy.engine.Engine - INFO - [cached since 451.2s ago] {'id_1': 13, 'param_1': 1}
2025-12-29 11:37:12,758 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:12,771 - sqlalchemy.engine.Engine - INFO - [cached since 451.2s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:37:12,778 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:12,789 - sqlalchemy.engine.Engine - INFO - [cached since 451.3s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:37:12,803 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:12,815 - sqlalchemy.engine.Engine - INFO - [cached since 451.3s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:37:12,819 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:12,829 - sqlalchemy.engine.Engine - INFO - [cached since 451.3s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:37:12,834 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:12,842 - sqlalchemy.engine.Engine - INFO - [cached since 451.3s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:37:12,849 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:12,859 - sqlalchemy.engine.Engine - INFO - [cached since 451.3s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:37:12,870 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:37:12,880 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:37:12,884 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:12,896 - sqlalchemy.engine.Engine - INFO - [cached since 451.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:37:12,902 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:37:12,916 - sqlalchemy.engine.Engine - INFO - [cached since 450.9s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 28, 6, 7, 12, 901776), 'param_1': 100}
2025-12-29 11:37:12,922 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:12,932 - sqlalchemy.engine.Engine - INFO - [cached since 451.4s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:37:12,937 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:12,953 - sqlalchemy.engine.Engine - INFO - [cached since 451.4s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:37:12,958 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:12,966 - sqlalchemy.engine.Engine - INFO - [cached since 451.4s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:37:12,972 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:12,983 - sqlalchemy.engine.Engine - INFO - [cached since 451.5s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:37:12,989 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:13,001 - sqlalchemy.engine.Engine - INFO - [cached since 451.5s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:37:13,008 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:13,019 - sqlalchemy.engine.Engine - INFO - [cached since 451.5s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:37:13,025 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:13,035 - sqlalchemy.engine.Engine - INFO - [cached since 451.5s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:37:13,041 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:13,051 - sqlalchemy.engine.Engine - INFO - [cached since 451.5s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:37:13,056 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:13,066 - sqlalchemy.engine.Engine - INFO - [cached since 451.5s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:37:13,073 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:13,085 - sqlalchemy.engine.Engine - INFO - [cached since 451.6s ago] {'id_1': 13, 'param_1': 1}
2025-12-29 11:37:13,092 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:13,102 - sqlalchemy.engine.Engine - INFO - [cached since 451.6s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:37:13,108 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:13,120 - sqlalchemy.engine.Engine - INFO - [cached since 451.6s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:37:13,126 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:13,141 - sqlalchemy.engine.Engine - INFO - [cached since 451.6s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:37:13,148 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:13,156 - sqlalchemy.engine.Engine - INFO - [cached since 451.6s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:37:13,163 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:13,171 - sqlalchemy.engine.Engine - INFO - [cached since 451.6s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:37:13,176 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:13,188 - sqlalchemy.engine.Engine - INFO - [cached since 451.7s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:37:13,198 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:37:16,514 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:37:16,521 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:16,533 - sqlalchemy.engine.Engine - INFO - [cached since 455.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:37:16,539 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:37:16,551 - sqlalchemy.engine.Engine - INFO - [cached since 455.4s ago] {}
2025-12-29 11:37:16,554 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:37:16,566 - sqlalchemy.engine.Engine - INFO - [cached since 366.9s ago] {'param_1': 0, 'param_2': 20}
2025-12-29 11:37:16,573 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:37:16,596 - sqlalchemy.engine.Engine - INFO - [cached since 420.2s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:37:16,601 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:37:16,616 - sqlalchemy.engine.Engine - INFO - [cached since 420.2s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:37:16,622 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:37:16,633 - sqlalchemy.engine.Engine - INFO - [cached since 420.2s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:37:16,640 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:37:16,657 - sqlalchemy.engine.Engine - INFO - [cached since 420.3s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:37:16,664 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:37:16,678 - sqlalchemy.engine.Engine - INFO - [cached since 420.3s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:37:16,684 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:37:16,696 - sqlalchemy.engine.Engine - INFO - [cached since 420.3s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:37:16,702 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:37:16,711 - sqlalchemy.engine.Engine - INFO - [cached since 420.3s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:37:16,716 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:37:16,731 - sqlalchemy.engine.Engine - INFO - [cached since 420.3s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-29 11:37:16,739 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:37:24,838 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:37:24,854 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:24,891 - sqlalchemy.engine.Engine - INFO - [cached since 463.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:37:24,907 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:24,926 - sqlalchemy.engine.Engine - INFO - [cached since 463.4s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:37:24,933 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:37:24,945 - sqlalchemy.engine.Engine - INFO - [cached since 387.8s ago] {'device_id_1': 14}
2025-12-29 11:37:24,950 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:37:24,961 - sqlalchemy.engine.Engine - INFO - [cached since 387.8s ago] {'device_id_1': 14}
2025-12-29 11:37:25,029 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:37:27,795 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:37:27,798 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:27,813 - sqlalchemy.engine.Engine - INFO - [cached since 466.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:37:27,822 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:37:27,849 - sqlalchemy.engine.Engine - INFO - [cached since 466.5s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:37:27,860 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:37:27,887 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:37:27,890 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:27,900 - sqlalchemy.engine.Engine - INFO - [cached since 466.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:37:27,908 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:37:34,562 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:37:34,582 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:34,594 - sqlalchemy.engine.Engine - INFO - [cached since 473.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:37:34,600 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-29 11:37:34,608 - sqlalchemy.engine.Engine - INFO - [cached since 467.9s ago] {'started_at': datetime.datetime(2025, 12, 29, 6, 7, 34, 599984), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'full', 'network_range': '10.41.243.0/24', 'status': 'running', 'error_message': None}
2025-12-29 11:37:34,616 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:37:34,625 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:37:34,628 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-29 11:37:34,635 - sqlalchemy.engine.Engine - INFO - [cached since 467.7s ago] {'pk_1': 32}
2025-12-29 11:37:34,642 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-29 11:37:34,649 - sqlalchemy.engine.Engine - INFO - [cached since 467.7s ago] {'pk_1': 1}
2025-12-29 11:37:34,653 - app.routers.scans - INFO - Scan started by admin: 32
2025-12-29 11:37:34,658 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:37:34,668 - sqlalchemy.engine.Engine - INFO - [cached since 467.7s ago] {'id_1': 32, 'param_1': 1}
2025-12-29 11:37:34,674 - app.services.scanner - INFO - Starting ARP scan on 10.41.243.0/24
2025-12-29 11:37:34,676 - app.services.scanner - INFO - Starting fallback scan on 10.41.243.0/24 (ping + ARP table)
2025-12-29 11:38:06,035 - app.services.scanner - INFO - Fallback scan complete: 8 devices found
2025-12-29 11:38:06,038 - app.services.scanner - INFO - Starting ICMP scan on 254 hosts
2025-12-29 11:38:10,200 - app.services.scanner - INFO - ICMP scan complete: 0 hosts responding
2025-12-29 11:38:10,202 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:10,212 - sqlalchemy.engine.Engine - INFO - [cached since 473.8s ago] {'mac_address_1': '96:A4:CB:4D:96:A9', 'param_1': 1}
2025-12-29 11:38:10,221 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:38:10,234 - sqlalchemy.engine.Engine - INFO - [cached since 473.8s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:38:10,240 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:10,251 - sqlalchemy.engine.Engine - INFO - [cached since 473.9s ago] {'mac_address_1': 'FF:FF:FF:FF:FF:FF', 'param_1': 1}
2025-12-29 11:38:10,257 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:38:10,272 - sqlalchemy.engine.Engine - INFO - [cached since 473.9s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:38:10,279 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:10,291 - sqlalchemy.engine.Engine - INFO - [cached since 473.9s ago] {'mac_address_1': '01:00:5E:00:00:16', 'param_1': 1}
2025-12-29 11:38:10,299 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:38:10,310 - sqlalchemy.engine.Engine - INFO - [cached since 473.9s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:38:10,318 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:10,327 - sqlalchemy.engine.Engine - INFO - [cached since 473.9s ago] {'mac_address_1': '01:00:5E:00:00:FB', 'param_1': 1}
2025-12-29 11:38:10,336 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:38:10,345 - sqlalchemy.engine.Engine - INFO - [cached since 473.9s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:38:10,354 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:10,362 - sqlalchemy.engine.Engine - INFO - [cached since 474s ago] {'mac_address_1': '01:00:5E:00:00:FC', 'param_1': 1}
2025-12-29 11:38:10,372 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:38:10,386 - sqlalchemy.engine.Engine - INFO - [cached since 474s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:38:10,393 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:10,406 - sqlalchemy.engine.Engine - INFO - [cached since 474s ago] {'mac_address_1': '01:00:5E:7F:66:12', 'param_1': 1}
2025-12-29 11:38:10,413 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:38:10,426 - sqlalchemy.engine.Engine - INFO - [cached since 474s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:38:10,435 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:10,443 - sqlalchemy.engine.Engine - INFO - [cached since 474.1s ago] {'mac_address_1': '01:00:5E:7F:FF:FA', 'param_1': 1}
2025-12-29 11:38:10,451 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:38:10,460 - sqlalchemy.engine.Engine - INFO - [cached since 474.1s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:38:10,469 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:10,478 - sqlalchemy.engine.Engine - INFO - [cached since 474.1s ago] {'mac_address_1': 'FF:FF:FF:FF:FF:FF', 'param_1': 1}
2025-12-29 11:38:10,486 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:38:10,495 - sqlalchemy.engine.Engine - INFO - [cached since 474.1s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:38:10,507 - sqlalchemy.engine.Engine - INFO - UPDATE devices SET last_seen=%(last_seen)s WHERE devices.id = %(devices_id)s
2025-12-29 11:38:10,509 - sqlalchemy.engine.Engine - INFO - [cached since 473.8s ago] [{'last_seen': datetime.datetime(2025, 12, 29, 6, 8, 10, 238965), 'devices_id': 8}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 8, 10, 504016), 'devices_id': 9}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 8, 10, 317380), 'devices_id': 10}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 8, 10, 352603), 'devices_id': 11}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 8, 10, 391513), 'devices_id': 12}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 8, 10, 434603), 'devices_id': 13}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 8, 10, 468103), 'devices_id': 14}]
2025-12-29 11:38:10,537 - sqlalchemy.engine.Engine - INFO - UPDATE scan_sessions SET completed_at=%(completed_at)s, total_devices_found=%(total_devices_found)s, status=%(status)s WHERE scan_sessions.id = %(scan_sessions_id)s
2025-12-29 11:38:10,540 - sqlalchemy.engine.Engine - INFO - [cached since 473.8s ago] {'completed_at': datetime.datetime(2025, 12, 29, 6, 8, 10, 504699), 'total_devices_found': 8, 'status': 'completed', 'scan_sessions_id': 32}
2025-12-29 11:38:10,547 - sqlalchemy.engine.Engine - INFO - INSERT INTO device_activity (device_id, event_type, old_value, new_value, event_timestamp) VALUES (%(device_id)s, %(event_type)s, %(old_value)s, %(new_value)s, %(event_timestamp)s)
2025-12-29 11:38:10,553 - sqlalchemy.engine.Engine - INFO - [cached since 473.8s ago] {'device_id': 9, 'event_type': 'ip_changed', 'old_value': '255.255.255.255', 'new_value': '10.41.243.255', 'event_timestamp': datetime.datetime(2025, 12, 29, 6, 8, 10, 547080)}
2025-12-29 11:38:10,559 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:38:10,568 - sqlalchemy.engine.Engine - INFO - [cached since 473.9s ago] {'device_id': 8, 'ip_address': '10.41.243.123', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 8, 10, 559652), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:38:10,573 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:38:10,578 - sqlalchemy.engine.Engine - INFO - [cached since 473.9s ago] {'device_id': 9, 'ip_address': '10.41.243.255', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 8, 10, 573649), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:38:10,588 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:38:10,592 - sqlalchemy.engine.Engine - INFO - [cached since 473.9s ago] {'device_id': 10, 'ip_address': '224.0.0.22', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 8, 10, 587927), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:38:10,599 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:38:10,604 - sqlalchemy.engine.Engine - INFO - [cached since 473.9s ago] {'device_id': 11, 'ip_address': '224.0.0.251', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 8, 10, 599680), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:38:10,609 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:38:10,616 - sqlalchemy.engine.Engine - INFO - [cached since 473.9s ago] {'device_id': 12, 'ip_address': '224.0.0.252', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 8, 10, 609507), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:38:10,621 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:38:10,625 - sqlalchemy.engine.Engine - INFO - [cached since 473.9s ago] {'device_id': 13, 'ip_address': '239.255.102.18', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 8, 10, 621867), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:38:10,635 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:38:10,640 - sqlalchemy.engine.Engine - INFO - [cached since 473.9s ago] {'device_id': 14, 'ip_address': '239.255.255.250', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 8, 10, 635055), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:38:10,647 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:38:10,653 - sqlalchemy.engine.Engine - INFO - [cached since 473.9s ago] {'device_id': 9, 'ip_address': '255.255.255.255', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 8, 10, 646840), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:38:10,659 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:38:10,667 - app.routers.scans - INFO - Scan completed: 8 devices, 0 new
2025-12-29 11:38:11,084 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:38:11,087 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:11,095 - sqlalchemy.engine.Engine - INFO - [cached since 510.1s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:38:11,102 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:38:11,113 - sqlalchemy.engine.Engine - INFO - [cached since 510s ago] {}
2025-12-29 11:38:11,121 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:38:11,137 - sqlalchemy.engine.Engine - INFO - [cached since 510s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 5, 58, 11, 119689)}
2025-12-29 11:38:11,142 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:38:11,151 - sqlalchemy.engine.Engine - INFO - [cached since 509.9s ago] {}
2025-12-29 11:38:11,155 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:38:11,167 - sqlalchemy.engine.Engine - INFO - [cached since 509.9s ago] {}
2025-12-29 11:38:11,172 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:38:11,242 - sqlalchemy.engine.Engine - INFO - [cached since 510s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:38:11,361 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:38:11,384 - sqlalchemy.engine.Engine - INFO - [cached since 510.1s ago] {}
2025-12-29 11:38:11,392 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:38:11,428 - sqlalchemy.engine.Engine - INFO - [cached since 510.1s ago] {}
2025-12-29 11:38:11,435 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:38:11,452 - sqlalchemy.engine.Engine - INFO - [cached since 510.1s ago] {'status_1': 'completed'}
2025-12-29 11:38:11,458 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:38:11,473 - sqlalchemy.engine.Engine - INFO - [cached since 510.1s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:38:11,481 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:38:11,486 - sqlalchemy.engine.Engine - INFO - [cached since 510.1s ago] {}
2025-12-29 11:38:11,493 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:38:11,502 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:38:11,504 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:11,507 - sqlalchemy.engine.Engine - INFO - [cached since 510.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:38:11,514 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:38:11,525 - sqlalchemy.engine.Engine - INFO - [cached since 510.4s ago] {}
2025-12-29 11:38:11,528 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:38:11,537 - sqlalchemy.engine.Engine - INFO - [cached since 510.4s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 5, 58, 11, 528256)}
2025-12-29 11:38:11,542 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:38:11,550 - sqlalchemy.engine.Engine - INFO - [cached since 510.3s ago] {}
2025-12-29 11:38:11,564 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:38:11,570 - sqlalchemy.engine.Engine - INFO - [cached since 510.3s ago] {}
2025-12-29 11:38:11,574 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:38:11,579 - sqlalchemy.engine.Engine - INFO - [cached since 510.3s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:38:11,585 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:38:11,591 - sqlalchemy.engine.Engine - INFO - [cached since 510.3s ago] {}
2025-12-29 11:38:11,595 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:38:11,604 - sqlalchemy.engine.Engine - INFO - [cached since 510.3s ago] {}
2025-12-29 11:38:11,607 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:38:11,619 - sqlalchemy.engine.Engine - INFO - [cached since 510.3s ago] {'status_1': 'completed'}
2025-12-29 11:38:11,623 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:38:11,636 - sqlalchemy.engine.Engine - INFO - [cached since 510.3s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:38:11,642 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:38:11,645 - sqlalchemy.engine.Engine - INFO - [cached since 510.2s ago] {}
2025-12-29 11:38:11,655 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:38:11,665 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:38:11,668 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:11,673 - sqlalchemy.engine.Engine - INFO - [cached since 510.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:38:11,678 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:11,687 - sqlalchemy.engine.Engine - INFO - [cached since 510.2s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:38:11,691 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:38:11,702 - sqlalchemy.engine.Engine - INFO - [cached since 510.1s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 22, 6, 8, 11, 690341), 'param_1': 100}
2025-12-29 11:38:11,706 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s AND scan_results.scan_timestamp >= %(scan_timestamp_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:38:11,715 - sqlalchemy.engine.Engine - INFO - [cached since 510.1s ago] {'device_id_1': 7, 'scan_timestamp_1': datetime.datetime(2025, 12, 22, 6, 8, 11, 690341), 'param_1': 100}
2025-12-29 11:38:11,725 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:38:11,738 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:38:11,741 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:11,750 - sqlalchemy.engine.Engine - INFO - [cached since 510.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:38:11,757 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:11,767 - sqlalchemy.engine.Engine - INFO - [cached since 510.2s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:38:11,774 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:38:11,788 - sqlalchemy.engine.Engine - INFO - [cached since 510.2s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 22, 6, 8, 11, 773094), 'param_1': 100}
2025-12-29 11:38:11,795 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s AND scan_results.scan_timestamp >= %(scan_timestamp_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:38:11,810 - sqlalchemy.engine.Engine - INFO - [cached since 510.2s ago] {'device_id_1': 7, 'scan_timestamp_1': datetime.datetime(2025, 12, 22, 6, 8, 11, 773094), 'param_1': 100}
2025-12-29 11:38:11,821 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:38:11,823 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:38:11,827 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:11,833 - sqlalchemy.engine.Engine - INFO - [cached since 510.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:38:11,838 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:38:11,854 - sqlalchemy.engine.Engine - INFO - [cached since 510.7s ago] {}
2025-12-29 11:38:11,858 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:38:11,864 - sqlalchemy.engine.Engine - INFO - [cached since 510.7s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 5, 58, 11, 857029)}
2025-12-29 11:38:11,869 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:38:11,879 - sqlalchemy.engine.Engine - INFO - [cached since 510.7s ago] {}
2025-12-29 11:38:11,884 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:38:11,891 - sqlalchemy.engine.Engine - INFO - [cached since 510.7s ago] {}
2025-12-29 11:38:11,894 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:38:11,902 - sqlalchemy.engine.Engine - INFO - [cached since 510.6s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:38:11,906 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:38:11,911 - sqlalchemy.engine.Engine - INFO - [cached since 510.6s ago] {}
2025-12-29 11:38:11,917 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:38:11,925 - sqlalchemy.engine.Engine - INFO - [cached since 510.6s ago] {}
2025-12-29 11:38:11,930 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:38:11,940 - sqlalchemy.engine.Engine - INFO - [cached since 510.6s ago] {'status_1': 'completed'}
2025-12-29 11:38:11,945 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:38:11,954 - sqlalchemy.engine.Engine - INFO - [cached since 510.6s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:38:11,959 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:38:11,962 - sqlalchemy.engine.Engine - INFO - [cached since 510.6s ago] {}
2025-12-29 11:38:11,969 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:38:11,984 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:38:11,987 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:11,992 - sqlalchemy.engine.Engine - INFO - [cached since 511s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:38:11,996 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:38:12,006 - sqlalchemy.engine.Engine - INFO - [cached since 510.9s ago] {}
2025-12-29 11:38:12,011 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:38:12,023 - sqlalchemy.engine.Engine - INFO - [cached since 510.9s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 5, 58, 12, 9892)}
2025-12-29 11:38:12,027 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:38:12,038 - sqlalchemy.engine.Engine - INFO - [cached since 510.8s ago] {}
2025-12-29 11:38:12,043 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:38:12,052 - sqlalchemy.engine.Engine - INFO - [cached since 510.8s ago] {}
2025-12-29 11:38:12,057 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:38:12,070 - sqlalchemy.engine.Engine - INFO - [cached since 510.8s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:38:12,082 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:38:12,118 - sqlalchemy.engine.Engine - INFO - [cached since 510.8s ago] {}
2025-12-29 11:38:12,124 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:38:12,141 - sqlalchemy.engine.Engine - INFO - [cached since 510.8s ago] {}
2025-12-29 11:38:12,150 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:38:12,165 - sqlalchemy.engine.Engine - INFO - [cached since 510.8s ago] {'status_1': 'completed'}
2025-12-29 11:38:12,171 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:38:12,188 - sqlalchemy.engine.Engine - INFO - [cached since 510.8s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:38:12,194 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:38:12,201 - sqlalchemy.engine.Engine - INFO - [cached since 510.8s ago] {}
2025-12-29 11:38:12,209 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:38:12,218 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:38:12,221 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:12,228 - sqlalchemy.engine.Engine - INFO - [cached since 511.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:38:12,236 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:38:12,249 - sqlalchemy.engine.Engine - INFO - [cached since 510.3s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 28, 6, 8, 12, 235358), 'param_1': 100}
2025-12-29 11:38:12,255 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:12,266 - sqlalchemy.engine.Engine - INFO - [cached since 510.7s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:38:12,271 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:12,279 - sqlalchemy.engine.Engine - INFO - [cached since 510.7s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:38:12,286 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:12,294 - sqlalchemy.engine.Engine - INFO - [cached since 510.8s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:38:12,300 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:12,306 - sqlalchemy.engine.Engine - INFO - [cached since 510.8s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:38:12,311 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:12,318 - sqlalchemy.engine.Engine - INFO - [cached since 510.8s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:38:12,322 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:12,327 - sqlalchemy.engine.Engine - INFO - [cached since 510.8s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:38:12,333 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:12,342 - sqlalchemy.engine.Engine - INFO - [cached since 510.8s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:38:12,347 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:12,354 - sqlalchemy.engine.Engine - INFO - [cached since 510.8s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:38:12,359 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:12,369 - sqlalchemy.engine.Engine - INFO - [cached since 510.8s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:38:12,373 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:12,384 - sqlalchemy.engine.Engine - INFO - [cached since 510.9s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:38:12,389 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:12,400 - sqlalchemy.engine.Engine - INFO - [cached since 510.9s ago] {'id_1': 13, 'param_1': 1}
2025-12-29 11:38:12,405 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:12,412 - sqlalchemy.engine.Engine - INFO - [cached since 510.9s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:38:12,419 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:12,435 - sqlalchemy.engine.Engine - INFO - [cached since 510.9s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:38:12,442 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:12,453 - sqlalchemy.engine.Engine - INFO - [cached since 510.9s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:38:12,459 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:12,471 - sqlalchemy.engine.Engine - INFO - [cached since 510.9s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:38:12,477 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:12,489 - sqlalchemy.engine.Engine - INFO - [cached since 511s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:38:12,493 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:12,502 - sqlalchemy.engine.Engine - INFO - [cached since 511s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:38:12,511 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:38:12,522 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:38:12,525 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:12,660 - sqlalchemy.engine.Engine - INFO - [cached since 511.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:38:12,828 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:38:12,849 - sqlalchemy.engine.Engine - INFO - [cached since 510.9s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 28, 6, 8, 12, 827558), 'param_1': 100}
2025-12-29 11:38:12,857 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:12,870 - sqlalchemy.engine.Engine - INFO - [cached since 511.3s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:38:12,878 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:12,903 - sqlalchemy.engine.Engine - INFO - [cached since 511.4s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:38:12,944 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:12,955 - sqlalchemy.engine.Engine - INFO - [cached since 511.4s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:38:12,960 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:12,976 - sqlalchemy.engine.Engine - INFO - [cached since 511.4s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:38:12,982 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:12,992 - sqlalchemy.engine.Engine - INFO - [cached since 511.5s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:38:13,003 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:13,017 - sqlalchemy.engine.Engine - INFO - [cached since 511.5s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:38:13,022 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:13,028 - sqlalchemy.engine.Engine - INFO - [cached since 511.5s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:38:13,034 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:13,041 - sqlalchemy.engine.Engine - INFO - [cached since 511.5s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:38:13,048 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:13,058 - sqlalchemy.engine.Engine - INFO - [cached since 511.5s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:38:13,067 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:13,078 - sqlalchemy.engine.Engine - INFO - [cached since 511.5s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:38:13,085 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:13,099 - sqlalchemy.engine.Engine - INFO - [cached since 511.6s ago] {'id_1': 13, 'param_1': 1}
2025-12-29 11:38:13,104 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:13,112 - sqlalchemy.engine.Engine - INFO - [cached since 511.6s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:38:13,117 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:13,125 - sqlalchemy.engine.Engine - INFO - [cached since 511.6s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:38:13,130 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:13,138 - sqlalchemy.engine.Engine - INFO - [cached since 511.6s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:38:13,142 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:13,151 - sqlalchemy.engine.Engine - INFO - [cached since 511.6s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:38:13,156 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:13,166 - sqlalchemy.engine.Engine - INFO - [cached since 511.6s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:38:13,172 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:13,187 - sqlalchemy.engine.Engine - INFO - [cached since 511.7s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:38:13,198 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:38:20,337 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:38:20,354 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:20,377 - sqlalchemy.engine.Engine - INFO - [cached since 519.4s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:38:20,389 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:38:25,282 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:38:25,299 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:25,331 - sqlalchemy.engine.Engine - INFO - [cached since 524.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:38:25,339 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices
2025-12-29 11:38:25,351 - sqlalchemy.engine.Engine - INFO - [cached since 448.3s ago] {}
2025-12-29 11:38:25,356 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:38:25,369 - sqlalchemy.engine.Engine - INFO - [cached since 448.3s ago] {'device_id_1': 7}
2025-12-29 11:38:25,374 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:38:25,384 - sqlalchemy.engine.Engine - INFO - [cached since 448.3s ago] {'device_id_1': 7}
2025-12-29 11:38:25,388 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:38:25,398 - sqlalchemy.engine.Engine - INFO - [cached since 448.3s ago] {'device_id_1': 8}
2025-12-29 11:38:25,403 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:38:25,412 - sqlalchemy.engine.Engine - INFO - [cached since 448.3s ago] {'device_id_1': 8}
2025-12-29 11:38:25,416 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:38:25,426 - sqlalchemy.engine.Engine - INFO - [cached since 448.3s ago] {'device_id_1': 9}
2025-12-29 11:38:25,434 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:38:25,442 - sqlalchemy.engine.Engine - INFO - [cached since 448.3s ago] {'device_id_1': 9}
2025-12-29 11:38:25,449 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:38:25,457 - sqlalchemy.engine.Engine - INFO - [cached since 448.4s ago] {'device_id_1': 10}
2025-12-29 11:38:25,463 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:38:25,472 - sqlalchemy.engine.Engine - INFO - [cached since 448.4s ago] {'device_id_1': 10}
2025-12-29 11:38:25,478 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:38:25,486 - sqlalchemy.engine.Engine - INFO - [cached since 448.4s ago] {'device_id_1': 11}
2025-12-29 11:38:25,491 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:38:25,500 - sqlalchemy.engine.Engine - INFO - [cached since 448.4s ago] {'device_id_1': 11}
2025-12-29 11:38:25,504 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:38:25,514 - sqlalchemy.engine.Engine - INFO - [cached since 448.4s ago] {'device_id_1': 12}
2025-12-29 11:38:25,519 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:38:25,529 - sqlalchemy.engine.Engine - INFO - [cached since 448.4s ago] {'device_id_1': 12}
2025-12-29 11:38:25,535 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:38:25,541 - sqlalchemy.engine.Engine - INFO - [cached since 448.4s ago] {'device_id_1': 13}
2025-12-29 11:38:25,549 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:38:25,557 - sqlalchemy.engine.Engine - INFO - [cached since 448.4s ago] {'device_id_1': 13}
2025-12-29 11:38:25,567 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:38:25,583 - sqlalchemy.engine.Engine - INFO - [cached since 448.5s ago] {'device_id_1': 14}
2025-12-29 11:38:25,588 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:38:25,602 - sqlalchemy.engine.Engine - INFO - [cached since 448.5s ago] {'device_id_1': 14}
2025-12-29 11:38:25,607 - app.ml.detector - INFO - Training anomaly detector with 8 devices
2025-12-29 11:38:25,621 - app.ml.isolation_forest - INFO - Training Isolation Forest with 8 samples
2025-12-29 11:38:26,198 - app.ml.isolation_forest - INFO - Model saved to E:\wifi-tracker\backend\data\models\isolation_forest.pkl
2025-12-29 11:38:26,253 - app.ml.isolation_forest - INFO - Training complete: {'model_type': 'isolation_forest', 'samples_trained': 8, 'contamination': 0.1, 'n_estimators': 100, 'anomalies_in_training': 1, 'score_mean': 0.21933113216565592, 'score_std': 0.139544568509368, 'trained_at': '2025-12-29T06:08:26.253068'}
2025-12-29 11:38:26,257 - app.ml.autoencoder - INFO - Training Autoencoder with 8 samples
2025-12-29 11:38:26,455 - app.ml.autoencoder - INFO - Epoch 20/100, Loss: 0.399956
2025-12-29 11:38:26,651 - app.ml.autoencoder - INFO - Epoch 40/100, Loss: 0.384309
2025-12-29 11:38:26,823 - app.ml.autoencoder - INFO - Epoch 60/100, Loss: 0.359890
2025-12-29 11:38:27,020 - app.ml.autoencoder - INFO - Epoch 80/100, Loss: 0.229921
2025-12-29 11:38:27,213 - app.ml.autoencoder - INFO - Epoch 100/100, Loss: 0.232970
2025-12-29 11:38:27,222 - app.ml.autoencoder - INFO - Autoencoder saved to E:\wifi-tracker\backend\data\models\autoencoder.pth
2025-12-29 11:38:27,224 - app.ml.autoencoder - INFO - Training complete: {'model_type': 'autoencoder', 'samples_trained': 8, 'input_dim': 15, 'encoding_dim': 8, 'epochs': 100, 'final_loss': 0.23297029733657837, 'threshold': 0.7502081394195557, 'threshold_percentile': 95, 'trained_at': '2025-12-29T06:08:27.224764'}
2025-12-29 11:38:27,230 - app.routers.dashboard - INFO - ML training initiated by admin: {'status': 'success', 'models': {'isolation_forest': {'model_type': 'isolation_forest', 'samples_trained': 8, 'contamination': 0.1, 'n_estimators': 100, 'anomalies_in_training': 1, 'score_mean': 0.21933113216565592, 'score_std': 0.139544568509368, 'trained_at': '2025-12-29T06:08:26.253068'}, 'autoencoder': {'model_type': 'autoencoder', 'samples_trained': 8, 'input_dim': 15, 'encoding_dim': 8, 'epochs': 100, 'final_loss': 0.23297029733657837, 'threshold': 0.7502081394195557, 'threshold_percentile': 95, 'trained_at': '2025-12-29T06:08:27.224764'}}, 'trained_at': '2025-12-29T06:08:27.230231', 'total_samples': 8}
2025-12-29 11:38:27,240 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:38:27,261 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:38:27,267 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:27,274 - sqlalchemy.engine.Engine - INFO - [cached since 526.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:38:27,286 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:38:32,753 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:38:32,786 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:32,803 - sqlalchemy.engine.Engine - INFO - [cached since 531.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:38:32,813 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:38:32,822 - sqlalchemy.engine.Engine - INFO - [cached since 531.5s ago] {}
2025-12-29 11:38:32,830 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:38:32,839 - sqlalchemy.engine.Engine - INFO - [cached since 531.5s ago] {}
2025-12-29 11:38:32,849 - sqlalchemy.engine.Engine - INFO - SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts ORDER BY alerts.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:38:32,863 - sqlalchemy.engine.Engine - INFO - [generated in 0.01422s] {'param_1': 0, 'param_2': 20}
2025-12-29 11:38:32,878 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:38:32,894 - sqlalchemy.engine.Engine - INFO - [generated in 0.01658s] {'pk_1': 13}
2025-12-29 11:38:32,901 - app.database - ERROR - Database session error: 'str' object has no attribute 'value'
2025-12-29 11:38:32,904 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:38:32,909 - app.main - ERROR - Unhandled exception: 'str' object has no attribute 'value'
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\alerts.py", line 84, in list_alerts
    alert_type=alert.alert_type.value,
               ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'value'
2025-12-29 11:38:33,475 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:38:33,484 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:33,501 - sqlalchemy.engine.Engine - INFO - [cached since 532.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:38:33,505 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:38:33,519 - sqlalchemy.engine.Engine - INFO - [cached since 532.1s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:38:33,530 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:38:33,546 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:38:33,548 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:33,555 - sqlalchemy.engine.Engine - INFO - [cached since 532.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:38:33,577 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:38:37,481 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:38:37,494 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:37,535 - sqlalchemy.engine.Engine - INFO - [cached since 536.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:38:37,546 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:38:37,561 - sqlalchemy.engine.Engine - INFO - [cached since 536.4s ago] {}
2025-12-29 11:38:37,565 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:38:37,579 - sqlalchemy.engine.Engine - INFO - [cached since 447.9s ago] {'param_1': 0, 'param_2': 20}
2025-12-29 11:38:37,585 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:38:37,599 - sqlalchemy.engine.Engine - INFO - [cached since 501.2s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:38:37,607 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:38:37,619 - sqlalchemy.engine.Engine - INFO - [cached since 501.2s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:38:37,626 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:38:37,637 - sqlalchemy.engine.Engine - INFO - [cached since 501.2s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:38:37,646 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:38:37,654 - sqlalchemy.engine.Engine - INFO - [cached since 501.3s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:38:37,663 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:38:37,677 - sqlalchemy.engine.Engine - INFO - [cached since 501.3s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:38:37,682 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:38:37,693 - sqlalchemy.engine.Engine - INFO - [cached since 501.3s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:38:37,698 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:38:37,713 - sqlalchemy.engine.Engine - INFO - [cached since 501.3s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:38:37,719 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:38:37,740 - sqlalchemy.engine.Engine - INFO - [cached since 501.3s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-29 11:38:37,751 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:38:41,245 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:38:41,267 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:41,305 - sqlalchemy.engine.Engine - INFO - [cached since 540.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:38:41,342 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:41,358 - sqlalchemy.engine.Engine - INFO - [cached since 539.8s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:38:41,365 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:38:41,376 - sqlalchemy.engine.Engine - INFO - [cached since 464.3s ago] {'device_id_1': 14}
2025-12-29 11:38:41,382 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:38:41,394 - sqlalchemy.engine.Engine - INFO - [cached since 464.3s ago] {'device_id_1': 14}
2025-12-29 11:38:41,476 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:38:46,309 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:38:46,312 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:46,328 - sqlalchemy.engine.Engine - INFO - [cached since 545.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:38:46,337 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:46,352 - sqlalchemy.engine.Engine - INFO - [cached since 544.8s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:38:46,361 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:38:46,373 - sqlalchemy.engine.Engine - INFO - [cached since 469.3s ago] {'device_id_1': 7}
2025-12-29 11:38:46,379 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:38:46,401 - sqlalchemy.engine.Engine - INFO - [cached since 469.3s ago] {'device_id_1': 7}
2025-12-29 11:38:46,516 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:38:52,137 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:38:52,149 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:52,177 - sqlalchemy.engine.Engine - INFO - [cached since 551.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:38:52,207 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:52,217 - sqlalchemy.engine.Engine - INFO - [cached since 550.7s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:38:52,225 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:38:52,235 - sqlalchemy.engine.Engine - INFO - [cached since 475.1s ago] {'device_id_1': 14}
2025-12-29 11:38:52,243 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:38:52,250 - sqlalchemy.engine.Engine - INFO - [cached since 475.1s ago] {'device_id_1': 14}
2025-12-29 11:38:52,335 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:38:54,357 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:38:54,385 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:54,405 - sqlalchemy.engine.Engine - INFO - [cached since 553.4s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:38:54,412 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:54,423 - sqlalchemy.engine.Engine - INFO - [cached since 552.9s ago] {'id_1': 13, 'param_1': 1}
2025-12-29 11:38:54,429 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:38:54,439 - sqlalchemy.engine.Engine - INFO - [cached since 477.3s ago] {'device_id_1': 13}
2025-12-29 11:38:54,445 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:38:54,456 - sqlalchemy.engine.Engine - INFO - [cached since 477.3s ago] {'device_id_1': 13}
2025-12-29 11:38:54,531 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:38:56,481 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:38:56,490 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:56,514 - sqlalchemy.engine.Engine - INFO - [cached since 555.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:38:56,530 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:56,566 - sqlalchemy.engine.Engine - INFO - [cached since 555s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:38:56,580 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:38:56,606 - sqlalchemy.engine.Engine - INFO - [cached since 479.5s ago] {'device_id_1': 12}
2025-12-29 11:38:56,616 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:38:56,631 - sqlalchemy.engine.Engine - INFO - [cached since 479.5s ago] {'device_id_1': 12}
2025-12-29 11:38:56,696 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:38:59,210 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:38:59,226 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:59,244 - sqlalchemy.engine.Engine - INFO - [cached since 558.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:38:59,251 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:38:59,264 - sqlalchemy.engine.Engine - INFO - [cached since 557.7s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:38:59,272 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:38:59,280 - sqlalchemy.engine.Engine - INFO - [cached since 482.2s ago] {'device_id_1': 11}
2025-12-29 11:38:59,287 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:38:59,297 - sqlalchemy.engine.Engine - INFO - [cached since 482.2s ago] {'device_id_1': 11}
2025-12-29 11:38:59,384 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:39:01,764 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:39:01,780 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:39:01,824 - sqlalchemy.engine.Engine - INFO - [cached since 560.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:39:01,834 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:39:01,849 - sqlalchemy.engine.Engine - INFO - [cached since 560.3s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:39:01,858 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:39:01,866 - sqlalchemy.engine.Engine - INFO - [cached since 484.8s ago] {'device_id_1': 8}
2025-12-29 11:39:01,873 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:39:01,882 - sqlalchemy.engine.Engine - INFO - [cached since 484.8s ago] {'device_id_1': 8}
2025-12-29 11:39:01,963 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:39:03,975 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:39:04,003 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:39:04,044 - sqlalchemy.engine.Engine - INFO - [cached since 563s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:39:04,057 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:39:04,070 - sqlalchemy.engine.Engine - INFO - [cached since 562.5s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:39:04,075 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:39:04,082 - sqlalchemy.engine.Engine - INFO - [cached since 487s ago] {'device_id_1': 9}
2025-12-29 11:39:04,091 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:39:04,104 - sqlalchemy.engine.Engine - INFO - [cached since 487s ago] {'device_id_1': 9}
2025-12-29 11:39:04,179 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:39:30,263 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:39:30,274 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:39:30,308 - sqlalchemy.engine.Engine - INFO - [cached since 589.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:39:30,337 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:39:30,357 - sqlalchemy.engine.Engine - INFO - [cached since 588.8s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:39:30,363 - sqlalchemy.engine.Engine - INFO - UPDATE devices SET last_seen=%(last_seen)s, is_trusted=%(is_trusted)s WHERE devices.id = %(devices_id)s
2025-12-29 11:39:30,366 - sqlalchemy.engine.Engine - INFO - [cached since 466.8s ago] {'last_seen': datetime.datetime(2025, 12, 29, 6, 9, 30, 363385), 'is_trusted': 1, 'devices_id': 7}
2025-12-29 11:39:30,373 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:39:30,379 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:39:30,382 - sqlalchemy.engine.Engine - INFO - SELECT devices.id, devices.mac_address, devices.hostname, devices.vendor, devices.device_type, devices.first_seen, devices.last_seen, devices.is_trusted, devices.is_suspicious, devices.notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:39:30,387 - sqlalchemy.engine.Engine - INFO - [cached since 466.7s ago] {'pk_1': 7}
2025-12-29 11:39:30,392 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-29 11:39:30,401 - sqlalchemy.engine.Engine - INFO - [cached since 583.4s ago] {'pk_1': 1}
2025-12-29 11:39:30,406 - app.routers.devices - INFO - Device 54:AF:97:FE:1A:C5 updated by admin
2025-12-29 11:39:30,410 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:39:30,426 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:39:30,432 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:39:30,442 - sqlalchemy.engine.Engine - INFO - [cached since 589.4s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:39:30,451 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:39:30,459 - sqlalchemy.engine.Engine - INFO - [cached since 589.3s ago] {}
2025-12-29 11:39:30,466 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:39:30,474 - sqlalchemy.engine.Engine - INFO - [cached since 500.8s ago] {'param_1': 0, 'param_2': 20}
2025-12-29 11:39:30,482 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:39:30,490 - sqlalchemy.engine.Engine - INFO - [cached since 554.1s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-29 11:39:30,496 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:39:30,504 - sqlalchemy.engine.Engine - INFO - [cached since 554.1s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:39:30,510 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:39:30,521 - sqlalchemy.engine.Engine - INFO - [cached since 554.1s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:39:30,527 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:39:30,538 - sqlalchemy.engine.Engine - INFO - [cached since 554.1s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:39:30,544 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:39:30,557 - sqlalchemy.engine.Engine - INFO - [cached since 554.2s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:39:30,564 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:39:30,574 - sqlalchemy.engine.Engine - INFO - [cached since 554.2s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:39:30,582 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:39:30,592 - sqlalchemy.engine.Engine - INFO - [cached since 554.2s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:39:30,601 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:39:30,610 - sqlalchemy.engine.Engine - INFO - [cached since 554.2s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:39:30,620 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:39:35,698 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:39:35,702 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:39:35,716 - sqlalchemy.engine.Engine - INFO - [cached since 594.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:39:35,723 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:39:35,741 - sqlalchemy.engine.Engine - INFO - [cached since 594.2s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:39:35,750 - sqlalchemy.engine.Engine - INFO - UPDATE devices SET last_seen=%(last_seen)s, is_trusted=%(is_trusted)s WHERE devices.id = %(devices_id)s
2025-12-29 11:39:35,754 - sqlalchemy.engine.Engine - INFO - [cached since 472.1s ago] {'last_seen': datetime.datetime(2025, 12, 29, 6, 9, 35, 749863), 'is_trusted': 0, 'devices_id': 7}
2025-12-29 11:39:35,767 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:39:35,776 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:39:35,781 - sqlalchemy.engine.Engine - INFO - SELECT devices.id, devices.mac_address, devices.hostname, devices.vendor, devices.device_type, devices.first_seen, devices.last_seen, devices.is_trusted, devices.is_suspicious, devices.notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:39:35,790 - sqlalchemy.engine.Engine - INFO - [cached since 472.1s ago] {'pk_1': 7}
2025-12-29 11:39:35,798 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-29 11:39:35,808 - sqlalchemy.engine.Engine - INFO - [cached since 588.8s ago] {'pk_1': 1}
2025-12-29 11:39:35,815 - app.routers.devices - INFO - Device 54:AF:97:FE:1A:C5 updated by admin
2025-12-29 11:39:35,819 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:39:35,851 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:39:35,855 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:39:35,871 - sqlalchemy.engine.Engine - INFO - [cached since 594.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:39:35,880 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:39:35,891 - sqlalchemy.engine.Engine - INFO - [cached since 594.8s ago] {}
2025-12-29 11:39:35,898 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:39:35,905 - sqlalchemy.engine.Engine - INFO - [cached since 506.2s ago] {'param_1': 0, 'param_2': 20}
2025-12-29 11:39:35,910 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:39:35,918 - sqlalchemy.engine.Engine - INFO - [cached since 559.5s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-29 11:39:35,923 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:39:35,933 - sqlalchemy.engine.Engine - INFO - [cached since 559.5s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:39:35,939 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:39:35,950 - sqlalchemy.engine.Engine - INFO - [cached since 559.5s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:39:35,956 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:39:35,969 - sqlalchemy.engine.Engine - INFO - [cached since 559.6s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:39:35,974 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:39:35,985 - sqlalchemy.engine.Engine - INFO - [cached since 559.6s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:39:35,991 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:39:36,001 - sqlalchemy.engine.Engine - INFO - [cached since 559.6s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:39:36,006 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:39:36,017 - sqlalchemy.engine.Engine - INFO - [cached since 559.6s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:39:36,022 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:39:36,031 - sqlalchemy.engine.Engine - INFO - [cached since 559.6s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:39:36,039 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:41:31,224 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:41:31,235 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:41:31,313 - sqlalchemy.engine.Engine - INFO - [cached since 710.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:41:31,336 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:41:37,854 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:41:37,873 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:41:37,892 - sqlalchemy.engine.Engine - INFO - [cached since 716.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:41:37,900 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:41:37,911 - sqlalchemy.engine.Engine - INFO - [cached since 716.6s ago] {}
2025-12-29 11:41:37,921 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:41:37,929 - sqlalchemy.engine.Engine - INFO - [cached since 716.6s ago] {}
2025-12-29 11:41:37,937 - sqlalchemy.engine.Engine - INFO - SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts ORDER BY alerts.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:41:37,947 - sqlalchemy.engine.Engine - INFO - [cached since 185.1s ago] {'param_1': 0, 'param_2': 20}
2025-12-29 11:41:37,957 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:41:37,969 - sqlalchemy.engine.Engine - INFO - [cached since 185.1s ago] {'pk_1': 13}
2025-12-29 11:41:37,974 - app.database - ERROR - Database session error: 'str' object has no attribute 'value'
2025-12-29 11:41:37,976 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:41:37,979 - app.main - ERROR - Unhandled exception: 'str' object has no attribute 'value'
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\alerts.py", line 84, in list_alerts
    alert_type=alert.alert_type.value,
               ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'value'
2025-12-29 11:41:39,325 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:41:39,339 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:41:39,352 - sqlalchemy.engine.Engine - INFO - [cached since 718.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:41:39,361 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:41:39,386 - sqlalchemy.engine.Engine - INFO - [cached since 718s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:41:39,398 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:41:39,422 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:41:39,426 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:41:39,435 - sqlalchemy.engine.Engine - INFO - [cached since 718.4s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:41:39,444 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:41:40,273 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:41:40,314 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:41:40,336 - sqlalchemy.engine.Engine - INFO - [cached since 719.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:41:40,344 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:41:41,983 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:41:42,011 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:41:42,050 - sqlalchemy.engine.Engine - INFO - [cached since 721s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:41:42,057 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:41:42,072 - sqlalchemy.engine.Engine - INFO - [cached since 721s ago] {}
2025-12-29 11:41:42,077 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:41:42,091 - sqlalchemy.engine.Engine - INFO - [cached since 632.4s ago] {'param_1': 0, 'param_2': 20}
2025-12-29 11:41:42,100 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:41:42,116 - sqlalchemy.engine.Engine - INFO - [cached since 685.7s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-29 11:41:42,123 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:41:42,136 - sqlalchemy.engine.Engine - INFO - [cached since 685.7s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:41:42,144 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:41:42,157 - sqlalchemy.engine.Engine - INFO - [cached since 685.8s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:41:42,164 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:41:42,172 - sqlalchemy.engine.Engine - INFO - [cached since 685.8s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:41:42,178 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:41:42,191 - sqlalchemy.engine.Engine - INFO - [cached since 685.8s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:41:42,199 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:41:42,220 - sqlalchemy.engine.Engine - INFO - [cached since 685.8s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:41:42,227 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:41:42,238 - sqlalchemy.engine.Engine - INFO - [cached since 685.8s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:41:42,243 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:41:42,260 - sqlalchemy.engine.Engine - INFO - [cached since 685.9s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:41:42,267 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:41:43,935 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:41:43,947 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:41:43,987 - sqlalchemy.engine.Engine - INFO - [cached since 723s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:41:44,013 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:41:44,052 - sqlalchemy.engine.Engine - INFO - [cached since 722.5s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:41:44,058 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:41:44,069 - sqlalchemy.engine.Engine - INFO - [cached since 647s ago] {'device_id_1': 7}
2025-12-29 11:41:44,075 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:41:44,084 - sqlalchemy.engine.Engine - INFO - [cached since 647s ago] {'device_id_1': 7}
2025-12-29 11:41:44,151 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:41:49,743 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:41:49,749 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:41:49,755 - sqlalchemy.engine.Engine - INFO - [cached since 728.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:41:49,762 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:41:49,775 - sqlalchemy.engine.Engine - INFO - [cached since 728.2s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:41:49,781 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:41:49,791 - sqlalchemy.engine.Engine - INFO - [cached since 652.7s ago] {'device_id_1': 12}
2025-12-29 11:41:49,801 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:41:49,812 - sqlalchemy.engine.Engine - INFO - [cached since 652.7s ago] {'device_id_1': 12}
2025-12-29 11:41:49,871 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:41:57,359 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:41:57,367 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:41:57,381 - sqlalchemy.engine.Engine - INFO - [cached since 736.4s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:41:57,386 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:41:57,401 - sqlalchemy.engine.Engine - INFO - [cached since 736.1s ago] {}
2025-12-29 11:41:57,407 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:41:57,423 - sqlalchemy.engine.Engine - INFO - [cached since 736.1s ago] {}
2025-12-29 11:41:57,431 - sqlalchemy.engine.Engine - INFO - SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts ORDER BY alerts.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:41:57,442 - sqlalchemy.engine.Engine - INFO - [cached since 204.6s ago] {'param_1': 0, 'param_2': 20}
2025-12-29 11:41:57,452 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:41:57,464 - sqlalchemy.engine.Engine - INFO - [cached since 204.6s ago] {'pk_1': 13}
2025-12-29 11:41:57,470 - app.database - ERROR - Database session error: 'str' object has no attribute 'value'
2025-12-29 11:41:57,471 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:41:57,475 - app.main - ERROR - Unhandled exception: 'str' object has no attribute 'value'
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\alerts.py", line 84, in list_alerts
    alert_type=alert.alert_type.value,
               ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'value'
2025-12-29 11:41:59,137 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:41:59,142 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:41:59,162 - sqlalchemy.engine.Engine - INFO - [cached since 738.1s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:41:59,173 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:41:59,198 - sqlalchemy.engine.Engine - INFO - [cached since 737.8s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:41:59,205 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:41:59,226 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:41:59,231 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:41:59,235 - sqlalchemy.engine.Engine - INFO - [cached since 738.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:41:59,240 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:41:59,848 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:41:59,851 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:41:59,863 - sqlalchemy.engine.Engine - INFO - [cached since 738.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:41:59,869 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:41:59,885 - sqlalchemy.engine.Engine - INFO - [cached since 738.6s ago] {}
2025-12-29 11:41:59,890 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:41:59,902 - sqlalchemy.engine.Engine - INFO - [cached since 738.6s ago] {}
2025-12-29 11:41:59,908 - sqlalchemy.engine.Engine - INFO - SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts ORDER BY alerts.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:41:59,924 - sqlalchemy.engine.Engine - INFO - [cached since 207.1s ago] {'param_1': 0, 'param_2': 20}
2025-12-29 11:41:59,932 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:41:59,945 - sqlalchemy.engine.Engine - INFO - [cached since 207.1s ago] {'pk_1': 13}
2025-12-29 11:41:59,949 - app.database - ERROR - Database session error: 'str' object has no attribute 'value'
2025-12-29 11:41:59,951 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:41:59,955 - app.main - ERROR - Unhandled exception: 'str' object has no attribute 'value'
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\alerts.py", line 84, in list_alerts
    alert_type=alert.alert_type.value,
               ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'value'
2025-12-29 11:42:03,090 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:42:03,099 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:42:03,111 - sqlalchemy.engine.Engine - INFO - [cached since 742.1s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:42:03,121 - sqlalchemy.engine.Engine - INFO - UPDATE alerts SET is_acknowledged=%(is_acknowledged)s, acknowledged_by=%(acknowledged_by)s, acknowledged_at=%(acknowledged_at)s WHERE alerts.is_acknowledged = false
2025-12-29 11:42:03,128 - sqlalchemy.engine.Engine - INFO - [generated in 0.00696s] {'is_acknowledged': 1, 'acknowledged_by': 1, 'acknowledged_at': datetime.datetime(2025, 12, 29, 6, 12, 3, 116376)}
2025-12-29 11:42:03,134 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:42:03,138 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:42:03,143 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-29 11:42:03,150 - sqlalchemy.engine.Engine - INFO - [cached since 736.2s ago] {'pk_1': 1}
2025-12-29 11:42:03,155 - app.routers.alerts - INFO - 0 alerts acknowledged by admin
2025-12-29 11:42:03,162 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:42:03,176 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:42:03,179 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:42:03,186 - sqlalchemy.engine.Engine - INFO - [cached since 742.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:42:03,197 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:42:03,206 - sqlalchemy.engine.Engine - INFO - [cached since 741.9s ago] {}
2025-12-29 11:42:03,213 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:42:03,222 - sqlalchemy.engine.Engine - INFO - [cached since 741.9s ago] {}
2025-12-29 11:42:03,228 - sqlalchemy.engine.Engine - INFO - SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts ORDER BY alerts.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:42:03,236 - sqlalchemy.engine.Engine - INFO - [cached since 210.4s ago] {'param_1': 0, 'param_2': 20}
2025-12-29 11:42:03,240 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:42:03,250 - sqlalchemy.engine.Engine - INFO - [cached since 210.4s ago] {'pk_1': 13}
2025-12-29 11:42:03,253 - app.database - ERROR - Database session error: 'str' object has no attribute 'value'
2025-12-29 11:42:03,254 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:42:03,257 - app.main - ERROR - Unhandled exception: 'str' object has no attribute 'value'
Traceback (most recent call last):
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\cors.py", line 144, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\middleware\exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\starlette\_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\raj95\AppData\Roaming\Python\Python313\site-packages\fastapi\routing.py", line 243, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "E:\wifi-tracker\backend\app\routers\alerts.py", line 84, in list_alerts
    alert_type=alert.alert_type.value,
               ^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'str' object has no attribute 'value'
2025-12-29 11:43:06,081 - app.services.notification - INFO - WebSocket client unregistered. Total: 1
2025-12-29 11:43:06,082 - app.main - INFO - WebSocket client disconnected
2025-12-29 11:43:06,083 - app.services.notification - INFO - WebSocket client unregistered. Total: 0
2025-12-29 11:43:06,084 - app.main - INFO - WebSocket client disconnected
2025-12-29 11:43:06,188 - app.main - INFO - Shutting down WiFi Tracker System...
2025-12-29 11:43:26,527 - app.main - INFO - Starting WiFi Tracker System...
2025-12-29 11:43:26,536 - sqlalchemy.engine.Engine - INFO - SELECT DATABASE()
2025-12-29 11:43:26,538 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:43:26,541 - sqlalchemy.engine.Engine - INFO - SELECT @@sql_mode
2025-12-29 11:43:26,542 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:43:26,545 - sqlalchemy.engine.Engine - INFO - SELECT @@lower_case_table_names
2025-12-29 11:43:26,547 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:43:26,550 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:43:26,552 - sqlalchemy.engine.Engine - INFO - SELECT 1
2025-12-29 11:43:26,553 - sqlalchemy.engine.Engine - INFO - [generated in 0.00220s] {}
2025-12-29 11:43:26,555 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:43:26,557 - app.main - INFO - Database connection successful
2025-12-29 11:43:26,558 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:43:26,559 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`users`
2025-12-29 11:43:26,561 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:43:26,590 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`devices`
2025-12-29 11:43:26,592 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:43:26,618 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_sessions`
2025-12-29 11:43:26,620 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:43:26,629 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`scan_results`
2025-12-29 11:43:26,634 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:43:26,641 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`alerts`
2025-12-29 11:43:26,644 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:43:26,655 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`ml_predictions`
2025-12-29 11:43:26,656 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:43:26,667 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`device_activity`
2025-12-29 11:43:26,669 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:43:26,677 - sqlalchemy.engine.Engine - INFO - DESCRIBE `wifi_tracker`.`settings`
2025-12-29 11:43:26,679 - sqlalchemy.engine.Engine - INFO - [raw sql] {}
2025-12-29 11:43:26,686 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:43:26,688 - app.database - INFO - Database tables initialized successfully
2025-12-29 11:43:26,693 - app.services.notification - INFO - WebSocket client registered. Total: 1
2025-12-29 11:43:26,694 - app.main - INFO - WebSocket client connected
2025-12-29 11:43:26,719 - app.services.notification - INFO - WebSocket client registered. Total: 2
2025-12-29 11:43:26,722 - app.main - INFO - WebSocket client connected
2025-12-29 11:43:52,630 - app.services.notification - INFO - WebSocket client unregistered. Total: 1
2025-12-29 11:43:52,641 - app.main - INFO - WebSocket client disconnected
2025-12-29 11:43:53,228 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:43:53,243 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:43:53,275 - sqlalchemy.engine.Engine - INFO - [generated in 0.03214s] {'id_1': 1, 'param_1': 1}
2025-12-29 11:43:53,287 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:43:53,307 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:43:53,310 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:43:53,320 - sqlalchemy.engine.Engine - INFO - [cached since 0.07739s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:43:53,336 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:43:53,348 - sqlalchemy.engine.Engine - INFO - [generated in 0.01099s] {}
2025-12-29 11:43:53,371 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:43:53,379 - sqlalchemy.engine.Engine - INFO - [generated in 0.00750s] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 3, 53, 360324)}
2025-12-29 11:43:53,392 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:43:53,403 - sqlalchemy.engine.Engine - INFO - [generated in 0.01152s] {}
2025-12-29 11:43:53,411 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:43:53,423 - sqlalchemy.engine.Engine - INFO - [generated in 0.01254s] {}
2025-12-29 11:43:53,431 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:43:53,442 - sqlalchemy.engine.Engine - INFO - [generated in 0.01071s] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:43:53,456 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:43:53,467 - sqlalchemy.engine.Engine - INFO - [generated in 0.01122s] {}
2025-12-29 11:43:53,486 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:43:53,499 - sqlalchemy.engine.Engine - INFO - [generated in 0.01285s] {}
2025-12-29 11:43:53,512 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:43:53,527 - sqlalchemy.engine.Engine - INFO - [generated in 0.01431s] {'status_1': 'completed'}
2025-12-29 11:43:53,537 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:43:53,547 - sqlalchemy.engine.Engine - INFO - [generated in 0.01033s] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:43:53,558 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:43:53,562 - sqlalchemy.engine.Engine - INFO - [generated in 0.00338s] {}
2025-12-29 11:43:53,574 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:43:53,605 - app.services.notification - INFO - WebSocket client registered. Total: 2
2025-12-29 11:43:53,606 - app.main - INFO - WebSocket client connected
2025-12-29 11:43:53,615 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:43:53,622 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:43:53,640 - sqlalchemy.engine.Engine - INFO - [cached since 0.3974s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:43:53,655 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:43:53,690 - sqlalchemy.engine.Engine - INFO - [generated in 0.03626s] {'id_1': 7, 'param_1': 1}
2025-12-29 11:43:53,703 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:43:53,722 - sqlalchemy.engine.Engine - INFO - [generated in 0.01839s] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 22, 6, 13, 53, 696804), 'param_1': 100}
2025-12-29 11:43:53,736 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s AND scan_results.scan_timestamp >= %(scan_timestamp_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:43:53,747 - sqlalchemy.engine.Engine - INFO - [generated in 0.01147s] {'device_id_1': 7, 'scan_timestamp_1': datetime.datetime(2025, 12, 22, 6, 13, 53, 696804), 'param_1': 100}
2025-12-29 11:43:53,761 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:43:53,780 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:43:53,785 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:43:53,791 - sqlalchemy.engine.Engine - INFO - [cached since 0.5485s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:43:53,797 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:43:53,805 - sqlalchemy.engine.Engine - INFO - [cached since 0.4686s ago] {}
2025-12-29 11:43:53,810 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:43:53,818 - sqlalchemy.engine.Engine - INFO - [cached since 0.4468s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 3, 53, 809063)}
2025-12-29 11:43:53,825 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:43:53,841 - sqlalchemy.engine.Engine - INFO - [cached since 0.4498s ago] {}
2025-12-29 11:43:53,853 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:43:53,867 - sqlalchemy.engine.Engine - INFO - [cached since 0.4558s ago] {}
2025-12-29 11:43:53,872 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:43:53,886 - sqlalchemy.engine.Engine - INFO - [cached since 0.4545s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:43:53,892 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:43:53,903 - sqlalchemy.engine.Engine - INFO - [cached since 0.4472s ago] {}
2025-12-29 11:43:53,909 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:43:53,920 - sqlalchemy.engine.Engine - INFO - [cached since 0.4338s ago] {}
2025-12-29 11:43:53,924 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:43:53,936 - sqlalchemy.engine.Engine - INFO - [cached since 0.424s ago] {'status_1': 'completed'}
2025-12-29 11:43:53,941 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:43:53,954 - sqlalchemy.engine.Engine - INFO - [cached since 0.4174s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:43:53,960 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:43:53,963 - sqlalchemy.engine.Engine - INFO - [cached since 0.4046s ago] {}
2025-12-29 11:43:53,971 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:43:54,024 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:43:54,027 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:43:54,035 - sqlalchemy.engine.Engine - INFO - [cached since 0.7928s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:43:54,042 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:43:54,055 - sqlalchemy.engine.Engine - INFO - [generated in 0.01263s] {'event_timestamp_1': datetime.datetime(2025, 12, 28, 6, 13, 54, 40390), 'param_1': 100}
2025-12-29 11:43:54,061 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:43:54,075 - sqlalchemy.engine.Engine - INFO - [cached since 0.4206s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:43:54,080 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:43:54,092 - sqlalchemy.engine.Engine - INFO - [cached since 0.4378s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:43:54,097 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:43:54,109 - sqlalchemy.engine.Engine - INFO - [cached since 0.4546s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:43:54,116 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:43:54,126 - sqlalchemy.engine.Engine - INFO - [cached since 0.4722s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:43:54,133 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:43:54,142 - sqlalchemy.engine.Engine - INFO - [cached since 0.488s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:43:54,147 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:43:54,159 - sqlalchemy.engine.Engine - INFO - [cached since 0.5052s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:43:54,165 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:43:54,173 - sqlalchemy.engine.Engine - INFO - [cached since 0.5185s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:43:54,178 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:43:54,189 - sqlalchemy.engine.Engine - INFO - [cached since 0.5345s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:43:54,193 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:43:54,209 - sqlalchemy.engine.Engine - INFO - [cached since 0.5544s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:43:54,217 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:43:54,234 - sqlalchemy.engine.Engine - INFO - [cached since 0.5795s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:43:54,240 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:43:54,252 - sqlalchemy.engine.Engine - INFO - [cached since 0.5981s ago] {'id_1': 13, 'param_1': 1}
2025-12-29 11:43:54,258 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:43:54,268 - sqlalchemy.engine.Engine - INFO - [cached since 0.6139s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:43:54,273 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:43:54,286 - sqlalchemy.engine.Engine - INFO - [cached since 0.6316s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:43:54,291 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:43:54,301 - sqlalchemy.engine.Engine - INFO - [cached since 0.647s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:43:54,307 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:43:54,317 - sqlalchemy.engine.Engine - INFO - [cached since 0.663s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:43:54,322 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:43:54,330 - sqlalchemy.engine.Engine - INFO - [cached since 0.6761s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:43:54,338 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:43:54,344 - sqlalchemy.engine.Engine - INFO - [cached since 0.6902s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:43:54,354 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:43:58,090 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:43:58,112 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:43:58,139 - sqlalchemy.engine.Engine - INFO - [cached since 4.896s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:43:58,149 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:43:58,157 - sqlalchemy.engine.Engine - INFO - [cached since 4.821s ago] {}
2025-12-29 11:43:58,165 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:43:58,177 - sqlalchemy.engine.Engine - INFO - [generated in 0.01260s] {'param_1': 0, 'param_2': 20}
2025-12-29 11:43:58,188 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:43:58,200 - sqlalchemy.engine.Engine - INFO - [generated in 0.01157s] {'device_id_1': 7, 'param_1': 1}
2025-12-29 11:43:58,206 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:43:58,218 - sqlalchemy.engine.Engine - INFO - [cached since 0.03s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:43:58,225 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:43:58,239 - sqlalchemy.engine.Engine - INFO - [cached since 0.05108s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:43:58,245 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:43:58,254 - sqlalchemy.engine.Engine - INFO - [cached since 0.06625s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:43:58,259 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:43:58,268 - sqlalchemy.engine.Engine - INFO - [cached since 0.07985s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:43:58,273 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:43:58,282 - sqlalchemy.engine.Engine - INFO - [cached since 0.0939s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:43:58,287 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:43:58,294 - sqlalchemy.engine.Engine - INFO - [cached since 0.1061s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:43:58,301 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:43:58,310 - sqlalchemy.engine.Engine - INFO - [cached since 0.1224s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:43:58,323 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:44:02,627 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:44:02,638 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:02,673 - sqlalchemy.engine.Engine - INFO - [cached since 9.43s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:44:02,697 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:44:02,723 - sqlalchemy.engine.Engine - INFO - [cached since 9.387s ago] {}
2025-12-29 11:44:02,728 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:44:02,743 - sqlalchemy.engine.Engine - INFO - [cached since 9.372s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 4, 2, 727614)}
2025-12-29 11:44:02,756 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:44:02,771 - sqlalchemy.engine.Engine - INFO - [cached since 9.379s ago] {}
2025-12-29 11:44:02,775 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:44:02,789 - sqlalchemy.engine.Engine - INFO - [cached since 9.378s ago] {}
2025-12-29 11:44:02,793 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:44:02,809 - sqlalchemy.engine.Engine - INFO - [cached since 9.378s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:44:02,820 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:44:02,835 - sqlalchemy.engine.Engine - INFO - [cached since 9.379s ago] {}
2025-12-29 11:44:02,840 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:44:02,854 - sqlalchemy.engine.Engine - INFO - [cached since 9.367s ago] {}
2025-12-29 11:44:02,859 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:44:02,875 - sqlalchemy.engine.Engine - INFO - [cached since 9.363s ago] {'status_1': 'completed'}
2025-12-29 11:44:02,882 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:02,895 - sqlalchemy.engine.Engine - INFO - [cached since 9.358s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:44:02,906 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:44:02,910 - sqlalchemy.engine.Engine - INFO - [cached since 9.351s ago] {}
2025-12-29 11:44:02,919 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:44:02,942 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:44:02,944 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:02,968 - sqlalchemy.engine.Engine - INFO - [cached since 9.725s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:44:02,977 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:02,992 - sqlalchemy.engine.Engine - INFO - [cached since 9.338s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:44:03,006 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:03,025 - sqlalchemy.engine.Engine - INFO - [cached since 9.322s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 22, 6, 14, 3, 5748), 'param_1': 100}
2025-12-29 11:44:03,041 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s AND scan_results.scan_timestamp >= %(scan_timestamp_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:03,072 - sqlalchemy.engine.Engine - INFO - [cached since 9.336s ago] {'device_id_1': 7, 'scan_timestamp_1': datetime.datetime(2025, 12, 22, 6, 14, 3, 5748), 'param_1': 100}
2025-12-29 11:44:03,090 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:44:03,115 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:44:03,121 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:03,135 - sqlalchemy.engine.Engine - INFO - [cached since 9.893s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:44:03,141 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:44:03,160 - sqlalchemy.engine.Engine - INFO - [cached since 9.824s ago] {}
2025-12-29 11:44:03,171 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:44:03,188 - sqlalchemy.engine.Engine - INFO - [cached since 9.817s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 4, 3, 169838)}
2025-12-29 11:44:03,195 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:44:03,208 - sqlalchemy.engine.Engine - INFO - [cached since 9.817s ago] {}
2025-12-29 11:44:03,217 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:44:03,237 - sqlalchemy.engine.Engine - INFO - [cached since 9.826s ago] {}
2025-12-29 11:44:03,244 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:44:03,260 - sqlalchemy.engine.Engine - INFO - [cached since 9.829s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:44:03,270 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:44:03,286 - sqlalchemy.engine.Engine - INFO - [cached since 9.83s ago] {}
2025-12-29 11:44:03,292 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:44:03,305 - sqlalchemy.engine.Engine - INFO - [cached since 9.819s ago] {}
2025-12-29 11:44:03,310 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:44:03,324 - sqlalchemy.engine.Engine - INFO - [cached since 9.812s ago] {'status_1': 'completed'}
2025-12-29 11:44:03,328 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:03,340 - sqlalchemy.engine.Engine - INFO - [cached since 9.803s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:44:03,347 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:44:03,352 - sqlalchemy.engine.Engine - INFO - [cached since 9.793s ago] {}
2025-12-29 11:44:03,357 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:44:03,387 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:44:03,391 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:03,403 - sqlalchemy.engine.Engine - INFO - [cached since 10.16s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:44:03,410 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:03,422 - sqlalchemy.engine.Engine - INFO - [cached since 9.38s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 28, 6, 14, 3, 409163), 'param_1': 100}
2025-12-29 11:44:03,430 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:03,441 - sqlalchemy.engine.Engine - INFO - [cached since 9.787s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:44:03,448 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:03,454 - sqlalchemy.engine.Engine - INFO - [cached since 9.8s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:44:03,458 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:03,469 - sqlalchemy.engine.Engine - INFO - [cached since 9.815s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:44:03,474 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:03,486 - sqlalchemy.engine.Engine - INFO - [cached since 9.832s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:44:03,492 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:03,504 - sqlalchemy.engine.Engine - INFO - [cached since 9.85s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:44:03,508 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:03,519 - sqlalchemy.engine.Engine - INFO - [cached since 9.865s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:44:03,523 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:03,534 - sqlalchemy.engine.Engine - INFO - [cached since 9.88s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:44:03,540 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:03,550 - sqlalchemy.engine.Engine - INFO - [cached since 9.896s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:44:03,555 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:03,567 - sqlalchemy.engine.Engine - INFO - [cached since 9.913s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:44:03,572 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:03,584 - sqlalchemy.engine.Engine - INFO - [cached since 9.93s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:44:03,589 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:03,599 - sqlalchemy.engine.Engine - INFO - [cached since 9.945s ago] {'id_1': 13, 'param_1': 1}
2025-12-29 11:44:03,605 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:03,616 - sqlalchemy.engine.Engine - INFO - [cached since 9.962s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:44:03,622 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:03,633 - sqlalchemy.engine.Engine - INFO - [cached since 9.978s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:44:03,638 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:03,648 - sqlalchemy.engine.Engine - INFO - [cached since 9.994s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:44:03,654 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:03,671 - sqlalchemy.engine.Engine - INFO - [cached since 10.02s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:44:03,680 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:03,688 - sqlalchemy.engine.Engine - INFO - [cached since 10.03s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:44:03,693 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:03,702 - sqlalchemy.engine.Engine - INFO - [cached since 10.05s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:44:03,710 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:44:03,922 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:44:03,926 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:03,954 - sqlalchemy.engine.Engine - INFO - [cached since 10.71s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:44:03,977 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-29 11:44:03,994 - sqlalchemy.engine.Engine - INFO - [generated in 0.01771s] {'started_at': datetime.datetime(2025, 12, 29, 6, 14, 3, 976986), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'arp', 'network_range': '192.168.1.0/24', 'status': 'running', 'error_message': None}
2025-12-29 11:44:04,009 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:44:04,022 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:44:04,032 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-29 11:44:04,040 - sqlalchemy.engine.Engine - INFO - [generated in 0.00769s] {'pk_1': 33}
2025-12-29 11:44:04,048 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-29 11:44:04,056 - sqlalchemy.engine.Engine - INFO - [generated in 0.00807s] {'pk_1': 1}
2025-12-29 11:44:04,061 - app.routers.scans - INFO - Scan started by admin: 33
2025-12-29 11:44:04,069 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:04,076 - sqlalchemy.engine.Engine - INFO - [generated in 0.00723s] {'id_1': 33, 'param_1': 1}
2025-12-29 11:44:04,083 - app.services.scanner - INFO - Starting ARP scan on 192.168.1.0/24
2025-12-29 11:44:04,085 - app.services.scanner - INFO - Starting fallback scan on 192.168.1.0/24 (ping + ARP table)
2025-12-29 11:44:36,083 - app.services.scanner - INFO - Fallback scan complete: 8 devices found
2025-12-29 11:44:36,092 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:36,111 - sqlalchemy.engine.Engine - INFO - [generated in 0.01997s] {'mac_address_1': '96:A4:CB:4D:96:A9', 'param_1': 1}
2025-12-29 11:44:36,119 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:36,136 - sqlalchemy.engine.Engine - INFO - [cached since 37.95s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:44:36,150 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:36,177 - sqlalchemy.engine.Engine - INFO - [cached since 0.08558s ago] {'mac_address_1': 'FF:FF:FF:FF:FF:FF', 'param_1': 1}
2025-12-29 11:44:36,189 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:36,233 - sqlalchemy.engine.Engine - INFO - [cached since 38.04s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:44:36,316 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:36,345 - sqlalchemy.engine.Engine - INFO - [cached since 0.2545s ago] {'mac_address_1': '01:00:5E:00:00:16', 'param_1': 1}
2025-12-29 11:44:36,355 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:36,377 - sqlalchemy.engine.Engine - INFO - [cached since 38.19s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:44:36,385 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:36,401 - sqlalchemy.engine.Engine - INFO - [cached since 0.3098s ago] {'mac_address_1': '01:00:5E:00:00:FB', 'param_1': 1}
2025-12-29 11:44:36,410 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:36,419 - sqlalchemy.engine.Engine - INFO - [cached since 38.23s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:44:36,428 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:36,442 - sqlalchemy.engine.Engine - INFO - [cached since 0.3514s ago] {'mac_address_1': '01:00:5E:00:00:FC', 'param_1': 1}
2025-12-29 11:44:36,448 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:36,460 - sqlalchemy.engine.Engine - INFO - [cached since 38.27s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:44:36,467 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:36,481 - sqlalchemy.engine.Engine - INFO - [cached since 0.3897s ago] {'mac_address_1': '01:00:5E:7F:66:12', 'param_1': 1}
2025-12-29 11:44:36,486 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:36,499 - sqlalchemy.engine.Engine - INFO - [cached since 38.31s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:44:36,506 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:36,519 - sqlalchemy.engine.Engine - INFO - [cached since 0.4286s ago] {'mac_address_1': '01:00:5E:7F:FF:FA', 'param_1': 1}
2025-12-29 11:44:36,530 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:36,542 - sqlalchemy.engine.Engine - INFO - [cached since 38.35s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:44:36,549 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:36,560 - sqlalchemy.engine.Engine - INFO - [cached since 0.4688s ago] {'mac_address_1': 'FF:FF:FF:FF:FF:FF', 'param_1': 1}
2025-12-29 11:44:36,571 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:36,584 - sqlalchemy.engine.Engine - INFO - [cached since 38.4s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:44:36,600 - sqlalchemy.engine.Engine - INFO - UPDATE devices SET last_seen=%(last_seen)s WHERE devices.id = %(devices_id)s
2025-12-29 11:44:36,603 - sqlalchemy.engine.Engine - INFO - [generated in 0.00317s] [{'last_seen': datetime.datetime(2025, 12, 29, 6, 14, 36, 146067), 'devices_id': 8}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 14, 36, 593600), 'devices_id': 9}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 14, 36, 383887), 'devices_id': 10}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 14, 36, 426630), 'devices_id': 11}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 14, 36, 466006), 'devices_id': 12}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 14, 36, 504827), 'devices_id': 13}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 14, 36, 547998), 'devices_id': 14}]
2025-12-29 11:44:36,631 - sqlalchemy.engine.Engine - INFO - UPDATE scan_sessions SET completed_at=%(completed_at)s, total_devices_found=%(total_devices_found)s, status=%(status)s WHERE scan_sessions.id = %(scan_sessions_id)s
2025-12-29 11:44:36,635 - sqlalchemy.engine.Engine - INFO - [generated in 0.00405s] {'completed_at': datetime.datetime(2025, 12, 29, 6, 14, 36, 594398), 'total_devices_found': 8, 'status': 'completed', 'scan_sessions_id': 33}
2025-12-29 11:44:36,643 - sqlalchemy.engine.Engine - INFO - INSERT INTO device_activity (device_id, event_type, old_value, new_value, event_timestamp) VALUES (%(device_id)s, %(event_type)s, %(old_value)s, %(new_value)s, %(event_timestamp)s)
2025-12-29 11:44:36,646 - sqlalchemy.engine.Engine - INFO - [generated in 0.00349s] {'device_id': 9, 'event_type': 'ip_changed', 'old_value': '255.255.255.255', 'new_value': '10.41.243.255', 'event_timestamp': datetime.datetime(2025, 12, 29, 6, 14, 36, 642878)}
2025-12-29 11:44:36,653 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:44:36,661 - sqlalchemy.engine.Engine - INFO - [generated in 0.00840s] {'device_id': 8, 'ip_address': '10.41.243.123', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 14, 36, 653091), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:44:36,667 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:44:36,672 - sqlalchemy.engine.Engine - INFO - [cached since 0.01936s ago] {'device_id': 9, 'ip_address': '10.41.243.255', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 14, 36, 667106), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:44:36,677 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:44:36,682 - sqlalchemy.engine.Engine - INFO - [cached since 0.02937s ago] {'device_id': 10, 'ip_address': '224.0.0.22', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 14, 36, 677800), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:44:36,689 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:44:36,695 - sqlalchemy.engine.Engine - INFO - [cached since 0.04239s ago] {'device_id': 11, 'ip_address': '224.0.0.251', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 14, 36, 689857), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:44:36,700 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:44:36,703 - sqlalchemy.engine.Engine - INFO - [cached since 0.0503s ago] {'device_id': 12, 'ip_address': '224.0.0.252', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 14, 36, 700360), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:44:36,710 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:44:36,715 - sqlalchemy.engine.Engine - INFO - [cached since 0.06281s ago] {'device_id': 13, 'ip_address': '239.255.102.18', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 14, 36, 710492), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:44:36,720 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:44:36,726 - sqlalchemy.engine.Engine - INFO - [cached since 0.07326s ago] {'device_id': 14, 'ip_address': '239.255.255.250', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 14, 36, 720654), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:44:36,730 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:44:36,733 - sqlalchemy.engine.Engine - INFO - [cached since 0.08106s ago] {'device_id': 9, 'ip_address': '255.255.255.255', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 14, 36, 730420), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:44:36,740 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:44:36,745 - app.routers.scans - INFO - Scan completed: 8 devices, 0 new
2025-12-29 11:44:36,788 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:44:36,792 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:36,799 - sqlalchemy.engine.Engine - INFO - [cached since 43.56s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:44:36,808 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:44:36,813 - sqlalchemy.engine.Engine - INFO - [cached since 43.48s ago] {}
2025-12-29 11:44:36,818 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:44:36,825 - sqlalchemy.engine.Engine - INFO - [cached since 38.66s ago] {'param_1': 0, 'param_2': 20}
2025-12-29 11:44:36,831 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:36,836 - sqlalchemy.engine.Engine - INFO - [cached since 38.65s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:44:36,842 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:36,848 - sqlalchemy.engine.Engine - INFO - [cached since 38.66s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:44:36,852 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:36,859 - sqlalchemy.engine.Engine - INFO - [cached since 38.67s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:44:36,863 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:36,870 - sqlalchemy.engine.Engine - INFO - [cached since 38.68s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:44:36,879 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:36,893 - sqlalchemy.engine.Engine - INFO - [cached since 38.7s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:44:36,900 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:36,910 - sqlalchemy.engine.Engine - INFO - [cached since 38.72s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:44:36,916 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:36,930 - sqlalchemy.engine.Engine - INFO - [cached since 38.74s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:44:36,936 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:36,948 - sqlalchemy.engine.Engine - INFO - [cached since 38.76s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-29 11:44:36,959 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:44:36,966 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:44:36,968 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:36,980 - sqlalchemy.engine.Engine - INFO - [cached since 43.74s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:44:36,989 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:44:37,001 - sqlalchemy.engine.Engine - INFO - [cached since 43.66s ago] {}
2025-12-29 11:44:37,014 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:44:37,032 - sqlalchemy.engine.Engine - INFO - [cached since 43.66s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 4, 37, 12483)}
2025-12-29 11:44:37,040 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:44:37,050 - sqlalchemy.engine.Engine - INFO - [cached since 43.66s ago] {}
2025-12-29 11:44:37,056 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:44:37,071 - sqlalchemy.engine.Engine - INFO - [cached since 43.66s ago] {}
2025-12-29 11:44:37,078 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:44:37,086 - sqlalchemy.engine.Engine - INFO - [cached since 43.65s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:44:37,093 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:44:37,110 - sqlalchemy.engine.Engine - INFO - [cached since 43.65s ago] {}
2025-12-29 11:44:37,119 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:44:37,130 - sqlalchemy.engine.Engine - INFO - [cached since 43.64s ago] {}
2025-12-29 11:44:37,135 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:44:37,144 - sqlalchemy.engine.Engine - INFO - [cached since 43.63s ago] {'status_1': 'completed'}
2025-12-29 11:44:37,153 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:37,176 - sqlalchemy.engine.Engine - INFO - [cached since 43.64s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:44:37,182 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:44:37,185 - sqlalchemy.engine.Engine - INFO - [cached since 43.63s ago] {}
2025-12-29 11:44:37,197 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:44:37,199 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:37,210 - sqlalchemy.engine.Engine - INFO - [cached since 43.97s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:44:37,220 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:44:37,231 - sqlalchemy.engine.Engine - INFO - [cached since 43.89s ago] {}
2025-12-29 11:44:37,236 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:44:37,248 - sqlalchemy.engine.Engine - INFO - [cached since 39.08s ago] {'param_1': 0, 'param_2': 20}
2025-12-29 11:44:37,256 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:37,264 - sqlalchemy.engine.Engine - INFO - [cached since 39.08s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:44:37,270 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:37,280 - sqlalchemy.engine.Engine - INFO - [cached since 39.09s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:44:37,286 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:37,297 - sqlalchemy.engine.Engine - INFO - [cached since 39.11s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:44:37,302 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:37,311 - sqlalchemy.engine.Engine - INFO - [cached since 39.12s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:44:37,316 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:37,329 - sqlalchemy.engine.Engine - INFO - [cached since 39.14s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:44:37,334 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:37,340 - sqlalchemy.engine.Engine - INFO - [cached since 39.15s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:44:37,344 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:37,353 - sqlalchemy.engine.Engine - INFO - [cached since 39.16s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:44:37,360 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:37,369 - sqlalchemy.engine.Engine - INFO - [cached since 39.18s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-29 11:44:37,379 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:44:37,381 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:44:37,402 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:44:37,406 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:37,414 - sqlalchemy.engine.Engine - INFO - [cached since 44.17s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:44:37,419 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:44:37,434 - sqlalchemy.engine.Engine - INFO - [cached since 44.1s ago] {}
2025-12-29 11:44:37,440 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:44:37,449 - sqlalchemy.engine.Engine - INFO - [cached since 44.08s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 4, 37, 437967)}
2025-12-29 11:44:37,457 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:44:37,466 - sqlalchemy.engine.Engine - INFO - [cached since 44.07s ago] {}
2025-12-29 11:44:37,470 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:44:37,482 - sqlalchemy.engine.Engine - INFO - [cached since 44.07s ago] {}
2025-12-29 11:44:37,488 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:44:37,498 - sqlalchemy.engine.Engine - INFO - [cached since 44.07s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:44:37,504 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:44:37,513 - sqlalchemy.engine.Engine - INFO - [cached since 44.06s ago] {}
2025-12-29 11:44:37,518 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:44:37,531 - sqlalchemy.engine.Engine - INFO - [cached since 44.05s ago] {}
2025-12-29 11:44:37,538 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:44:37,552 - sqlalchemy.engine.Engine - INFO - [cached since 44.04s ago] {'status_1': 'completed'}
2025-12-29 11:44:37,560 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:37,573 - sqlalchemy.engine.Engine - INFO - [cached since 44.04s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:44:37,581 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:44:37,586 - sqlalchemy.engine.Engine - INFO - [cached since 44.03s ago] {}
2025-12-29 11:44:37,598 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:44:37,606 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:37,611 - sqlalchemy.engine.Engine - INFO - [cached since 44.37s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:44:37,617 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:44:37,625 - sqlalchemy.engine.Engine - INFO - [cached since 44.29s ago] {}
2025-12-29 11:44:37,628 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:44:37,639 - sqlalchemy.engine.Engine - INFO - [cached since 39.47s ago] {'param_1': 0, 'param_2': 20}
2025-12-29 11:44:37,645 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:37,655 - sqlalchemy.engine.Engine - INFO - [cached since 39.47s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:44:37,662 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:37,675 - sqlalchemy.engine.Engine - INFO - [cached since 39.49s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:44:37,681 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:37,690 - sqlalchemy.engine.Engine - INFO - [cached since 39.5s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:44:37,696 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:37,709 - sqlalchemy.engine.Engine - INFO - [cached since 39.52s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:44:37,715 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:37,725 - sqlalchemy.engine.Engine - INFO - [cached since 39.54s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:44:37,731 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:37,742 - sqlalchemy.engine.Engine - INFO - [cached since 39.55s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:44:37,747 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:37,757 - sqlalchemy.engine.Engine - INFO - [cached since 39.57s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:44:37,763 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:37,777 - sqlalchemy.engine.Engine - INFO - [cached since 39.59s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-29 11:44:37,784 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:44:37,786 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:44:37,795 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:44:37,801 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:37,815 - sqlalchemy.engine.Engine - INFO - [cached since 44.57s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:44:37,826 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:37,848 - sqlalchemy.engine.Engine - INFO - [cached since 44.19s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:44:37,857 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:37,886 - sqlalchemy.engine.Engine - INFO - [cached since 44.18s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 22, 6, 14, 37, 853694), 'param_1': 100}
2025-12-29 11:44:37,900 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s AND scan_results.scan_timestamp >= %(scan_timestamp_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:37,920 - sqlalchemy.engine.Engine - INFO - [cached since 44.18s ago] {'device_id_1': 7, 'scan_timestamp_1': datetime.datetime(2025, 12, 22, 6, 14, 37, 853694), 'param_1': 100}
2025-12-29 11:44:37,944 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:44:37,948 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:44:37,976 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:37,996 - sqlalchemy.engine.Engine - INFO - [cached since 44.75s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:44:38,003 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:44:38,020 - sqlalchemy.engine.Engine - INFO - [cached since 44.68s ago] {}
2025-12-29 11:44:38,029 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:44:38,040 - sqlalchemy.engine.Engine - INFO - [cached since 39.88s ago] {'param_1': 0, 'param_2': 20}
2025-12-29 11:44:38,048 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:38,061 - sqlalchemy.engine.Engine - INFO - [cached since 39.87s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:44:38,067 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:38,079 - sqlalchemy.engine.Engine - INFO - [cached since 39.89s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:44:38,086 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:38,101 - sqlalchemy.engine.Engine - INFO - [cached since 39.91s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:44:38,111 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:38,118 - sqlalchemy.engine.Engine - INFO - [cached since 39.93s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:44:38,125 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:38,136 - sqlalchemy.engine.Engine - INFO - [cached since 39.95s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:44:38,146 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:38,160 - sqlalchemy.engine.Engine - INFO - [cached since 39.97s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:44:38,167 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:38,186 - sqlalchemy.engine.Engine - INFO - [cached since 40s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:44:38,205 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:38,228 - sqlalchemy.engine.Engine - INFO - [cached since 40.04s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-29 11:44:38,247 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:44:38,254 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:44:38,302 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:38,347 - sqlalchemy.engine.Engine - INFO - [cached since 45.1s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:44:38,357 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:38,381 - sqlalchemy.engine.Engine - INFO - [cached since 44.73s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:44:38,390 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:38,431 - sqlalchemy.engine.Engine - INFO - [cached since 44.73s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 22, 6, 14, 38, 388438), 'param_1': 100}
2025-12-29 11:44:38,448 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s AND scan_results.scan_timestamp >= %(scan_timestamp_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:38,471 - sqlalchemy.engine.Engine - INFO - [cached since 44.73s ago] {'device_id_1': 7, 'scan_timestamp_1': datetime.datetime(2025, 12, 22, 6, 14, 38, 388438), 'param_1': 100}
2025-12-29 11:44:38,487 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:44:38,496 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:38,508 - sqlalchemy.engine.Engine - INFO - [cached since 45.27s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:44:38,516 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:44:38,528 - sqlalchemy.engine.Engine - INFO - [cached since 45.19s ago] {}
2025-12-29 11:44:38,533 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:44:38,546 - sqlalchemy.engine.Engine - INFO - [cached since 40.38s ago] {'param_1': 0, 'param_2': 20}
2025-12-29 11:44:38,552 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:38,569 - sqlalchemy.engine.Engine - INFO - [cached since 40.38s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:44:38,579 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:38,596 - sqlalchemy.engine.Engine - INFO - [cached since 40.41s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:44:38,607 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:38,635 - sqlalchemy.engine.Engine - INFO - [cached since 40.45s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:44:38,645 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:38,661 - sqlalchemy.engine.Engine - INFO - [cached since 40.47s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:44:38,666 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:38,684 - sqlalchemy.engine.Engine - INFO - [cached since 40.5s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:44:38,702 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:38,728 - sqlalchemy.engine.Engine - INFO - [cached since 40.54s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:44:38,734 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:38,749 - sqlalchemy.engine.Engine - INFO - [cached since 40.56s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:44:38,759 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:38,770 - sqlalchemy.engine.Engine - INFO - [cached since 40.58s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-29 11:44:38,781 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:44:38,782 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:44:38,784 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:44:38,796 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:38,814 - sqlalchemy.engine.Engine - INFO - [cached since 45.57s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:44:38,828 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:44:38,850 - sqlalchemy.engine.Engine - INFO - [cached since 45.51s ago] {}
2025-12-29 11:44:38,862 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:44:38,881 - sqlalchemy.engine.Engine - INFO - [cached since 45.51s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 4, 38, 860738)}
2025-12-29 11:44:38,891 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:44:38,915 - sqlalchemy.engine.Engine - INFO - [cached since 45.52s ago] {}
2025-12-29 11:44:38,922 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:44:38,948 - sqlalchemy.engine.Engine - INFO - [cached since 45.54s ago] {}
2025-12-29 11:44:38,953 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:44:38,971 - sqlalchemy.engine.Engine - INFO - [cached since 45.54s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:44:38,981 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:44:38,993 - sqlalchemy.engine.Engine - INFO - [cached since 45.54s ago] {}
2025-12-29 11:44:38,997 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:44:39,014 - sqlalchemy.engine.Engine - INFO - [cached since 45.53s ago] {}
2025-12-29 11:44:39,018 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:44:39,033 - sqlalchemy.engine.Engine - INFO - [cached since 45.52s ago] {'status_1': 'completed'}
2025-12-29 11:44:39,038 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:39,053 - sqlalchemy.engine.Engine - INFO - [cached since 45.52s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:44:39,064 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:44:39,068 - sqlalchemy.engine.Engine - INFO - [cached since 45.51s ago] {}
2025-12-29 11:44:39,079 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:44:39,081 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:44:39,093 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:39,102 - sqlalchemy.engine.Engine - INFO - [cached since 45.86s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:44:39,112 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:44:39,123 - sqlalchemy.engine.Engine - INFO - [cached since 45.79s ago] {}
2025-12-29 11:44:39,128 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:44:39,142 - sqlalchemy.engine.Engine - INFO - [cached since 40.98s ago] {'param_1': 0, 'param_2': 20}
2025-12-29 11:44:39,148 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:39,159 - sqlalchemy.engine.Engine - INFO - [cached since 40.97s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:44:39,164 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:39,174 - sqlalchemy.engine.Engine - INFO - [cached since 40.99s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:44:39,179 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:39,190 - sqlalchemy.engine.Engine - INFO - [cached since 41s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:44:39,195 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:39,207 - sqlalchemy.engine.Engine - INFO - [cached since 41.02s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:44:39,212 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:39,222 - sqlalchemy.engine.Engine - INFO - [cached since 41.03s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:44:39,227 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:39,243 - sqlalchemy.engine.Engine - INFO - [cached since 41.06s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:44:39,251 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:39,267 - sqlalchemy.engine.Engine - INFO - [cached since 41.08s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:44:39,277 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:39,290 - sqlalchemy.engine.Engine - INFO - [cached since 41.1s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-29 11:44:39,299 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:44:39,309 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:44:39,314 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:39,328 - sqlalchemy.engine.Engine - INFO - [cached since 46.08s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:44:39,334 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:44:39,350 - sqlalchemy.engine.Engine - INFO - [cached since 46.01s ago] {}
2025-12-29 11:44:39,367 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:44:39,378 - sqlalchemy.engine.Engine - INFO - [cached since 41.21s ago] {'param_1': 0, 'param_2': 20}
2025-12-29 11:44:39,388 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:39,407 - sqlalchemy.engine.Engine - INFO - [cached since 41.22s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:44:39,418 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:39,445 - sqlalchemy.engine.Engine - INFO - [cached since 41.26s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:44:39,451 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:39,467 - sqlalchemy.engine.Engine - INFO - [cached since 41.28s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:44:39,473 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:39,485 - sqlalchemy.engine.Engine - INFO - [cached since 41.3s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:44:39,495 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:39,510 - sqlalchemy.engine.Engine - INFO - [cached since 41.32s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:44:39,516 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:39,531 - sqlalchemy.engine.Engine - INFO - [cached since 41.34s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:44:39,536 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:39,550 - sqlalchemy.engine.Engine - INFO - [cached since 41.36s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:44:39,559 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:39,577 - sqlalchemy.engine.Engine - INFO - [cached since 41.39s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-29 11:44:39,589 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:44:39,592 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:44:39,618 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:39,633 - sqlalchemy.engine.Engine - INFO - [cached since 46.39s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:44:39,640 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:39,663 - sqlalchemy.engine.Engine - INFO - [cached since 45.62s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 28, 6, 14, 39, 638972), 'param_1': 100}
2025-12-29 11:44:39,670 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:39,686 - sqlalchemy.engine.Engine - INFO - [cached since 46.03s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:44:39,697 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:39,711 - sqlalchemy.engine.Engine - INFO - [cached since 46.06s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:44:39,716 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:39,728 - sqlalchemy.engine.Engine - INFO - [cached since 46.07s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:44:39,734 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:39,749 - sqlalchemy.engine.Engine - INFO - [cached since 46.09s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:44:39,758 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:39,765 - sqlalchemy.engine.Engine - INFO - [cached since 46.11s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:44:39,771 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:39,784 - sqlalchemy.engine.Engine - INFO - [cached since 46.13s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:44:39,795 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:39,803 - sqlalchemy.engine.Engine - INFO - [cached since 46.15s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:44:39,814 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:39,830 - sqlalchemy.engine.Engine - INFO - [cached since 46.18s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:44:39,841 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:39,852 - sqlalchemy.engine.Engine - INFO - [cached since 46.2s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:44:39,862 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:39,880 - sqlalchemy.engine.Engine - INFO - [cached since 46.23s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:44:39,889 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:39,904 - sqlalchemy.engine.Engine - INFO - [cached since 46.25s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:44:39,917 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:39,934 - sqlalchemy.engine.Engine - INFO - [cached since 46.28s ago] {'id_1': 13, 'param_1': 1}
2025-12-29 11:44:39,949 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:39,962 - sqlalchemy.engine.Engine - INFO - [cached since 46.31s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:44:39,966 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:39,977 - sqlalchemy.engine.Engine - INFO - [cached since 46.32s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:44:39,981 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:39,992 - sqlalchemy.engine.Engine - INFO - [cached since 46.34s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:44:39,996 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:40,010 - sqlalchemy.engine.Engine - INFO - [cached since 46.36s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:44:40,015 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:40,025 - sqlalchemy.engine.Engine - INFO - [cached since 46.37s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:44:40,030 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:40,035 - sqlalchemy.engine.Engine - INFO - [cached since 46.38s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:44:40,045 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:44:40,057 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:44:40,059 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:40,063 - sqlalchemy.engine.Engine - INFO - [cached since 46.82s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:44:40,069 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:44:40,076 - sqlalchemy.engine.Engine - INFO - [cached since 46.74s ago] {}
2025-12-29 11:44:40,081 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:44:40,085 - sqlalchemy.engine.Engine - INFO - [cached since 41.92s ago] {'param_1': 0, 'param_2': 20}
2025-12-29 11:44:40,093 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:40,099 - sqlalchemy.engine.Engine - INFO - [cached since 41.91s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:44:40,104 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:40,115 - sqlalchemy.engine.Engine - INFO - [cached since 41.93s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:44:40,119 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:40,129 - sqlalchemy.engine.Engine - INFO - [cached since 41.94s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:44:40,133 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:40,144 - sqlalchemy.engine.Engine - INFO - [cached since 41.96s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:44:40,149 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:40,162 - sqlalchemy.engine.Engine - INFO - [cached since 41.97s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:44:40,166 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:40,179 - sqlalchemy.engine.Engine - INFO - [cached since 41.99s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:44:40,184 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:40,194 - sqlalchemy.engine.Engine - INFO - [cached since 42.01s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:44:40,198 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:40,210 - sqlalchemy.engine.Engine - INFO - [cached since 42.02s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-29 11:44:40,218 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:44:40,224 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:44:40,233 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:40,247 - sqlalchemy.engine.Engine - INFO - [cached since 47s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:44:40,285 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:40,326 - sqlalchemy.engine.Engine - INFO - [cached since 46.67s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:44:40,333 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:44:40,348 - sqlalchemy.engine.Engine - INFO - [generated in 0.01507s] {'device_id_1': 8}
2025-12-29 11:44:40,354 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:44:40,365 - sqlalchemy.engine.Engine - INFO - [generated in 0.01106s] {'device_id_1': 8}
2025-12-29 11:44:40,659 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:44:40,767 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:40,816 - sqlalchemy.engine.Engine - INFO - [cached since 47.57s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:44:40,823 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:44:40,830 - sqlalchemy.engine.Engine - INFO - [cached since 47.49s ago] {}
2025-12-29 11:44:40,835 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:44:40,844 - sqlalchemy.engine.Engine - INFO - [cached since 47.47s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 4, 40, 834259)}
2025-12-29 11:44:40,849 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:44:40,863 - sqlalchemy.engine.Engine - INFO - [cached since 47.47s ago] {}
2025-12-29 11:44:40,875 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:44:40,923 - sqlalchemy.engine.Engine - INFO - [cached since 47.51s ago] {}
2025-12-29 11:44:41,006 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:44:41,017 - sqlalchemy.engine.Engine - INFO - [cached since 47.59s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:44:41,024 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:44:41,031 - sqlalchemy.engine.Engine - INFO - [cached since 47.58s ago] {}
2025-12-29 11:44:41,035 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:44:41,046 - sqlalchemy.engine.Engine - INFO - [cached since 47.56s ago] {}
2025-12-29 11:44:41,051 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:44:41,063 - sqlalchemy.engine.Engine - INFO - [cached since 47.55s ago] {'status_1': 'completed'}
2025-12-29 11:44:41,068 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:41,083 - sqlalchemy.engine.Engine - INFO - [cached since 47.55s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:44:41,088 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:44:41,092 - sqlalchemy.engine.Engine - INFO - [cached since 47.53s ago] {}
2025-12-29 11:44:41,099 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:44:41,099 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:44:41,134 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:44:41,137 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:41,143 - sqlalchemy.engine.Engine - INFO - [cached since 47.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:44:41,148 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:44:41,158 - sqlalchemy.engine.Engine - INFO - [cached since 47.12s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 28, 6, 14, 41, 147485), 'param_1': 100}
2025-12-29 11:44:41,164 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:41,175 - sqlalchemy.engine.Engine - INFO - [cached since 47.52s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:44:41,180 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:41,193 - sqlalchemy.engine.Engine - INFO - [cached since 47.54s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:44:41,199 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:41,210 - sqlalchemy.engine.Engine - INFO - [cached since 47.56s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:44:41,216 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:41,230 - sqlalchemy.engine.Engine - INFO - [cached since 47.58s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:44:41,234 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:41,242 - sqlalchemy.engine.Engine - INFO - [cached since 47.59s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:44:41,246 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:41,255 - sqlalchemy.engine.Engine - INFO - [cached since 47.6s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:44:41,260 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:41,266 - sqlalchemy.engine.Engine - INFO - [cached since 47.61s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:44:41,271 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:41,278 - sqlalchemy.engine.Engine - INFO - [cached since 47.62s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:44:41,282 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:41,292 - sqlalchemy.engine.Engine - INFO - [cached since 47.64s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:44:41,298 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:41,308 - sqlalchemy.engine.Engine - INFO - [cached since 47.65s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:44:41,314 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:41,326 - sqlalchemy.engine.Engine - INFO - [cached since 47.67s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:44:41,332 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:41,342 - sqlalchemy.engine.Engine - INFO - [cached since 47.69s ago] {'id_1': 13, 'param_1': 1}
2025-12-29 11:44:41,347 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:41,355 - sqlalchemy.engine.Engine - INFO - [cached since 47.7s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:44:41,360 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:41,370 - sqlalchemy.engine.Engine - INFO - [cached since 47.72s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:44:41,376 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:41,386 - sqlalchemy.engine.Engine - INFO - [cached since 47.73s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:44:41,396 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:41,408 - sqlalchemy.engine.Engine - INFO - [cached since 47.75s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:44:41,416 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:41,427 - sqlalchemy.engine.Engine - INFO - [cached since 47.77s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:44:41,434 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:41,445 - sqlalchemy.engine.Engine - INFO - [cached since 47.79s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:44:41,456 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:44:42,708 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:44:42,712 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:42,729 - sqlalchemy.engine.Engine - INFO - [cached since 49.49s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:44:42,744 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:44:49,832 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:44:49,838 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:49,845 - sqlalchemy.engine.Engine - INFO - [cached since 56.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:44:49,852 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices
2025-12-29 11:44:49,860 - sqlalchemy.engine.Engine - INFO - [generated in 0.00794s] {}
2025-12-29 11:44:49,866 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:44:49,877 - sqlalchemy.engine.Engine - INFO - [cached since 9.544s ago] {'device_id_1': 7}
2025-12-29 11:44:49,881 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:44:49,890 - sqlalchemy.engine.Engine - INFO - [cached since 9.537s ago] {'device_id_1': 7}
2025-12-29 11:44:49,896 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:44:49,906 - sqlalchemy.engine.Engine - INFO - [cached since 9.573s ago] {'device_id_1': 8}
2025-12-29 11:44:49,911 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:44:49,920 - sqlalchemy.engine.Engine - INFO - [cached since 9.566s ago] {'device_id_1': 8}
2025-12-29 11:44:49,927 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:44:49,937 - sqlalchemy.engine.Engine - INFO - [cached since 9.605s ago] {'device_id_1': 9}
2025-12-29 11:44:49,946 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:44:49,955 - sqlalchemy.engine.Engine - INFO - [cached since 9.601s ago] {'device_id_1': 9}
2025-12-29 11:44:49,961 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:44:49,971 - sqlalchemy.engine.Engine - INFO - [cached since 9.638s ago] {'device_id_1': 10}
2025-12-29 11:44:49,976 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:44:49,987 - sqlalchemy.engine.Engine - INFO - [cached since 9.633s ago] {'device_id_1': 10}
2025-12-29 11:44:49,993 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:44:50,003 - sqlalchemy.engine.Engine - INFO - [cached since 9.67s ago] {'device_id_1': 11}
2025-12-29 11:44:50,008 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:44:50,017 - sqlalchemy.engine.Engine - INFO - [cached since 9.664s ago] {'device_id_1': 11}
2025-12-29 11:44:50,024 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:44:50,038 - sqlalchemy.engine.Engine - INFO - [cached since 9.705s ago] {'device_id_1': 12}
2025-12-29 11:44:50,043 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:44:50,053 - sqlalchemy.engine.Engine - INFO - [cached since 9.7s ago] {'device_id_1': 12}
2025-12-29 11:44:50,059 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:44:50,066 - sqlalchemy.engine.Engine - INFO - [cached since 9.733s ago] {'device_id_1': 13}
2025-12-29 11:44:50,072 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:44:50,080 - sqlalchemy.engine.Engine - INFO - [cached since 9.726s ago] {'device_id_1': 13}
2025-12-29 11:44:50,085 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:44:50,096 - sqlalchemy.engine.Engine - INFO - [cached since 9.763s ago] {'device_id_1': 14}
2025-12-29 11:44:50,103 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:44:50,110 - sqlalchemy.engine.Engine - INFO - [cached since 9.757s ago] {'device_id_1': 14}
2025-12-29 11:44:50,114 - app.ml.detector - INFO - Training anomaly detector with 8 devices
2025-12-29 11:44:50,122 - app.ml.isolation_forest - INFO - Training Isolation Forest with 8 samples
2025-12-29 11:44:50,730 - app.ml.isolation_forest - INFO - Model saved to E:\wifi-tracker\backend\data\models\isolation_forest.pkl
2025-12-29 11:44:50,780 - app.ml.isolation_forest - INFO - Training complete: {'model_type': 'isolation_forest', 'samples_trained': 8, 'contamination': 0.1, 'n_estimators': 100, 'anomalies_in_training': 1, 'score_mean': 0.21919620141615614, 'score_std': 0.1408813957250836, 'trained_at': '2025-12-29T06:14:50.780695'}
2025-12-29 11:44:50,782 - app.ml.autoencoder - INFO - Training Autoencoder with 8 samples
2025-12-29 11:44:56,335 - app.ml.autoencoder - INFO - Epoch 20/100, Loss: 0.396789
2025-12-29 11:44:56,512 - app.ml.autoencoder - INFO - Epoch 40/100, Loss: 0.375065
2025-12-29 11:44:56,677 - app.ml.autoencoder - INFO - Epoch 60/100, Loss: 0.390502
2025-12-29 11:44:56,887 - app.ml.autoencoder - INFO - Epoch 80/100, Loss: 0.294396
2025-12-29 11:44:57,064 - app.ml.autoencoder - INFO - Epoch 100/100, Loss: 0.222615
2025-12-29 11:44:57,084 - app.ml.autoencoder - INFO - Autoencoder saved to E:\wifi-tracker\backend\data\models\autoencoder.pth
2025-12-29 11:44:57,087 - app.ml.autoencoder - INFO - Training complete: {'model_type': 'autoencoder', 'samples_trained': 8, 'input_dim': 15, 'encoding_dim': 8, 'epochs': 100, 'final_loss': 0.22261494398117065, 'threshold': 0.6595950126647949, 'threshold_percentile': 95, 'trained_at': '2025-12-29T06:14:57.087389'}
2025-12-29 11:44:57,091 - app.routers.dashboard - INFO - ML training initiated by admin: {'status': 'success', 'models': {'isolation_forest': {'model_type': 'isolation_forest', 'samples_trained': 8, 'contamination': 0.1, 'n_estimators': 100, 'anomalies_in_training': 1, 'score_mean': 0.21919620141615614, 'score_std': 0.1408813957250836, 'trained_at': '2025-12-29T06:14:50.780695'}, 'autoencoder': {'model_type': 'autoencoder', 'samples_trained': 8, 'input_dim': 15, 'encoding_dim': 8, 'epochs': 100, 'final_loss': 0.22261494398117065, 'threshold': 0.6595950126647949, 'threshold_percentile': 95, 'trained_at': '2025-12-29T06:14:57.087389'}}, 'trained_at': '2025-12-29T06:14:57.091541', 'total_samples': 8}
2025-12-29 11:44:57,106 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:44:57,129 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:44:57,136 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:44:57,147 - sqlalchemy.engine.Engine - INFO - [cached since 63.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:44:57,155 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:45:02,984 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:45:02,993 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:03,046 - sqlalchemy.engine.Engine - INFO - [cached since 69.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:45:03,063 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:45:03,077 - sqlalchemy.engine.Engine - INFO - [cached since 69.74s ago] {}
2025-12-29 11:45:03,087 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:45:03,102 - sqlalchemy.engine.Engine - INFO - [cached since 64.94s ago] {'param_1': 0, 'param_2': 20}
2025-12-29 11:45:03,111 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:45:03,126 - sqlalchemy.engine.Engine - INFO - [cached since 64.94s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:45:03,135 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:45:03,146 - sqlalchemy.engine.Engine - INFO - [cached since 64.96s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:45:03,156 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:45:03,169 - sqlalchemy.engine.Engine - INFO - [cached since 64.98s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:45:03,174 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:45:03,185 - sqlalchemy.engine.Engine - INFO - [cached since 65s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:45:03,191 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:45:03,205 - sqlalchemy.engine.Engine - INFO - [cached since 65.02s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:45:03,212 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:45:03,224 - sqlalchemy.engine.Engine - INFO - [cached since 65.04s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:45:03,232 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:45:03,242 - sqlalchemy.engine.Engine - INFO - [cached since 65.05s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:45:03,246 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:45:03,256 - sqlalchemy.engine.Engine - INFO - [cached since 65.07s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-29 11:45:03,263 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:45:04,846 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:45:04,851 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:04,860 - sqlalchemy.engine.Engine - INFO - [cached since 71.62s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:45:04,868 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:04,877 - sqlalchemy.engine.Engine - INFO - [cached since 71.22s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:45:04,884 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:45:04,892 - sqlalchemy.engine.Engine - INFO - [cached since 24.56s ago] {'device_id_1': 8}
2025-12-29 11:45:04,899 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:45:04,906 - sqlalchemy.engine.Engine - INFO - [cached since 24.55s ago] {'device_id_1': 8}
2025-12-29 11:45:04,976 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:45:07,835 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:45:07,858 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:07,874 - sqlalchemy.engine.Engine - INFO - [cached since 74.63s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:45:07,883 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:45:07,896 - sqlalchemy.engine.Engine - INFO - [cached since 74.44s ago] {}
2025-12-29 11:45:07,906 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:45:07,920 - sqlalchemy.engine.Engine - INFO - [cached since 74.43s ago] {}
2025-12-29 11:45:07,926 - sqlalchemy.engine.Engine - INFO - SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts ORDER BY alerts.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:45:07,936 - sqlalchemy.engine.Engine - INFO - [generated in 0.00983s] {'param_1': 0, 'param_2': 20}
2025-12-29 11:45:07,949 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:07,959 - sqlalchemy.engine.Engine - INFO - [generated in 0.01014s] {'pk_1': 13}
2025-12-29 11:45:07,966 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:07,972 - sqlalchemy.engine.Engine - INFO - [cached since 0.02325s ago] {'pk_1': 14}
2025-12-29 11:45:07,977 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:07,987 - sqlalchemy.engine.Engine - INFO - [cached since 0.03854s ago] {'pk_1': 7}
2025-12-29 11:45:07,993 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:08,003 - sqlalchemy.engine.Engine - INFO - [cached since 0.05372s ago] {'pk_1': 8}
2025-12-29 11:45:08,007 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:08,019 - sqlalchemy.engine.Engine - INFO - [cached since 0.07038s ago] {'pk_1': 9}
2025-12-29 11:45:08,024 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:08,034 - sqlalchemy.engine.Engine - INFO - [cached since 0.08551s ago] {'pk_1': 10}
2025-12-29 11:45:08,040 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:08,051 - sqlalchemy.engine.Engine - INFO - [cached since 0.102s ago] {'pk_1': 11}
2025-12-29 11:45:08,054 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:08,062 - sqlalchemy.engine.Engine - INFO - [cached since 0.1133s ago] {'pk_1': 12}
2025-12-29 11:45:08,074 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:45:22,226 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:45:22,231 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:22,238 - sqlalchemy.engine.Engine - INFO - [cached since 89s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:45:22,247 - sqlalchemy.engine.Engine - INFO - SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:22,257 - sqlalchemy.engine.Engine - INFO - [generated in 0.01027s] {'id_1': 11, 'param_1': 1}
2025-12-29 11:45:22,270 - sqlalchemy.engine.Engine - INFO - DELETE FROM alerts WHERE alerts.id = %(id)s
2025-12-29 11:45:22,273 - sqlalchemy.engine.Engine - INFO - [generated in 0.00271s] {'id': 11}
2025-12-29 11:45:22,280 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:45:22,285 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:45:22,289 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-29 11:45:22,299 - sqlalchemy.engine.Engine - INFO - [cached since 78.25s ago] {'pk_1': 1}
2025-12-29 11:45:22,304 - app.routers.alerts - INFO - Alert 11 deleted by admin
2025-12-29 11:45:22,308 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:45:22,333 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:45:22,336 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:22,348 - sqlalchemy.engine.Engine - INFO - [cached since 89.11s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:45:22,355 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:45:22,370 - sqlalchemy.engine.Engine - INFO - [cached since 88.92s ago] {}
2025-12-29 11:45:22,377 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:45:22,389 - sqlalchemy.engine.Engine - INFO - [cached since 88.9s ago] {}
2025-12-29 11:45:22,396 - sqlalchemy.engine.Engine - INFO - SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts ORDER BY alerts.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:45:22,404 - sqlalchemy.engine.Engine - INFO - [cached since 14.48s ago] {'param_1': 0, 'param_2': 20}
2025-12-29 11:45:22,411 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:22,420 - sqlalchemy.engine.Engine - INFO - [cached since 14.47s ago] {'pk_1': 13}
2025-12-29 11:45:22,425 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:22,435 - sqlalchemy.engine.Engine - INFO - [cached since 14.49s ago] {'pk_1': 14}
2025-12-29 11:45:22,440 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:22,448 - sqlalchemy.engine.Engine - INFO - [cached since 14.5s ago] {'pk_1': 7}
2025-12-29 11:45:22,453 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:22,464 - sqlalchemy.engine.Engine - INFO - [cached since 14.52s ago] {'pk_1': 8}
2025-12-29 11:45:22,469 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:22,480 - sqlalchemy.engine.Engine - INFO - [cached since 14.53s ago] {'pk_1': 9}
2025-12-29 11:45:22,485 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:22,495 - sqlalchemy.engine.Engine - INFO - [cached since 14.55s ago] {'pk_1': 10}
2025-12-29 11:45:22,501 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:22,510 - sqlalchemy.engine.Engine - INFO - [cached since 14.56s ago] {'pk_1': 11}
2025-12-29 11:45:22,520 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:45:28,518 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:45:28,521 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:28,531 - sqlalchemy.engine.Engine - INFO - [cached since 95.29s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:45:28,540 - sqlalchemy.engine.Engine - INFO - UPDATE alerts SET is_acknowledged=%(is_acknowledged)s, acknowledged_by=%(acknowledged_by)s, acknowledged_at=%(acknowledged_at)s WHERE alerts.is_acknowledged = false
2025-12-29 11:45:28,546 - sqlalchemy.engine.Engine - INFO - [generated in 0.00648s] {'is_acknowledged': 1, 'acknowledged_by': 1, 'acknowledged_at': datetime.datetime(2025, 12, 29, 6, 15, 28, 535651)}
2025-12-29 11:45:28,550 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:45:28,554 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:45:28,557 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-29 11:45:28,565 - sqlalchemy.engine.Engine - INFO - [cached since 84.52s ago] {'pk_1': 1}
2025-12-29 11:45:28,569 - app.routers.alerts - INFO - 0 alerts acknowledged by admin
2025-12-29 11:45:28,573 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:45:28,594 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:45:28,599 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:28,610 - sqlalchemy.engine.Engine - INFO - [cached since 95.37s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:45:28,617 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:45:28,626 - sqlalchemy.engine.Engine - INFO - [cached since 95.17s ago] {}
2025-12-29 11:45:28,633 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:45:28,642 - sqlalchemy.engine.Engine - INFO - [cached since 95.16s ago] {}
2025-12-29 11:45:28,649 - sqlalchemy.engine.Engine - INFO - SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts ORDER BY alerts.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:45:28,657 - sqlalchemy.engine.Engine - INFO - [cached since 20.73s ago] {'param_1': 0, 'param_2': 20}
2025-12-29 11:45:28,666 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:28,674 - sqlalchemy.engine.Engine - INFO - [cached since 20.72s ago] {'pk_1': 13}
2025-12-29 11:45:28,680 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:28,689 - sqlalchemy.engine.Engine - INFO - [cached since 20.74s ago] {'pk_1': 14}
2025-12-29 11:45:28,695 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:28,703 - sqlalchemy.engine.Engine - INFO - [cached since 20.75s ago] {'pk_1': 7}
2025-12-29 11:45:28,709 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:28,717 - sqlalchemy.engine.Engine - INFO - [cached since 20.77s ago] {'pk_1': 8}
2025-12-29 11:45:28,722 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:28,731 - sqlalchemy.engine.Engine - INFO - [cached since 20.78s ago] {'pk_1': 9}
2025-12-29 11:45:28,736 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:28,746 - sqlalchemy.engine.Engine - INFO - [cached since 20.8s ago] {'pk_1': 10}
2025-12-29 11:45:28,750 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:28,760 - sqlalchemy.engine.Engine - INFO - [cached since 20.81s ago] {'pk_1': 11}
2025-12-29 11:45:28,769 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:45:33,604 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:45:33,609 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:33,619 - sqlalchemy.engine.Engine - INFO - [cached since 100.4s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:45:33,632 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.alert_type = %(alert_type_1)s) AS anon_1
2025-12-29 11:45:33,643 - sqlalchemy.engine.Engine - INFO - [generated in 0.01142s] {'alert_type_1': <AlertType.NEW_DEVICE: 'new_device'>}
2025-12-29 11:45:33,649 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:45:33,659 - sqlalchemy.engine.Engine - INFO - [cached since 100.2s ago] {}
2025-12-29 11:45:33,664 - sqlalchemy.engine.Engine - INFO - SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.alert_type = %(alert_type_1)s ORDER BY alerts.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:45:33,674 - sqlalchemy.engine.Engine - INFO - [generated in 0.00957s] {'alert_type_1': <AlertType.NEW_DEVICE: 'new_device'>, 'param_1': 0, 'param_2': 20}
2025-12-29 11:45:33,684 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:33,694 - sqlalchemy.engine.Engine - INFO - [cached since 25.75s ago] {'pk_1': 13}
2025-12-29 11:45:33,699 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:33,709 - sqlalchemy.engine.Engine - INFO - [cached since 25.76s ago] {'pk_1': 14}
2025-12-29 11:45:33,714 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:33,725 - sqlalchemy.engine.Engine - INFO - [cached since 25.78s ago] {'pk_1': 7}
2025-12-29 11:45:33,731 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:33,738 - sqlalchemy.engine.Engine - INFO - [cached since 25.79s ago] {'pk_1': 8}
2025-12-29 11:45:33,744 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:33,754 - sqlalchemy.engine.Engine - INFO - [cached since 25.81s ago] {'pk_1': 9}
2025-12-29 11:45:33,760 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:33,768 - sqlalchemy.engine.Engine - INFO - [cached since 25.82s ago] {'pk_1': 10}
2025-12-29 11:45:33,772 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:33,781 - sqlalchemy.engine.Engine - INFO - [cached since 25.83s ago] {'pk_1': 11}
2025-12-29 11:45:33,789 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:45:36,907 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:45:36,917 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:36,953 - sqlalchemy.engine.Engine - INFO - [cached since 103.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:45:37,003 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.alert_type = %(alert_type_1)s AND alerts.severity = %(severity_1)s) AS anon_1
2025-12-29 11:45:37,028 - sqlalchemy.engine.Engine - INFO - [generated in 0.02476s] {'alert_type_1': <AlertType.NEW_DEVICE: 'new_device'>, 'severity_1': <AlertSeverity.HIGH: 'high'>}
2025-12-29 11:45:37,037 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:45:37,048 - sqlalchemy.engine.Engine - INFO - [cached since 103.6s ago] {}
2025-12-29 11:45:37,054 - sqlalchemy.engine.Engine - INFO - SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.alert_type = %(alert_type_1)s AND alerts.severity = %(severity_1)s ORDER BY alerts.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:45:37,066 - sqlalchemy.engine.Engine - INFO - [generated in 0.01216s] {'alert_type_1': <AlertType.NEW_DEVICE: 'new_device'>, 'severity_1': <AlertSeverity.HIGH: 'high'>, 'param_1': 0, 'param_2': 20}
2025-12-29 11:45:37,077 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:45:39,051 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:45:39,054 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:39,065 - sqlalchemy.engine.Engine - INFO - [cached since 105.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:45:39,071 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.alert_type = %(alert_type_1)s) AS anon_1
2025-12-29 11:45:39,084 - sqlalchemy.engine.Engine - INFO - [cached since 5.452s ago] {'alert_type_1': <AlertType.NEW_DEVICE: 'new_device'>}
2025-12-29 11:45:39,091 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:45:39,102 - sqlalchemy.engine.Engine - INFO - [cached since 105.6s ago] {}
2025-12-29 11:45:39,109 - sqlalchemy.engine.Engine - INFO - SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.alert_type = %(alert_type_1)s ORDER BY alerts.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:45:39,119 - sqlalchemy.engine.Engine - INFO - [cached since 5.455s ago] {'alert_type_1': <AlertType.NEW_DEVICE: 'new_device'>, 'param_1': 0, 'param_2': 20}
2025-12-29 11:45:39,127 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:39,135 - sqlalchemy.engine.Engine - INFO - [cached since 31.19s ago] {'pk_1': 13}
2025-12-29 11:45:39,141 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:39,150 - sqlalchemy.engine.Engine - INFO - [cached since 31.2s ago] {'pk_1': 14}
2025-12-29 11:45:39,158 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:39,169 - sqlalchemy.engine.Engine - INFO - [cached since 31.22s ago] {'pk_1': 7}
2025-12-29 11:45:39,174 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:39,182 - sqlalchemy.engine.Engine - INFO - [cached since 31.23s ago] {'pk_1': 8}
2025-12-29 11:45:39,187 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:39,198 - sqlalchemy.engine.Engine - INFO - [cached since 31.25s ago] {'pk_1': 9}
2025-12-29 11:45:39,204 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:39,214 - sqlalchemy.engine.Engine - INFO - [cached since 31.27s ago] {'pk_1': 10}
2025-12-29 11:45:39,220 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:45:39,229 - sqlalchemy.engine.Engine - INFO - [cached since 31.28s ago] {'pk_1': 11}
2025-12-29 11:45:39,236 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:45:40,316 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:45:40,334 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:40,420 - sqlalchemy.engine.Engine - INFO - [cached since 107.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:45:40,438 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:45:40,480 - sqlalchemy.engine.Engine - INFO - [cached since 107.1s ago] {}
2025-12-29 11:45:40,487 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:45:40,513 - sqlalchemy.engine.Engine - INFO - [cached since 107.1s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 5, 40, 486224)}
2025-12-29 11:45:40,522 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:45:40,537 - sqlalchemy.engine.Engine - INFO - [cached since 107.1s ago] {}
2025-12-29 11:45:40,549 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:45:40,553 - sqlalchemy.engine.Engine - INFO - [cached since 107.1s ago] {}
2025-12-29 11:45:40,564 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:45:40,570 - sqlalchemy.engine.Engine - INFO - [cached since 107.1s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:45:40,582 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:45:40,588 - sqlalchemy.engine.Engine - INFO - [cached since 107.1s ago] {}
2025-12-29 11:45:40,597 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:45:40,603 - sqlalchemy.engine.Engine - INFO - [cached since 107.1s ago] {}
2025-12-29 11:45:40,614 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:45:40,629 - sqlalchemy.engine.Engine - INFO - [cached since 107.1s ago] {'status_1': 'completed'}
2025-12-29 11:45:40,634 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:45:40,654 - sqlalchemy.engine.Engine - INFO - [cached since 107.1s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:45:40,665 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:45:40,669 - sqlalchemy.engine.Engine - INFO - [cached since 107.1s ago] {}
2025-12-29 11:45:40,681 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:45:40,726 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:45:40,733 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:40,751 - sqlalchemy.engine.Engine - INFO - [cached since 107.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:45:40,772 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:40,786 - sqlalchemy.engine.Engine - INFO - [cached since 107.1s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:45:40,797 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:45:40,813 - sqlalchemy.engine.Engine - INFO - [cached since 107.1s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 22, 6, 15, 40, 795838), 'param_1': 100}
2025-12-29 11:45:40,825 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s AND scan_results.scan_timestamp >= %(scan_timestamp_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:45:40,842 - sqlalchemy.engine.Engine - INFO - [cached since 107.1s ago] {'device_id_1': 7, 'scan_timestamp_1': datetime.datetime(2025, 12, 22, 6, 15, 40, 795838), 'param_1': 100}
2025-12-29 11:45:40,853 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:45:40,871 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:45:40,878 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:40,884 - sqlalchemy.engine.Engine - INFO - [cached since 107.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:45:40,889 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:45:40,901 - sqlalchemy.engine.Engine - INFO - [cached since 107.6s ago] {}
2025-12-29 11:45:40,907 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:45:40,920 - sqlalchemy.engine.Engine - INFO - [cached since 107.5s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 5, 40, 904564)}
2025-12-29 11:45:40,931 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:45:40,950 - sqlalchemy.engine.Engine - INFO - [cached since 107.6s ago] {}
2025-12-29 11:45:40,956 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:45:40,977 - sqlalchemy.engine.Engine - INFO - [cached since 107.6s ago] {}
2025-12-29 11:45:40,983 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:45:40,999 - sqlalchemy.engine.Engine - INFO - [cached since 107.6s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:45:41,004 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:45:41,020 - sqlalchemy.engine.Engine - INFO - [cached since 107.6s ago] {}
2025-12-29 11:45:41,033 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:45:41,049 - sqlalchemy.engine.Engine - INFO - [cached since 107.6s ago] {}
2025-12-29 11:45:41,054 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:45:41,082 - sqlalchemy.engine.Engine - INFO - [cached since 107.6s ago] {'status_1': 'completed'}
2025-12-29 11:45:41,090 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:45:41,117 - sqlalchemy.engine.Engine - INFO - [cached since 107.6s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:45:41,126 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:45:41,131 - sqlalchemy.engine.Engine - INFO - [cached since 107.6s ago] {}
2025-12-29 11:45:41,142 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:45:41,180 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:45:41,182 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:41,189 - sqlalchemy.engine.Engine - INFO - [cached since 107.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:45:41,197 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:45:41,204 - sqlalchemy.engine.Engine - INFO - [cached since 107.2s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 28, 6, 15, 41, 195761), 'param_1': 100}
2025-12-29 11:45:41,212 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:41,221 - sqlalchemy.engine.Engine - INFO - [cached since 107.6s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:45:41,228 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:41,237 - sqlalchemy.engine.Engine - INFO - [cached since 107.6s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:45:41,243 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:41,260 - sqlalchemy.engine.Engine - INFO - [cached since 107.6s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:45:41,264 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:41,271 - sqlalchemy.engine.Engine - INFO - [cached since 107.6s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:45:41,277 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:41,285 - sqlalchemy.engine.Engine - INFO - [cached since 107.6s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:45:41,290 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:41,298 - sqlalchemy.engine.Engine - INFO - [cached since 107.6s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:45:41,302 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:41,313 - sqlalchemy.engine.Engine - INFO - [cached since 107.7s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:45:41,318 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:41,329 - sqlalchemy.engine.Engine - INFO - [cached since 107.7s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:45:41,334 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:41,347 - sqlalchemy.engine.Engine - INFO - [cached since 107.7s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:45:41,352 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:41,362 - sqlalchemy.engine.Engine - INFO - [cached since 107.7s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:45:41,366 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:41,378 - sqlalchemy.engine.Engine - INFO - [cached since 107.7s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:45:41,383 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:41,395 - sqlalchemy.engine.Engine - INFO - [cached since 107.7s ago] {'id_1': 13, 'param_1': 1}
2025-12-29 11:45:41,401 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:41,412 - sqlalchemy.engine.Engine - INFO - [cached since 107.8s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:45:41,418 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:41,431 - sqlalchemy.engine.Engine - INFO - [cached since 107.8s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:45:41,439 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:41,451 - sqlalchemy.engine.Engine - INFO - [cached since 107.8s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:45:41,457 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:41,467 - sqlalchemy.engine.Engine - INFO - [cached since 107.8s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:45:41,475 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:41,485 - sqlalchemy.engine.Engine - INFO - [cached since 107.8s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:45:41,495 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:41,502 - sqlalchemy.engine.Engine - INFO - [cached since 107.8s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:45:41,511 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:45:42,520 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:45:42,530 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:42,537 - sqlalchemy.engine.Engine - INFO - [cached since 109.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:45:42,548 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:45:42,561 - sqlalchemy.engine.Engine - INFO - [cached since 109.2s ago] {}
2025-12-29 11:45:42,564 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:45:42,578 - sqlalchemy.engine.Engine - INFO - [cached since 104.4s ago] {'param_1': 0, 'param_2': 20}
2025-12-29 11:45:42,583 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:45:42,596 - sqlalchemy.engine.Engine - INFO - [cached since 104.4s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:45:42,602 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:45:42,616 - sqlalchemy.engine.Engine - INFO - [cached since 104.4s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:45:42,621 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:45:42,633 - sqlalchemy.engine.Engine - INFO - [cached since 104.4s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:45:42,637 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:45:42,650 - sqlalchemy.engine.Engine - INFO - [cached since 104.5s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:45:42,657 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:45:42,666 - sqlalchemy.engine.Engine - INFO - [cached since 104.5s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:45:42,672 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:45:42,683 - sqlalchemy.engine.Engine - INFO - [cached since 104.5s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:45:42,688 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:45:42,699 - sqlalchemy.engine.Engine - INFO - [cached since 104.5s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:45:42,704 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:45:42,716 - sqlalchemy.engine.Engine - INFO - [cached since 104.5s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-29 11:45:42,726 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:45:43,804 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:45:43,811 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:43,832 - sqlalchemy.engine.Engine - INFO - [cached since 110.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:45:43,839 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:45:43,862 - sqlalchemy.engine.Engine - INFO - [cached since 110.3s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:45:43,870 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:45:43,891 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:45:43,895 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:45:43,899 - sqlalchemy.engine.Engine - INFO - [cached since 110.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:45:43,912 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:46:07,515 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:46:07,522 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:07,530 - sqlalchemy.engine.Engine - INFO - [cached since 134.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:46:07,543 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-29 11:46:07,553 - sqlalchemy.engine.Engine - INFO - [cached since 123.6s ago] {'started_at': datetime.datetime(2025, 12, 29, 6, 16, 7, 543177), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'full', 'network_range': '10.41.243.0/24', 'status': 'running', 'error_message': None}
2025-12-29 11:46:07,562 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:46:07,570 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:46:07,572 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-29 11:46:07,578 - sqlalchemy.engine.Engine - INFO - [cached since 123.5s ago] {'pk_1': 34}
2025-12-29 11:46:07,585 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-29 11:46:07,592 - sqlalchemy.engine.Engine - INFO - [cached since 123.5s ago] {'pk_1': 1}
2025-12-29 11:46:07,596 - app.routers.scans - INFO - Scan started by admin: 34
2025-12-29 11:46:07,602 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:07,612 - sqlalchemy.engine.Engine - INFO - [cached since 123.5s ago] {'id_1': 34, 'param_1': 1}
2025-12-29 11:46:07,621 - app.services.scanner - INFO - Starting ARP scan on 10.41.243.0/24
2025-12-29 11:46:07,625 - app.services.scanner - INFO - Starting fallback scan on 10.41.243.0/24 (ping + ARP table)
2025-12-29 11:46:39,377 - app.services.scanner - INFO - Fallback scan complete: 8 devices found
2025-12-29 11:46:39,381 - app.services.scanner - INFO - Starting ICMP scan on 254 hosts
2025-12-29 11:46:43,273 - app.services.scanner - INFO - ICMP scan complete: 0 hosts responding
2025-12-29 11:46:43,280 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:43,297 - sqlalchemy.engine.Engine - INFO - [cached since 127.2s ago] {'mac_address_1': '96:A4:CB:4D:96:A9', 'param_1': 1}
2025-12-29 11:46:43,303 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:46:43,317 - sqlalchemy.engine.Engine - INFO - [cached since 165.1s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:46:43,324 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:43,338 - sqlalchemy.engine.Engine - INFO - [cached since 127.2s ago] {'mac_address_1': 'FF:FF:FF:FF:FF:FF', 'param_1': 1}
2025-12-29 11:46:43,348 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:46:43,362 - sqlalchemy.engine.Engine - INFO - [cached since 165.2s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:46:43,370 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:43,397 - sqlalchemy.engine.Engine - INFO - [cached since 127.3s ago] {'mac_address_1': '01:00:5E:00:00:16', 'param_1': 1}
2025-12-29 11:46:43,405 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:46:43,418 - sqlalchemy.engine.Engine - INFO - [cached since 165.2s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:46:43,427 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:43,440 - sqlalchemy.engine.Engine - INFO - [cached since 127.3s ago] {'mac_address_1': '01:00:5E:00:00:FB', 'param_1': 1}
2025-12-29 11:46:43,450 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:46:43,463 - sqlalchemy.engine.Engine - INFO - [cached since 165.3s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:46:43,469 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:43,484 - sqlalchemy.engine.Engine - INFO - [cached since 127.4s ago] {'mac_address_1': '01:00:5E:00:00:FC', 'param_1': 1}
2025-12-29 11:46:43,490 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:46:43,505 - sqlalchemy.engine.Engine - INFO - [cached since 165.3s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:46:43,516 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:43,531 - sqlalchemy.engine.Engine - INFO - [cached since 127.4s ago] {'mac_address_1': '01:00:5E:7F:66:12', 'param_1': 1}
2025-12-29 11:46:43,538 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:46:43,563 - sqlalchemy.engine.Engine - INFO - [cached since 165.4s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:46:43,572 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:43,595 - sqlalchemy.engine.Engine - INFO - [cached since 127.5s ago] {'mac_address_1': '01:00:5E:7F:FF:FA', 'param_1': 1}
2025-12-29 11:46:43,603 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:46:43,616 - sqlalchemy.engine.Engine - INFO - [cached since 165.4s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:46:43,625 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:43,636 - sqlalchemy.engine.Engine - INFO - [cached since 127.5s ago] {'mac_address_1': 'FF:FF:FF:FF:FF:FF', 'param_1': 1}
2025-12-29 11:46:43,643 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:46:43,651 - sqlalchemy.engine.Engine - INFO - [cached since 165.5s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:46:43,660 - sqlalchemy.engine.Engine - INFO - UPDATE devices SET last_seen=%(last_seen)s WHERE devices.id = %(devices_id)s
2025-12-29 11:46:43,665 - sqlalchemy.engine.Engine - INFO - [cached since 127.1s ago] [{'last_seen': datetime.datetime(2025, 12, 29, 6, 16, 43, 322198), 'devices_id': 8}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 16, 43, 656486), 'devices_id': 9}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 16, 43, 423774), 'devices_id': 10}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 16, 43, 468337), 'devices_id': 11}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 16, 43, 514367), 'devices_id': 12}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 16, 43, 570904), 'devices_id': 13}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 16, 43, 622597), 'devices_id': 14}]
2025-12-29 11:46:43,694 - sqlalchemy.engine.Engine - INFO - UPDATE scan_sessions SET completed_at=%(completed_at)s, total_devices_found=%(total_devices_found)s, status=%(status)s WHERE scan_sessions.id = %(scan_sessions_id)s
2025-12-29 11:46:43,698 - sqlalchemy.engine.Engine - INFO - [cached since 127.1s ago] {'completed_at': datetime.datetime(2025, 12, 29, 6, 16, 43, 657536), 'total_devices_found': 8, 'status': 'completed', 'scan_sessions_id': 34}
2025-12-29 11:46:43,704 - sqlalchemy.engine.Engine - INFO - INSERT INTO device_activity (device_id, event_type, old_value, new_value, event_timestamp) VALUES (%(device_id)s, %(event_type)s, %(old_value)s, %(new_value)s, %(event_timestamp)s)
2025-12-29 11:46:43,714 - sqlalchemy.engine.Engine - INFO - [cached since 127.1s ago] {'device_id': 9, 'event_type': 'ip_changed', 'old_value': '255.255.255.255', 'new_value': '10.41.243.255', 'event_timestamp': datetime.datetime(2025, 12, 29, 6, 16, 43, 704777)}
2025-12-29 11:46:43,722 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:46:43,730 - sqlalchemy.engine.Engine - INFO - [cached since 127.1s ago] {'device_id': 8, 'ip_address': '10.41.243.123', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 16, 43, 722160), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:46:43,736 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:46:43,747 - sqlalchemy.engine.Engine - INFO - [cached since 127.1s ago] {'device_id': 9, 'ip_address': '10.41.243.255', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 16, 43, 736288), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:46:43,753 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:46:43,761 - sqlalchemy.engine.Engine - INFO - [cached since 127.1s ago] {'device_id': 10, 'ip_address': '224.0.0.22', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 16, 43, 752936), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:46:43,767 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:46:43,772 - sqlalchemy.engine.Engine - INFO - [cached since 127.1s ago] {'device_id': 11, 'ip_address': '224.0.0.251', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 16, 43, 767420), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:46:43,784 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:46:43,789 - sqlalchemy.engine.Engine - INFO - [cached since 127.1s ago] {'device_id': 12, 'ip_address': '224.0.0.252', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 16, 43, 784436), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:46:43,799 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:46:43,811 - sqlalchemy.engine.Engine - INFO - [cached since 127.2s ago] {'device_id': 13, 'ip_address': '239.255.102.18', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 16, 43, 799570), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:46:43,829 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:46:43,834 - sqlalchemy.engine.Engine - INFO - [cached since 127.2s ago] {'device_id': 14, 'ip_address': '239.255.255.250', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 16, 43, 829655), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:46:43,844 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:46:43,850 - sqlalchemy.engine.Engine - INFO - [cached since 127.2s ago] {'device_id': 9, 'ip_address': '255.255.255.255', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 16, 43, 844612), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:46:43,862 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:46:43,868 - app.routers.scans - INFO - Scan completed: 8 devices, 0 new
2025-12-29 11:46:44,187 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:46:44,190 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:44,202 - sqlalchemy.engine.Engine - INFO - [cached since 171s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:46:44,210 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:46:44,218 - sqlalchemy.engine.Engine - INFO - [cached since 170.9s ago] {}
2025-12-29 11:46:44,224 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:46:44,232 - sqlalchemy.engine.Engine - INFO - [cached since 170.9s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 6, 44, 222206)}
2025-12-29 11:46:44,241 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:46:44,252 - sqlalchemy.engine.Engine - INFO - [cached since 170.9s ago] {}
2025-12-29 11:46:44,258 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:46:44,270 - sqlalchemy.engine.Engine - INFO - [cached since 170.9s ago] {}
2025-12-29 11:46:44,277 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:46:44,287 - sqlalchemy.engine.Engine - INFO - [cached since 170.9s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:46:44,294 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:46:44,304 - sqlalchemy.engine.Engine - INFO - [cached since 170.8s ago] {}
2025-12-29 11:46:44,311 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:46:44,321 - sqlalchemy.engine.Engine - INFO - [cached since 170.8s ago] {}
2025-12-29 11:46:44,328 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:46:44,339 - sqlalchemy.engine.Engine - INFO - [cached since 170.8s ago] {'status_1': 'completed'}
2025-12-29 11:46:44,346 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:46:44,356 - sqlalchemy.engine.Engine - INFO - [cached since 170.8s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:46:44,364 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:46:44,367 - sqlalchemy.engine.Engine - INFO - [cached since 170.8s ago] {}
2025-12-29 11:46:44,374 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:46:44,392 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:46:44,395 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:44,398 - sqlalchemy.engine.Engine - INFO - [cached since 171.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:46:44,403 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:44,410 - sqlalchemy.engine.Engine - INFO - [cached since 170.8s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:46:44,416 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:46:44,427 - sqlalchemy.engine.Engine - INFO - [cached since 170.7s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 22, 6, 16, 44, 415194), 'param_1': 100}
2025-12-29 11:46:44,436 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s AND scan_results.scan_timestamp >= %(scan_timestamp_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:46:44,451 - sqlalchemy.engine.Engine - INFO - [cached since 170.7s ago] {'device_id_1': 7, 'scan_timestamp_1': datetime.datetime(2025, 12, 22, 6, 16, 44, 415194), 'param_1': 100}
2025-12-29 11:46:44,462 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:46:44,478 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:46:44,481 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:44,489 - sqlalchemy.engine.Engine - INFO - [cached since 171.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:46:44,499 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:46:44,510 - sqlalchemy.engine.Engine - INFO - [cached since 171.2s ago] {}
2025-12-29 11:46:44,514 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:46:44,526 - sqlalchemy.engine.Engine - INFO - [cached since 171.2s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 6, 44, 513496)}
2025-12-29 11:46:44,533 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:46:44,546 - sqlalchemy.engine.Engine - INFO - [cached since 171.2s ago] {}
2025-12-29 11:46:44,551 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:46:44,562 - sqlalchemy.engine.Engine - INFO - [cached since 171.2s ago] {}
2025-12-29 11:46:44,567 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:46:44,579 - sqlalchemy.engine.Engine - INFO - [cached since 171.1s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:46:44,585 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:46:44,596 - sqlalchemy.engine.Engine - INFO - [cached since 171.1s ago] {}
2025-12-29 11:46:44,601 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:46:44,610 - sqlalchemy.engine.Engine - INFO - [cached since 171.1s ago] {}
2025-12-29 11:46:44,615 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:46:44,629 - sqlalchemy.engine.Engine - INFO - [cached since 171.1s ago] {'status_1': 'completed'}
2025-12-29 11:46:44,635 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:46:44,648 - sqlalchemy.engine.Engine - INFO - [cached since 171.1s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:46:44,654 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:46:44,659 - sqlalchemy.engine.Engine - INFO - [cached since 171.1s ago] {}
2025-12-29 11:46:44,668 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:46:44,688 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:46:44,691 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:44,697 - sqlalchemy.engine.Engine - INFO - [cached since 171.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:46:44,703 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:46:44,713 - sqlalchemy.engine.Engine - INFO - [cached since 170.7s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 28, 6, 16, 44, 702567), 'param_1': 100}
2025-12-29 11:46:44,721 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:44,733 - sqlalchemy.engine.Engine - INFO - [cached since 171.1s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:46:44,740 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:44,749 - sqlalchemy.engine.Engine - INFO - [cached since 171.1s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:46:44,756 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:44,768 - sqlalchemy.engine.Engine - INFO - [cached since 171.1s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:46:44,776 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:44,785 - sqlalchemy.engine.Engine - INFO - [cached since 171.1s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:46:44,792 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:44,801 - sqlalchemy.engine.Engine - INFO - [cached since 171.1s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:46:44,809 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:44,827 - sqlalchemy.engine.Engine - INFO - [cached since 171.2s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:46:44,833 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:44,845 - sqlalchemy.engine.Engine - INFO - [cached since 171.2s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:46:44,850 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:44,860 - sqlalchemy.engine.Engine - INFO - [cached since 171.2s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:46:44,865 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:44,877 - sqlalchemy.engine.Engine - INFO - [cached since 171.2s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:46:44,882 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:44,893 - sqlalchemy.engine.Engine - INFO - [cached since 171.2s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:46:44,900 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:44,911 - sqlalchemy.engine.Engine - INFO - [cached since 171.3s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:46:44,916 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:44,927 - sqlalchemy.engine.Engine - INFO - [cached since 171.3s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:46:44,933 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:44,945 - sqlalchemy.engine.Engine - INFO - [cached since 171.3s ago] {'id_1': 13, 'param_1': 1}
2025-12-29 11:46:44,952 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:44,962 - sqlalchemy.engine.Engine - INFO - [cached since 171.3s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:46:44,968 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:44,980 - sqlalchemy.engine.Engine - INFO - [cached since 171.3s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:46:44,986 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:44,999 - sqlalchemy.engine.Engine - INFO - [cached since 171.3s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:46:45,005 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:45,013 - sqlalchemy.engine.Engine - INFO - [cached since 171.4s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:46:45,019 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:45,031 - sqlalchemy.engine.Engine - INFO - [cached since 171.4s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:46:45,043 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:45,057 - sqlalchemy.engine.Engine - INFO - [cached since 171.4s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:46:45,069 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:46:45,230 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:46:45,232 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:45,244 - sqlalchemy.engine.Engine - INFO - [cached since 172s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:46:45,249 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:46:45,259 - sqlalchemy.engine.Engine - INFO - [cached since 171.9s ago] {}
2025-12-29 11:46:45,265 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:46:45,282 - sqlalchemy.engine.Engine - INFO - [cached since 171.9s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 6, 45, 263920)}
2025-12-29 11:46:45,291 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:46:45,305 - sqlalchemy.engine.Engine - INFO - [cached since 171.9s ago] {}
2025-12-29 11:46:45,313 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:46:45,322 - sqlalchemy.engine.Engine - INFO - [cached since 171.9s ago] {}
2025-12-29 11:46:45,330 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:46:45,342 - sqlalchemy.engine.Engine - INFO - [cached since 171.9s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:46:45,347 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:46:45,360 - sqlalchemy.engine.Engine - INFO - [cached since 171.9s ago] {}
2025-12-29 11:46:45,364 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:46:45,378 - sqlalchemy.engine.Engine - INFO - [cached since 171.9s ago] {}
2025-12-29 11:46:45,383 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:46:45,407 - sqlalchemy.engine.Engine - INFO - [cached since 171.9s ago] {'status_1': 'completed'}
2025-12-29 11:46:45,416 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:46:45,436 - sqlalchemy.engine.Engine - INFO - [cached since 171.9s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:46:45,443 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:46:45,447 - sqlalchemy.engine.Engine - INFO - [cached since 171.9s ago] {}
2025-12-29 11:46:45,454 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:46:45,560 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:46:45,563 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:45,571 - sqlalchemy.engine.Engine - INFO - [cached since 172.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:46:45,578 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:45,586 - sqlalchemy.engine.Engine - INFO - [cached since 171.9s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:46:45,594 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:46:45,604 - sqlalchemy.engine.Engine - INFO - [cached since 171.9s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 22, 6, 16, 45, 592516), 'param_1': 100}
2025-12-29 11:46:45,612 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s AND scan_results.scan_timestamp >= %(scan_timestamp_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:46:45,622 - sqlalchemy.engine.Engine - INFO - [cached since 171.9s ago] {'device_id_1': 7, 'scan_timestamp_1': datetime.datetime(2025, 12, 22, 6, 16, 45, 592516), 'param_1': 100}
2025-12-29 11:46:45,632 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:46:45,688 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:46:45,693 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:45,700 - sqlalchemy.engine.Engine - INFO - [cached since 172.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:46:45,706 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:46:45,716 - sqlalchemy.engine.Engine - INFO - [cached since 172.4s ago] {}
2025-12-29 11:46:45,722 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:46:45,733 - sqlalchemy.engine.Engine - INFO - [cached since 172.4s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 6, 45, 720729)}
2025-12-29 11:46:45,742 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:46:45,751 - sqlalchemy.engine.Engine - INFO - [cached since 172.4s ago] {}
2025-12-29 11:46:45,756 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:46:45,770 - sqlalchemy.engine.Engine - INFO - [cached since 172.4s ago] {}
2025-12-29 11:46:45,777 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:46:45,788 - sqlalchemy.engine.Engine - INFO - [cached since 172.4s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:46:45,795 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:46:45,810 - sqlalchemy.engine.Engine - INFO - [cached since 172.4s ago] {}
2025-12-29 11:46:45,814 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:46:45,826 - sqlalchemy.engine.Engine - INFO - [cached since 172.3s ago] {}
2025-12-29 11:46:45,832 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:46:45,848 - sqlalchemy.engine.Engine - INFO - [cached since 172.3s ago] {'status_1': 'completed'}
2025-12-29 11:46:45,854 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:46:45,866 - sqlalchemy.engine.Engine - INFO - [cached since 172.3s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:46:45,877 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:46:45,882 - sqlalchemy.engine.Engine - INFO - [cached since 172.3s ago] {}
2025-12-29 11:46:45,891 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:46:46,216 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:46:46,218 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:46,225 - sqlalchemy.engine.Engine - INFO - [cached since 173s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:46:46,232 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:46:46,248 - sqlalchemy.engine.Engine - INFO - [cached since 172.2s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 28, 6, 16, 46, 231827), 'param_1': 100}
2025-12-29 11:46:46,257 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:46,267 - sqlalchemy.engine.Engine - INFO - [cached since 172.6s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:46:46,274 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:46,287 - sqlalchemy.engine.Engine - INFO - [cached since 172.6s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:46:46,300 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:46,314 - sqlalchemy.engine.Engine - INFO - [cached since 172.7s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:46:46,320 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:46,334 - sqlalchemy.engine.Engine - INFO - [cached since 172.7s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:46:46,342 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:46,353 - sqlalchemy.engine.Engine - INFO - [cached since 172.7s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:46:46,363 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:46,373 - sqlalchemy.engine.Engine - INFO - [cached since 172.7s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:46:46,380 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:46,394 - sqlalchemy.engine.Engine - INFO - [cached since 172.7s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:46:46,400 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:46,412 - sqlalchemy.engine.Engine - INFO - [cached since 172.8s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:46:46,418 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:46,428 - sqlalchemy.engine.Engine - INFO - [cached since 172.8s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:46:46,433 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:46,444 - sqlalchemy.engine.Engine - INFO - [cached since 172.8s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:46:46,450 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:46,468 - sqlalchemy.engine.Engine - INFO - [cached since 172.8s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:46:46,476 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:46,489 - sqlalchemy.engine.Engine - INFO - [cached since 172.8s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:46:46,497 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:46,512 - sqlalchemy.engine.Engine - INFO - [cached since 172.9s ago] {'id_1': 13, 'param_1': 1}
2025-12-29 11:46:46,522 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:46,537 - sqlalchemy.engine.Engine - INFO - [cached since 172.9s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:46:46,548 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:46,563 - sqlalchemy.engine.Engine - INFO - [cached since 172.9s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:46:46,569 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:46,585 - sqlalchemy.engine.Engine - INFO - [cached since 172.9s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:46:46,597 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:46,605 - sqlalchemy.engine.Engine - INFO - [cached since 173s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:46:46,613 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:46,622 - sqlalchemy.engine.Engine - INFO - [cached since 173s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:46:46,629 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:46:46,638 - sqlalchemy.engine.Engine - INFO - [cached since 173s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:46:46,648 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:47:03,031 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:47:03,061 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:03,084 - sqlalchemy.engine.Engine - INFO - [cached since 189.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:47:03,096 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:47:03,108 - sqlalchemy.engine.Engine - INFO - [cached since 189.8s ago] {}
2025-12-29 11:47:03,112 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:47:03,125 - sqlalchemy.engine.Engine - INFO - [cached since 185s ago] {'param_1': 0, 'param_2': 20}
2025-12-29 11:47:03,134 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:47:03,159 - sqlalchemy.engine.Engine - INFO - [cached since 185s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:47:03,167 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:47:03,189 - sqlalchemy.engine.Engine - INFO - [cached since 185s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:47:03,194 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:47:03,205 - sqlalchemy.engine.Engine - INFO - [cached since 185s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:47:03,210 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:47:03,222 - sqlalchemy.engine.Engine - INFO - [cached since 185s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:47:03,227 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:47:03,234 - sqlalchemy.engine.Engine - INFO - [cached since 185s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:47:03,239 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:47:03,250 - sqlalchemy.engine.Engine - INFO - [cached since 185.1s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:47:03,257 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:47:03,266 - sqlalchemy.engine.Engine - INFO - [cached since 185.1s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:47:03,272 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:47:03,280 - sqlalchemy.engine.Engine - INFO - [cached since 185.1s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-29 11:47:03,288 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:47:06,415 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:47:06,431 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:06,461 - sqlalchemy.engine.Engine - INFO - [cached since 193.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:47:06,471 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:06,482 - sqlalchemy.engine.Engine - INFO - [cached since 192.8s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:47:06,492 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:47:06,500 - sqlalchemy.engine.Engine - INFO - [cached since 146.2s ago] {'device_id_1': 7}
2025-12-29 11:47:06,506 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:47:06,515 - sqlalchemy.engine.Engine - INFO - [cached since 146.2s ago] {'device_id_1': 7}
2025-12-29 11:47:06,579 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:47:23,476 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:47:23,479 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:23,494 - sqlalchemy.engine.Engine - INFO - [cached since 210.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:47:23,510 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:47:38,955 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:47:38,964 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.username = %(username_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:38,977 - sqlalchemy.engine.Engine - INFO - [generated in 0.01391s] {'username_1': 'admin', 'param_1': 1}
2025-12-29 11:47:39,717 - sqlalchemy.engine.Engine - INFO - UPDATE users SET last_login=%(last_login)s WHERE users.id = %(users_id)s
2025-12-29 11:47:39,721 - sqlalchemy.engine.Engine - INFO - [generated in 0.00387s] {'last_login': datetime.datetime(2025, 12, 29, 6, 17, 39, 715493), 'users_id': 1}
2025-12-29 11:47:39,733 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:47:39,738 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:47:39,740 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-29 11:47:39,745 - sqlalchemy.engine.Engine - INFO - [cached since 215.7s ago] {'pk_1': 1}
2025-12-29 11:47:39,750 - app.routers.auth - INFO - User logged in: admin
2025-12-29 11:47:39,753 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:47:39,771 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:47:39,774 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:39,782 - sqlalchemy.engine.Engine - INFO - [cached since 226.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:47:39,790 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:47:39,838 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:47:39,848 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:39,858 - sqlalchemy.engine.Engine - INFO - [cached since 226.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:47:39,868 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:47:39,882 - sqlalchemy.engine.Engine - INFO - [cached since 226.5s ago] {}
2025-12-29 11:47:39,888 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:47:39,901 - sqlalchemy.engine.Engine - INFO - [cached since 226.5s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 7, 39, 887006)}
2025-12-29 11:47:39,907 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:47:39,919 - sqlalchemy.engine.Engine - INFO - [cached since 226.5s ago] {}
2025-12-29 11:47:39,924 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:47:39,936 - sqlalchemy.engine.Engine - INFO - [cached since 226.5s ago] {}
2025-12-29 11:47:39,941 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:47:39,951 - sqlalchemy.engine.Engine - INFO - [cached since 226.5s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:47:39,956 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:47:39,969 - sqlalchemy.engine.Engine - INFO - [cached since 226.5s ago] {}
2025-12-29 11:47:39,976 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:47:39,991 - sqlalchemy.engine.Engine - INFO - [cached since 226.5s ago] {}
2025-12-29 11:47:40,002 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:47:40,015 - sqlalchemy.engine.Engine - INFO - [cached since 226.5s ago] {'status_1': 'completed'}
2025-12-29 11:47:40,020 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:47:40,035 - sqlalchemy.engine.Engine - INFO - [cached since 226.5s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:47:40,040 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:47:40,047 - sqlalchemy.engine.Engine - INFO - [cached since 226.5s ago] {}
2025-12-29 11:47:40,054 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:47:40,073 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:47:40,075 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:40,084 - sqlalchemy.engine.Engine - INFO - [cached since 226.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:47:40,090 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:40,102 - sqlalchemy.engine.Engine - INFO - [cached since 226.4s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:47:40,108 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:47:40,121 - sqlalchemy.engine.Engine - INFO - [cached since 226.4s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 22, 6, 17, 40, 106829), 'param_1': 100}
2025-12-29 11:47:40,128 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s AND scan_results.scan_timestamp >= %(scan_timestamp_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:47:40,143 - sqlalchemy.engine.Engine - INFO - [cached since 226.4s ago] {'device_id_1': 7, 'scan_timestamp_1': datetime.datetime(2025, 12, 22, 6, 17, 40, 106829), 'param_1': 100}
2025-12-29 11:47:40,156 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:47:40,165 - app.services.notification - INFO - WebSocket client registered. Total: 3
2025-12-29 11:47:40,168 - app.main - INFO - WebSocket client connected
2025-12-29 11:47:40,181 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:47:40,184 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:40,190 - sqlalchemy.engine.Engine - INFO - [cached since 226.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:47:40,196 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:47:40,202 - sqlalchemy.engine.Engine - INFO - [cached since 226.9s ago] {}
2025-12-29 11:47:40,206 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:47:40,217 - sqlalchemy.engine.Engine - INFO - [cached since 226.8s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 7, 40, 205640)}
2025-12-29 11:47:40,223 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:47:40,233 - sqlalchemy.engine.Engine - INFO - [cached since 226.8s ago] {}
2025-12-29 11:47:40,236 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:47:40,246 - sqlalchemy.engine.Engine - INFO - [cached since 226.8s ago] {}
2025-12-29 11:47:40,250 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:47:40,256 - sqlalchemy.engine.Engine - INFO - [cached since 226.8s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:47:40,260 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:47:40,268 - sqlalchemy.engine.Engine - INFO - [cached since 226.8s ago] {}
2025-12-29 11:47:40,271 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:47:40,281 - sqlalchemy.engine.Engine - INFO - [cached since 226.8s ago] {}
2025-12-29 11:47:40,286 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:47:40,299 - sqlalchemy.engine.Engine - INFO - [cached since 226.8s ago] {'status_1': 'completed'}
2025-12-29 11:47:40,304 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:47:40,318 - sqlalchemy.engine.Engine - INFO - [cached since 226.8s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:47:40,324 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:47:40,329 - sqlalchemy.engine.Engine - INFO - [cached since 226.8s ago] {}
2025-12-29 11:47:40,335 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:47:40,355 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:47:40,357 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:40,367 - sqlalchemy.engine.Engine - INFO - [cached since 227.1s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:47:40,373 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:47:40,385 - sqlalchemy.engine.Engine - INFO - [cached since 226.3s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 28, 6, 17, 40, 372397), 'param_1': 100}
2025-12-29 11:47:40,392 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:40,402 - sqlalchemy.engine.Engine - INFO - [cached since 226.7s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:47:40,408 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:40,418 - sqlalchemy.engine.Engine - INFO - [cached since 226.8s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:47:40,425 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:40,436 - sqlalchemy.engine.Engine - INFO - [cached since 226.8s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:47:40,441 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:40,452 - sqlalchemy.engine.Engine - INFO - [cached since 226.8s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:47:40,457 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:40,468 - sqlalchemy.engine.Engine - INFO - [cached since 226.8s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:47:40,473 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:40,488 - sqlalchemy.engine.Engine - INFO - [cached since 226.8s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:47:40,496 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:40,508 - sqlalchemy.engine.Engine - INFO - [cached since 226.9s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:47:40,517 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:40,531 - sqlalchemy.engine.Engine - INFO - [cached since 226.9s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:47:40,537 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:40,550 - sqlalchemy.engine.Engine - INFO - [cached since 226.9s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:47:40,555 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:40,568 - sqlalchemy.engine.Engine - INFO - [cached since 226.9s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:47:40,574 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:40,586 - sqlalchemy.engine.Engine - INFO - [cached since 226.9s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:47:40,590 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:40,602 - sqlalchemy.engine.Engine - INFO - [cached since 226.9s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:47:40,607 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:40,619 - sqlalchemy.engine.Engine - INFO - [cached since 227s ago] {'id_1': 13, 'param_1': 1}
2025-12-29 11:47:40,626 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:40,639 - sqlalchemy.engine.Engine - INFO - [cached since 227s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:47:40,648 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:40,658 - sqlalchemy.engine.Engine - INFO - [cached since 227s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:47:40,670 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:40,684 - sqlalchemy.engine.Engine - INFO - [cached since 227s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:47:40,689 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:40,702 - sqlalchemy.engine.Engine - INFO - [cached since 227s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:47:40,709 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:40,721 - sqlalchemy.engine.Engine - INFO - [cached since 227.1s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:47:40,728 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:40,740 - sqlalchemy.engine.Engine - INFO - [cached since 227.1s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:47:40,751 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:47:46,884 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:47:46,902 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:46,939 - sqlalchemy.engine.Engine - INFO - [cached since 233.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:47:46,950 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices
2025-12-29 11:47:46,962 - sqlalchemy.engine.Engine - INFO - [cached since 177.1s ago] {}
2025-12-29 11:47:46,971 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:47:46,988 - sqlalchemy.engine.Engine - INFO - [cached since 186.7s ago] {'device_id_1': 7}
2025-12-29 11:47:46,996 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:47:47,007 - sqlalchemy.engine.Engine - INFO - [cached since 186.7s ago] {'device_id_1': 7}
2025-12-29 11:47:47,014 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:47:47,023 - sqlalchemy.engine.Engine - INFO - [cached since 186.7s ago] {'device_id_1': 8}
2025-12-29 11:47:47,031 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:47:47,037 - sqlalchemy.engine.Engine - INFO - [cached since 186.7s ago] {'device_id_1': 8}
2025-12-29 11:47:47,045 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:47:47,054 - sqlalchemy.engine.Engine - INFO - [cached since 186.7s ago] {'device_id_1': 9}
2025-12-29 11:47:47,062 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:47:47,070 - sqlalchemy.engine.Engine - INFO - [cached since 186.7s ago] {'device_id_1': 9}
2025-12-29 11:47:47,077 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:47:47,086 - sqlalchemy.engine.Engine - INFO - [cached since 186.8s ago] {'device_id_1': 10}
2025-12-29 11:47:47,092 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:47:47,101 - sqlalchemy.engine.Engine - INFO - [cached since 186.7s ago] {'device_id_1': 10}
2025-12-29 11:47:47,106 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:47:47,116 - sqlalchemy.engine.Engine - INFO - [cached since 186.8s ago] {'device_id_1': 11}
2025-12-29 11:47:47,122 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:47:47,131 - sqlalchemy.engine.Engine - INFO - [cached since 186.8s ago] {'device_id_1': 11}
2025-12-29 11:47:47,137 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:47:47,148 - sqlalchemy.engine.Engine - INFO - [cached since 186.8s ago] {'device_id_1': 12}
2025-12-29 11:47:47,153 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:47:47,164 - sqlalchemy.engine.Engine - INFO - [cached since 186.8s ago] {'device_id_1': 12}
2025-12-29 11:47:47,168 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:47:47,182 - sqlalchemy.engine.Engine - INFO - [cached since 186.8s ago] {'device_id_1': 13}
2025-12-29 11:47:47,189 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:47:47,197 - sqlalchemy.engine.Engine - INFO - [cached since 186.8s ago] {'device_id_1': 13}
2025-12-29 11:47:47,202 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:47:47,212 - sqlalchemy.engine.Engine - INFO - [cached since 186.9s ago] {'device_id_1': 14}
2025-12-29 11:47:47,216 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:47:47,225 - sqlalchemy.engine.Engine - INFO - [cached since 186.9s ago] {'device_id_1': 14}
2025-12-29 11:47:47,231 - app.ml.detector - INFO - Training anomaly detector with 8 devices
2025-12-29 11:47:47,238 - app.ml.isolation_forest - INFO - Training Isolation Forest with 8 samples
2025-12-29 11:47:47,869 - app.ml.isolation_forest - INFO - Model saved to E:\wifi-tracker\backend\data\models\isolation_forest.pkl
2025-12-29 11:47:47,948 - app.ml.isolation_forest - INFO - Training complete: {'model_type': 'isolation_forest', 'samples_trained': 8, 'contamination': 0.1, 'n_estimators': 100, 'anomalies_in_training': 1, 'score_mean': 0.22352112736488206, 'score_std': 0.14176606900783098, 'trained_at': '2025-12-29T06:17:47.948375'}
2025-12-29 11:47:47,950 - app.ml.autoencoder - INFO - Training Autoencoder with 8 samples
2025-12-29 11:47:48,167 - app.ml.autoencoder - INFO - Epoch 20/100, Loss: 0.409348
2025-12-29 11:47:48,371 - app.ml.autoencoder - INFO - Epoch 40/100, Loss: 0.394961
2025-12-29 11:47:48,552 - app.ml.autoencoder - INFO - Epoch 60/100, Loss: 0.388922
2025-12-29 11:47:48,762 - app.ml.autoencoder - INFO - Epoch 80/100, Loss: 0.389424
2025-12-29 11:47:48,973 - app.ml.autoencoder - INFO - Epoch 100/100, Loss: 0.331776
2025-12-29 11:47:48,988 - app.ml.autoencoder - INFO - Autoencoder saved to E:\wifi-tracker\backend\data\models\autoencoder.pth
2025-12-29 11:47:48,989 - app.ml.autoencoder - INFO - Training complete: {'model_type': 'autoencoder', 'samples_trained': 8, 'input_dim': 15, 'encoding_dim': 8, 'epochs': 100, 'final_loss': 0.33177629113197327, 'threshold': 1.1977245807647705, 'threshold_percentile': 95, 'trained_at': '2025-12-29T06:17:48.989692'}
2025-12-29 11:47:48,994 - app.routers.dashboard - INFO - ML training initiated by admin: {'status': 'success', 'models': {'isolation_forest': {'model_type': 'isolation_forest', 'samples_trained': 8, 'contamination': 0.1, 'n_estimators': 100, 'anomalies_in_training': 1, 'score_mean': 0.22352112736488206, 'score_std': 0.14176606900783098, 'trained_at': '2025-12-29T06:17:47.948375'}, 'autoencoder': {'model_type': 'autoencoder', 'samples_trained': 8, 'input_dim': 15, 'encoding_dim': 8, 'epochs': 100, 'final_loss': 0.33177629113197327, 'threshold': 1.1977245807647705, 'threshold_percentile': 95, 'trained_at': '2025-12-29T06:17:48.989692'}}, 'trained_at': '2025-12-29T06:17:48.994518', 'total_samples': 8}
2025-12-29 11:47:49,022 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:47:49,024 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:47:49,038 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:49,051 - sqlalchemy.engine.Engine - INFO - [cached since 235.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:47:49,062 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices
2025-12-29 11:47:49,073 - sqlalchemy.engine.Engine - INFO - [cached since 179.2s ago] {}
2025-12-29 11:47:49,084 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:47:49,096 - sqlalchemy.engine.Engine - INFO - [cached since 188.8s ago] {'device_id_1': 7}
2025-12-29 11:47:49,101 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:47:49,112 - sqlalchemy.engine.Engine - INFO - [cached since 188.8s ago] {'device_id_1': 7}
2025-12-29 11:47:49,116 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:47:49,127 - sqlalchemy.engine.Engine - INFO - [cached since 188.8s ago] {'device_id_1': 8}
2025-12-29 11:47:49,131 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:47:49,138 - sqlalchemy.engine.Engine - INFO - [cached since 188.8s ago] {'device_id_1': 8}
2025-12-29 11:47:49,144 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:47:49,150 - sqlalchemy.engine.Engine - INFO - [cached since 188.8s ago] {'device_id_1': 9}
2025-12-29 11:47:49,155 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:47:49,162 - sqlalchemy.engine.Engine - INFO - [cached since 188.8s ago] {'device_id_1': 9}
2025-12-29 11:47:49,168 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:47:49,174 - sqlalchemy.engine.Engine - INFO - [cached since 188.8s ago] {'device_id_1': 10}
2025-12-29 11:47:49,182 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:47:49,190 - sqlalchemy.engine.Engine - INFO - [cached since 188.8s ago] {'device_id_1': 10}
2025-12-29 11:47:49,198 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:47:49,207 - sqlalchemy.engine.Engine - INFO - [cached since 188.9s ago] {'device_id_1': 11}
2025-12-29 11:47:49,216 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:47:49,223 - sqlalchemy.engine.Engine - INFO - [cached since 188.9s ago] {'device_id_1': 11}
2025-12-29 11:47:49,229 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:47:49,236 - sqlalchemy.engine.Engine - INFO - [cached since 188.9s ago] {'device_id_1': 12}
2025-12-29 11:47:49,242 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:47:49,252 - sqlalchemy.engine.Engine - INFO - [cached since 188.9s ago] {'device_id_1': 12}
2025-12-29 11:47:49,256 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:47:49,265 - sqlalchemy.engine.Engine - INFO - [cached since 188.9s ago] {'device_id_1': 13}
2025-12-29 11:47:49,269 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:47:49,280 - sqlalchemy.engine.Engine - INFO - [cached since 188.9s ago] {'device_id_1': 13}
2025-12-29 11:47:49,284 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s
2025-12-29 11:47:49,296 - sqlalchemy.engine.Engine - INFO - [cached since 189s ago] {'device_id_1': 14}
2025-12-29 11:47:49,301 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s
2025-12-29 11:47:49,313 - sqlalchemy.engine.Engine - INFO - [cached since 189s ago] {'device_id_1': 14}
2025-12-29 11:47:49,317 - app.ml.detector - INFO - Training anomaly detector with 8 devices
2025-12-29 11:47:49,323 - app.ml.isolation_forest - INFO - Training Isolation Forest with 8 samples
2025-12-29 11:47:50,113 - app.ml.isolation_forest - INFO - Model saved to E:\wifi-tracker\backend\data\models\isolation_forest.pkl
2025-12-29 11:47:50,178 - app.ml.isolation_forest - INFO - Training complete: {'model_type': 'isolation_forest', 'samples_trained': 8, 'contamination': 0.1, 'n_estimators': 100, 'anomalies_in_training': 1, 'score_mean': 0.22352112736488206, 'score_std': 0.14176606900783098, 'trained_at': '2025-12-29T06:17:50.177991'}
2025-12-29 11:47:50,183 - app.ml.autoencoder - INFO - Training Autoencoder with 8 samples
2025-12-29 11:47:50,569 - app.ml.autoencoder - INFO - Epoch 20/100, Loss: 0.413723
2025-12-29 11:47:50,788 - app.ml.autoencoder - INFO - Epoch 40/100, Loss: 0.402109
2025-12-29 11:47:50,984 - app.ml.autoencoder - INFO - Epoch 60/100, Loss: 0.399975
2025-12-29 11:47:51,195 - app.ml.autoencoder - INFO - Epoch 80/100, Loss: 0.389276
2025-12-29 11:47:51,414 - app.ml.autoencoder - INFO - Epoch 100/100, Loss: 0.354661
2025-12-29 11:47:51,429 - app.ml.autoencoder - INFO - Autoencoder saved to E:\wifi-tracker\backend\data\models\autoencoder.pth
2025-12-29 11:47:51,430 - app.ml.autoencoder - INFO - Training complete: {'model_type': 'autoencoder', 'samples_trained': 8, 'input_dim': 15, 'encoding_dim': 8, 'epochs': 100, 'final_loss': 0.35466063022613525, 'threshold': 1.2666810750961304, 'threshold_percentile': 95, 'trained_at': '2025-12-29T06:17:51.430548'}
2025-12-29 11:47:51,433 - app.routers.dashboard - INFO - ML training initiated by admin: {'status': 'success', 'models': {'isolation_forest': {'model_type': 'isolation_forest', 'samples_trained': 8, 'contamination': 0.1, 'n_estimators': 100, 'anomalies_in_training': 1, 'score_mean': 0.22352112736488206, 'score_std': 0.14176606900783098, 'trained_at': '2025-12-29T06:17:50.177991'}, 'autoencoder': {'model_type': 'autoencoder', 'samples_trained': 8, 'input_dim': 15, 'encoding_dim': 8, 'epochs': 100, 'final_loss': 0.35466063022613525, 'threshold': 1.2666810750961304, 'threshold_percentile': 95, 'trained_at': '2025-12-29T06:17:51.430548'}}, 'trained_at': '2025-12-29T06:17:51.433603', 'total_samples': 8}
2025-12-29 11:47:51,454 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:47:51,473 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:47:51,481 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:51,490 - sqlalchemy.engine.Engine - INFO - [cached since 238.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:47:51,503 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:47:51,508 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:47:51,514 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:47:51,521 - sqlalchemy.engine.Engine - INFO - [cached since 238.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:47:51,531 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:48:33,962 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:48:33,969 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:48:33,974 - sqlalchemy.engine.Engine - INFO - [cached since 280.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:48:33,980 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.alert_type = %(alert_type_1)s) AS anon_1
2025-12-29 11:48:33,992 - sqlalchemy.engine.Engine - INFO - [cached since 180.4s ago] {'alert_type_1': <AlertType.NEW_DEVICE: 'new_device'>}
2025-12-29 11:48:33,997 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:48:34,010 - sqlalchemy.engine.Engine - INFO - [cached since 280.5s ago] {}
2025-12-29 11:48:34,016 - sqlalchemy.engine.Engine - INFO - SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.alert_type = %(alert_type_1)s ORDER BY alerts.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:48:34,028 - sqlalchemy.engine.Engine - INFO - [cached since 180.4s ago] {'alert_type_1': <AlertType.NEW_DEVICE: 'new_device'>, 'param_1': 0, 'param_2': 20}
2025-12-29 11:48:34,037 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:48:34,044 - sqlalchemy.engine.Engine - INFO - [cached since 206.1s ago] {'pk_1': 13}
2025-12-29 11:48:34,048 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:48:34,057 - sqlalchemy.engine.Engine - INFO - [cached since 206.1s ago] {'pk_1': 14}
2025-12-29 11:48:34,060 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:48:34,071 - sqlalchemy.engine.Engine - INFO - [cached since 206.1s ago] {'pk_1': 7}
2025-12-29 11:48:34,075 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:48:34,086 - sqlalchemy.engine.Engine - INFO - [cached since 206.1s ago] {'pk_1': 8}
2025-12-29 11:48:34,090 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:48:34,097 - sqlalchemy.engine.Engine - INFO - [cached since 206.1s ago] {'pk_1': 9}
2025-12-29 11:48:34,104 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:48:34,118 - sqlalchemy.engine.Engine - INFO - [cached since 206.2s ago] {'pk_1': 10}
2025-12-29 11:48:34,122 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:48:34,136 - sqlalchemy.engine.Engine - INFO - [cached since 206.2s ago] {'pk_1': 11}
2025-12-29 11:48:34,142 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:48:34,158 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:48:34,162 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:48:34,177 - sqlalchemy.engine.Engine - INFO - [cached since 280.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:48:34,193 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.alert_type = %(alert_type_1)s) AS anon_1
2025-12-29 11:48:34,209 - sqlalchemy.engine.Engine - INFO - [cached since 180.6s ago] {'alert_type_1': <AlertType.NEW_DEVICE: 'new_device'>}
2025-12-29 11:48:34,216 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:48:34,237 - sqlalchemy.engine.Engine - INFO - [cached since 280.8s ago] {}
2025-12-29 11:48:34,241 - sqlalchemy.engine.Engine - INFO - SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.alert_type = %(alert_type_1)s ORDER BY alerts.created_at DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:48:34,257 - sqlalchemy.engine.Engine - INFO - [cached since 180.6s ago] {'alert_type_1': <AlertType.NEW_DEVICE: 'new_device'>, 'param_1': 0, 'param_2': 20}
2025-12-29 11:48:34,263 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:48:34,279 - sqlalchemy.engine.Engine - INFO - [cached since 206.3s ago] {'pk_1': 13}
2025-12-29 11:48:34,290 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:48:34,307 - sqlalchemy.engine.Engine - INFO - [cached since 206.4s ago] {'pk_1': 14}
2025-12-29 11:48:34,313 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:48:34,326 - sqlalchemy.engine.Engine - INFO - [cached since 206.4s ago] {'pk_1': 7}
2025-12-29 11:48:34,331 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:48:34,346 - sqlalchemy.engine.Engine - INFO - [cached since 206.4s ago] {'pk_1': 8}
2025-12-29 11:48:34,357 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:48:34,372 - sqlalchemy.engine.Engine - INFO - [cached since 206.4s ago] {'pk_1': 9}
2025-12-29 11:48:34,377 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:48:34,393 - sqlalchemy.engine.Engine - INFO - [cached since 206.4s ago] {'pk_1': 10}
2025-12-29 11:48:34,406 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(pk_1)s
2025-12-29 11:48:34,423 - sqlalchemy.engine.Engine - INFO - [cached since 206.5s ago] {'pk_1': 11}
2025-12-29 11:48:34,443 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:51:56,901 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:51:56,907 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:51:56,920 - sqlalchemy.engine.Engine - INFO - [cached since 483.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:51:56,926 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-29 11:51:56,930 - sqlalchemy.engine.Engine - INFO - [cached since 473s ago] {'started_at': datetime.datetime(2025, 12, 29, 6, 21, 56, 926248), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'arp', 'network_range': '192.168.1.0/24', 'status': 'running', 'error_message': None}
2025-12-29 11:51:56,941 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:51:56,946 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:51:56,950 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-29 11:51:56,963 - sqlalchemy.engine.Engine - INFO - [cached since 472.9s ago] {'pk_1': 35}
2025-12-29 11:51:56,970 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-29 11:51:56,975 - sqlalchemy.engine.Engine - INFO - [cached since 472.9s ago] {'pk_1': 1}
2025-12-29 11:51:56,980 - app.routers.scans - INFO - Scan started by admin: 35
2025-12-29 11:51:56,991 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:51:57,036 - sqlalchemy.engine.Engine - INFO - [cached since 473s ago] {'id_1': 35, 'param_1': 1}
2025-12-29 11:51:57,047 - app.services.scanner - INFO - Starting ARP scan on 192.168.1.0/24
2025-12-29 11:51:57,057 - app.services.scanner - INFO - Starting fallback scan on 192.168.1.0/24 (ping + ARP table)
2025-12-29 11:52:08,311 - app.services.scanner - INFO - Fallback scan complete: 0 devices found
2025-12-29 11:52:08,325 - sqlalchemy.engine.Engine - INFO - UPDATE scan_sessions SET completed_at=%(completed_at)s, status=%(status)s WHERE scan_sessions.id = %(scan_sessions_id)s
2025-12-29 11:52:08,335 - sqlalchemy.engine.Engine - INFO - [generated in 0.01024s] {'completed_at': datetime.datetime(2025, 12, 29, 6, 22, 8, 322680), 'status': 'completed', 'scan_sessions_id': 35}
2025-12-29 11:52:08,354 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:52:08,364 - app.routers.scans - INFO - Scan completed: 0 devices, 0 new
2025-12-29 11:52:08,411 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:52:08,419 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:08,435 - sqlalchemy.engine.Engine - INFO - [cached since 495.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:52:08,444 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:52:08,460 - sqlalchemy.engine.Engine - INFO - [cached since 495.1s ago] {}
2025-12-29 11:52:08,470 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:52:08,486 - sqlalchemy.engine.Engine - INFO - [cached since 495.1s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 12, 8, 468614)}
2025-12-29 11:52:08,497 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:52:08,523 - sqlalchemy.engine.Engine - INFO - [cached since 495.1s ago] {}
2025-12-29 11:52:08,540 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:52:08,569 - sqlalchemy.engine.Engine - INFO - [cached since 495.2s ago] {}
2025-12-29 11:52:08,591 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:52:08,624 - sqlalchemy.engine.Engine - INFO - [cached since 495.2s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:52:08,635 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:52:08,645 - sqlalchemy.engine.Engine - INFO - [cached since 495.2s ago] {}
2025-12-29 11:52:08,657 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:52:08,675 - sqlalchemy.engine.Engine - INFO - [cached since 495.2s ago] {}
2025-12-29 11:52:08,682 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:52:08,706 - sqlalchemy.engine.Engine - INFO - [cached since 495.2s ago] {'status_1': 'completed'}
2025-12-29 11:52:08,711 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:52:08,741 - sqlalchemy.engine.Engine - INFO - [cached since 495.2s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:52:08,754 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:52:08,760 - sqlalchemy.engine.Engine - INFO - [cached since 495.2s ago] {}
2025-12-29 11:52:08,774 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:52:08,790 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:52:08,792 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:08,808 - sqlalchemy.engine.Engine - INFO - [cached since 495.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:52:08,818 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:52:08,829 - sqlalchemy.engine.Engine - INFO - [cached since 495.5s ago] {}
2025-12-29 11:52:08,839 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:52:08,861 - sqlalchemy.engine.Engine - INFO - [cached since 495.5s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 12, 8, 837686)}
2025-12-29 11:52:08,891 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:52:08,917 - sqlalchemy.engine.Engine - INFO - [cached since 495.5s ago] {}
2025-12-29 11:52:08,927 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:52:08,944 - sqlalchemy.engine.Engine - INFO - [cached since 495.5s ago] {}
2025-12-29 11:52:08,955 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:52:08,970 - sqlalchemy.engine.Engine - INFO - [cached since 495.5s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:52:08,978 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:52:08,995 - sqlalchemy.engine.Engine - INFO - [cached since 495.5s ago] {}
2025-12-29 11:52:09,006 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:52:09,026 - sqlalchemy.engine.Engine - INFO - [cached since 495.5s ago] {}
2025-12-29 11:52:09,035 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:52:09,059 - sqlalchemy.engine.Engine - INFO - [cached since 495.5s ago] {'status_1': 'completed'}
2025-12-29 11:52:09,072 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:52:09,092 - sqlalchemy.engine.Engine - INFO - [cached since 495.6s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:52:09,102 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:52:09,108 - sqlalchemy.engine.Engine - INFO - [cached since 495.5s ago] {}
2025-12-29 11:52:09,122 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:52:09,131 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:52:09,138 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:09,150 - sqlalchemy.engine.Engine - INFO - [cached since 495.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:52:09,157 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:52:09,163 - sqlalchemy.engine.Engine - INFO - [cached since 495.8s ago] {}
2025-12-29 11:52:09,171 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:52:09,177 - sqlalchemy.engine.Engine - INFO - [cached since 495.8s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 12, 9, 169768)}
2025-12-29 11:52:09,189 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:52:09,206 - sqlalchemy.engine.Engine - INFO - [cached since 495.8s ago] {}
2025-12-29 11:52:09,219 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:52:09,240 - sqlalchemy.engine.Engine - INFO - [cached since 495.8s ago] {}
2025-12-29 11:52:09,248 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:52:09,269 - sqlalchemy.engine.Engine - INFO - [cached since 495.8s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:52:09,287 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:52:09,302 - sqlalchemy.engine.Engine - INFO - [cached since 495.8s ago] {}
2025-12-29 11:52:09,309 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:52:09,326 - sqlalchemy.engine.Engine - INFO - [cached since 495.8s ago] {}
2025-12-29 11:52:09,350 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:52:09,374 - sqlalchemy.engine.Engine - INFO - [cached since 495.9s ago] {'status_1': 'completed'}
2025-12-29 11:52:09,381 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:52:09,407 - sqlalchemy.engine.Engine - INFO - [cached since 495.9s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:52:09,415 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:52:09,419 - sqlalchemy.engine.Engine - INFO - [cached since 495.9s ago] {}
2025-12-29 11:52:09,428 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:52:09,437 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:09,454 - sqlalchemy.engine.Engine - INFO - [cached since 496.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:52:09,461 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:09,477 - sqlalchemy.engine.Engine - INFO - [cached since 495.8s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:52:09,488 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:52:09,508 - sqlalchemy.engine.Engine - INFO - [cached since 495.8s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 22, 6, 22, 9, 487018), 'param_1': 100}
2025-12-29 11:52:09,521 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s AND scan_results.scan_timestamp >= %(scan_timestamp_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:52:09,543 - sqlalchemy.engine.Engine - INFO - [cached since 495.8s ago] {'device_id_1': 7, 'scan_timestamp_1': datetime.datetime(2025, 12, 22, 6, 22, 9, 487018), 'param_1': 100}
2025-12-29 11:52:09,561 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:52:09,567 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:52:09,583 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:52:09,594 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:09,608 - sqlalchemy.engine.Engine - INFO - [cached since 496.4s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:52:09,620 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:52:09,638 - sqlalchemy.engine.Engine - INFO - [cached since 496.3s ago] {}
2025-12-29 11:52:09,653 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:52:09,674 - sqlalchemy.engine.Engine - INFO - [cached since 496.3s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 12, 9, 651165)}
2025-12-29 11:52:09,686 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:52:09,703 - sqlalchemy.engine.Engine - INFO - [cached since 496.3s ago] {}
2025-12-29 11:52:09,709 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:52:09,717 - sqlalchemy.engine.Engine - INFO - [cached since 496.3s ago] {}
2025-12-29 11:52:09,722 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:52:09,727 - sqlalchemy.engine.Engine - INFO - [cached since 496.3s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:52:09,734 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:52:09,740 - sqlalchemy.engine.Engine - INFO - [cached since 496.3s ago] {}
2025-12-29 11:52:09,745 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:52:09,755 - sqlalchemy.engine.Engine - INFO - [cached since 496.3s ago] {}
2025-12-29 11:52:09,761 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:52:09,786 - sqlalchemy.engine.Engine - INFO - [cached since 496.3s ago] {'status_1': 'completed'}
2025-12-29 11:52:09,795 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:52:09,816 - sqlalchemy.engine.Engine - INFO - [cached since 496.3s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:52:09,824 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:52:09,828 - sqlalchemy.engine.Engine - INFO - [cached since 496.3s ago] {}
2025-12-29 11:52:09,842 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:52:09,844 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:52:09,857 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:09,878 - sqlalchemy.engine.Engine - INFO - [cached since 496.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:52:09,891 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:09,909 - sqlalchemy.engine.Engine - INFO - [cached since 496.3s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:52:09,920 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:52:09,950 - sqlalchemy.engine.Engine - INFO - [cached since 496.2s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 22, 6, 22, 9, 919121), 'param_1': 100}
2025-12-29 11:52:09,960 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s AND scan_results.scan_timestamp >= %(scan_timestamp_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:52:09,984 - sqlalchemy.engine.Engine - INFO - [cached since 496.2s ago] {'device_id_1': 7, 'scan_timestamp_1': datetime.datetime(2025, 12, 22, 6, 22, 9, 919121), 'param_1': 100}
2025-12-29 11:52:10,003 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:52:10,021 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:52:10,026 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:10,037 - sqlalchemy.engine.Engine - INFO - [cached since 496.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:52:10,045 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:52:10,061 - sqlalchemy.engine.Engine - INFO - [cached since 496.7s ago] {}
2025-12-29 11:52:10,131 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:52:10,190 - sqlalchemy.engine.Engine - INFO - [cached since 496.8s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 12, 10, 128800)}
2025-12-29 11:52:10,205 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:52:10,237 - sqlalchemy.engine.Engine - INFO - [cached since 496.8s ago] {}
2025-12-29 11:52:10,264 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:52:10,288 - sqlalchemy.engine.Engine - INFO - [cached since 496.9s ago] {}
2025-12-29 11:52:10,300 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:52:10,323 - sqlalchemy.engine.Engine - INFO - [cached since 496.9s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:52:10,338 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:52:10,358 - sqlalchemy.engine.Engine - INFO - [cached since 496.9s ago] {}
2025-12-29 11:52:10,372 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:52:10,401 - sqlalchemy.engine.Engine - INFO - [cached since 496.9s ago] {}
2025-12-29 11:52:10,410 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:52:10,588 - sqlalchemy.engine.Engine - INFO - [cached since 497.1s ago] {'status_1': 'completed'}
2025-12-29 11:52:10,745 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:52:10,802 - sqlalchemy.engine.Engine - INFO - [cached since 497.3s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:52:10,871 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:52:10,879 - sqlalchemy.engine.Engine - INFO - [cached since 497.3s ago] {}
2025-12-29 11:52:10,891 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:52:10,901 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:52:10,928 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:10,985 - sqlalchemy.engine.Engine - INFO - [cached since 497.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:52:10,999 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:11,007 - sqlalchemy.engine.Engine - INFO - [cached since 497.4s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:52:11,015 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:52:11,021 - sqlalchemy.engine.Engine - INFO - [cached since 497.3s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 22, 6, 22, 11, 13565), 'param_1': 100}
2025-12-29 11:52:11,031 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s AND scan_results.scan_timestamp >= %(scan_timestamp_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:52:11,057 - sqlalchemy.engine.Engine - INFO - [cached since 497.3s ago] {'device_id_1': 7, 'scan_timestamp_1': datetime.datetime(2025, 12, 22, 6, 22, 11, 13565), 'param_1': 100}
2025-12-29 11:52:11,117 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:52:11,144 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:52:11,157 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:11,176 - sqlalchemy.engine.Engine - INFO - [cached since 497.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:52:11,188 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:52:11,204 - sqlalchemy.engine.Engine - INFO - [cached since 497.9s ago] {}
2025-12-29 11:52:11,219 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:52:11,238 - sqlalchemy.engine.Engine - INFO - [cached since 497.9s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 12, 11, 218474)}
2025-12-29 11:52:11,249 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:52:11,263 - sqlalchemy.engine.Engine - INFO - [cached since 497.9s ago] {}
2025-12-29 11:52:11,272 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:52:11,292 - sqlalchemy.engine.Engine - INFO - [cached since 497.9s ago] {}
2025-12-29 11:52:11,299 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:52:11,321 - sqlalchemy.engine.Engine - INFO - [cached since 497.9s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:52:11,327 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:52:11,344 - sqlalchemy.engine.Engine - INFO - [cached since 497.9s ago] {}
2025-12-29 11:52:11,354 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:52:11,370 - sqlalchemy.engine.Engine - INFO - [cached since 497.9s ago] {}
2025-12-29 11:52:11,377 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:52:11,407 - sqlalchemy.engine.Engine - INFO - [cached since 497.9s ago] {'status_1': 'completed'}
2025-12-29 11:52:11,419 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:52:11,428 - sqlalchemy.engine.Engine - INFO - [cached since 497.9s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:52:11,442 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:52:11,506 - sqlalchemy.engine.Engine - INFO - [cached since 497.9s ago] {}
2025-12-29 11:52:11,527 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:52:11,534 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:11,558 - sqlalchemy.engine.Engine - INFO - [cached since 498.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:52:11,566 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:11,578 - sqlalchemy.engine.Engine - INFO - [cached since 497.9s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:52:11,589 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:52:11,604 - sqlalchemy.engine.Engine - INFO - [cached since 497.9s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 22, 6, 22, 11, 588576), 'param_1': 100}
2025-12-29 11:52:11,615 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s AND scan_results.scan_timestamp >= %(scan_timestamp_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:52:11,636 - sqlalchemy.engine.Engine - INFO - [cached since 497.9s ago] {'device_id_1': 7, 'scan_timestamp_1': datetime.datetime(2025, 12, 22, 6, 22, 11, 588576), 'param_1': 100}
2025-12-29 11:52:11,652 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:52:11,653 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:52:11,660 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:52:11,674 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:11,678 - sqlalchemy.engine.Engine - INFO - [cached since 498.4s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:52:11,688 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:52:11,705 - sqlalchemy.engine.Engine - INFO - [cached since 497.7s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 28, 6, 22, 11, 687436), 'param_1': 100}
2025-12-29 11:52:11,717 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:11,741 - sqlalchemy.engine.Engine - INFO - [cached since 498.1s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:11,760 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:11,773 - sqlalchemy.engine.Engine - INFO - [cached since 498.1s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:11,782 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:11,803 - sqlalchemy.engine.Engine - INFO - [cached since 498.1s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:11,810 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:11,826 - sqlalchemy.engine.Engine - INFO - [cached since 498.2s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:11,844 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:11,859 - sqlalchemy.engine.Engine - INFO - [cached since 498.2s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:11,868 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:11,883 - sqlalchemy.engine.Engine - INFO - [cached since 498.2s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:11,889 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:11,903 - sqlalchemy.engine.Engine - INFO - [cached since 498.2s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:11,910 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:11,923 - sqlalchemy.engine.Engine - INFO - [cached since 498.3s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:52:11,928 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:11,942 - sqlalchemy.engine.Engine - INFO - [cached since 498.3s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:11,949 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:11,959 - sqlalchemy.engine.Engine - INFO - [cached since 498.3s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:11,966 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:11,980 - sqlalchemy.engine.Engine - INFO - [cached since 498.3s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:11,990 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:12,010 - sqlalchemy.engine.Engine - INFO - [cached since 498.4s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:52:12,024 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:12,042 - sqlalchemy.engine.Engine - INFO - [cached since 498.4s ago] {'id_1': 13, 'param_1': 1}
2025-12-29 11:52:12,053 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:12,067 - sqlalchemy.engine.Engine - INFO - [cached since 498.4s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:52:12,083 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:12,093 - sqlalchemy.engine.Engine - INFO - [cached since 498.4s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:52:12,102 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:12,119 - sqlalchemy.engine.Engine - INFO - [cached since 498.5s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:52:12,127 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:12,142 - sqlalchemy.engine.Engine - INFO - [cached since 498.5s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:12,149 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:12,159 - sqlalchemy.engine.Engine - INFO - [cached since 498.5s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:52:12,170 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:12,176 - sqlalchemy.engine.Engine - INFO - [cached since 498.5s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:52:12,194 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:52:12,203 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:52:12,209 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:12,220 - sqlalchemy.engine.Engine - INFO - [cached since 499s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:52:12,233 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:52:12,244 - sqlalchemy.engine.Engine - INFO - [cached since 498.9s ago] {}
2025-12-29 11:52:12,255 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:52:12,274 - sqlalchemy.engine.Engine - INFO - [cached since 498.9s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 12, 12, 254420)}
2025-12-29 11:52:12,284 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:52:12,294 - sqlalchemy.engine.Engine - INFO - [cached since 498.9s ago] {}
2025-12-29 11:52:12,304 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:52:12,311 - sqlalchemy.engine.Engine - INFO - [cached since 498.9s ago] {}
2025-12-29 11:52:12,322 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:52:12,336 - sqlalchemy.engine.Engine - INFO - [cached since 498.9s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:52:12,341 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:52:12,352 - sqlalchemy.engine.Engine - INFO - [cached since 498.9s ago] {}
2025-12-29 11:52:12,357 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:52:12,369 - sqlalchemy.engine.Engine - INFO - [cached since 498.9s ago] {}
2025-12-29 11:52:12,375 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:52:12,392 - sqlalchemy.engine.Engine - INFO - [cached since 498.9s ago] {'status_1': 'completed'}
2025-12-29 11:52:12,402 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:52:12,410 - sqlalchemy.engine.Engine - INFO - [cached since 498.9s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:52:12,420 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:52:12,424 - sqlalchemy.engine.Engine - INFO - [cached since 498.9s ago] {}
2025-12-29 11:52:12,438 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:52:12,440 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:52:12,445 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:12,461 - sqlalchemy.engine.Engine - INFO - [cached since 499.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:52:12,472 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:52:12,477 - sqlalchemy.engine.Engine - INFO - [cached since 499.1s ago] {}
2025-12-29 11:52:12,486 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:52:12,494 - sqlalchemy.engine.Engine - INFO - [cached since 499.1s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 12, 12, 485052)}
2025-12-29 11:52:12,504 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:52:12,525 - sqlalchemy.engine.Engine - INFO - [cached since 499.1s ago] {}
2025-12-29 11:52:12,533 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:52:12,544 - sqlalchemy.engine.Engine - INFO - [cached since 499.1s ago] {}
2025-12-29 11:52:12,552 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:52:12,560 - sqlalchemy.engine.Engine - INFO - [cached since 499.1s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:52:12,568 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:52:12,576 - sqlalchemy.engine.Engine - INFO - [cached since 499.1s ago] {}
2025-12-29 11:52:12,586 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:52:12,601 - sqlalchemy.engine.Engine - INFO - [cached since 499.1s ago] {}
2025-12-29 11:52:12,605 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:52:12,619 - sqlalchemy.engine.Engine - INFO - [cached since 499.1s ago] {'status_1': 'completed'}
2025-12-29 11:52:12,625 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:52:12,641 - sqlalchemy.engine.Engine - INFO - [cached since 499.1s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:52:12,644 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:52:12,653 - sqlalchemy.engine.Engine - INFO - [cached since 499.1s ago] {}
2025-12-29 11:52:12,660 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:52:12,669 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:12,678 - sqlalchemy.engine.Engine - INFO - [cached since 499.4s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:52:12,688 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:52:12,694 - sqlalchemy.engine.Engine - INFO - [cached since 498.7s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 28, 6, 22, 12, 687429), 'param_1': 100}
2025-12-29 11:52:12,705 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:12,710 - sqlalchemy.engine.Engine - INFO - [cached since 499.1s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:12,720 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:12,727 - sqlalchemy.engine.Engine - INFO - [cached since 499.1s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:12,736 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:12,744 - sqlalchemy.engine.Engine - INFO - [cached since 499.1s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:12,753 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:12,758 - sqlalchemy.engine.Engine - INFO - [cached since 499.1s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:12,764 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:12,775 - sqlalchemy.engine.Engine - INFO - [cached since 499.1s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:12,783 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:12,794 - sqlalchemy.engine.Engine - INFO - [cached since 499.1s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:12,803 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:12,810 - sqlalchemy.engine.Engine - INFO - [cached since 499.2s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:12,820 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:12,833 - sqlalchemy.engine.Engine - INFO - [cached since 499.2s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:52:12,839 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:12,844 - sqlalchemy.engine.Engine - INFO - [cached since 499.2s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:12,851 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:12,857 - sqlalchemy.engine.Engine - INFO - [cached since 499.2s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:12,864 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:12,873 - sqlalchemy.engine.Engine - INFO - [cached since 499.2s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:12,876 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:12,887 - sqlalchemy.engine.Engine - INFO - [cached since 499.2s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:52:12,892 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:12,904 - sqlalchemy.engine.Engine - INFO - [cached since 499.3s ago] {'id_1': 13, 'param_1': 1}
2025-12-29 11:52:12,910 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:12,922 - sqlalchemy.engine.Engine - INFO - [cached since 499.3s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:52:12,927 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:12,938 - sqlalchemy.engine.Engine - INFO - [cached since 499.3s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:52:12,945 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:12,959 - sqlalchemy.engine.Engine - INFO - [cached since 499.3s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:52:12,968 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:12,976 - sqlalchemy.engine.Engine - INFO - [cached since 499.3s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:12,985 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:12,993 - sqlalchemy.engine.Engine - INFO - [cached since 499.3s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:52:13,002 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:13,010 - sqlalchemy.engine.Engine - INFO - [cached since 499.4s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:52:13,025 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:52:13,034 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:52:13,048 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:52:13,051 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:13,057 - sqlalchemy.engine.Engine - INFO - [cached since 499.8s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:52:13,061 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:52:13,074 - sqlalchemy.engine.Engine - INFO - [cached since 499.7s ago] {}
2025-12-29 11:52:13,081 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:52:13,089 - sqlalchemy.engine.Engine - INFO - [cached since 499.7s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 12, 13, 78009)}
2025-12-29 11:52:13,094 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:52:13,104 - sqlalchemy.engine.Engine - INFO - [cached since 499.7s ago] {}
2025-12-29 11:52:13,110 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:52:13,134 - sqlalchemy.engine.Engine - INFO - [cached since 499.7s ago] {}
2025-12-29 11:52:13,175 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:52:13,192 - sqlalchemy.engine.Engine - INFO - [cached since 499.8s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:52:13,207 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:52:13,221 - sqlalchemy.engine.Engine - INFO - [cached since 499.8s ago] {}
2025-12-29 11:52:13,230 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:52:13,243 - sqlalchemy.engine.Engine - INFO - [cached since 499.8s ago] {}
2025-12-29 11:52:13,269 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:52:13,279 - sqlalchemy.engine.Engine - INFO - [cached since 499.8s ago] {'status_1': 'completed'}
2025-12-29 11:52:13,288 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:52:13,301 - sqlalchemy.engine.Engine - INFO - [cached since 499.8s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:52:13,309 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:52:13,318 - sqlalchemy.engine.Engine - INFO - [cached since 499.8s ago] {}
2025-12-29 11:52:13,327 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:52:13,335 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:13,342 - sqlalchemy.engine.Engine - INFO - [cached since 500.1s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:52:13,352 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:52:13,361 - sqlalchemy.engine.Engine - INFO - [cached since 499.3s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 28, 6, 22, 13, 351483), 'param_1': 100}
2025-12-29 11:52:13,373 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:13,385 - sqlalchemy.engine.Engine - INFO - [cached since 499.7s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:13,392 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:13,407 - sqlalchemy.engine.Engine - INFO - [cached since 499.8s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:13,416 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:13,421 - sqlalchemy.engine.Engine - INFO - [cached since 499.8s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:13,427 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:13,437 - sqlalchemy.engine.Engine - INFO - [cached since 499.8s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:13,442 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:13,451 - sqlalchemy.engine.Engine - INFO - [cached since 499.8s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:13,458 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:13,466 - sqlalchemy.engine.Engine - INFO - [cached since 499.8s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:13,472 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:13,483 - sqlalchemy.engine.Engine - INFO - [cached since 499.8s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:13,491 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:13,504 - sqlalchemy.engine.Engine - INFO - [cached since 499.9s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:52:13,553 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:13,608 - sqlalchemy.engine.Engine - INFO - [cached since 500s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:13,686 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:13,832 - sqlalchemy.engine.Engine - INFO - [cached since 500.2s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:13,909 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:13,922 - sqlalchemy.engine.Engine - INFO - [cached since 500.3s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:13,929 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:13,943 - sqlalchemy.engine.Engine - INFO - [cached since 500.3s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:52:13,957 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:13,975 - sqlalchemy.engine.Engine - INFO - [cached since 500.3s ago] {'id_1': 13, 'param_1': 1}
2025-12-29 11:52:13,987 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,001 - sqlalchemy.engine.Engine - INFO - [cached since 500.3s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:52:14,038 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,082 - sqlalchemy.engine.Engine - INFO - [cached since 500.4s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:52:14,090 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,100 - sqlalchemy.engine.Engine - INFO - [cached since 500.4s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:52:14,105 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,115 - sqlalchemy.engine.Engine - INFO - [cached since 500.5s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:14,120 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,128 - sqlalchemy.engine.Engine - INFO - [cached since 500.5s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:52:14,136 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,144 - sqlalchemy.engine.Engine - INFO - [cached since 500.5s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:52:14,157 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:52:14,158 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:52:14,162 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:52:14,179 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,192 - sqlalchemy.engine.Engine - INFO - [cached since 500.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:52:14,203 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:52:14,217 - sqlalchemy.engine.Engine - INFO - [cached since 500.2s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 28, 6, 22, 14, 201944), 'param_1': 100}
2025-12-29 11:52:14,229 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,243 - sqlalchemy.engine.Engine - INFO - [cached since 500.6s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:14,253 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,261 - sqlalchemy.engine.Engine - INFO - [cached since 500.6s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:14,269 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,276 - sqlalchemy.engine.Engine - INFO - [cached since 500.6s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:14,284 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,294 - sqlalchemy.engine.Engine - INFO - [cached since 500.6s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:14,302 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,312 - sqlalchemy.engine.Engine - INFO - [cached since 500.7s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:14,320 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,334 - sqlalchemy.engine.Engine - INFO - [cached since 500.7s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:14,341 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,354 - sqlalchemy.engine.Engine - INFO - [cached since 500.7s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:14,360 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,372 - sqlalchemy.engine.Engine - INFO - [cached since 500.7s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:52:14,377 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,387 - sqlalchemy.engine.Engine - INFO - [cached since 500.7s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:14,394 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,405 - sqlalchemy.engine.Engine - INFO - [cached since 500.8s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:14,410 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,423 - sqlalchemy.engine.Engine - INFO - [cached since 500.8s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:14,431 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,438 - sqlalchemy.engine.Engine - INFO - [cached since 500.8s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:52:14,443 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,454 - sqlalchemy.engine.Engine - INFO - [cached since 500.8s ago] {'id_1': 13, 'param_1': 1}
2025-12-29 11:52:14,459 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,473 - sqlalchemy.engine.Engine - INFO - [cached since 500.8s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:52:14,479 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,489 - sqlalchemy.engine.Engine - INFO - [cached since 500.8s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:52:14,494 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,505 - sqlalchemy.engine.Engine - INFO - [cached since 500.9s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:52:14,509 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,519 - sqlalchemy.engine.Engine - INFO - [cached since 500.9s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:14,524 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,533 - sqlalchemy.engine.Engine - INFO - [cached since 500.9s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:52:14,539 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,544 - sqlalchemy.engine.Engine - INFO - [cached since 500.9s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:52:14,557 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:52:14,566 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:52:14,569 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,575 - sqlalchemy.engine.Engine - INFO - [cached since 501.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:52:14,584 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,590 - sqlalchemy.engine.Engine - INFO - [cached since 500.9s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:52:14,598 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:52:14,607 - sqlalchemy.engine.Engine - INFO - [cached since 500.9s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 22, 6, 22, 14, 593971), 'param_1': 100}
2025-12-29 11:52:14,615 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s AND scan_results.scan_timestamp >= %(scan_timestamp_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:52:14,623 - sqlalchemy.engine.Engine - INFO - [cached since 500.9s ago] {'device_id_1': 7, 'scan_timestamp_1': datetime.datetime(2025, 12, 22, 6, 22, 14, 593971), 'param_1': 100}
2025-12-29 11:52:14,633 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:52:14,657 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:52:14,659 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,668 - sqlalchemy.engine.Engine - INFO - [cached since 501.4s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:52:14,673 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:52:14,683 - sqlalchemy.engine.Engine - INFO - [cached since 501.3s ago] {}
2025-12-29 11:52:14,689 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:52:14,700 - sqlalchemy.engine.Engine - INFO - [cached since 501.3s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 12, 14, 687351)}
2025-12-29 11:52:14,707 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:52:14,717 - sqlalchemy.engine.Engine - INFO - [cached since 501.3s ago] {}
2025-12-29 11:52:14,721 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:52:14,727 - sqlalchemy.engine.Engine - INFO - [cached since 501.3s ago] {}
2025-12-29 11:52:14,735 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:52:14,744 - sqlalchemy.engine.Engine - INFO - [cached since 501.3s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:52:14,752 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:52:14,760 - sqlalchemy.engine.Engine - INFO - [cached since 501.3s ago] {}
2025-12-29 11:52:14,768 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:52:14,783 - sqlalchemy.engine.Engine - INFO - [cached since 501.3s ago] {}
2025-12-29 11:52:14,788 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:52:14,804 - sqlalchemy.engine.Engine - INFO - [cached since 501.3s ago] {'status_1': 'completed'}
2025-12-29 11:52:14,810 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:52:14,825 - sqlalchemy.engine.Engine - INFO - [cached since 501.3s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:52:14,831 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:52:14,835 - sqlalchemy.engine.Engine - INFO - [cached since 501.3s ago] {}
2025-12-29 11:52:14,841 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:52:14,879 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:52:14,882 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,890 - sqlalchemy.engine.Engine - INFO - [cached since 501.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:52:14,897 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:52:14,908 - sqlalchemy.engine.Engine - INFO - [cached since 500.9s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 28, 6, 22, 14, 896646), 'param_1': 100}
2025-12-29 11:52:14,915 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,924 - sqlalchemy.engine.Engine - INFO - [cached since 501.3s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:14,930 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,941 - sqlalchemy.engine.Engine - INFO - [cached since 501.3s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:14,949 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,958 - sqlalchemy.engine.Engine - INFO - [cached since 501.3s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:14,962 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,972 - sqlalchemy.engine.Engine - INFO - [cached since 501.3s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:14,976 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:14,988 - sqlalchemy.engine.Engine - INFO - [cached since 501.3s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:14,992 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:15,004 - sqlalchemy.engine.Engine - INFO - [cached since 501.3s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:15,009 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:15,018 - sqlalchemy.engine.Engine - INFO - [cached since 501.4s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:15,023 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:15,028 - sqlalchemy.engine.Engine - INFO - [cached since 501.4s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:52:15,036 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:15,043 - sqlalchemy.engine.Engine - INFO - [cached since 501.4s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:15,053 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:15,058 - sqlalchemy.engine.Engine - INFO - [cached since 501.4s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:15,064 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:15,071 - sqlalchemy.engine.Engine - INFO - [cached since 501.4s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:15,076 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:15,085 - sqlalchemy.engine.Engine - INFO - [cached since 501.4s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:52:15,091 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:15,100 - sqlalchemy.engine.Engine - INFO - [cached since 501.4s ago] {'id_1': 13, 'param_1': 1}
2025-12-29 11:52:15,104 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:15,110 - sqlalchemy.engine.Engine - INFO - [cached since 501.5s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:52:15,147 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:15,208 - sqlalchemy.engine.Engine - INFO - [cached since 501.6s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:52:15,236 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:15,255 - sqlalchemy.engine.Engine - INFO - [cached since 501.6s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:52:15,263 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:15,284 - sqlalchemy.engine.Engine - INFO - [cached since 501.6s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:52:15,294 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:15,308 - sqlalchemy.engine.Engine - INFO - [cached since 501.7s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:52:15,320 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:52:15,334 - sqlalchemy.engine.Engine - INFO - [cached since 501.7s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:52:15,350 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:56:08,247 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:56:08,262 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:08,279 - sqlalchemy.engine.Engine - INFO - [cached since 735s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:56:08,287 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_sessions (started_at, completed_at, total_devices_found, new_devices_found, scan_type, network_range, status, error_message) VALUES (%(started_at)s, %(completed_at)s, %(total_devices_found)s, %(new_devices_found)s, %(scan_type)s, %(network_range)s, %(status)s, %(error_message)s)
2025-12-29 11:56:08,307 - sqlalchemy.engine.Engine - INFO - [cached since 724.3s ago] {'started_at': datetime.datetime(2025, 12, 29, 6, 26, 8, 287315), 'completed_at': None, 'total_devices_found': 0, 'new_devices_found': 0, 'scan_type': 'arp', 'network_range': '192.168.1.0/24', 'status': 'running', 'error_message': None}
2025-12-29 11:56:08,315 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:56:08,321 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:56:08,325 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id, scan_sessions.started_at, scan_sessions.completed_at, scan_sessions.total_devices_found, scan_sessions.new_devices_found, scan_sessions.scan_type, scan_sessions.network_range, scan_sessions.status, scan_sessions.error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(pk_1)s
2025-12-29 11:56:08,337 - sqlalchemy.engine.Engine - INFO - [cached since 724.3s ago] {'pk_1': 36}
2025-12-29 11:56:08,342 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(pk_1)s
2025-12-29 11:56:08,349 - sqlalchemy.engine.Engine - INFO - [cached since 724.3s ago] {'pk_1': 1}
2025-12-29 11:56:08,354 - app.routers.scans - INFO - Scan started by admin: 36
2025-12-29 11:56:08,361 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:08,380 - sqlalchemy.engine.Engine - INFO - [cached since 724.3s ago] {'id_1': 36, 'param_1': 1}
2025-12-29 11:56:08,386 - app.services.scanner - INFO - Starting ARP scan on 192.168.1.0/24
2025-12-29 11:56:08,389 - app.services.scanner - INFO - Starting fallback scan on 192.168.1.0/24 (ping + ARP table)
2025-12-29 11:56:32,940 - app.services.scanner - INFO - Fallback scan complete: 7 devices found
2025-12-29 11:56:32,945 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:32,960 - sqlalchemy.engine.Engine - INFO - [cached since 716.9s ago] {'mac_address_1': '96:A4:CB:4D:96:A9', 'param_1': 1}
2025-12-29 11:56:32,965 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:56:32,978 - sqlalchemy.engine.Engine - INFO - [cached since 754.8s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:56:32,984 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:32,991 - sqlalchemy.engine.Engine - INFO - [cached since 716.9s ago] {'mac_address_1': 'FF:FF:FF:FF:FF:FF', 'param_1': 1}
2025-12-29 11:56:32,996 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:56:33,003 - sqlalchemy.engine.Engine - INFO - [cached since 754.8s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:56:33,011 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:33,023 - sqlalchemy.engine.Engine - INFO - [cached since 716.9s ago] {'mac_address_1': '01:00:5E:00:00:16', 'param_1': 1}
2025-12-29 11:56:33,045 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:56:33,061 - sqlalchemy.engine.Engine - INFO - [cached since 754.9s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:56:33,070 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:33,082 - sqlalchemy.engine.Engine - INFO - [cached since 717s ago] {'mac_address_1': '01:00:5E:00:00:FB', 'param_1': 1}
2025-12-29 11:56:33,090 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:56:33,100 - sqlalchemy.engine.Engine - INFO - [cached since 754.9s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:56:33,105 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:33,113 - sqlalchemy.engine.Engine - INFO - [cached since 717s ago] {'mac_address_1': '01:00:5E:00:00:FC', 'param_1': 1}
2025-12-29 11:56:33,121 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:56:33,133 - sqlalchemy.engine.Engine - INFO - [cached since 754.9s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:56:33,141 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:33,151 - sqlalchemy.engine.Engine - INFO - [cached since 717.1s ago] {'mac_address_1': '01:00:5E:7F:66:12', 'param_1': 1}
2025-12-29 11:56:33,159 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:56:33,169 - sqlalchemy.engine.Engine - INFO - [cached since 755s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:56:33,175 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.mac_address = %(mac_address_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:33,186 - sqlalchemy.engine.Engine - INFO - [cached since 717.1s ago] {'mac_address_1': 'FF:FF:FF:FF:FF:FF', 'param_1': 1}
2025-12-29 11:56:33,193 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:56:33,204 - sqlalchemy.engine.Engine - INFO - [cached since 755s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:56:33,211 - sqlalchemy.engine.Engine - INFO - UPDATE devices SET last_seen=%(last_seen)s WHERE devices.id = %(devices_id)s
2025-12-29 11:56:33,213 - sqlalchemy.engine.Engine - INFO - [cached since 716.6s ago] [{'last_seen': datetime.datetime(2025, 12, 29, 6, 26, 32, 982441), 'devices_id': 8}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 26, 33, 208231), 'devices_id': 9}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 26, 33, 68037), 'devices_id': 10}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 26, 33, 103964), 'devices_id': 11}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 26, 33, 139339), 'devices_id': 12}, {'last_seen': datetime.datetime(2025, 12, 29, 6, 26, 33, 174108), 'devices_id': 13}]
2025-12-29 11:56:33,234 - sqlalchemy.engine.Engine - INFO - UPDATE scan_sessions SET completed_at=%(completed_at)s, total_devices_found=%(total_devices_found)s, status=%(status)s WHERE scan_sessions.id = %(scan_sessions_id)s
2025-12-29 11:56:33,238 - sqlalchemy.engine.Engine - INFO - [cached since 716.6s ago] {'completed_at': datetime.datetime(2025, 12, 29, 6, 26, 33, 208964), 'total_devices_found': 7, 'status': 'completed', 'scan_sessions_id': 36}
2025-12-29 11:56:33,243 - sqlalchemy.engine.Engine - INFO - INSERT INTO device_activity (device_id, event_type, old_value, new_value, event_timestamp) VALUES (%(device_id)s, %(event_type)s, %(old_value)s, %(new_value)s, %(event_timestamp)s)
2025-12-29 11:56:33,247 - sqlalchemy.engine.Engine - INFO - [cached since 716.6s ago] {'device_id': 9, 'event_type': 'ip_changed', 'old_value': '255.255.255.255', 'new_value': '10.41.243.255', 'event_timestamp': datetime.datetime(2025, 12, 29, 6, 26, 33, 243795)}
2025-12-29 11:56:33,252 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:56:33,258 - sqlalchemy.engine.Engine - INFO - [cached since 716.6s ago] {'device_id': 8, 'ip_address': '10.41.243.123', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 26, 33, 251893), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:56:33,264 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:56:33,268 - sqlalchemy.engine.Engine - INFO - [cached since 716.6s ago] {'device_id': 9, 'ip_address': '10.41.243.255', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 26, 33, 264155), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:56:33,274 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:56:33,279 - sqlalchemy.engine.Engine - INFO - [cached since 716.6s ago] {'device_id': 10, 'ip_address': '224.0.0.22', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 26, 33, 274522), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:56:33,291 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:56:33,297 - sqlalchemy.engine.Engine - INFO - [cached since 716.6s ago] {'device_id': 11, 'ip_address': '224.0.0.251', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 26, 33, 291141), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:56:33,303 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:56:33,308 - sqlalchemy.engine.Engine - INFO - [cached since 716.7s ago] {'device_id': 12, 'ip_address': '224.0.0.252', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 26, 33, 303163), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:56:33,314 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:56:33,319 - sqlalchemy.engine.Engine - INFO - [cached since 716.7s ago] {'device_id': 13, 'ip_address': '239.255.102.18', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 26, 33, 314177), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:56:33,327 - sqlalchemy.engine.Engine - INFO - INSERT INTO scan_results (device_id, ip_address, rssi, scan_timestamp, is_connected, response_time_ms) VALUES (%(device_id)s, %(ip_address)s, %(rssi)s, %(scan_timestamp)s, %(is_connected)s, %(response_time_ms)s)
2025-12-29 11:56:33,331 - sqlalchemy.engine.Engine - INFO - [cached since 716.7s ago] {'device_id': 9, 'ip_address': '255.255.255.255', 'rssi': None, 'scan_timestamp': datetime.datetime(2025, 12, 29, 6, 26, 33, 327261), 'is_connected': 1, 'response_time_ms': None}
2025-12-29 11:56:33,339 - sqlalchemy.engine.Engine - INFO - COMMIT
2025-12-29 11:56:33,345 - app.routers.scans - INFO - Scan completed: 7 devices, 0 new
2025-12-29 11:56:33,714 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:56:33,727 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:33,751 - sqlalchemy.engine.Engine - INFO - [cached since 760.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:56:33,766 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:56:33,772 - sqlalchemy.engine.Engine - INFO - [cached since 760.4s ago] {}
2025-12-29 11:56:33,776 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:56:33,786 - sqlalchemy.engine.Engine - INFO - [cached since 760.4s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 16, 33, 775605)}
2025-12-29 11:56:33,792 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:56:33,803 - sqlalchemy.engine.Engine - INFO - [cached since 760.4s ago] {}
2025-12-29 11:56:33,808 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:56:33,821 - sqlalchemy.engine.Engine - INFO - [cached since 760.4s ago] {}
2025-12-29 11:56:33,826 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:56:33,837 - sqlalchemy.engine.Engine - INFO - [cached since 760.4s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:56:33,842 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:56:33,853 - sqlalchemy.engine.Engine - INFO - [cached since 760.4s ago] {}
2025-12-29 11:56:33,857 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:56:33,865 - sqlalchemy.engine.Engine - INFO - [cached since 760.4s ago] {}
2025-12-29 11:56:33,869 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:56:33,878 - sqlalchemy.engine.Engine - INFO - [cached since 760.4s ago] {'status_1': 'completed'}
2025-12-29 11:56:33,883 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:56:33,901 - sqlalchemy.engine.Engine - INFO - [cached since 760.4s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:56:33,909 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:56:33,914 - sqlalchemy.engine.Engine - INFO - [cached since 760.4s ago] {}
2025-12-29 11:56:33,923 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:56:33,933 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:56:33,937 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:33,942 - sqlalchemy.engine.Engine - INFO - [cached since 760.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:56:33,948 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:56:33,955 - sqlalchemy.engine.Engine - INFO - [cached since 760.6s ago] {}
2025-12-29 11:56:33,967 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:56:33,978 - sqlalchemy.engine.Engine - INFO - [cached since 760.6s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 16, 33, 965961)}
2025-12-29 11:56:33,987 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:56:33,996 - sqlalchemy.engine.Engine - INFO - [cached since 760.6s ago] {}
2025-12-29 11:56:34,000 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:56:34,008 - sqlalchemy.engine.Engine - INFO - [cached since 760.6s ago] {}
2025-12-29 11:56:34,014 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:56:34,022 - sqlalchemy.engine.Engine - INFO - [cached since 760.6s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:56:34,027 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:56:34,032 - sqlalchemy.engine.Engine - INFO - [cached since 760.6s ago] {}
2025-12-29 11:56:34,037 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:56:34,047 - sqlalchemy.engine.Engine - INFO - [cached since 760.6s ago] {}
2025-12-29 11:56:34,051 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:56:34,063 - sqlalchemy.engine.Engine - INFO - [cached since 760.6s ago] {'status_1': 'completed'}
2025-12-29 11:56:34,068 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:56:34,079 - sqlalchemy.engine.Engine - INFO - [cached since 760.5s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:56:34,084 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:56:34,088 - sqlalchemy.engine.Engine - INFO - [cached since 760.5s ago] {}
2025-12-29 11:56:34,096 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:56:34,103 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:56:34,105 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:34,114 - sqlalchemy.engine.Engine - INFO - [cached since 760.9s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:56:34,123 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:34,133 - sqlalchemy.engine.Engine - INFO - [cached since 760.5s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:56:34,143 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:56:34,156 - sqlalchemy.engine.Engine - INFO - [cached since 760.5s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 22, 6, 26, 34, 141733), 'param_1': 100}
2025-12-29 11:56:34,165 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s AND scan_results.scan_timestamp >= %(scan_timestamp_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:56:34,180 - sqlalchemy.engine.Engine - INFO - [cached since 760.4s ago] {'device_id_1': 7, 'scan_timestamp_1': datetime.datetime(2025, 12, 22, 6, 26, 34, 141733), 'param_1': 100}
2025-12-29 11:56:34,200 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:56:34,209 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:34,221 - sqlalchemy.engine.Engine - INFO - [cached since 761s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:56:34,226 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:56:34,235 - sqlalchemy.engine.Engine - INFO - [cached since 760.9s ago] {}
2025-12-29 11:56:34,238 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:56:34,248 - sqlalchemy.engine.Engine - INFO - [cached since 760.9s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 16, 34, 237555)}
2025-12-29 11:56:34,256 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:56:34,263 - sqlalchemy.engine.Engine - INFO - [cached since 760.9s ago] {}
2025-12-29 11:56:34,267 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:56:34,275 - sqlalchemy.engine.Engine - INFO - [cached since 760.9s ago] {}
2025-12-29 11:56:34,279 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:56:34,291 - sqlalchemy.engine.Engine - INFO - [cached since 760.9s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:56:34,296 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:56:34,304 - sqlalchemy.engine.Engine - INFO - [cached since 760.8s ago] {}
2025-12-29 11:56:34,310 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:56:34,325 - sqlalchemy.engine.Engine - INFO - [cached since 760.8s ago] {}
2025-12-29 11:56:34,329 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:56:34,341 - sqlalchemy.engine.Engine - INFO - [cached since 760.8s ago] {'status_1': 'completed'}
2025-12-29 11:56:34,346 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:56:34,357 - sqlalchemy.engine.Engine - INFO - [cached since 760.8s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:56:34,363 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:56:34,366 - sqlalchemy.engine.Engine - INFO - [cached since 760.8s ago] {}
2025-12-29 11:56:34,374 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:56:34,375 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:56:34,389 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:56:34,394 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:34,401 - sqlalchemy.engine.Engine - INFO - [cached since 761.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:56:34,408 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:34,415 - sqlalchemy.engine.Engine - INFO - [cached since 760.8s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:56:34,422 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:56:34,429 - sqlalchemy.engine.Engine - INFO - [cached since 760.7s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 22, 6, 26, 34, 420808), 'param_1': 100}
2025-12-29 11:56:34,437 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s AND scan_results.scan_timestamp >= %(scan_timestamp_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:56:34,456 - sqlalchemy.engine.Engine - INFO - [cached since 760.7s ago] {'device_id_1': 7, 'scan_timestamp_1': datetime.datetime(2025, 12, 22, 6, 26, 34, 420808), 'param_1': 100}
2025-12-29 11:56:34,467 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:56:34,471 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:56:34,476 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:34,485 - sqlalchemy.engine.Engine - INFO - [cached since 761.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:56:34,492 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:56:34,502 - sqlalchemy.engine.Engine - INFO - [cached since 761.2s ago] {}
2025-12-29 11:56:34,507 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:56:34,516 - sqlalchemy.engine.Engine - INFO - [cached since 761.1s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 16, 34, 505857)}
2025-12-29 11:56:34,523 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:56:34,531 - sqlalchemy.engine.Engine - INFO - [cached since 761.1s ago] {}
2025-12-29 11:56:34,536 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:56:34,544 - sqlalchemy.engine.Engine - INFO - [cached since 761.1s ago] {}
2025-12-29 11:56:34,548 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:56:34,558 - sqlalchemy.engine.Engine - INFO - [cached since 761.1s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:56:34,564 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:56:34,571 - sqlalchemy.engine.Engine - INFO - [cached since 761.1s ago] {}
2025-12-29 11:56:34,575 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:56:34,582 - sqlalchemy.engine.Engine - INFO - [cached since 761.1s ago] {}
2025-12-29 11:56:34,590 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:56:34,598 - sqlalchemy.engine.Engine - INFO - [cached since 761.1s ago] {'status_1': 'completed'}
2025-12-29 11:56:34,603 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:56:34,614 - sqlalchemy.engine.Engine - INFO - [cached since 761.1s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:56:34,621 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:56:34,624 - sqlalchemy.engine.Engine - INFO - [cached since 761.1s ago] {}
2025-12-29 11:56:34,633 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:56:34,638 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:34,657 - sqlalchemy.engine.Engine - INFO - [cached since 761.4s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:56:34,664 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:34,669 - sqlalchemy.engine.Engine - INFO - [cached since 761s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:56:34,674 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.device_id = %(device_id_1)s AND device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:56:34,680 - sqlalchemy.engine.Engine - INFO - [cached since 761s ago] {'device_id_1': 7, 'event_timestamp_1': datetime.datetime(2025, 12, 22, 6, 26, 34, 673384), 'param_1': 100}
2025-12-29 11:56:34,687 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s AND scan_results.scan_timestamp >= %(scan_timestamp_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:56:34,698 - sqlalchemy.engine.Engine - INFO - [cached since 761s ago] {'device_id_1': 7, 'scan_timestamp_1': datetime.datetime(2025, 12, 22, 6, 26, 34, 673384), 'param_1': 100}
2025-12-29 11:56:34,706 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:56:34,710 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:56:34,726 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:56:34,729 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:34,736 - sqlalchemy.engine.Engine - INFO - [cached since 761.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:56:34,744 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:56:34,756 - sqlalchemy.engine.Engine - INFO - [cached since 761.4s ago] {}
2025-12-29 11:56:34,763 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:56:34,774 - sqlalchemy.engine.Engine - INFO - [cached since 761.4s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 16, 34, 761961)}
2025-12-29 11:56:34,780 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:56:34,793 - sqlalchemy.engine.Engine - INFO - [cached since 761.4s ago] {}
2025-12-29 11:56:34,799 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:56:34,810 - sqlalchemy.engine.Engine - INFO - [cached since 761.4s ago] {}
2025-12-29 11:56:34,816 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:56:34,826 - sqlalchemy.engine.Engine - INFO - [cached since 761.4s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:56:34,830 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:56:34,840 - sqlalchemy.engine.Engine - INFO - [cached since 761.4s ago] {}
2025-12-29 11:56:34,845 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:56:34,855 - sqlalchemy.engine.Engine - INFO - [cached since 761.4s ago] {}
2025-12-29 11:56:34,861 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:56:34,869 - sqlalchemy.engine.Engine - INFO - [cached since 761.4s ago] {'status_1': 'completed'}
2025-12-29 11:56:34,873 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:56:34,883 - sqlalchemy.engine.Engine - INFO - [cached since 761.3s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:56:34,889 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:56:34,893 - sqlalchemy.engine.Engine - INFO - [cached since 761.3s ago] {}
2025-12-29 11:56:34,902 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:56:34,906 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:56:34,909 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:34,914 - sqlalchemy.engine.Engine - INFO - [cached since 761.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:56:34,919 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:56:34,931 - sqlalchemy.engine.Engine - INFO - [cached since 760.9s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 28, 6, 26, 34, 918418), 'param_1': 100}
2025-12-29 11:56:34,939 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:34,948 - sqlalchemy.engine.Engine - INFO - [cached since 761.3s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:34,957 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:34,966 - sqlalchemy.engine.Engine - INFO - [cached since 761.3s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:34,973 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:34,979 - sqlalchemy.engine.Engine - INFO - [cached since 761.3s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:35,019 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:35,154 - sqlalchemy.engine.Engine - INFO - [cached since 761.5s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:35,337 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:35,395 - sqlalchemy.engine.Engine - INFO - [cached since 761.7s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:35,406 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:35,434 - sqlalchemy.engine.Engine - INFO - [cached since 761.8s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:35,448 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:35,500 - sqlalchemy.engine.Engine - INFO - [cached since 761.8s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:35,573 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:35,595 - sqlalchemy.engine.Engine - INFO - [cached since 761.9s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:35,601 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:35,618 - sqlalchemy.engine.Engine - INFO - [cached since 762s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:56:35,627 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:35,642 - sqlalchemy.engine.Engine - INFO - [cached since 762s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:35,648 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:35,663 - sqlalchemy.engine.Engine - INFO - [cached since 762s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:35,671 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:35,690 - sqlalchemy.engine.Engine - INFO - [cached since 762s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:35,697 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:35,711 - sqlalchemy.engine.Engine - INFO - [cached since 762.1s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:56:35,725 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:35,744 - sqlalchemy.engine.Engine - INFO - [cached since 762.1s ago] {'id_1': 13, 'param_1': 1}
2025-12-29 11:56:35,751 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:35,775 - sqlalchemy.engine.Engine - INFO - [cached since 762.1s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:56:35,780 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:35,801 - sqlalchemy.engine.Engine - INFO - [cached since 762.1s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:35,806 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:35,818 - sqlalchemy.engine.Engine - INFO - [cached since 762.2s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:56:35,826 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:35,838 - sqlalchemy.engine.Engine - INFO - [cached since 762.2s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:56:35,846 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:35,868 - sqlalchemy.engine.Engine - INFO - [cached since 762.2s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:56:35,877 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:35,895 - sqlalchemy.engine.Engine - INFO - [cached since 762.2s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:56:35,912 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:56:35,922 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:35,934 - sqlalchemy.engine.Engine - INFO - [cached since 762.7s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:56:35,942 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:56:35,974 - sqlalchemy.engine.Engine - INFO - [cached since 762.6s ago] {}
2025-12-29 11:56:35,994 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.last_seen >= %(last_seen_1)s) AS anon_1
2025-12-29 11:56:36,011 - sqlalchemy.engine.Engine - INFO - [cached since 762.6s ago] {'last_seen_1': datetime.datetime(2025, 12, 29, 6, 16, 35, 990023)}
2025-12-29 11:56:36,023 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_trusted = true) AS anon_1
2025-12-29 11:56:36,038 - sqlalchemy.engine.Engine - INFO - [cached since 762.6s ago] {}
2025-12-29 11:56:36,044 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.is_suspicious = true) AS anon_1
2025-12-29 11:56:36,058 - sqlalchemy.engine.Engine - INFO - [cached since 762.6s ago] {}
2025-12-29 11:56:36,065 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.first_seen >= %(first_seen_1)s) AS anon_1
2025-12-29 11:56:36,080 - sqlalchemy.engine.Engine - INFO - [cached since 762.6s ago] {'first_seen_1': datetime.datetime(2025, 12, 29, 0, 0)}
2025-12-29 11:56:36,088 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts) AS anon_1
2025-12-29 11:56:36,099 - sqlalchemy.engine.Engine - INFO - [cached since 762.6s ago] {}
2025-12-29 11:56:36,106 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT alerts.id AS alerts_id, alerts.device_id AS alerts_device_id, alerts.alert_type AS alerts_alert_type, alerts.severity AS alerts_severity, alerts.message AS alerts_message, alerts.details AS alerts_details, alerts.is_acknowledged AS alerts_is_acknowledged, alerts.acknowledged_by AS alerts_acknowledged_by, alerts.created_at AS alerts_created_at, alerts.acknowledged_at AS alerts_acknowledged_at 
FROM alerts 
WHERE alerts.is_acknowledged = false) AS anon_1
2025-12-29 11:56:36,124 - sqlalchemy.engine.Engine - INFO - [cached since 762.6s ago] {}
2025-12-29 11:56:36,131 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s) AS anon_1
2025-12-29 11:56:36,147 - sqlalchemy.engine.Engine - INFO - [cached since 762.6s ago] {'status_1': 'completed'}
2025-12-29 11:56:36,156 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:56:36,177 - sqlalchemy.engine.Engine - INFO - [cached since 762.6s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:56:36,191 - sqlalchemy.engine.Engine - INFO - SELECT devices.vendor AS devices_vendor, count(devices.id) AS count_1 
FROM devices 
WHERE devices.vendor IS NOT NULL GROUP BY devices.vendor
2025-12-29 11:56:36,204 - sqlalchemy.engine.Engine - INFO - [cached since 762.6s ago] {}
2025-12-29 11:56:36,222 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:56:36,235 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:56:36,279 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:56:36,298 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,314 - sqlalchemy.engine.Engine - INFO - [cached since 763.1s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:56:36,328 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:56:36,343 - sqlalchemy.engine.Engine - INFO - [cached since 762.3s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 28, 6, 26, 36, 326412), 'param_1': 100}
2025-12-29 11:56:36,359 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,374 - sqlalchemy.engine.Engine - INFO - [cached since 762.7s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:36,383 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,400 - sqlalchemy.engine.Engine - INFO - [cached since 762.7s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:36,407 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,426 - sqlalchemy.engine.Engine - INFO - [cached since 762.8s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:36,434 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,446 - sqlalchemy.engine.Engine - INFO - [cached since 762.8s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:36,454 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,467 - sqlalchemy.engine.Engine - INFO - [cached since 762.8s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:36,475 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,488 - sqlalchemy.engine.Engine - INFO - [cached since 762.8s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:36,496 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,512 - sqlalchemy.engine.Engine - INFO - [cached since 762.9s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:36,518 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,531 - sqlalchemy.engine.Engine - INFO - [cached since 762.9s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:36,543 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,553 - sqlalchemy.engine.Engine - INFO - [cached since 762.9s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:56:36,559 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,565 - sqlalchemy.engine.Engine - INFO - [cached since 762.9s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:36,571 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,577 - sqlalchemy.engine.Engine - INFO - [cached since 762.9s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:36,585 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,597 - sqlalchemy.engine.Engine - INFO - [cached since 762.9s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:36,603 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,612 - sqlalchemy.engine.Engine - INFO - [cached since 763s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:56:36,618 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,628 - sqlalchemy.engine.Engine - INFO - [cached since 763s ago] {'id_1': 13, 'param_1': 1}
2025-12-29 11:56:36,634 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,644 - sqlalchemy.engine.Engine - INFO - [cached since 763s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:56:36,650 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,661 - sqlalchemy.engine.Engine - INFO - [cached since 763s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:36,667 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,677 - sqlalchemy.engine.Engine - INFO - [cached since 763s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:56:36,684 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,695 - sqlalchemy.engine.Engine - INFO - [cached since 763s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:56:36,700 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,711 - sqlalchemy.engine.Engine - INFO - [cached since 763.1s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:56:36,717 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,728 - sqlalchemy.engine.Engine - INFO - [cached since 763.1s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:56:36,741 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:56:36,747 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:56:36,754 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,765 - sqlalchemy.engine.Engine - INFO - [cached since 763.5s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:56:36,772 - sqlalchemy.engine.Engine - INFO - SELECT device_activity.id AS device_activity_id, device_activity.device_id AS device_activity_device_id, device_activity.event_type AS device_activity_event_type, device_activity.old_value AS device_activity_old_value, device_activity.new_value AS device_activity_new_value, device_activity.event_timestamp AS device_activity_event_timestamp 
FROM device_activity 
WHERE device_activity.event_timestamp >= %(event_timestamp_1)s ORDER BY device_activity.event_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:56:36,781 - sqlalchemy.engine.Engine - INFO - [cached since 762.7s ago] {'event_timestamp_1': datetime.datetime(2025, 12, 28, 6, 26, 36, 771368), 'param_1': 100}
2025-12-29 11:56:36,793 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,804 - sqlalchemy.engine.Engine - INFO - [cached since 763.1s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:36,810 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,820 - sqlalchemy.engine.Engine - INFO - [cached since 763.2s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:36,826 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,835 - sqlalchemy.engine.Engine - INFO - [cached since 763.2s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:36,842 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,852 - sqlalchemy.engine.Engine - INFO - [cached since 763.2s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:36,859 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,870 - sqlalchemy.engine.Engine - INFO - [cached since 763.2s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:36,876 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,889 - sqlalchemy.engine.Engine - INFO - [cached since 763.2s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:36,895 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,906 - sqlalchemy.engine.Engine - INFO - [cached since 763.3s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:36,912 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,922 - sqlalchemy.engine.Engine - INFO - [cached since 763.3s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:36,928 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,937 - sqlalchemy.engine.Engine - INFO - [cached since 763.3s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:56:36,944 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,955 - sqlalchemy.engine.Engine - INFO - [cached since 763.3s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:36,962 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,974 - sqlalchemy.engine.Engine - INFO - [cached since 763.3s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:36,979 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:36,995 - sqlalchemy.engine.Engine - INFO - [cached since 763.3s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:37,002 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:37,011 - sqlalchemy.engine.Engine - INFO - [cached since 763.4s ago] {'id_1': 14, 'param_1': 1}
2025-12-29 11:56:37,017 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:37,027 - sqlalchemy.engine.Engine - INFO - [cached since 763.4s ago] {'id_1': 13, 'param_1': 1}
2025-12-29 11:56:37,032 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:37,041 - sqlalchemy.engine.Engine - INFO - [cached since 763.4s ago] {'id_1': 8, 'param_1': 1}
2025-12-29 11:56:37,047 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:37,058 - sqlalchemy.engine.Engine - INFO - [cached since 763.4s ago] {'id_1': 9, 'param_1': 1}
2025-12-29 11:56:37,065 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:37,074 - sqlalchemy.engine.Engine - INFO - [cached since 763.4s ago] {'id_1': 10, 'param_1': 1}
2025-12-29 11:56:37,080 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:37,091 - sqlalchemy.engine.Engine - INFO - [cached since 763.4s ago] {'id_1': 11, 'param_1': 1}
2025-12-29 11:56:37,098 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:37,107 - sqlalchemy.engine.Engine - INFO - [cached since 763.5s ago] {'id_1': 12, 'param_1': 1}
2025-12-29 11:56:37,113 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices 
WHERE devices.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:56:37,124 - sqlalchemy.engine.Engine - INFO - [cached since 763.5s ago] {'id_1': 7, 'param_1': 1}
2025-12-29 11:56:37,135 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:57:18,330 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:57:18,334 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:57:18,344 - sqlalchemy.engine.Engine - INFO - [cached since 805.1s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:57:18,353 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:57:18,374 - sqlalchemy.engine.Engine - INFO - [cached since 804.8s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:57:18,383 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:57:18,402 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:57:18,405 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:57:18,415 - sqlalchemy.engine.Engine - INFO - [cached since 805.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:57:18,422 - sqlalchemy.engine.Engine - INFO - SELECT scan_sessions.id AS scan_sessions_id, scan_sessions.started_at AS scan_sessions_started_at, scan_sessions.completed_at AS scan_sessions_completed_at, scan_sessions.total_devices_found AS scan_sessions_total_devices_found, scan_sessions.new_devices_found AS scan_sessions_new_devices_found, scan_sessions.scan_type AS scan_sessions_scan_type, scan_sessions.network_range AS scan_sessions_network_range, scan_sessions.status AS scan_sessions_status, scan_sessions.error_message AS scan_sessions_error_message 
FROM scan_sessions 
WHERE scan_sessions.status = %(status_1)s ORDER BY scan_sessions.completed_at DESC 
 LIMIT %(param_1)s
2025-12-29 11:57:18,451 - sqlalchemy.engine.Engine - INFO - [cached since 804.9s ago] {'status_1': 'completed', 'param_1': 1}
2025-12-29 11:57:18,466 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:57:18,480 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:57:18,483 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:57:18,498 - sqlalchemy.engine.Engine - INFO - [cached since 805.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:57:18,510 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:57:18,516 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:57:18,520 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:57:18,532 - sqlalchemy.engine.Engine - INFO - [cached since 805.3s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:57:18,545 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:57:19,782 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:57:19,785 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:57:19,797 - sqlalchemy.engine.Engine - INFO - [cached since 806.6s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:57:19,805 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:57:19,817 - sqlalchemy.engine.Engine - INFO - [cached since 806.5s ago] {}
2025-12-29 11:57:19,823 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:57:19,837 - sqlalchemy.engine.Engine - INFO - [cached since 801.7s ago] {'param_1': 0, 'param_2': 20}
2025-12-29 11:57:19,845 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:57:19,856 - sqlalchemy.engine.Engine - INFO - [cached since 801.7s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:57:19,864 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:57:19,876 - sqlalchemy.engine.Engine - INFO - [cached since 801.7s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:57:19,881 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:57:19,892 - sqlalchemy.engine.Engine - INFO - [cached since 801.7s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:57:19,900 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:57:19,910 - sqlalchemy.engine.Engine - INFO - [cached since 801.7s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:57:19,915 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:57:19,923 - sqlalchemy.engine.Engine - INFO - [cached since 801.7s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:57:20,054 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:57:20,092 - sqlalchemy.engine.Engine - INFO - [cached since 801.9s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:57:20,111 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:57:20,227 - sqlalchemy.engine.Engine - INFO - [cached since 802s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:57:20,338 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:57:20,350 - sqlalchemy.engine.Engine - INFO - [cached since 802.2s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-29 11:57:20,363 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:57:20,374 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2025-12-29 11:57:20,384 - sqlalchemy.engine.Engine - INFO - SELECT users.id AS users_id, users.username AS users_username, users.email AS users_email, users.password_hash AS users_password_hash, users.role AS users_role, users.is_active AS users_is_active, users.created_at AS users_created_at, users.last_login AS users_last_login 
FROM users 
WHERE users.id = %(id_1)s 
 LIMIT %(param_1)s
2025-12-29 11:57:20,404 - sqlalchemy.engine.Engine - INFO - [cached since 807.2s ago] {'id_1': 1, 'param_1': 1}
2025-12-29 11:57:20,512 - sqlalchemy.engine.Engine - INFO - SELECT count(*) AS count_1 
FROM (SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices) AS anon_1
2025-12-29 11:57:20,547 - sqlalchemy.engine.Engine - INFO - [cached since 807.2s ago] {}
2025-12-29 11:57:20,588 - sqlalchemy.engine.Engine - INFO - SELECT devices.id AS devices_id, devices.mac_address AS devices_mac_address, devices.hostname AS devices_hostname, devices.vendor AS devices_vendor, devices.device_type AS devices_device_type, devices.first_seen AS devices_first_seen, devices.last_seen AS devices_last_seen, devices.is_trusted AS devices_is_trusted, devices.is_suspicious AS devices_is_suspicious, devices.notes AS devices_notes 
FROM devices ORDER BY devices.last_seen DESC 
 LIMIT %(param_1)s, %(param_2)s
2025-12-29 11:57:20,608 - sqlalchemy.engine.Engine - INFO - [cached since 802.4s ago] {'param_1': 0, 'param_2': 20}
2025-12-29 11:57:20,616 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:57:20,634 - sqlalchemy.engine.Engine - INFO - [cached since 802.4s ago] {'device_id_1': 9, 'param_1': 1}
2025-12-29 11:57:20,643 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:57:20,659 - sqlalchemy.engine.Engine - INFO - [cached since 802.5s ago] {'device_id_1': 10, 'param_1': 1}
2025-12-29 11:57:20,675 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:57:20,710 - sqlalchemy.engine.Engine - INFO - [cached since 802.5s ago] {'device_id_1': 11, 'param_1': 1}
2025-12-29 11:57:20,717 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:57:20,740 - sqlalchemy.engine.Engine - INFO - [cached since 802.6s ago] {'device_id_1': 12, 'param_1': 1}
2025-12-29 11:57:20,749 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:57:20,767 - sqlalchemy.engine.Engine - INFO - [cached since 802.6s ago] {'device_id_1': 13, 'param_1': 1}
2025-12-29 11:57:20,783 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:57:20,810 - sqlalchemy.engine.Engine - INFO - [cached since 802.6s ago] {'device_id_1': 8, 'param_1': 1}
2025-12-29 11:57:20,825 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:57:20,853 - sqlalchemy.engine.Engine - INFO - [cached since 802.7s ago] {'device_id_1': 14, 'param_1': 1}
2025-12-29 11:57:20,866 - sqlalchemy.engine.Engine - INFO - SELECT scan_results.id AS scan_results_id, scan_results.device_id AS scan_results_device_id, scan_results.ip_address AS scan_results_ip_address, scan_results.rssi AS scan_results_rssi, scan_results.scan_timestamp AS scan_results_scan_timestamp, scan_results.is_connected AS scan_results_is_connected, scan_results.response_time_ms AS scan_results_response_time_ms 
FROM scan_results 
WHERE scan_results.device_id = %(device_id_1)s ORDER BY scan_results.scan_timestamp DESC 
 LIMIT %(param_1)s
2025-12-29 11:57:20,891 - sqlalchemy.engine.Engine - INFO - [cached since 802.7s ago] {'device_id_1': 7, 'param_1': 1}
2025-12-29 11:57:20,914 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2025-12-29 11:57:22,684 - app.services.notification - INFO - WebSocket client unregistered. Total: 2
2025-12-29 11:57:22,686 - app.main - INFO - WebSocket client disconnected
2025-12-29 11:57:22,694 - app.services.notification - INFO - WebSocket client unregistered. Total: 1
2025-12-29 11:57:22,698 - app.main - INFO - WebSocket client disconnected
2025-12-29 11:57:23,754 - app.services.notification - INFO - WebSocket client unregistered. Total: 0
2025-12-29 11:57:23,757 - app.main - INFO - WebSocket client disconnected
